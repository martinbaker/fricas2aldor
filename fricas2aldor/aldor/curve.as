[File 

 [DEF FunctionFieldCategory F UP UPUP add
 DEFSubnode:atts= Category
  [Node list symbol=Category ]
  
 DEFSubnode:atts= UniqueFactorizationDomain
  [Node list symbol=UniqueFactorizationDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory F
  [Node list symbol=UnivariatePolynomialCategory symbol=F ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=MonogenicAlgebra symbol=UPUP 
   
    [Node list symbol=Fraction symbol=UP ]
    ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=numberOfComponents 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=genus 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=absolutelyIrreducible? 
    
     [Node list 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=rationalPoint? 
    
     [Node list symbol=F symbol=F 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=branchPointAtInfinity? 
    
     [Node list 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=branchPoint? 
    
     [Node list symbol=F 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=branchPoint? 
    
     [Node list symbol=UP 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=singularAtInfinity? 
    
     [Node list 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=singular? 
    
     [Node list symbol=F 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=singular? 
    
     [Node list symbol=UP 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ramifiedAtInfinity? 
    
     [Node list 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ramified? 
    
     [Node list symbol=F 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ramified? 
    
     [Node list symbol=UP 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralBasis 
    
     [Node list 
     
      [Node list symbol=Vector symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralBasisAtInfinity 
    
     [Node list 
     
      [Node list symbol=Vector symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralAtInfinity? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integral? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=complementaryBasis 
    
     [Node list 
     
      [Node list symbol=Vector symbol=$ ]
      
      [Node list symbol=Vector symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=normalizeAtInfinity 
    
     [Node list 
     
      [Node list symbol=Vector symbol=$ ]
      
      [Node list symbol=Vector symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=reduceBasisAtInfinity 
    
     [Node list 
     
      [Node list symbol=Vector symbol=$ ]
      
      [Node list symbol=Vector symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralMatrix 
    
     [Node list 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=inverseIntegralMatrix 
    
     [Node list 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralMatrixAtInfinity 
    
     [Node list 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=inverseIntegralMatrixAtInfinity 
    
     [Node list 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=yCoordinates 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=num 
       
        [Node list symbol=Vector symbol=UP ]
        ]
       
       [Node list symbol=: symbol=den symbol=UP ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralCoordinates 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=num 
       
        [Node list symbol=Vector symbol=UP ]
        ]
       
       [Node list symbol=: symbol=den symbol=UP ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralRepresents 
    
     [Node list symbol=$ symbol=UP 
     
      [Node list symbol=Vector symbol=UP ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integralDerivationMatrix 
    
     [Node list 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=num 
       
        [Node list symbol=Matrix symbol=UP ]
        ]
       
       [Node list symbol=: symbol=den symbol=UP ]
       ]
      
      [Node list symbol=Mapping symbol=UP symbol=UP ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integral? 
    
     [Node list symbol=$ symbol=F 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integral? 
    
     [Node list symbol=$ symbol=UP 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=differentiate 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=UP symbol=UP ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=represents 
    
     [Node list symbol=$ symbol=UP 
     
      [Node list symbol=Vector symbol=UP ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=primitivePart 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=elt 
    
     [Node list symbol=F symbol=$ symbol=F symbol=F ]
     ]
    
    [Node list symbol=SIGNATURE symbol=elliptic 
    
     [Node list 
     
      [Node list symbol=Union symbol=UP string=failed ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=hyperelliptic 
    
     [Node list 
     
      [Node list symbol=Union symbol=UP string=failed ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=algSplitSimple 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=num symbol=$ ]
       
       [Node list symbol=: symbol=den symbol=UP ]
       
       [Node list symbol=: symbol=derivden symbol=UP ]
       
       [Node list symbol=: symbol=gd symbol=UP ]
       ]
      
      [Node list symbol=Mapping symbol=UP symbol=UP ]
      ]
     ]
    
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=F 
     
      [Node list symbol=Field ]
      ]
     
     [Node list symbol=SIGNATURE symbol=nonSingularModel 
     
      [Node list 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=F ]
        ]
       
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=F 
     
      [Node list symbol=Finite ]
      ]
     
     [Node list symbol=SIGNATURE symbol=rationalPoints 
     
      [Node list 
      
       [Node list symbol=List 
       
        [Node list symbol=List symbol=F ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=import 
   
    [Node list symbol=InnerCommonDenominator symbol=UP 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=Vector symbol=UP ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=UnivariatePolynomialCommonDenominator symbol=UP symbol=UPUP 
    
     [Node list symbol=Fraction symbol=UP ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=NonNegativeInteger ]
    ]
   
   [Node list symbol=: symbol=repOrder 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Integer ]
     
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     
     [Node list symbol=Integer ]
     ]
    ]
   
   [Node list symbol=: symbol=Q2RF 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=Fraction symbol=F ]
     ]
    ]
   
   [Node list symbol=: symbol=infOrder 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Integer ]
     
     [Node list symbol=Fraction symbol=UP ]
     ]
    ]
   
   [Node list symbol=: symbol=infValue 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Fraction symbol=F ]
     
     [Node list symbol=Fraction symbol=UP ]
     ]
    ]
   
   [Node list symbol=: symbol=intvalue 
   
    [Node list symbol=Mapping symbol=F symbol=F symbol=F 
    
     [Node list symbol=Vector symbol=UP ]
     ]
    ]
   
   [Node list symbol=: symbol=rfmonom 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=Integer ]
     ]
    ]
   
   [Node list symbol=: symbol=kmin 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=pos 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=km 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=F ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=Q2RF symbol=q ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=/ 
    
     [Node list symbol=:: symbol=UP 
     
      [Node list symbol=numer symbol=q ]
      ]
     
     [Node list symbol=:: symbol=UP 
     
      [Node list symbol=denom symbol=q ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=infOrder symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=- 
    
     [Node list symbol=:: 
     
      [Node list symbol=degree 
      
       [Node list symbol=denom symbol=f ]
       ]
      
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=degree 
      
       [Node list symbol=numer symbol=f ]
       ]
      
      [Node list symbol=Integer ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integral? symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=ground? 
    
     [Node list symbol=den 
     
      [Node list symbol=integralCoordinates symbol=f ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integral? symbol=f symbol=a ]
    
    [Node list symbol=$ symbol=F 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=~= 
    
     [Node list symbol=a 
     
      [Node list symbol=den 
      
       [Node list symbol=integralCoordinates symbol=f ]
       ]
      ]
     
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=absolutelyIrreducible? ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol== 
    
     [Node list symbol=numberOfComponents ]
     
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=yCoordinates symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=splitDenominator 
    
     [Node list symbol=coordinates symbol=f ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=hyperelliptic ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G392703 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= int=2 
      
       [Node list symbol=degree 
       
        [Node list symbol=LET symbol=f 
        
         [Node list symbol=definingPolynomial ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G392703 string=failed 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=u 
        
         [Node list symbol=@ 
         
          [Node list symbol=retractIfCan 
          
           [Node list symbol=reductum symbol=f ]
           ]
          
          [Node list symbol=Union string=failed 
          
           [Node list symbol=Fraction symbol=UP ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF string=failed 
         
          [Node list symbol=case symbol=u string=failed ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=v 
           
            [Node list symbol=@ 
            
             [Node list symbol=retractIfCan 
             
              [Node list symbol=- 
              
               [Node list symbol=/ 
               
                [Node list symbol=:: symbol=u 
                
                 [Node list symbol=Fraction symbol=UP ]
                 ]
                
                [Node list symbol=leadingCoefficient symbol=f ]
                ]
               ]
              ]
             
             [Node list symbol=Union symbol=UP string=failed ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF string=failed 
            
             [Node list symbol=case symbol=v string=failed ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G392704 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=odd? 
               
                [Node list symbol=degree 
                
                 [Node list symbol=LET symbol=p 
                 
                  [Node list symbol=:: symbol=v symbol=UP ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G392704 symbol=p string=failed ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=algSplitSimple symbol=f symbol=derivation ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=cd 
     
      [Node list symbol=splitDenominator 
      
       [Node list symbol=lift symbol=f ]
       ]
      ]
     
     [Node list symbol=LET symbol=dd 
     
      [Node list symbol=:: symbol=UP 
      
       [Node list symbol=exquo 
       
        [Node list symbol=cd symbol=den ]
        
        [Node list symbol=LET symbol=g 
        
         [Node list symbol=gcd 
         
          [Node list symbol=cd symbol=den ]
          
          [Node list symbol=derivation 
          
           [Node list symbol=cd symbol=den ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct symbol=dd 
      
       [Node list symbol=reduce 
       
        [Node list symbol=* 
        
         [Node list symbol=inv 
         
          [Node list symbol=:: symbol=g 
          
           [Node list symbol=Fraction symbol=UP ]
           ]
          ]
         
         [Node list symbol=cd symbol=num ]
         ]
        ]
       
       [Node list symbol=derivation symbol=dd ]
       
       [Node list symbol=gcd symbol=dd 
       
        [Node list symbol=@ symbol=UP 
        
         [Node list symbol=retract 
         
          [Node list symbol=discriminant ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=elliptic ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=u 
     
      [Node list symbol=hyperelliptic ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF string=failed 
      
       [Node list symbol=case symbol=u string=failed ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G392705 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol== int=3 
         
          [Node list symbol=degree 
          
           [Node list symbol=LET symbol=p 
           
            [Node list symbol=:: symbol=u symbol=UP ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G392705 symbol=p string=failed ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=Fraction symbol=UP ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=rationalPoint? symbol=x symbol=y ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=zero? 
    
     [Node list 
     
      [Node list 
      
       [Node list symbol=definingPolynomial ]
       
       [Node list symbol=:: 
       
        [Node list symbol=:: symbol=y symbol=UP ]
        
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=:: symbol=x symbol=UP ]
       
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=F 
    
     [Node list symbol=Field ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=import 
     
      [Node list symbol=PolyGroebner symbol=F ]
      ]
     
     [Node list symbol=import 
     
      [Node list symbol=MatrixCommonDenominator symbol=UP 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     
     [Node list symbol=: symbol=UP2P 
     
      [Node list symbol=Mapping symbol=UP 
      
       [Node list symbol=Polynomial symbol=F ]
       
       [Node list symbol=Polynomial symbol=F ]
       ]
      ]
     
     [Node list symbol=: symbol=UPUP2P 
     
      [Node list symbol=Mapping symbol=UPUP 
      
       [Node list symbol=Polynomial symbol=F ]
       
       [Node list symbol=Polynomial symbol=F ]
       
       [Node list symbol=Polynomial symbol=F ]
       ]
      ]
     
     [Node list symbol=DEF 
     
      [Node list symbol=UP2P symbol=p symbol=x ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=x 
      
       [Node list symbol=p 
       
        [Node list symbol=Sel symbol=map 
        
         [Node list symbol=UnivariatePolynomialCategoryFunctions2 symbol=F symbol=UP 
         
          [Node list symbol=Polynomial symbol=F ]
          
          [Node list symbol=SparseUnivariatePolynomial 
          
           [Node list symbol=Polynomial symbol=F ]
           ]
          ]
         ]
        
        [Node list symbol=+-> 
        
         [Node list symbol=: 
         
          [Node list symbol=: symbol=s symbol=F ]
          
          [Node list symbol=Polynomial symbol=F ]
          ]
         
         [Node list symbol=:: symbol=s 
         
          [Node list symbol=Polynomial symbol=F ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=DEF 
     
      [Node list symbol=UPUP2P symbol=p symbol=x symbol=y ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=y 
      
       [Node list symbol=p 
       
        [Node list symbol=Sel symbol=map 
        
         [Node list symbol=UnivariatePolynomialCategoryFunctions2 symbol=UPUP 
         
          [Node list symbol=Fraction symbol=UP ]
          
          [Node list symbol=Polynomial symbol=F ]
          
          [Node list symbol=SparseUnivariatePolynomial 
          
           [Node list symbol=Polynomial symbol=F ]
           ]
          ]
         ]
        
        [Node list symbol=+-> 
        
         [Node list symbol=: 
         
          [Node list symbol=: symbol=s 
          
           [Node list symbol=Fraction symbol=UP ]
           ]
          
          [Node list symbol=Polynomial symbol=F ]
          ]
         
         [Node list symbol=UP2P symbol=x 
         
          [Node list symbol=@ symbol=UP 
          
           [Node list symbol=retract symbol=s ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DEF 
      
       [Node list symbol=nonSingularModel symbol=u ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=import 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=LET symbol=d 
        
         [Node list symbol=:: 
         
          [Node list symbol=commonDenominator 
          
           [Node list symbol=coordinates 
           
            [Node list symbol=LET symbol=w 
            
             [Node list symbol=integralBasis ]
             ]
            ]
           ]
          
          [Node list symbol=Fraction symbol=UP ]
          ]
         ]
        
        [Node list symbol=LET symbol=vars 
        
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=One ]
            
            [Node list symbol=LET symbol=n 
            
             [Node list symbol=# symbol=w ]
             ]
            ]
           ]
          
          [Node list symbol=:: 
          
           [Node list symbol=concat 
           
            [Node list symbol=string symbol=u ]
            
            [Node list symbol=string symbol=i ]
            ]
           
           [Node list symbol=Symbol ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=x 
        
         [Node list symbol=QUOTE symbol=%%dummy1 ]
         ]
        
        [Node list symbol=LET symbol=y 
        
         [Node list symbol=QUOTE symbol=%%dummy2 ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=select! 
         
          [Node list symbol=+-> symbol=s 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G392706 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=zero? 
             
              [Node list symbol=degree symbol=s symbol=x ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G392706 symbol=false 
             
              [Node list symbol=zero? 
              
               [Node list symbol=degree symbol=s symbol=y ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=lexGroebner 
          
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=v symbol=vars ]
            
            [Node list symbol=IN symbol=i 
            
             [Node list symbol=SEGMENT symbol=n 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=- 
            
             [Node list symbol=:: symbol=v 
             
              [Node list symbol=Polynomial symbol=F ]
              ]
             
             [Node list symbol=UPUP2P 
             
              [Node list symbol=lift 
              
               [Node list symbol=* symbol=d 
               
                [Node list symbol=w symbol=i ]
                ]
               ]
              
              [Node list symbol=:: symbol=x 
              
               [Node list symbol=Polynomial symbol=F ]
               ]
              
              [Node list symbol=:: symbol=y 
              
               [Node list symbol=Polynomial symbol=F ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=concat symbol=vars 
           
            [Node list symbol=construct symbol=x symbol=y ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=F 
    
     [Node list symbol=Finite ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=: symbol=ispoint 
     
      [Node list symbol=Mapping symbol=UPUP symbol=F symbol=F 
      
       [Node list symbol=List symbol=F ]
       ]
      ]
     
     [Node list symbol=DEF 
     
      [Node list symbol=ispoint symbol=p symbol=x symbol=y ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=jhd 
        
         [Node list symbol=Fraction symbol=UP ]
         ]
        
        [Node list symbol=p 
        
         [Node list symbol=:: 
         
          [Node list symbol=:: symbol=y symbol=UP ]
          
          [Node list symbol=Fraction symbol=UP ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G392707 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? 
        
         [Node list symbol=jhd 
         
          [Node list symbol=:: 
          
           [Node list symbol=:: symbol=x symbol=UP ]
           
           [Node list symbol=Fraction symbol=UP ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G392707 
        
         [Node list symbol=construct symbol=x symbol=y ]
         
         [Node list symbol=empty ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DEF 
      
       [Node list symbol=rationalPoints ]
       
       [Node list 
       
        [Node list ]
        ]
       
       [Node list 
       
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=p 
        
         [Node list symbol=definingPolynomial ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=concat 
         
          [Node list 
          
           [Node list symbol=Sel symbol=COLLECT 
           
            [Node list symbol=List 
            
             [Node list symbol=List 
             
              [Node list symbol=List symbol=F ]
              ]
             ]
            ]
           
           [Node list symbol=IN symbol=x 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=One ]
             
             [Node list 
             
              [Node list symbol=Sel symbol=F symbol=size ]
              ]
             ]
            ]
           
           [Node list symbol=pt 
           
            [Node list symbol=Sel symbol=COLLECT 
            
             [Node list symbol=List 
             
              [Node list symbol=List symbol=F ]
              ]
             ]
            
            [Node list symbol=IN symbol=y 
            
             [Node list symbol=SEGMENT 
             
              [Node list symbol=One ]
              
              [Node list 
              
               [Node list symbol=Sel symbol=F symbol=size ]
               ]
              ]
             ]
            
            [Node list symbol=| 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G392708 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? 
               
                [Node list symbol=LET symbol=pt 
                
                 [Node list symbol=ispoint symbol=p 
                 
                  [Node list 
                  
                   [Node list symbol=Sel symbol=F symbol=index ]
                   
                   [Node list symbol=:: symbol=x 
                   
                    [Node list symbol=PositiveInteger ]
                    ]
                   ]
                  
                  [Node list 
                  
                   [Node list symbol=Sel symbol=F symbol=index ]
                   
                   [Node list symbol=:: symbol=y 
                   
                    [Node list symbol=PositiveInteger ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G392708 symbol=false symbol=true ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=intvalue symbol=v symbol=x symbol=y ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G392709 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=singular? symbol=x ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G392709 
      
       [Node list symbol=error string=Point is singular ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=mini 
        
         [Node list symbol=minIndex 
         
          [Node list symbol=LET symbol=w 
          
           [Node list symbol=integralBasis ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=rec 
        
         [Node list symbol=yCoordinates 
         
          [Node list symbol=REDUCE symbol=+ int=0 
          
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=i 
            
             [Node list symbol=SEGMENT symbol=mini 
             
              [Node list symbol=maxIndex symbol=w ]
              ]
             ]
            
            [Node list symbol=* 
            
             [Node list symbol=:: 
             
              [Node list symbol=qelt symbol=v symbol=i ]
              
              [Node list symbol=Fraction symbol=UP ]
              ]
             
             [Node list symbol=qelt symbol=w symbol=i ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=n 
        
         [Node list symbol=REDUCE symbol=+ int=0 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT symbol=mini 
            
             [Node list symbol=maxIndex symbol=w ]
             ]
            ]
           
           [Node list symbol=* 
           
            [Node list symbol=x 
            
             [Node list symbol=qelt symbol=i 
             
              [Node list symbol=rec symbol=num ]
              ]
             ]
            
            [Node list symbol=^ symbol=y 
            
             [Node list symbol=:: 
             
              [Node list symbol=- symbol=i symbol=mini ]
              
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G392711 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? 
         
          [Node list symbol=LET symbol=d 
          
           [Node list symbol=x 
           
            [Node list symbol=rec symbol=den ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G392711 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G392710 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=n ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G392710 
            
             [Node list symbol=error string=0/0 -- cannot compute value yet ]
             
             [Node list symbol=error string=Shouldn't happen ]
             ]
            ]
           ]
          
          [Node list symbol=:: symbol=F 
          
           [Node list symbol=exquo symbol=n symbol=d ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=elt symbol=f symbol=x symbol=y ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=rec 
     
      [Node list symbol=integralCoordinates symbol=f ]
      ]
     
     [Node list symbol=LET symbol=n 
     
      [Node list symbol=intvalue symbol=x symbol=y 
      
       [Node list symbol=rec symbol=num ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G392713 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? 
      
       [Node list symbol=LET symbol=d 
       
        [Node list symbol=x 
        
         [Node list symbol=rec symbol=den ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G392713 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G392712 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=n ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G392712 
         
          [Node list symbol=error string=0/0 -- cannot compute value yet ]
          
          [Node list symbol=error string=Function has a pole at the given point ]
          ]
         ]
        ]
       
       [Node list symbol=:: symbol=F 
       
        [Node list symbol=exquo symbol=n symbol=d ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=primitivePart symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=import 
     
      [Node list symbol=Vector symbol=UP ]
      ]
     
     [Node list symbol=LET symbol=cd 
     
      [Node list symbol=yCoordinates symbol=f ]
      ]
     
     [Node list symbol=LET symbol=d 
     
      [Node list symbol=* 
      
       [Node list symbol=gcd 
       
        [Node list 
        
         [Node list symbol=Sel symbol=COLLECT 
         
          [Node list symbol=List symbol=F ]
          ]
         
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=minIndex 
           
            [Node list symbol=cd symbol=num ]
            ]
           
           [Node list symbol=maxIndex 
           
            [Node list symbol=cd symbol=num ]
            ]
           ]
          ]
         
         [Node list symbol=content 
         
          [Node list symbol=qelt symbol=i 
          
           [Node list symbol=cd symbol=num ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=primitivePart 
       
        [Node list symbol=cd symbol=den ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=represents 
      
       [Node list 
       
        [Node list symbol=Sel symbol=COLLECT 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=minIndex 
          
           [Node list symbol=cd symbol=num ]
           ]
          
          [Node list symbol=maxIndex 
          
           [Node list symbol=cd symbol=num ]
           ]
          ]
         ]
        
        [Node list symbol=/ symbol=d 
        
         [Node list symbol=qelt symbol=i 
         
          [Node list symbol=cd symbol=num ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=reduceBasisAtInfinity symbol=b ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=x 
     
      [Node list symbol=:: 
      
       [Node list 
       
        [Node list symbol=Sel symbol=UP symbol=monomial ]
        
        [Node list symbol=One ]
        
        [Node list symbol=One ]
        ]
       
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=concat 
      
       [Node list 
       
        [Node list symbol=Sel symbol=COLLECT 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector symbol=$ ]
          ]
         ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=minIndex symbol=b ]
          
          [Node list symbol=maxIndex symbol=b ]
          ]
         ]
        
        [Node list symbol=f 
        
         [Node list symbol=Sel symbol=COLLECT 
         
          [Node list symbol=Vector symbol=$ ]
          ]
         
         [Node list symbol=IN symbol=j 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=Zero ]
           ]
          ]
         
         [Node list symbol=WHILE 
         
          [Node list symbol=integralAtInfinity? 
          
           [Node list symbol=LET symbol=f 
           
            [Node list symbol=* 
            
             [Node list symbol=^ symbol=x symbol=j ]
             
             [Node list symbol=qelt symbol=b symbol=i ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=complementaryBasis symbol=b ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=m 
     
      [Node list symbol=:: 
      
       [Node list symbol=inverse 
       
        [Node list symbol=traceMatrix symbol=b ]
        ]
       
       [Node list symbol=Matrix 
       
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=minRowIndex symbol=m ]
         
         [Node list symbol=maxRowIndex symbol=m ]
         ]
        ]
       
       [Node list symbol=represents 
       
        [Node list symbol=row symbol=m symbol=i ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=Matrix 
    
     [Node list symbol=Fraction symbol=UP ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralAtInfinity? symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G392714 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=any? 
       
        [Node list symbol=Vector 
        
         [Node list symbol=Fraction symbol=UP ]
         ]
        ]
       
       [Node list symbol=+-> symbol=s 
       
        [Node list symbol=< 
        
         [Node list symbol=infOrder symbol=s ]
         
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=* 
       
        [Node list symbol=coordinates symbol=f ]
        
        [Node list symbol=inverseIntegralMatrixAtInfinity ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G392714 symbol=false symbol=true ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=numberOfComponents ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=integralAtInfinity? 
    
     [Node list symbol=Sel symbol=count 
     
      [Node list symbol=Vector symbol=$ ]
      ]
     
     [Node list symbol=integralBasis ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=represents symbol=v symbol=d ]
    
    [Node list symbol=UP 
    
     [Node list ]
     
     [Node list symbol=Vector symbol=UP ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=represents 
    
     [Node list 
     
      [Node list symbol=Sel symbol=COLLECT 
      
       [Node list symbol=Vector 
       
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=minIndex symbol=v ]
        
        [Node list symbol=maxIndex symbol=v ]
        ]
       ]
      
      [Node list symbol=/ symbol=d 
      
       [Node list symbol=qelt symbol=v symbol=i ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=genus ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=ds 
     
      [Node list symbol=discriminant ]
      ]
     
     [Node list symbol=LET symbol=d 
     
      [Node list symbol=+ 
      
       [Node list symbol=degree 
       
        [Node list symbol=@ symbol=UP 
        
         [Node list symbol=retract symbol=ds ]
         ]
        ]
       
       [Node list symbol=infOrder 
       
        [Node list symbol=* symbol=ds 
        
         [Node list symbol=^ int=2 
         
          [Node list symbol=determinant 
          
           [Node list symbol=* 
           
            [Node list symbol=integralMatrixAtInfinity ]
            
            [Node list symbol=inverseIntegralMatrix ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=dd 
     
      [Node list symbol=:: 
      
       [Node list symbol=exquo 
       
        [Node list symbol=- 
        
         [Node list symbol=:: 
         
          [Node list symbol=exquo symbol=d int=2 ]
          
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=rank ]
         ]
        
        [Node list symbol=numberOfComponents ]
        ]
       
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=+ symbol=dd 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=repOrder symbol=m symbol=i ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=true 
     
      [Node list symbol=: symbol=nostart 
      
       [Node list symbol=Boolean ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ans 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=row symbol=m symbol=i ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=minIndex symbol=r ]
        
        [Node list symbol=maxIndex symbol=r ]
        ]
       ]
      
      [Node list symbol=| 
      
       [Node list symbol=~= 
       
        [Node list symbol=qelt symbol=r symbol=j ]
        
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=LET symbol=ans 
      
       [Node list symbol=IF symbol=nostart 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=nostart symbol=false ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=infOrder 
          
           [Node list symbol=qelt symbol=r symbol=j ]
           ]
          ]
         ]
        
        [Node list symbol=min symbol=ans 
        
         [Node list symbol=infOrder 
         
          [Node list symbol=qelt symbol=r symbol=j ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=nostart symbol=ans 
      
       [Node list symbol=error string=Null row ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=infValue symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G392715 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=f ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G392715 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=n 
        
         [Node list symbol=infOrder symbol=f ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=> symbol=n 
          
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=Zero ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G392716 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=n ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G392716 
            
             [Node list symbol=/ 
             
              [Node list symbol=leadingCoefficient 
              
               [Node list symbol=numer symbol=f ]
               ]
              
              [Node list symbol=leadingCoefficient 
              
               [Node list symbol=denom symbol=f ]
               ]
              ]
             
             [Node list symbol=error string=f not locally integral at infinity ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=rfmonom symbol=n ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=< symbol=n 
     
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=inv 
     
      [Node list symbol=:: 
      
       [Node list 
       
        [Node list symbol=Sel symbol=UP symbol=monomial ]
        
        [Node list symbol=One ]
        
        [Node list symbol=:: 
        
         [Node list symbol=- symbol=n ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     
     [Node list symbol=:: 
     
      [Node list 
      
       [Node list symbol=Sel symbol=UP symbol=monomial ]
       
       [Node list symbol=One ]
       
       [Node list symbol=:: symbol=n 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=kmin symbol=m symbol=v ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=true 
     
      [Node list symbol=: symbol=nostart 
      
       [Node list symbol=Boolean ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=k 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET symbol=ii 
     
      [Node list symbol=- 
      
       [Node list symbol=minRowIndex symbol=m ]
       
       [Node list symbol=LET symbol=i0 
       
        [Node list symbol=minIndex symbol=v ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=minIndex symbol=v ]
        
        [Node list symbol=maxIndex symbol=v ]
        ]
       ]
      
      [Node list symbol=| 
      
       [Node list symbol=~= 
       
        [Node list symbol=qelt symbol=v symbol=i ]
        
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=nk 
       
        [Node list symbol=repOrder symbol=m 
        
         [Node list symbol=+ symbol=i symbol=ii ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=nostart 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=nostart symbol=false ]
          
          [Node list symbol=LET symbol=k symbol=nk ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=i0 symbol=i ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol=< symbol=nk symbol=k ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=k symbol=nk ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=i0 symbol=i ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=nostart 
      
       [Node list symbol=error string=vector v has only zero entries ]
       
       [Node list symbol=construct symbol=i0 symbol=k ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=normalizeAtInfinity symbol=w ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=import 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction symbol=F ]
       ]
      ]
     
     [Node list symbol=LET symbol=ans 
     
      [Node list symbol=copy symbol=w ]
      ]
     
     [Node list symbol=LET symbol=infm 
     
      [Node list symbol=inverseIntegralMatrixAtInfinity ]
      ]
     
     [Node list symbol=LET symbol=mhat 
     
      [Node list 
      
       [Node list symbol=Sel symbol=zero 
       
        [Node list symbol=Matrix 
        
         [Node list symbol=Fraction symbol=UP ]
         ]
        ]
       
       [Node list symbol=rank ]
       
       [Node list symbol=rank ]
       ]
      ]
     
     [Node list symbol=LET symbol=ii 
     
      [Node list symbol=- 
      
       [Node list symbol=minIndex symbol=w ]
       
       [Node list symbol=minRowIndex symbol=mhat ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=REPEAT 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=m 
        
         [Node list symbol=* symbol=infm 
         
          [Node list symbol=coordinates symbol=ans ]
          ]
         ]
        
        [Node list symbol=LET symbol=r 
        
         [Node list 
         
          [Node list symbol=Sel symbol=COLLECT 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction symbol=UP ]
            ]
           ]
          
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=minRowIndex symbol=m ]
            
            [Node list symbol=maxRowIndex symbol=m ]
            ]
           ]
          
          [Node list symbol=rfmonom 
          
           [Node list symbol=repOrder symbol=m symbol=i ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=minRowIndex symbol=m ]
           
           [Node list symbol=maxRowIndex symbol=m ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=minColIndex symbol=m ]
            
            [Node list symbol=maxColIndex symbol=m ]
            ]
           ]
          
          [Node list symbol=qsetelt! symbol=mhat symbol=i symbol=j 
          
           [Node list symbol=* 
           
            [Node list symbol=qelt symbol=r 
            
             [Node list symbol=+ symbol=i symbol=ii ]
             ]
            
            [Node list symbol=qelt symbol=m symbol=i symbol=j ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=solList 
        
         [Node list symbol=nullSpace 
         
          [Node list symbol=transpose 
          
           [Node list symbol=infValue symbol=mhat 
           
            [Node list symbol=Sel symbol=map 
            
             [Node list symbol=MatrixCategoryFunctions2 
             
              [Node list symbol=Fraction symbol=UP ]
              
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction symbol=UP ]
               ]
              
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction symbol=UP ]
               ]
              
              [Node list symbol=Matrix 
              
               [Node list symbol=Fraction symbol=UP ]
               ]
              
              [Node list symbol=Fraction symbol=F ]
              
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction symbol=F ]
               ]
              
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction symbol=F ]
               ]
              
              [Node list symbol=Matrix 
              
               [Node list symbol=Fraction symbol=F ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G392717 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? symbol=solList ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G392717 
         
          [Node list symbol=return symbol=ans ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=sol 
           
            [Node list symbol=first symbol=solList ]
            ]
           
           [Node list symbol=LET symbol=pr 
           
            [Node list symbol=kmin symbol=m symbol=sol ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=qsetelt! symbol=ans 
            
             [Node list symbol=pr symbol=pos ]
             
             [Node list symbol=REDUCE symbol=+ int=0 
             
              [Node list symbol=COLLECT 
              
               [Node list symbol=IN symbol=i 
               
                [Node list symbol=SEGMENT 
                
                 [Node list symbol=minIndex symbol=sol ]
                 
                 [Node list symbol=maxIndex symbol=sol ]
                 ]
                ]
               
               [Node list symbol=* 
               
                [Node list symbol=* 
                
                 [Node list symbol=Q2RF 
                 
                  [Node list symbol=qelt symbol=sol symbol=i ]
                  ]
                 
                 [Node list symbol=rfmonom 
                 
                  [Node list symbol=- 
                  
                   [Node list symbol=repOrder symbol=m 
                   
                    [Node list symbol=- symbol=i symbol=ii ]
                    ]
                   
                   [Node list symbol=pr symbol=km ]
                   ]
                  ]
                 ]
                
                [Node list symbol=qelt symbol=ans symbol=i ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integral? symbol=f symbol=p ]
    
    [Node list symbol=$ symbol=UP 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=@ 
      
       [Node list symbol=retractIfCan symbol=p ]
       
       [Node list symbol=Union symbol=F string=failed ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=r symbol=F ]
       
       [Node list symbol=integral? symbol=f 
       
        [Node list symbol=:: symbol=r symbol=F ]
        ]
       
       [Node list symbol=case string=failed 
       
        [Node list symbol=exquo symbol=p 
        
         [Node list symbol=den 
         
          [Node list symbol=integralCoordinates symbol=f ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=differentiate symbol=f symbol=d ]
    
    [Node list symbol=$ 
    
     [Node list ]
     
     [Node list symbol=Mapping symbol=UP symbol=UP ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=differentiate symbol=f 
    
     [Node list symbol=+-> 
     
      [Node list symbol=: 
      
       [Node list symbol=: symbol=x 
       
        [Node list symbol=Fraction symbol=UP ]
        ]
       
       [Node list symbol=Fraction symbol=UP ]
       ]
      
      [Node list symbol=x symbol=d 
      
       [Node list symbol=Sel symbol=differentiate 
       
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF MultipleMap R1 UP1 UPUP1 R2 UP2 UPUP2
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  map
   SIGNATURE params:Mapping R2 R1 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEFnType:
   [FnType   rfmap
   FnType  params:Fraction UP2 
   Mapping R2 R1 
   Fraction UP1 
   
   ]
   
  CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=UnivariatePolynomialCategoryFunctions2 symbol=R1 symbol=UP1 symbol=R2 symbol=UP2 ]
    ]
   
  CAPSULEDef:
   [DEF rfmap f q /
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= map f
    [Node list symbol=map symbol=f 
    
     [Node list symbol=numer symbol=q ]
     ]
    
   DEFSubnode:atts= map f
    [Node list symbol=map symbol=f 
    
     [Node list symbol=denom symbol=q ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF map f p p
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel map
    [Node list symbol=Sel symbol=map 
    
     [Node list symbol=UnivariatePolynomialCategoryFunctions2 symbol=UPUP1 symbol=UPUP2 
     
      [Node list symbol=Fraction symbol=UP1 ]
      
      [Node list symbol=Fraction symbol=UP2 ]
      ]
     ]
    
   DEFSubnode:atts= +-> x
    [Node list symbol=+-> symbol=x 
    
     [Node list symbol=rfmap symbol=f symbol=x ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= IntegralDomain
  [Node list symbol=IntegralDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory R1
  [Node list symbol=UnivariatePolynomialCategory symbol=R1 ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP1 ]
   ]
  
 DEFSubnode:atts= IntegralDomain
  [Node list symbol=IntegralDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory R2
  [Node list symbol=UnivariatePolynomialCategory symbol=R2 ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP2 ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF FunctionFieldCategoryFunctions2 R1 UP1 UPUP1 F1 R2 UP2 UPUP2 F2
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  map
   SIGNATURE params:Mapping R2 R1 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEDef:
   [DEF map f f1 reduce
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= f
    [Node list symbol=f 
    
     [Node list symbol=Sel symbol=map 
     
      [Node list symbol=MultipleMap symbol=R1 symbol=UP1 symbol=UPUP1 symbol=R2 symbol=UP2 symbol=UPUP2 ]
      ]
     
     [Node list symbol=lift symbol=f1 ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= UniqueFactorizationDomain
  [Node list symbol=UniqueFactorizationDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory R1
  [Node list symbol=UnivariatePolynomialCategory symbol=R1 ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP1 ]
   ]
  
 DEFSubnode:atts= FunctionFieldCategory R1 UP1 UPUP1
  [Node list symbol=FunctionFieldCategory symbol=R1 symbol=UP1 symbol=UPUP1 ]
  
 DEFSubnode:atts= UniqueFactorizationDomain
  [Node list symbol=UniqueFactorizationDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory R2
  [Node list symbol=UnivariatePolynomialCategory symbol=R2 ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP2 ]
   ]
  
 DEFSubnode:atts= FunctionFieldCategory R2 UP2 UPUP2
  [Node list symbol=FunctionFieldCategory symbol=R2 symbol=UP2 symbol=UPUP2 ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF ChangeOfVariable F UP UPUP
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  mkIntegral
   SIGNATURE params:Record : coef Fraction UP : poly UPUP 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  radPoly
   SIGNATURE params:Union failed Record : radicand Fraction UP : deg NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  rootPoly
   SIGNATURE params:Record : exponent NonNegativeInteger : coef Fraction UP : radicand UP 
   Fraction UP 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  goodPoint
   SIGNATURE params:List UPUP 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  eval
   SIGNATURE params:Fraction UP 
   Fraction UP 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  chvar
   SIGNATURE params:Record : func UPUP : poly UPUP : c1 Fraction UP : c2 Fraction UP : deg NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  chvar
   SIGNATURE params:Record : func List UPUP : poly UPUP : c1 Fraction UP : c2 Fraction UP : deg NonNegativeInteger 
   List UPUP 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEFnType:
   [FnType   algPoly
   FnType  params:Record : coef Fraction UP : poly UPUP 
   
   ]
   
  CAPSULEFnType:
   [FnType   RPrim
   FnType  params:Record : coef Fraction UP : poly UPUP 
   
   ]
   
  CAPSULEFnType:
   [FnType   good?
   FnType  params:Boolean 
   List UP 
   
   ]
   
  CAPSULEFnType:
   [FnType   infIntegral?
   FnType  params:Boolean 
   
   ]
   
  CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=UnivariatePolynomialCommonDenominator symbol=UP symbol=UPUP 
    
     [Node list symbol=Fraction symbol=UP ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=Fraction symbol=UP ]
    ]
   
  CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=Fraction 
    
     [Node list symbol=Integer ]
     ]
    ]
   
  CAPSULEDef:
   [DEF eval p x y
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= map p
    [Node list symbol=map symbol=p 
    
     [Node list symbol=+-> symbol=s 
     
      [Node list symbol=s symbol=x ]
      ]
     ]
    
   DEFSubnode:atts= monomial y
    [Node list symbol=monomial symbol=y 
    
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF good? a p lq SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G413027 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=p symbol=a ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G413027 symbol=false 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=q symbol=lq ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G413028 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol== 
          
           [Node list symbol=q symbol=a ]
           
           [Node list symbol=Zero ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G413028 symbol=noBranch 
          
           [Node list symbol=return symbol=false ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=true ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF algPoly p SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G413029 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=ground? 
     
      [Node list symbol=LET symbol=a 
      
       [Node list symbol=@ symbol=UP 
       
        [Node list symbol=retract 
        
         [Node list symbol=leadingCoefficient 
         
          [Node list symbol=LET symbol=q 
          
           [Node list symbol=clearDenominator symbol=p ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G413029 
     
      [Node list symbol=RPrim symbol=a symbol=q 
      
       [Node list symbol=One ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=c 
       
        [Node list symbol=LET symbol=d 
        
         [Node list symbol=squareFreePart symbol=a ]
         ]
        ]
       
       [Node list symbol=LET symbol=q 
       
        [Node list symbol=clearDenominator 
        
         [Node list symbol=q 
         
          [Node list symbol=monomial 
          
           [Node list symbol=inv 
           
            [Node list symbol=:: symbol=d 
            
             [Node list symbol=Fraction symbol=UP ]
             ]
            ]
           
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G413030 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=ground? 
           
            [Node list symbol=LET symbol=a 
            
             [Node list symbol=@ symbol=UP 
             
              [Node list symbol=retract 
              
               [Node list symbol=leadingCoefficient symbol=q ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G413030 symbol=false symbol=true ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=c 
         
          [Node list symbol=* symbol=c 
          
           [Node list symbol=LET symbol=d 
           
            [Node list symbol=gcd symbol=a symbol=d ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=q 
          
           [Node list symbol=clearDenominator 
           
            [Node list symbol=q 
            
             [Node list symbol=monomial 
             
              [Node list symbol=inv 
              
               [Node list symbol=:: symbol=d 
               
                [Node list symbol=Fraction symbol=UP ]
                ]
               ]
              
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=RPrim symbol=c symbol=a symbol=q ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF RPrim c a q IF
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= = a
    [Node list symbol== symbol=a 
    
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= construct q
    [Node list symbol=construct symbol=q 
    
     [Node list symbol=:: symbol=c 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=:: 
     
      [Node list symbol=* symbol=a symbol=c ]
      
      [Node list symbol=Fraction symbol=UP ]
      ]
     
     [Node list symbol=clearDenominator 
     
      [Node list symbol=q 
      
       [Node list symbol=monomial 
       
        [Node list symbol=inv 
        
         [Node list symbol=:: symbol=a 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         ]
        
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF chvar lf modulus UPUP SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= List UPUP
    [Node list symbol=List symbol=UPUP ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r1
    [Node list symbol=LET symbol=r1 
    
     [Node list symbol=mkIntegral symbol=modulus ]
     ]
    
   DEFSubnode:atts= LET r1inv
    [Node list symbol=LET symbol=r1inv 
    
     [Node list symbol=inv 
     
      [Node list symbol=r1 symbol=coef ]
      ]
     ]
    
   DEFSubnode:atts= LET m1
    [Node list symbol=LET symbol=m1 
    
     [Node list symbol=monomial symbol=r1inv 
     
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= LET lf1
    [Node list symbol=LET symbol=lf1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=f symbol=lf ]
      
      [Node list symbol=f symbol=m1 ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G413031 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol== 
      
       [Node list symbol=denom 
       
        [Node list symbol=r1 symbol=coef ]
        ]
       
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G413031 symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G413032 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=every? symbol=lf1 
         
          [Node list symbol=+-> 
          
           [Node list symbol=: 
           
            [Node list symbol=: symbol=f symbol=UPUP ]
            
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=infIntegral? symbol=f 
           
            [Node list symbol=r1 symbol=poly ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G413032 symbol=noBranch 
         
          [Node list symbol=exit int=3 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=inf_deg 
            
             [Node list symbol=degree 
             
              [Node list symbol=numer 
              
               [Node list symbol=r1 symbol=coef ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=construct symbol=lf1 symbol=inf_deg 
             
              [Node list symbol=r1 symbol=poly ]
              
              [Node list symbol=:: 
              
               [Node list 
               
                [Node list symbol=Sel symbol=UP symbol=monomial ]
                
                [Node list symbol=One ]
                
                [Node list symbol=One ]
                ]
               
               [Node list symbol=Fraction symbol=UP ]
               ]
              
              [Node list symbol=r1 symbol=coef ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET x
    [Node list symbol=LET symbol=x 
    
     [Node list symbol=+ 
     
      [Node list symbol=:: 
      
       [Node list symbol=:: symbol=UP 
       
        [Node list symbol=LET symbol=a 
        
         [Node list symbol=goodPoint symbol=lf1 
         
          [Node list symbol=r1 symbol=poly ]
          ]
         ]
        ]
       
       [Node list symbol=Fraction symbol=UP ]
       ]
      
      [Node list symbol=inv 
      
       [Node list symbol=:: 
       
        [Node list symbol=monomial 
        
         [Node list symbol=One ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET r2c
    [Node list symbol=LET symbol=r2c 
    
     [Node list symbol=@ symbol=UP 
     
      [Node list symbol=retract 
      
       [Node list symbol=coef 
       
        [Node list symbol=LET symbol=r2 
        
         [Node list symbol=mkIntegral 
         
          [Node list symbol=map 
          
           [Node list symbol=+-> symbol=s 
           
            [Node list symbol=s symbol=x ]
            ]
           
           [Node list symbol=r1 symbol=poly ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET t
    [Node list symbol=LET symbol=t 
    
     [Node list symbol=inv 
     
      [Node list symbol=:: 
      
       [Node list symbol=- 
       
        [Node list 
        
         [Node list symbol=Sel symbol=UP symbol=monomial ]
         
         [Node list symbol=One ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=:: symbol=a symbol=UP ]
        ]
       
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET im2
    [Node list symbol=LET symbol=im2 
    
     [Node list symbol=- 
     
      [Node list symbol=inv 
      
       [Node list symbol=:: 
       
        [Node list int=2 
        
         [Node list symbol=Sel symbol=UP symbol=monomial ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ir2
    [Node list symbol=LET symbol=ir2 
    
     [Node list symbol=inv 
     
      [Node list symbol=r2 symbol=coef ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=t 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=f symbol=lf1 ]
       
       [Node list symbol=* symbol=im2 
       
        [Node list symbol=eval symbol=f symbol=x symbol=ir2 ]
        ]
       ]
      
      [Node list symbol=r2 symbol=poly ]
      
      [Node list symbol=* 
      
       [Node list symbol=r1 symbol=coef ]
       
       [Node list symbol=r2c symbol=t ]
       ]
      
      [Node list symbol=degree symbol=r2c ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF chvar f p UPUP UPUP SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET res1
    [Node list symbol=LET symbol=res1 
    
     [Node list symbol=chvar symbol=p 
     
      [Node list symbol=construct symbol=f ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=first 
      
       [Node list symbol=res1 symbol=func ]
       ]
      
      [Node list symbol=res1 symbol=poly ]
      
      [Node list symbol=res1 symbol=c1 ]
      
      [Node list symbol=res1 symbol=c2 ]
      
      [Node list symbol=res1 symbol=deg ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF infIntegral? p modulus SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=radPoly symbol=modulus ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=false 
     
      [Node list symbol=case symbol=r string=failed ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ninv 
       
        [Node list symbol=inv 
        
         [Node list symbol=:: 
         
          [Node list symbol=r symbol=deg ]
          
          [Node list symbol=Fraction 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=degy 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=* symbol=ninv 
        
         [Node list symbol=degree 
         
          [Node list symbol=@ symbol=UP 
          
           [Node list symbol=retract 
           
            [Node list symbol=r symbol=radicand ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=degp 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=~= symbol=p 
         
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=c 
         
          [Node list symbol=leadingCoefficient symbol=p ]
          ]
         
         [Node list symbol=LET symbol=degp 
         
          [Node list symbol=max symbol=degp 
          
           [Node list symbol=+ 
           
            [Node list symbol=:: 
            
             [Node list symbol=- 
             
              [Node list symbol=+ int=2 
              
               [Node list symbol=:: 
               
                [Node list symbol=degree 
                
                 [Node list symbol=numer symbol=c ]
                 ]
                
                [Node list symbol=Integer ]
                ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=degree 
               
                [Node list symbol=denom symbol=c ]
                ]
               
               [Node list symbol=Integer ]
               ]
              ]
             
             [Node list symbol=Fraction 
             
              [Node list symbol=Integer ]
              ]
             ]
            
            [Node list symbol=* symbol=degy 
            
             [Node list symbol=degree symbol=p ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=p 
          
           [Node list symbol=reductum symbol=p ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=<= symbol=degp symbol=ninv ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mkIntegral p SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=radPoly symbol=p ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol=case symbol=r string=failed ]
      
      [Node list symbol=algPoly symbol=p ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=rp 
       
        [Node list symbol=rootPoly 
        
         [Node list symbol=r symbol=radicand ]
         
         [Node list symbol=r symbol=deg ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct 
        
         [Node list symbol=rp symbol=coef ]
         
         [Node list symbol=- 
         
          [Node list 
          
           [Node list symbol=Sel symbol=UPUP symbol=monomial ]
           
           [Node list symbol=One ]
           
           [Node list symbol=rp symbol=exponent ]
           ]
          
          [Node list symbol=:: symbol=UPUP 
          
           [Node list symbol=:: 
           
            [Node list symbol=rp symbol=radicand ]
            
            [Node list symbol=Fraction symbol=UP ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF goodPoint lp modulus SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET q
    [Node list symbol=LET symbol=q 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=r 
      
       [Node list symbol=radPoly symbol=modulus ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol=case symbol=r string=failed ]
        
        [Node list symbol=@ symbol=UP 
        
         [Node list symbol=retract 
         
          [Node list symbol=resultant symbol=modulus 
          
           [Node list symbol=differentiate symbol=modulus ]
           ]
          ]
         ]
        
        [Node list symbol=@ symbol=UP 
        
         [Node list symbol=retract 
         
          [Node list symbol=r symbol=radicand ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ld
    [Node list symbol=LET symbol=ld 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=p symbol=lp ]
      
      [Node list symbol=commonDenominator symbol=p ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G413033 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=good? symbol=q symbol=ld 
        
         [Node list symbol=LET symbol=a 
         
          [Node list symbol=:: symbol=i symbol=F ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G413033 
        
         [Node list symbol=return symbol=a ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G413034 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=good? symbol=q symbol=ld 
           
            [Node list symbol=- symbol=a ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G413034 symbol=noBranch 
           
            [Node list symbol=exit int=1 
            
             [Node list symbol=return 
             
              [Node list symbol=- symbol=a ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF radPoly p SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=@ 
     
      [Node list symbol=retractIfCan 
      
       [Node list symbol=reductum symbol=p ]
       ]
      
      [Node list symbol=Union string=failed 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF string=failed 
     
      [Node list symbol=case symbol=r string=failed ]
      
      [Node list symbol=construct 
      
       [Node list symbol=- 
       
        [Node list symbol=:: symbol=r 
        
         [Node list symbol=Fraction symbol=UP ]
         ]
        ]
       
       [Node list symbol=degree symbol=p ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF rootPoly g m SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G413035 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=g ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G413035 
     
      [Node list symbol=error string=Should not happen ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=pr 
       
        [Node list symbol=m 
        
         [Node list symbol=Sel symbol=nthRoot 
         
          [Node list symbol=FactoredFunctions symbol=UP ]
          ]
         
         [Node list symbol=squareFree 
         
          [Node list symbol=* 
          
           [Node list symbol=numer symbol=g ]
           
           [Node list symbol=^ 
           
            [Node list symbol=LET symbol=d 
            
             [Node list symbol=denom symbol=g ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=- symbol=m 
             
              [Node list symbol=One ]
              ]
             
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct 
        
         [Node list symbol=pr symbol=exponent ]
         
         [Node list symbol=/ symbol=d 
         
          [Node list symbol=pr symbol=coef ]
          ]
         
         [Node list symbol=REDUCE symbol=* int=0 
         
          [Node list symbol=COLLECT symbol=G413026 
          
           [Node list symbol=IN symbol=G413026 
           
            [Node list symbol=pr symbol=radicand ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= UniqueFactorizationDomain
  [Node list symbol=UniqueFactorizationDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory F
  [Node list symbol=UnivariatePolynomialCategory symbol=F ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF RadicalFunctionField F UP UPUP radicnd n add
 DEFSubnode:atts= FunctionFieldCategory F UP UPUP
  [Node list symbol=FunctionFieldCategory symbol=F symbol=UP symbol=UPUP ]
  
 DEFSubnode:atts= UniqueFactorizationDomain
  [Node list symbol=UniqueFactorizationDomain ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory F
  [Node list symbol=UnivariatePolynomialCategory symbol=F ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP ]
   ]
  
 DEFSubnode:atts= Fraction UP
  [Node list symbol=Fraction symbol=UP ]
  
 DEFSubnode:atts= NonNegativeInteger
  [Node list symbol=NonNegativeInteger ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= SimpleAlgebraicExtension UPUP
  [Node list symbol=SimpleAlgebraicExtension symbol=UPUP 
  
   [Node list symbol=Fraction symbol=UP ]
   
   [Node list symbol=- 
   
    [Node list symbol=n 
    
     [Node list symbol=Sel symbol=UPUP symbol=monomial ]
     
     [Node list symbol=One ]
     ]
    
    [Node list symbol=:: symbol=radicnd symbol=UPUP ]
    ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=import 
   
    [Node list symbol=ChangeOfVariable symbol=F symbol=UP symbol=UPUP ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=InnerCommonDenominator symbol=UP 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=Vector symbol=UP ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=UnivariatePolynomialCategoryFunctions2 symbol=UPUP symbol=UP 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=Matrix symbol=UP ]
    ]
   
   [Node list symbol=: symbol=diag 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Vector symbol=$ ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=: symbol=startUp 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Void ]
     
     [Node list symbol=Boolean ]
     ]
    ]
   
   [Node list symbol=: symbol=fullVector 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=PrimitiveArray symbol=UP ]
     
     [Node list symbol=Factored symbol=UP ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=: symbol=iBasis 
   
    [Node list symbol=Mapping symbol=UP 
    
     [Node list symbol=Vector symbol=UP ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=: symbol=inftyBasis 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=: symbol=basisvec 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=: symbol=char0StartUp 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Void ]
     ]
    ]
   
   [Node list symbol=: symbol=charPStartUp 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Void ]
     ]
    ]
   
   [Node list symbol=: symbol=getInfBasis 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Void ]
     ]
    ]
   
   [Node list symbol=: symbol=radcand 
   
    [Node list symbol=Mapping symbol=UP ]
    ]
   
   [Node list symbol=: symbol=charPintbas 
   
    [Node list symbol=Mapping symbol=UPUP 
    
     [Node list symbol=Void ]
     
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=brandNew? 
    
     [Node list symbol=Reference 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=ref symbol=true ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=discPoly 
    
     [Node list symbol=Reference 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=ref 
    
     [Node list symbol=Sel 
     
      [Node list symbol=Fraction symbol=UP ]
      
      [Node list symbol=Zero ]
      ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=newrad 
    
     [Node list symbol=Reference symbol=UP ]
     ]
    
    [Node list symbol=ref 
    
     [Node list symbol=Sel symbol=UP 
     
      [Node list symbol=Zero ]
      ]
     ]
    ]
   
   [Node list symbol=LET symbol=n1 
   
    [Node list symbol=:: 
    
     [Node list symbol=- symbol=n 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=LET symbol=modulus 
   
    [Node list symbol=- 
    
     [Node list symbol=n 
     
      [Node list symbol=Sel symbol=UPUP symbol=monomial ]
      
      [Node list symbol=One ]
      ]
     
     [Node list symbol=:: symbol=radicnd symbol=UPUP ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=ibasis 
    
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=new symbol=n 
    
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=invibasis 
    
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=new symbol=n 
    
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=infbasis 
    
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=new symbol=n 
    
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=invinfbasis 
    
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=new symbol=n 
    
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=LET symbol=mini 
   
    [Node list symbol=minIndex symbol=ibasis ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=discriminant ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418546 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418546 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=discPoly ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=radcand ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418547 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418547 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=newrad ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralBasis ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418548 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418548 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=diag symbol=ibasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralBasisAtInfinity ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418549 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418549 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=diag symbol=infbasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=basisvec ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418550 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418550 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=ibasis ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralMatrix ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=diagonalMatrix 
    
     [Node list symbol=basisvec ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralMatrixAtInfinity ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418551 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418551 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=diagonalMatrix symbol=infbasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=inverseIntegralMatrix ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418552 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418552 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=diagonalMatrix symbol=invibasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=inverseIntegralMatrixAtInfinity ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418553 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418553 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=diagonalMatrix symbol=invinfbasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF symbol=modulus 
   
    [Node list symbol=definingPolynomial ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=ramified? symbol=point ]
    
    [Node list symbol=F 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=zero? 
    
     [Node list symbol=point 
     
      [Node list symbol=radcand ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=branchPointAtInfinity? ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=case string=failed 
    
     [Node list symbol=exquo symbol=n 
     
      [Node list symbol=degree 
      
       [Node list symbol=radcand ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=elliptic ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=n int=2 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G418554 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== int=3 
        
         [Node list symbol=degree 
         
          [Node list symbol=radcand ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G418554 symbol=noBranch 
        
         [Node list symbol=exit int=2 
         
          [Node list symbol=radcand ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 string=failed ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=hyperelliptic ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=n int=2 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G418555 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=odd? 
        
         [Node list symbol=degree 
         
          [Node list symbol=radcand ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G418555 symbol=noBranch 
        
         [Node list symbol=exit int=2 
         
          [Node list symbol=radcand ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 string=failed ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=diag symbol=v ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=n1 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=reduce 
     
      [Node list symbol=monomial symbol=i 
      
       [Node list symbol=qelt symbol=v 
       
        [Node list symbol=+ symbol=i symbol=mini ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralRepresents symbol=v symbol=d ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=ib 
     
      [Node list symbol=basisvec ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=represents 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=mini 
         
          [Node list symbol=maxIndex symbol=ib ]
          ]
         ]
        
        [Node list symbol=* 
        
         [Node list symbol=qelt symbol=ib symbol=i ]
         
         [Node list symbol=d 
         
          [Node list symbol=Sel symbol=/ 
          
           [Node list symbol=Fraction symbol=UP ]
           ]
          
          [Node list symbol=qelt symbol=v symbol=i ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralCoordinates symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=v 
     
      [Node list symbol=coordinates symbol=f ]
      ]
     
     [Node list symbol=LET symbol=ib 
     
      [Node list symbol=basisvec ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=splitDenominator 
      
       [Node list 
       
        [Node list symbol=Sel symbol=COLLECT 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=mini 
         
          [Node list symbol=maxIndex symbol=ib ]
          ]
         ]
        
        [Node list symbol=/ 
        
         [Node list symbol=qelt symbol=v symbol=i ]
         
         [Node list symbol=qelt symbol=ib symbol=i ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralDerivationMatrix symbol=d ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=dlogp 
     
      [Node list symbol=/ 
      
       [Node list symbol=differentiate symbol=radicnd symbol=d ]
       
       [Node list symbol=* symbol=n symbol=radicnd ]
       ]
      ]
     
     [Node list symbol=LET symbol=v 
     
      [Node list symbol=basisvec ]
      ]
     
     [Node list symbol=LET symbol=cd 
     
      [Node list symbol=splitDenominator 
      
       [Node list 
       
        [Node list symbol=Sel symbol=COLLECT 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=mini 
         
          [Node list symbol=maxIndex symbol=v ]
          ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=* symbol=dlogp 
         
          [Node list symbol=- symbol=i symbol=mini ]
          ]
         
         [Node list symbol=/ 
         
          [Node list symbol=differentiate symbol=d 
          
           [Node list symbol=qelt symbol=v symbol=i ]
           ]
          
          [Node list symbol=qelt symbol=v symbol=i ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct 
      
       [Node list symbol=diagonalMatrix 
       
        [Node list symbol=cd symbol=num ]
        ]
       
       [Node list symbol=cd symbol=den ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=iBasis symbol=p symbol=d ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=pl 
     
      [Node list symbol=fullVector symbol=d 
      
       [Node list symbol=squareFree symbol=p ]
       ]
      ]
     
     [Node list symbol=LET symbol=d1 
     
      [Node list symbol=:: 
      
       [Node list symbol=- symbol=d 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=d1 
        
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=REDUCE symbol=* int=0 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=j 
         
          [Node list symbol=SEGMENT symbol=d1 
          
           [Node list symbol=Zero ]
           ]
          ]
         
         [Node list symbol=^ 
         
          [Node list symbol=pl symbol=j ]
          
          [Node list symbol=quo symbol=d 
          
           [Node list symbol=* symbol=i symbol=j ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=fullVector symbol=p symbol=m ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ans 
      
       [Node list symbol=PrimitiveArray symbol=UP ]
       ]
      
      [Node list symbol=new symbol=m 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=ans 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=unit symbol=p ]
      ]
     
     [Node list symbol=LET symbol=l 
     
      [Node list symbol=factors symbol=p ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=maxIndex symbol=ans ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=ans symbol=i ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=u 
        
         [Node list symbol=find symbol=l 
         
          [Node list symbol=+-> symbol=s 
          
           [Node list symbol== symbol=i 
           
            [Node list symbol=s symbol=exponent ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=case symbol=u string=failed ]
          
          [Node list symbol=One ]
          
          [Node list symbol=factor 
          
           [Node list symbol=:: symbol=u 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=factor symbol=UP ]
             
             [Node list symbol=: symbol=exponent 
             
              [Node list symbol=Integer ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=ans ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=inftyBasis symbol=p symbol=m ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=rt 
     
      [Node list symbol=rootPoly symbol=m 
      
       [Node list symbol=p 
       
        [Node list symbol=LET symbol=x 
        
         [Node list symbol=inv 
         
          [Node list symbol=:: 
          
           [Node list 
           
            [Node list symbol=Sel symbol=UP symbol=monomial ]
            
            [Node list symbol=One ]
            
            [Node list symbol=One ]
            ]
           
           [Node list symbol=Fraction symbol=UP ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G418556 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=m 
      
       [Node list symbol=rt symbol=exponent ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G418556 
      
       [Node list symbol=error string=Curve not irreducible after change of variable 0 -> infinity ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=a 
        
         [Node list symbol=x 
         
          [Node list symbol=rt symbol=coef ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=b 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=LET symbol=v 
        
         [Node list symbol=iBasis symbol=m 
         
          [Node list symbol=rt symbol=radicand ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=w 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction symbol=UP ]
           ]
          ]
         
         [Node list symbol=new symbol=m 
         
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT symbol=mini 
          
           [Node list symbol=maxIndex symbol=v ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=qsetelt! symbol=w symbol=i 
          
           [Node list symbol=/ symbol=b 
           
            [Node list symbol=x 
            
             [Node list symbol=:: 
             
              [Node list symbol=qelt symbol=v symbol=i ]
              
              [Node list symbol=Fraction symbol=UP ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=b 
           
            [Node list symbol=* symbol=b symbol=a ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=w ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=charPintbas symbol=p symbol=c symbol=v symbol=w ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G418557 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=n 
      
       [Node list symbol=degree symbol=p ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G418557 
      
       [Node list symbol=error string=charPintbas: should not happen ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=q 
         
          [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
          ]
         
         [Node list symbol=map symbol=p 
         
          [Node list symbol=+-> symbol=s 
          
           [Node list symbol=@ symbol=UP 
           
            [Node list symbol=retract symbol=s ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=ib 
        
         [Node list 
         
          [Node list symbol=Sel symbol=integralBasis 
          
           [Node list symbol=FunctionFieldIntegralBasis symbol=UP 
           
            [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
            
            [Node list symbol=SimpleAlgebraicExtension symbol=UP symbol=q 
            
             [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G418558 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=diagonal? 
          
           [Node list symbol=ib symbol=basis ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G418558 symbol=noBranch 
          
           [Node list symbol=exit int=2 
           
            [Node list symbol=error string=charPintbas: integral basis not diagonal ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=a 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=minRowIndex 
           
            [Node list symbol=ib symbol=basis ]
            ]
           
           [Node list symbol=maxRowIndex 
           
            [Node list symbol=ib symbol=basis ]
            ]
           ]
          ]
         
         [Node list symbol=IN symbol=j 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=minColIndex 
           
            [Node list symbol=ib symbol=basis ]
            ]
           
           [Node list symbol=maxColIndex 
           
            [Node list symbol=ib symbol=basis ]
            ]
           ]
          ]
         
         [Node list symbol=IN symbol=k 
         
          [Node list symbol=SEGMENT symbol=mini 
          
           [Node list symbol=maxIndex symbol=v ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=qsetelt! symbol=v symbol=k 
          
           [Node list symbol=* symbol=a 
           
            [Node list symbol=/ 
            
             [Node list symbol=qelt symbol=i symbol=j 
             
              [Node list symbol=ib symbol=basis ]
              ]
             
             [Node list symbol=ib symbol=basisDen ]
             ]
            ]
           ]
          
          [Node list symbol=qsetelt! symbol=w symbol=k 
          
           [Node list symbol=* 
           
            [Node list symbol=qelt symbol=i symbol=j 
            
             [Node list symbol=ib symbol=basisInv ]
             ]
            
            [Node list symbol=inv symbol=a ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=a 
           
            [Node list symbol=* symbol=a symbol=c ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=void ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=charPStartUp ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=mkIntegral symbol=modulus ]
      ]
     
     [Node list symbol=charPintbas symbol=ibasis symbol=invibasis 
     
      [Node list symbol=r symbol=poly ]
      
      [Node list symbol=r symbol=coef ]
      ]
     
     [Node list symbol=LET symbol=x 
     
      [Node list symbol=inv 
      
       [Node list symbol=:: 
       
        [Node list 
        
         [Node list symbol=Sel symbol=UP symbol=monomial ]
         
         [Node list symbol=One ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=invmod 
     
      [Node list symbol=- 
      
       [Node list symbol=n 
       
        [Node list symbol=Sel symbol=UPUP symbol=monomial ]
        
        [Node list symbol=One ]
        ]
       
       [Node list symbol=:: symbol=UPUP 
       
        [Node list symbol=radicnd symbol=x ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=mkIntegral symbol=invmod ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=charPintbas symbol=infbasis symbol=invinfbasis 
      
       [Node list symbol=r symbol=poly ]
       
       [Node list symbol=x 
       
        [Node list symbol=r symbol=coef ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=startUp symbol=b ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=b 
     
      [Node list symbol=brandNew? ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G418559 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? 
       
        [Node list symbol=LET symbol=p 
        
         [Node list 
         
          [Node list symbol=Sel symbol=F symbol=characteristic ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G418559 
       
        [Node list symbol=char0StartUp ]
        
        [Node list symbol=IF 
        
         [Node list symbol=> symbol=p symbol=n ]
         
         [Node list symbol=char0StartUp ]
         
         [Node list symbol=charPStartUp ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=dsc 
      
       [Node list symbol=Fraction symbol=UP ]
       ]
      
      [Node list symbol=* 
      
       [Node list symbol=* 
       
        [Node list 
        
         [Node list symbol=Sel symbol=* 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=^ 
         
          [Node list 
          
           [Node list symbol=Sel symbol=- 
           
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=quo 
          
           [Node list symbol=n symbol=n1 
           
            [Node list symbol=Sel symbol=* 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           
           [Node list symbol=:: int=2 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         
         [Node list symbol=^ symbol=n 
         
          [Node list symbol=:: symbol=n 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        
        [Node list symbol=^ symbol=radicnd symbol=n1 ]
        ]
       
       [Node list symbol=REDUCE symbol=* int=0 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT symbol=mini 
          
           [Node list symbol=maxIndex symbol=ibasis ]
           ]
          ]
         
         [Node list symbol=^ int=2 
         
          [Node list symbol=qelt symbol=ibasis symbol=i ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=discPoly ]
      
      [Node list symbol=/ 
      
       [Node list symbol=primitivePart 
       
        [Node list symbol=numer symbol=dsc ]
        ]
       
       [Node list symbol=denom symbol=dsc ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=void ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=char0StartUp ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=rp 
     
      [Node list symbol=rootPoly symbol=radicnd symbol=n ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G418560 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=n 
      
       [Node list symbol=rp symbol=exponent ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G418560 
      
       [Node list symbol=error string=RadicalFunctionField: curve is not irreducible ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=newrad ]
         
         [Node list symbol=rp symbol=radicand ]
         ]
        
        [Node list symbol=LET symbol=ib 
        
         [Node list symbol=iBasis symbol=n 
         
          [Node list symbol=newrad ]
          ]
         ]
        
        [Node list symbol=LET symbol=infb 
        
         [Node list symbol=inftyBasis symbol=radicnd symbol=n ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=invden 
         
          [Node list symbol=Fraction symbol=UP ]
          ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT symbol=mini 
          
           [Node list symbol=maxIndex symbol=ib ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=qsetelt! symbol=invibasis symbol=i 
          
           [Node list symbol=LET symbol=a 
           
            [Node list symbol=* symbol=invden 
            
             [Node list symbol=qelt symbol=ib symbol=i ]
             ]
            ]
           ]
          
          [Node list symbol=qsetelt! symbol=ibasis symbol=i 
          
           [Node list symbol=inv symbol=a ]
           ]
          
          [Node list symbol=LET symbol=invden 
          
           [Node list symbol=/ symbol=invden 
           
            [Node list symbol=rp symbol=coef ]
            ]
           ]
          
          [Node list symbol=qsetelt! symbol=infbasis symbol=i 
          
           [Node list symbol=LET symbol=a 
           
            [Node list symbol=qelt symbol=infb symbol=i ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=qsetelt! symbol=invinfbasis symbol=i 
           
            [Node list symbol=inv symbol=a ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=void ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=ramified? symbol=p ]
    
    [Node list symbol=UP 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=@ 
      
       [Node list symbol=retractIfCan symbol=p ]
       
       [Node list symbol=Union symbol=F string=failed ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=r symbol=F ]
       
       [Node list symbol=singular? 
       
        [Node list symbol=:: symbol=r symbol=F ]
        ]
       
       [Node list symbol=case symbol=UP 
       
        [Node list symbol=exquo symbol=p 
        
         [Node list symbol=radcand ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=singular? symbol=p ]
    
    [Node list symbol=UP 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=@ 
      
       [Node list symbol=retractIfCan symbol=p ]
       
       [Node list symbol=Union symbol=F string=failed ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=r symbol=F ]
       
       [Node list symbol=singular? 
       
        [Node list symbol=:: symbol=r symbol=F ]
        ]
       
       [Node list symbol=case symbol=UP 
       
        [Node list symbol=exquo 
        
         [Node list symbol=radcand ]
         
         [Node list symbol=^ symbol=p int=2 ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=branchPoint? symbol=p ]
    
    [Node list symbol=UP 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=@ 
      
       [Node list symbol=retractIfCan symbol=p ]
       
       [Node list symbol=Union symbol=F string=failed ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=r symbol=F ]
       
       [Node list symbol=branchPoint? 
       
        [Node list symbol=:: symbol=r symbol=F ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=q 
        
         [Node list symbol=exquo symbol=p 
         
          [Node list symbol=radcand ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=false 
         
          [Node list symbol=case symbol=q symbol=UP ]
          
          [Node list symbol=case string=failed 
          
           [Node list symbol=exquo symbol=p 
           
            [Node list symbol=:: symbol=q symbol=UP ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=singular? symbol=point ]
    
    [Node list symbol=F 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G418561 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? 
      
       [Node list symbol=point 
       
        [Node list symbol=radcand ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G418561 symbol=false 
      
       [Node list symbol=zero? 
       
        [Node list symbol=point 
        
         [Node list symbol=:: symbol=UP 
         
          [Node list symbol=exquo 
          
           [Node list symbol=radcand ]
           
           [Node list symbol=- 
           
            [Node list 
            
             [Node list symbol=Sel symbol=UP symbol=monomial ]
             
             [Node list symbol=One ]
             
             [Node list symbol=One ]
             ]
            
            [Node list symbol=:: symbol=point symbol=UP ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=branchPoint? symbol=point ]
    
    [Node list symbol=F 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G418563 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? 
      
       [Node list symbol=point 
       
        [Node list symbol=radcand ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G418563 symbol=false 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G418562 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? 
         
          [Node list symbol=point 
          
           [Node list symbol=:: symbol=UP 
           
            [Node list symbol=exquo 
            
             [Node list symbol=radcand ]
             
             [Node list symbol=- 
             
              [Node list 
              
               [Node list symbol=Sel symbol=UP symbol=monomial ]
               
               [Node list symbol=One ]
               
               [Node list symbol=One ]
               ]
              
              [Node list symbol=:: symbol=point symbol=UP ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G418562 symbol=false symbol=true ]
         ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF AlgebraicFunctionField F UP UPUP modulus UPUP add
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=FunctionFieldCategory symbol=F symbol=UP symbol=UPUP ]
   
   [Node list symbol=CATEGORY symbol=package 
   
    [Node list symbol=SIGNATURE symbol=knownInfBasis 
    
     [Node list 
     
      [Node list symbol=Void ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= Field
  [Node list symbol=Field ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory F
  [Node list symbol=UnivariatePolynomialCategory symbol=F ]
  
 DEFSubnode:atts= UnivariatePolynomialCategory
  [Node list symbol=UnivariatePolynomialCategory 
  
   [Node list symbol=Fraction symbol=UP ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= SimpleAlgebraicExtension UPUP modulus
  [Node list symbol=SimpleAlgebraicExtension symbol=UPUP symbol=modulus 
  
   [Node list symbol=Fraction symbol=UP ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=import 
   
    [Node list symbol=ChangeOfVariable symbol=F symbol=UP symbol=UPUP ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=InnerCommonDenominator symbol=UP 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=Vector symbol=UP ]
     
     [Node list symbol=Vector 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=MatrixCommonDenominator symbol=UP 
    
     [Node list symbol=Fraction symbol=UP ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=UnivariatePolynomialCategoryFunctions2 symbol=UPUP symbol=UP 
    
     [Node list symbol=Fraction symbol=UP ]
     
     [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
     ]
    ]
   
   [Node list symbol=: symbol=startUp 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Void ]
     
     [Node list symbol=Boolean ]
     ]
    ]
   
   [Node list symbol=: symbol=vect 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Vector symbol=$ ]
     
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    ]
   
   [Node list symbol=: symbol=getInfBasis 
   
    [Node list symbol=Mapping 
    
     [Node list symbol=Void ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=brandNew? 
    
     [Node list symbol=Reference 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=ref symbol=true ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=infBr? 
    
     [Node list symbol=Reference 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=ref symbol=true ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=discPoly 
    
     [Node list symbol=Reference 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=ref 
    
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=LET symbol=n 
   
    [Node list symbol=degree symbol=modulus ]
    ]
   
   [Node list symbol=LET symbol=n1 
   
    [Node list symbol=:: 
    
     [Node list symbol=- symbol=n 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=ibasis 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=zero symbol=n symbol=n ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=invibasis 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=copy symbol=ibasis ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=infbasis 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=copy symbol=ibasis ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=invinfbasis 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Fraction symbol=UP ]
      ]
     ]
    
    [Node list symbol=copy symbol=ibasis ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=branchPointAtInfinity? ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479054 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479054 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=infBr? ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=discriminant ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479055 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479055 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=discPoly ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralBasis ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479056 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479056 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=vect symbol=ibasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralBasisAtInfinity ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479057 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479057 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=vect symbol=infbasis ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralMatrix ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479058 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479058 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=ibasis ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=inverseIntegralMatrix ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479059 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479059 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=invibasis ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralMatrixAtInfinity ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479060 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479060 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=infbasis ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=branchPoint? symbol=a ]
    
    [Node list symbol=F 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=zero? 
    
     [Node list symbol=a 
     
      [Node list symbol=@ symbol=UP 
      
       [Node list symbol=retract 
       
        [Node list symbol=discriminant ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF symbol=modulus 
   
    [Node list symbol=definingPolynomial ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=inverseIntegralMatrixAtInfinity ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479061 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479061 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=invinfbasis ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=vect symbol=m ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=minRowIndex symbol=m ]
       
       [Node list symbol=maxRowIndex symbol=m ]
       ]
      ]
     
     [Node list symbol=represents 
     
      [Node list symbol=row symbol=m symbol=i ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralCoordinates symbol=f ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=splitDenominator 
    
     [Node list symbol=* 
     
      [Node list symbol=coordinates symbol=f ]
      
      [Node list symbol=inverseIntegralMatrix ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=knownInfBasis symbol=d ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479062 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479062 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=alpha 
         
          [Node list 
          
           [Node list symbol=Sel symbol=COLLECT 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction symbol=UP ]
             ]
            ]
           
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT symbol=n1 
            
             [Node list symbol=Zero ]
             ]
            ]
           
           [Node list symbol=:: 
           
            [Node list 
            
             [Node list symbol=Sel symbol=UP symbol=monomial ]
             
             [Node list symbol=One ]
             
             [Node list symbol=* symbol=d symbol=i ]
             ]
            
            [Node list symbol=Fraction symbol=UP ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=ib 
         
          [Node list symbol=diagonalMatrix 
          
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=i 
            
             [Node list symbol=SEGMENT 
             
              [Node list symbol=minIndex symbol=alpha ]
              
              [Node list symbol=maxIndex symbol=alpha ]
              ]
             ]
            
            [Node list symbol=inv 
            
             [Node list symbol=qelt symbol=alpha symbol=i ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=invib 
         
          [Node list symbol=diagonalMatrix symbol=alpha ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=minRowIndex symbol=ib ]
             
             [Node list symbol=maxRowIndex symbol=ib ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=j 
            
             [Node list symbol=SEGMENT 
             
              [Node list symbol=minColIndex symbol=ib ]
              
              [Node list symbol=maxColIndex symbol=ib ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=infbasis symbol=i symbol=j ]
              
              [Node list symbol=qelt symbol=ib symbol=i symbol=j ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET 
              
               [Node list symbol=invinfbasis symbol=i symbol=j ]
               
               [Node list symbol=invib symbol=i symbol=j ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=void ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=getInfBasis ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=x 
     
      [Node list symbol=inv 
      
       [Node list symbol=:: 
       
        [Node list 
        
         [Node list symbol=Sel symbol=UP symbol=monomial ]
         
         [Node list symbol=One ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=invmod 
     
      [Node list symbol=map symbol=modulus 
      
       [Node list symbol=+-> symbol=s 
       
        [Node list symbol=s symbol=x ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=mkIntegral symbol=invmod ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G479063 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=n 
      
       [Node list symbol=degree 
       
        [Node list symbol=r symbol=poly ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G479063 
      
       [Node list symbol=error string=Should not happen ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=ninvmod 
         
          [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
          ]
         
         [Node list symbol=map 
         
          [Node list symbol=+-> symbol=s 
          
           [Node list symbol=@ symbol=UP 
           
            [Node list symbol=retract symbol=s ]
            ]
           ]
          
          [Node list symbol=r symbol=poly ]
          ]
         ]
        
        [Node list symbol=LET symbol=alpha 
        
         [Node list 
         
          [Node list symbol=Sel symbol=COLLECT 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction symbol=UP ]
            ]
           ]
          
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT symbol=n1 
           
            [Node list symbol=Zero ]
            ]
           ]
          
          [Node list symbol=x 
          
           [Node list symbol=^ symbol=i 
           
            [Node list symbol=r symbol=coef ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=invalpha 
        
         [Node list 
         
          [Node list symbol=Sel symbol=COLLECT 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction symbol=UP ]
            ]
           ]
          
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=minIndex symbol=alpha ]
            
            [Node list symbol=maxIndex symbol=alpha ]
            ]
           ]
          
          [Node list symbol=inv 
          
           [Node list symbol=qelt symbol=alpha symbol=i ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=invib 
        
         [Node list 
         
          [Node list symbol=Sel symbol=integralBasis 
          
           [Node list symbol=FunctionFieldIntegralBasis symbol=UP 
           
            [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
            
            [Node list symbol=SimpleAlgebraicExtension symbol=UP symbol=ninvmod 
            
             [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=minRowIndex symbol=ibasis ]
           
           [Node list symbol=maxRowIndex symbol=ibasis ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=minColIndex symbol=ibasis ]
            
            [Node list symbol=maxColIndex symbol=ibasis ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=infbasis symbol=i symbol=j ]
            
            [Node list symbol=x 
            
             [Node list symbol=/ 
             
              [Node list symbol=i symbol=j 
              
               [Node list symbol=invib symbol=basis ]
               ]
              
              [Node list symbol=invib symbol=basisDen ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET 
            
             [Node list symbol=invinfbasis symbol=i symbol=j ]
             
             [Node list symbol=x 
             
              [Node list symbol=i symbol=j 
              
               [Node list symbol=invib symbol=basisInv ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=ib2 
        
         [Node list symbol=* symbol=infbasis 
         
          [Node list symbol=diagonalMatrix symbol=alpha ]
          ]
         ]
        
        [Node list symbol=LET symbol=invib2 
        
         [Node list symbol=* symbol=invinfbasis 
         
          [Node list symbol=diagonalMatrix symbol=invalpha ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=minRowIndex symbol=ib2 ]
           
           [Node list symbol=maxRowIndex symbol=ib2 ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=minColIndex symbol=ibasis ]
            
            [Node list symbol=maxColIndex symbol=ibasis ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=infbasis symbol=i symbol=j ]
            
            [Node list symbol=qelt symbol=ib2 symbol=i symbol=j ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET 
            
             [Node list symbol=invinfbasis symbol=i symbol=j ]
             
             [Node list symbol=invib2 symbol=i symbol=j ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=void ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=startUp symbol=b ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=b 
     
      [Node list symbol=brandNew? ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=nmod 
      
       [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
       ]
      
      [Node list symbol=map symbol=retract symbol=modulus ]
      ]
     
     [Node list symbol=LET symbol=ib 
     
      [Node list 
      
       [Node list symbol=Sel symbol=integralBasis 
       
        [Node list symbol=FunctionFieldIntegralBasis symbol=UP 
        
         [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
         
         [Node list symbol=SimpleAlgebraicExtension symbol=UP symbol=nmod 
         
          [Node list symbol=SparseUnivariatePolynomial symbol=UP ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=minRowIndex symbol=ibasis ]
        
        [Node list symbol=maxRowIndex symbol=ibasis ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=minColIndex symbol=ibasis ]
         
         [Node list symbol=maxColIndex symbol=ibasis ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=qsetelt! symbol=ibasis symbol=i symbol=j 
        
         [Node list symbol=/ 
         
          [Node list symbol=i symbol=j 
          
           [Node list symbol=ib symbol=basis ]
           ]
          
          [Node list symbol=ib symbol=basisDen ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET 
         
          [Node list symbol=invibasis symbol=i symbol=j ]
          
          [Node list symbol=:: 
          
           [Node list symbol=i symbol=j 
           
            [Node list symbol=ib symbol=basisInv ]
            ]
           
           [Node list symbol=Fraction symbol=UP ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479064 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? 
       
        [Node list symbol=infbasis 
        
         [Node list symbol=minRowIndex symbol=infbasis ]
         
         [Node list symbol=minColIndex symbol=infbasis ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479064 symbol=noBranch 
       
        [Node list symbol=getInfBasis ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=ib2 
     
      [Node list symbol=coordinates 
      
       [Node list symbol=normalizeAtInfinity 
       
        [Node list symbol=vect symbol=ibasis ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=invib2 
     
      [Node list symbol=:: 
      
       [Node list symbol=inverse symbol=ib2 ]
       
       [Node list symbol=Matrix 
       
        [Node list symbol=Fraction symbol=UP ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=minRowIndex symbol=ib2 ]
        
        [Node list symbol=maxRowIndex symbol=ib2 ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=minColIndex symbol=ib2 ]
         
         [Node list symbol=maxColIndex symbol=ib2 ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=ibasis symbol=i symbol=j ]
         
         [Node list symbol=qelt symbol=ib2 symbol=i symbol=j ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET 
         
          [Node list symbol=invibasis symbol=i symbol=j ]
          
          [Node list symbol=invib2 symbol=i symbol=j ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=dsc 
     
      [Node list symbol=resultant symbol=modulus 
      
       [Node list symbol=differentiate symbol=modulus ]
       ]
      ]
     
     [Node list symbol=LET symbol=dsc0 
     
      [Node list symbol=* symbol=dsc 
      
       [Node list symbol=^ int=2 
       
        [Node list symbol=determinant symbol=infbasis ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G479065 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=degree 
       
        [Node list symbol=numer symbol=dsc0 ]
        ]
       
       [Node list symbol=degree 
       
        [Node list symbol=denom symbol=dsc0 ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G479065 
      
       [Node list symbol=error string=Shouldn't happen ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=infBr? ]
         
         [Node list symbol=< 
         
          [Node list symbol=degree 
          
           [Node list symbol=numer symbol=dsc0 ]
           ]
          
          [Node list symbol=degree 
          
           [Node list symbol=denom symbol=dsc0 ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=dsc 
        
         [Node list symbol=* symbol=dsc 
         
          [Node list symbol=^ int=2 
          
           [Node list symbol=determinant symbol=ibasis ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=discPoly ]
         
         [Node list symbol=/ 
         
          [Node list symbol=primitivePart 
          
           [Node list symbol=numer symbol=dsc ]
           ]
          
          [Node list symbol=denom symbol=dsc ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=void ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralDerivationMatrix symbol=d ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=w 
     
      [Node list symbol=integralBasis ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=splitDenominator 
      
       [Node list symbol=* 
       
        [Node list symbol=coordinates 
        
         [Node list 
         
          [Node list symbol=Sel symbol=COLLECT 
          
           [Node list symbol=Vector symbol=$ ]
           ]
          
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=minIndex symbol=w ]
            
            [Node list symbol=maxIndex symbol=w ]
            ]
           ]
          
          [Node list symbol=differentiate symbol=d 
          
           [Node list symbol=w symbol=i ]
           ]
          ]
         ]
        
        [Node list symbol=inverseIntegralMatrix ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integralRepresents symbol=v symbol=d ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=represents 
    
     [Node list symbol=* 
     
      [Node list symbol=coordinates 
      
       [Node list symbol=represents symbol=v symbol=d ]
       ]
      
      [Node list symbol=integralMatrix ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=branchPoint? symbol=p ]
    
    [Node list symbol=UP 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G479066 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=deref symbol=brandNew? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G479066 symbol=noBranch 
       
        [Node list symbol=startUp symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=@ 
      
       [Node list symbol=retractIfCan symbol=p ]
       
       [Node list symbol=Union symbol=F string=failed ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=r symbol=F ]
       
       [Node list symbol=branchPoint? 
       
        [Node list symbol=:: symbol=r symbol=F ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G479067 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=ground? 
         
          [Node list symbol=gcd symbol=p 
          
           [Node list symbol=@ symbol=UP 
           
            [Node list symbol=retract 
            
             [Node list symbol=discriminant ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G479067 symbol=false symbol=true ]
         ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 