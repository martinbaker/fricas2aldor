[File 

 [DEF ParametricLinearEquations R Var Expon GR
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Matrix GR 
   List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Matrix GR 
   List Symbol 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Matrix GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Matrix GR 
   List GR 
   PositiveInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Matrix GR 
   List Symbol 
   PositiveInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Matrix GR 
   PositiveInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:Integer 
   Matrix GR 
   List GR 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:Integer 
   Matrix GR 
   List Symbol 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:Integer 
   Matrix GR 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:Integer 
   Matrix GR 
   List GR 
   PositiveInteger 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:Integer 
   Matrix GR 
   List Symbol 
   PositiveInteger 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  psolve
   SIGNATURE params:Integer 
   Matrix GR 
   PositiveInteger 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  wrregime
   SIGNATURE params:Integer 
   List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  rdregime
   SIGNATURE params:List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   String 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  bsolve
   SIGNATURE params:Record : rgl List Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R : rgsz Integer 
   Matrix GR 
   List Fraction Polynomial R 
   NonNegativeInteger 
   String 
   Integer 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  dmp2rfi
   SIGNATURE params:Fraction Polynomial R 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  dmp2rfi
   SIGNATURE params:Matrix Fraction Polynomial R 
   Matrix GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  dmp2rfi
   SIGNATURE params:List Fraction Polynomial R 
   List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  se2rfi
   SIGNATURE params:List Fraction Polynomial R 
   List Symbol 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  pr2dmp
   SIGNATURE params:Polynomial R 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  hasoln
   SIGNATURE params:Record : sysok Boolean : z0 List GR : n0 List GR 
   List GR 
   List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  ParCondList
   SIGNATURE params:List Record : rank NonNegativeInteger : eqns List Record : det GR : rows List Integer : cols List Integer : fgb List GR 
   Matrix GR 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  redpps
   SIGNATURE params:Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  B1solve
   SIGNATURE params:Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Record : mat Matrix Fraction Polynomial R : vec List Fraction Polynomial R : rank NonNegativeInteger : rows List Integer : cols List Integer 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  factorset
   SIGNATURE params:List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  maxrank
   SIGNATURE params:NonNegativeInteger 
   List Record : rank NonNegativeInteger : eqns List Record : det GR : rows List Integer : cols List Integer : fgb List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  minrank
   SIGNATURE params:NonNegativeInteger 
   List Record : rank NonNegativeInteger : eqns List Record : det GR : rows List Integer : cols List Integer : fgb List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  minset
   SIGNATURE params:List List GR 
   List List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  nextSublist
   SIGNATURE params:List List Integer 
   Integer 
   Integer 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  overset?
   SIGNATURE params:Boolean 
   List GR 
   List List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  ParCond
   SIGNATURE params:List Record : det GR : rows List Integer : cols List Integer 
   Matrix GR 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  redmat
   SIGNATURE params:Matrix GR 
   Matrix GR 
   List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  regime
   SIGNATURE params:Record : eqzro List GR : neqzro List GR : wcond List Polynomial R : bsoln Record : partsol Vector Fraction Polynomial R : basis List Vector Fraction Polynomial R 
   Record : det GR : rows List Integer : cols List Integer 
   Matrix GR 
   List Fraction Polynomial R 
   List List GR 
   NonNegativeInteger 
   NonNegativeInteger 
   Integer 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  sqfree
   SIGNATURE params:
   ]
   
  CATEGORYSig:
   [SIGNATURE  inconsistent?
   SIGNATURE params:Boolean 
   List GR 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  inconsistent?
   SIGNATURE params:Boolean 
   List Polynomial R 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEDef:
   [DEF inconsistent? pl SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= List GR
    [Node list symbol=List symbol=GR ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=p symbol=pl ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G11476846 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=ground? symbol=p ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G11476846 symbol=noBranch 
       
        [Node list symbol=exit int=2 
        
         [Node list symbol=return symbol=true ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 false
    [Node list symbol=exit int=1 symbol=false ]
    
   ]
   
  CAPSULEDef:
   [DEF inconsistent? pl SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Polynomial symbol=R ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=p symbol=pl ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G11476847 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=ground? symbol=p ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G11476847 symbol=noBranch 
       
        [Node list symbol=exit int=2 
        
         [Node list symbol=return symbol=true ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 false
    [Node list symbol=exit int=1 symbol=false ]
    
   ]
   
  CAPSULEDef:
   [DEF B1solve sys SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=partsol 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=basis 
     
      [Node list symbol=List 
      
       [Node list symbol=Vector 
       
        [Node list symbol=Fraction 
        
         [Node list symbol=Polynomial symbol=R ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=mat 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=vec 
     
      [Node list symbol=List 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=rank 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=rows 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=: symbol=cols 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=i symbol=j symbol=i1 symbol=j1 ]
     
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rss 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=sys symbol=rows ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nss 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=sys symbol=cols ]
     ]
    
   DEFSubnode:atts= LET k
    [Node list symbol=LET symbol=k 
    
     [Node list symbol=sys symbol=rank ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=cmat 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=sys symbol=mat ]
     ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=ncols symbol=cmat ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=frcols 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=nss 
     
      [Node list symbol=Sel symbol=setDifference 
      
       [Node list symbol=List 
       
        [Node list symbol=Integer ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=expand 
       
        [Node list symbol=Segment 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=SEGMENT symbol=n 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=w 
     
      [Node list symbol=List 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=sys symbol=vec ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=p 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=new symbol=n 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=pbas 
     
      [Node list symbol=List 
      
       [Node list symbol=Vector 
       
        [Node list symbol=Fraction 
        
         [Node list symbol=Polynomial symbol=R ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G11476848 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=k 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G11476848 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=augmat 
         
          [Node list symbol=Matrix 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         
         [Node list symbol=zero symbol=k 
         
          [Node list symbol=+ symbol=n 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i symbol=rss ]
         
         [Node list symbol=IN symbol=i1 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=j symbol=nss ]
           
           [Node list symbol=IN symbol=j1 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=augmat symbol=i1 symbol=j1 ]
            
            [Node list symbol=cmat symbol=i symbol=j ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=j symbol=frcols ]
           
           [Node list symbol=IN symbol=j1 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=+ symbol=k 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=augmat symbol=i1 symbol=j1 ]
            
            [Node list symbol=- 
            
             [Node list symbol=cmat symbol=i symbol=j ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET 
           
            [Node list symbol=augmat symbol=i1 
            
             [Node list symbol=+ symbol=n 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=w symbol=i ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=augmat 
        
         [Node list symbol=augmat 
         
          [Node list symbol=Sel symbol=rowEchelon 
          
           [Node list symbol=Matrix 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i symbol=nss ]
         
         [Node list symbol=IN symbol=i1 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=p symbol=i ]
          
          [Node list symbol=augmat symbol=i1 
          
           [Node list symbol=+ symbol=n 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j symbol=frcols ]
          
          [Node list symbol=IN symbol=j1 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=+ symbol=k 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=pb 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            
            [Node list symbol=new symbol=n 
            
             [Node list symbol=Zero ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=pb symbol=j ]
            
            [Node list symbol=One ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=i symbol=nss ]
            
            [Node list symbol=IN symbol=i1 
            
             [Node list symbol=SEGMENT 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=pb symbol=i ]
             
             [Node list symbol=augmat symbol=i1 symbol=j1 ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=pbas 
            
             [Node list symbol=cons symbol=pb symbol=pbas ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j symbol=frcols ]
        
        [Node list symbol=IN symbol=j1 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=+ symbol=k 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=pb 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          
          [Node list symbol=new symbol=n 
          
           [Node list symbol=Zero ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=pb symbol=j ]
          
          [Node list symbol=One ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=pbas 
          
           [Node list symbol=cons symbol=pb symbol=pbas ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=p symbol=pbas ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF regime y coef w psbf rk rkmax mode SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=i symbol=j ]
     
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ydetf 
     
      [Node list symbol=List symbol=GR ]
      ]
     
     [Node list symbol=factorset 
     
      [Node list symbol=y symbol=det ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=yzero 
     
      [Node list symbol=List symbol=GR ]
      ]
     
     [Node list symbol=IF 
     
      [Node list symbol== symbol=rk symbol=rkmax ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=construct 
       
        [Node list symbol=List symbol=GR ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=psbf 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=x symbol=psbf ]
         
         [Node list symbol=setDifference symbol=x symbol=ydetf ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list 
        
         [Node list symbol=Sel symbol=euclideanGroebner 
         
          [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
          ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=x symbol=psbf ]
          
          [Node list symbol=REDUCE symbol=* int=0 
          
           [Node list symbol=COLLECT symbol=G11476843 
           
            [Node list symbol=IN symbol=G11476843 symbol=x ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nc 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=dmp2rfi 
     
      [Node list symbol=redmat symbol=coef symbol=yzero ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rss 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=y symbol=rows ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nss 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=y symbol=cols ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=sys 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=mat 
       
        [Node list symbol=Matrix 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=vec 
       
        [Node list symbol=List 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=rank 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=rows 
       
        [Node list symbol=List 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=: symbol=cols 
       
        [Node list symbol=List 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=nc symbol=w symbol=rk symbol=rss symbol=nss 
     
      [Node list symbol=Sel symbol=construct 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=mat 
        
         [Node list symbol=Matrix 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=vec 
        
         [Node list symbol=List 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=rank 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=rows 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=: symbol=cols 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET pps
    [Node list symbol=LET symbol=pps 
    
     [Node list symbol=B1solve symbol=sys ]
     ]
    
   DEFSubnode:atts= LET pp
    [Node list symbol=LET symbol=pp 
    
     [Node list symbol=pps symbol=partsol ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=frows 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=rss 
     
      [Node list symbol=Sel symbol=setDifference 
      
       [Node list symbol=List 
       
        [Node list symbol=Integer ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=expand 
       
        [Node list symbol=Segment 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=nrows symbol=coef ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=wcd 
     
      [Node list symbol=List 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476849 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=entry? symbol=mode 
     
      [Node list int=3 int=6 int=9 int=12 
      
       [Node list symbol=Sel symbol=construct 
       
        [Node list symbol=List 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476849 
     
      [Node list symbol=yzero symbol=ydetf symbol=wcd 
      
       [Node list symbol=Sel symbol=construct 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=eqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=neqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=wcond 
         
          [Node list symbol=List 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         
         [Node list symbol=: symbol=bsoln 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=partsol 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           
           [Node list symbol=: symbol=basis 
           
            [Node list symbol=List 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=redpps symbol=pps symbol=yzero ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=i symbol=frows ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=weqn 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          
          [Node list symbol=REDUCE symbol=+ int=0 
          
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=j symbol=nss ]
            
            [Node list symbol=* 
            
             [Node list symbol=nc symbol=i symbol=j ]
             
             [Node list symbol=pp symbol=j ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=wnum 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          
          [Node list 
          
           [Node list symbol=Sel symbol=numer 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           
           [Node list symbol=- symbol=weqn 
           
            [Node list symbol=w symbol=i ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF string=trivially satisfied 
          
           [Node list symbol== symbol=wnum 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G11476850 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=ground? symbol=wnum ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G11476850 
             
              [Node list symbol=return 
              
               [Node list symbol=yzero symbol=ydetf symbol=pps 
               
                [Node list symbol=Sel symbol=construct 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=eqzro 
                  
                   [Node list symbol=List symbol=GR ]
                   ]
                  
                  [Node list symbol=: symbol=neqzro 
                  
                   [Node list symbol=List symbol=GR ]
                   ]
                  
                  [Node list symbol=: symbol=wcond 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Polynomial symbol=R ]
                    ]
                   ]
                  
                  [Node list symbol=: symbol=bsoln 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=partsol 
                    
                     [Node list symbol=Vector 
                     
                      [Node list symbol=Fraction 
                      
                       [Node list symbol=Polynomial symbol=R ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=: symbol=basis 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Vector 
                      
                       [Node list symbol=Fraction 
                       
                        [Node list symbol=Polynomial symbol=R ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list 
                
                 [Node list symbol=Sel symbol=construct 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Polynomial symbol=R ]
                   ]
                  ]
                 
                 [Node list symbol=Sel 
                 
                  [Node list symbol=Polynomial symbol=R ]
                  
                  [Node list symbol=One ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=wcd 
              
               [Node list symbol=cons symbol=wnum symbol=wcd ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G11476851 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=entry? symbol=mode 
        
         [Node list int=2 int=5 int=8 int=11 
         
          [Node list symbol=Sel symbol=construct 
          
           [Node list symbol=List 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G11476851 
        
         [Node list symbol=yzero symbol=ydetf symbol=wcd symbol=pps 
         
          [Node list symbol=Sel symbol=construct 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=eqzro 
            
             [Node list symbol=List symbol=GR ]
             ]
            
            [Node list symbol=: symbol=neqzro 
            
             [Node list symbol=List symbol=GR ]
             ]
            
            [Node list symbol=: symbol=wcond 
            
             [Node list symbol=List 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            
            [Node list symbol=: symbol=bsoln 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=partsol 
              
               [Node list symbol=Vector 
               
                [Node list symbol=Fraction 
                
                 [Node list symbol=Polynomial symbol=R ]
                 ]
                ]
               ]
              
              [Node list symbol=: symbol=basis 
              
               [Node list symbol=List 
               
                [Node list symbol=Vector 
                
                 [Node list symbol=Fraction 
                 
                  [Node list symbol=Polynomial symbol=R ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G11476852 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=wcd ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G11476852 symbol=noBranch 
            
             [Node list symbol=LET symbol=yzero 
             
              [Node list symbol=removeDuplicates 
              
               [Node list symbol=append symbol=yzero 
               
                [Node list symbol=COLLECT 
                
                 [Node list symbol=IN symbol=pw symbol=wcd ]
                 
                 [Node list symbol=pr2dmp symbol=pw ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=test 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=sysok 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=: symbol=z0 
             
              [Node list symbol=List symbol=GR ]
              ]
             
             [Node list symbol=: symbol=n0 
             
              [Node list symbol=List symbol=GR ]
              ]
             ]
            ]
           
           [Node list symbol=hasoln symbol=yzero symbol=ydetf ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G11476853 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=test symbol=sysok ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G11476853 symbol=noBranch 
            
             [Node list symbol=exit int=2 
             
              [Node list symbol=pps 
              
               [Node list symbol=Sel symbol=construct 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=eqzro 
                 
                  [Node list symbol=List symbol=GR ]
                  ]
                 
                 [Node list symbol=: symbol=neqzro 
                 
                  [Node list symbol=List symbol=GR ]
                  ]
                 
                 [Node list symbol=: symbol=wcond 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Polynomial symbol=R ]
                   ]
                  ]
                 
                 [Node list symbol=: symbol=bsoln 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=partsol 
                   
                    [Node list symbol=Vector 
                    
                     [Node list symbol=Fraction 
                     
                      [Node list symbol=Polynomial symbol=R ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=: symbol=basis 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=Vector 
                     
                      [Node list symbol=Fraction 
                      
                       [Node list symbol=Polynomial symbol=R ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=test symbol=z0 ]
               
               [Node list symbol=test symbol=n0 ]
               
               [Node list 
               
                [Node list symbol=Sel symbol=construct 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Polynomial symbol=R ]
                  ]
                 ]
                
                [Node list symbol=Sel 
                
                 [Node list symbol=Polynomial symbol=R ]
                 
                 [Node list symbol=One ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list 
           
            [Node list symbol=Sel symbol=construct 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=eqzro 
              
               [Node list symbol=List symbol=GR ]
               ]
              
              [Node list symbol=: symbol=neqzro 
              
               [Node list symbol=List symbol=GR ]
               ]
              
              [Node list symbol=: symbol=wcond 
              
               [Node list symbol=List 
               
                [Node list symbol=Polynomial symbol=R ]
                ]
               ]
              
              [Node list symbol=: symbol=bsoln 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=partsol 
                
                 [Node list symbol=Vector 
                 
                  [Node list symbol=Fraction 
                  
                   [Node list symbol=Polynomial symbol=R ]
                   ]
                  ]
                 ]
                
                [Node list symbol=: symbol=basis 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Vector 
                  
                   [Node list symbol=Fraction 
                   
                    [Node list symbol=Polynomial symbol=R ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=test symbol=z0 ]
            
            [Node list symbol=test symbol=n0 ]
            
            [Node list symbol=construct ]
            
            [Node list symbol=redpps symbol=pps 
            
             [Node list symbol=test symbol=z0 ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF bsolve coeff w h outname mode SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=nrows symbol=coeff ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476854 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= symbol=r 
     
      [Node list symbol=# symbol=w ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476854 
     
      [Node list symbol=error string=number of rows unequal on lhs and rhs ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=: symbol=newfile 
       
        [Node list symbol=FileName ]
        ]
       
       [Node list symbol=: symbol=rksoln 
       
        [Node list symbol=File 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=eqzro 
          
           [Node list symbol=List symbol=GR ]
           ]
          
          [Node list symbol=: symbol=neqzro 
          
           [Node list symbol=List symbol=GR ]
           ]
          
          [Node list symbol=: symbol=wcond 
          
           [Node list symbol=List 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          
          [Node list symbol=: symbol=bsoln 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=partsol 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            
            [Node list symbol=: symbol=basis 
            
             [Node list symbol=List 
             
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction 
               
                [Node list symbol=Polynomial symbol=R ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=count 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=lrec3 
        
         [Node list symbol=List 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=eqzro 
           
            [Node list symbol=List symbol=GR ]
            ]
           
           [Node list symbol=: symbol=neqzro 
           
            [Node list symbol=List symbol=GR ]
            ]
           
           [Node list symbol=: symbol=wcond 
           
            [Node list symbol=List 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           
           [Node list symbol=: symbol=bsoln 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=partsol 
             
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction 
               
                [Node list symbol=Polynomial symbol=R ]
                ]
               ]
              ]
             
             [Node list symbol=: symbol=basis 
             
              [Node list symbol=List 
              
               [Node list symbol=Vector 
               
                [Node list symbol=Fraction 
                
                 [Node list symbol=Polynomial symbol=R ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=construct ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=filemode 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=entry? symbol=mode 
        
         [Node list int=7 int=8 int=9 int=10 int=11 int=12 
         
          [Node list symbol=Sel symbol=construct 
          
           [Node list symbol=List 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=filemode symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=newfile 
         
          [Node list string=symbol=outname string=regime 
          
           [Node list symbol=Sel symbol=new 
           
            [Node list symbol=FileName ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=rksoln 
          
           [Node list symbol=newfile 
           
            [Node list symbol=Sel symbol=open 
            
             [Node list symbol=File 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=eqzro 
               
                [Node list symbol=List symbol=GR ]
                ]
               
               [Node list symbol=: symbol=neqzro 
               
                [Node list symbol=List symbol=GR ]
                ]
               
               [Node list symbol=: symbol=wcond 
               
                [Node list symbol=List 
                
                 [Node list symbol=Polynomial symbol=R ]
                 ]
                ]
               
               [Node list symbol=: symbol=bsoln 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=partsol 
                 
                  [Node list symbol=Vector 
                  
                   [Node list symbol=Fraction 
                   
                    [Node list symbol=Polynomial symbol=R ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=: symbol=basis 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Vector 
                   
                    [Node list symbol=Fraction 
                    
                     [Node list symbol=Polynomial symbol=R ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=y 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=det symbol=GR ]
         
         [Node list symbol=: symbol=rows 
         
          [Node list symbol=List 
          
           [Node list symbol=Integer ]
           ]
          ]
         
         [Node list symbol=: symbol=cols 
         
          [Node list symbol=List 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=k 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=rrcl 
        
         [Node list symbol=List 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=rank 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=: symbol=eqns 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=det symbol=GR ]
              
              [Node list symbol=: symbol=rows 
              
               [Node list symbol=List 
               
                [Node list symbol=Integer ]
                ]
               ]
              
              [Node list symbol=: symbol=cols 
              
               [Node list symbol=List 
               
                [Node list symbol=Integer ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=: symbol=fgb 
           
            [Node list symbol=List symbol=GR ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G11476855 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=entry? symbol=mode 
          
           [Node list int=2 int=3 int=7 int=8 int=9 
           
            [Node list symbol=Sel symbol=construct 
            
             [Node list symbol=List 
             
              [Node list symbol=Integer ]
              ]
             ]
            
            [Node list symbol=One ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G11476855 
          
           [Node list symbol=ParCondList symbol=coeff 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G11476856 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=entry? symbol=mode 
             
              [Node list int=4 int=5 int=6 int=10 int=11 int=12 
              
               [Node list symbol=Sel symbol=construct 
               
                [Node list symbol=List 
                
                 [Node list symbol=Integer ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G11476856 symbol=noBranch 
             
              [Node list symbol=exit int=1 
              
               [Node list symbol=ParCondList symbol=coeff symbol=h ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=rkmax 
       
        [Node list symbol=maxrank symbol=rrcl ]
        ]
       
       [Node list symbol=LET symbol=rkmin 
       
        [Node list symbol=minrank symbol=rrcl ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=INBY symbol=k 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=+ 
          
           [Node list symbol=- symbol=rkmax symbol=rkmin ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=One ]
          ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=rk 
         
          [Node list symbol=rank 
          
           [Node list symbol=rrcl symbol=k ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=pc 
          
           [Node list symbol=List 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=det symbol=GR ]
             
             [Node list symbol=: symbol=rows 
             
              [Node list symbol=List 
              
               [Node list symbol=Integer ]
               ]
              ]
             
             [Node list symbol=: symbol=cols 
             
              [Node list symbol=List 
              
               [Node list symbol=Integer ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=eqns 
          
           [Node list symbol=rrcl symbol=k ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=psb 
          
           [Node list symbol=List symbol=GR ]
           ]
          
          [Node list symbol=IF 
          
           [Node list symbol== symbol=rk symbol=rkmax ]
           
           [Node list symbol=construct ]
           
           [Node list symbol=fgb 
           
            [Node list symbol=rrcl 
            
             [Node list symbol=+ symbol=k 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=psbf 
          
           [Node list symbol=List 
           
            [Node list symbol=List symbol=GR ]
            ]
           ]
          
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=x symbol=psb ]
           
           [Node list symbol=factorset symbol=x ]
           ]
          ]
         
         [Node list symbol=LET symbol=psbf 
         
          [Node list symbol=minset symbol=psbf ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=y symbol=pc ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=rec3 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=eqzro 
               
                [Node list symbol=List symbol=GR ]
                ]
               
               [Node list symbol=: symbol=neqzro 
               
                [Node list symbol=List symbol=GR ]
                ]
               
               [Node list symbol=: symbol=wcond 
               
                [Node list symbol=List 
                
                 [Node list symbol=Polynomial symbol=R ]
                 ]
                ]
               
               [Node list symbol=: symbol=bsoln 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=partsol 
                 
                  [Node list symbol=Vector 
                  
                   [Node list symbol=Fraction 
                   
                    [Node list symbol=Polynomial symbol=R ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=: symbol=basis 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Vector 
                   
                    [Node list symbol=Fraction 
                    
                     [Node list symbol=Polynomial symbol=R ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=regime symbol=y symbol=coeff symbol=w symbol=psbf symbol=rk symbol=rkmax symbol=mode ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G11476857 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=inconsistent? 
             
              [Node list symbol=rec3 symbol=wcond ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G11476857 string=incompatible system 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=IF symbol=filemode 
               
                [Node list symbol=write! symbol=rksoln symbol=rec3 ]
                
                [Node list symbol=LET symbol=lrec3 
                
                 [Node list symbol=cons symbol=rec3 symbol=lrec3 ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=count 
                
                 [Node list symbol=+ symbol=count 
                 
                  [Node list symbol=One ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=filemode symbol=noBranch 
       
        [Node list symbol=close! symbol=rksoln ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=lrec3 symbol=count 
        
         [Node list symbol=Sel symbol=construct 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=rgl 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=eqzro 
              
               [Node list symbol=List symbol=GR ]
               ]
              
              [Node list symbol=: symbol=neqzro 
              
               [Node list symbol=List symbol=GR ]
               ]
              
              [Node list symbol=: symbol=wcond 
              
               [Node list symbol=List 
               
                [Node list symbol=Polynomial symbol=R ]
                ]
               ]
              
              [Node list symbol=: symbol=bsoln 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=partsol 
                
                 [Node list symbol=Vector 
                 
                  [Node list symbol=Fraction 
                  
                   [Node list symbol=Polynomial symbol=R ]
                   ]
                  ]
                 ]
                
                [Node list symbol=: symbol=basis 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Vector 
                  
                   [Node list symbol=Fraction 
                   
                    [Node list symbol=Polynomial symbol=R ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=: symbol=rgsz 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF factorset y SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476858 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=ground? symbol=y ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476858 
     
      [Node list symbol=construct ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=factors 
        
         [Node list symbol=y 
         
          [Node list symbol=Sel symbol=factor 
          
           [Node list symbol=MultivariateFactorize symbol=Var symbol=Expon symbol=R symbol=GR ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=j symbol=factor ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ParCondList mat h SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rcl 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=rank 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=eqns 
        
         [Node list symbol=List 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=det symbol=GR ]
           
           [Node list symbol=: symbol=rows 
           
            [Node list symbol=List 
            
             [Node list symbol=Integer ]
             ]
            ]
           
           [Node list symbol=: symbol=cols 
           
            [Node list symbol=List 
            
             [Node list symbol=Integer ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=fgb 
        
         [Node list symbol=List symbol=GR ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ps 
     
      [Node list symbol=List symbol=GR ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=pc 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=det symbol=GR ]
        
        [Node list symbol=: symbol=rows 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=: symbol=cols 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=npc 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=det symbol=GR ]
        
        [Node list symbol=: symbol=rows 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=: symbol=cols 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=psbf 
     
      [Node list symbol=List symbol=GR ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= : rc
    [Node list symbol=: symbol=rc 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=det symbol=GR ]
      
      [Node list symbol=: symbol=rows 
      
       [Node list symbol=List 
       
        [Node list symbol=Integer ]
        ]
       ]
      
      [Node list symbol=: symbol=cols 
      
       [Node list symbol=List 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET false
    [Node list symbol=LET symbol=false 
    
     [Node list symbol=: symbol=done 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=nrows symbol=mat ]
     ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=ncols symbol=mat ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=maxrk 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=min symbol=r symbol=n ]
     ]
    
   DEFSubnode:atts= : k
    [Node list symbol=: symbol=k 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=INBY symbol=k 
     
      [Node list symbol=SEGMENT symbol=h 
      
       [Node list symbol=min symbol=r symbol=n ]
       ]
      
      [Node list symbol=- 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=UNTIL symbol=done ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=pc 
      
       [Node list symbol=ParCond symbol=mat symbol=k ]
       ]
      
      [Node list symbol=LET symbol=npc 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G11476859 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=pc ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G11476859 symbol=noBranch 
        
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol=>= symbol=k 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=exit int=2 
          
           [Node list symbol=LET symbol=maxrk 
           
            [Node list symbol=- symbol=k 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G11476861 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=ground? 
        
         [Node list symbol=det 
         
          [Node list symbol=pc 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G11476861 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=npc symbol=pc ]
          
          [Node list symbol=LET symbol=done symbol=true ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ps 
           
            [Node list symbol=construct 
            
             [Node list symbol=Sel symbol=GR 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=zro 
           
            [Node list symbol=List symbol=GR ]
            ]
           
           [Node list symbol=IF 
           
            [Node list symbol== symbol=k symbol=maxrk ]
            
            [Node list symbol=construct ]
            
            [Node list symbol=fgb 
            
             [Node list symbol=rcl 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=false 
          
           [Node list symbol=: symbol=covered 
           
            [Node list symbol=Boolean ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=rc symbol=pc ]
           
           [Node list symbol=UNTIL symbol=covered ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=p symbol=GR ]
             
             [Node list symbol=zro 
             
              [Node list symbol=Sel symbol=euclideanNormalForm 
              
               [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
               ]
              
              [Node list symbol=rc symbol=det ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF string=incompatible or covered subdeterminant 
             
              [Node list symbol== symbol=p 
              
               [Node list symbol=Zero ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=test 
               
                [Node list symbol=hasoln symbol=zro 
                
                 [Node list symbol=construct 
                 
                  [Node list symbol=rc symbol=det ]
                  ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G11476860 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=test symbol=sysok ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G11476860 symbol=noBranch 
                 
                  [Node list symbol=exit int=2 string=incompatible or covered ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=zro 
               
                [Node list 
                
                 [Node list symbol=Sel symbol=euclideanGroebner 
                 
                  [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
                  ]
                 
                 [Node list symbol=cons symbol=p symbol=zro ]
                 ]
                ]
               
               [Node list symbol=LET symbol=npc 
               
                [Node list symbol=cons symbol=rc symbol=npc ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=done 
                
                 [Node list symbol=LET symbol=covered 
                 
                  [Node list symbol=inconsistent? symbol=zro ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ps symbol=zro ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=pcl 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=rank 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=eqns 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=det symbol=GR ]
            
            [Node list symbol=: symbol=rows 
            
             [Node list symbol=List 
             
              [Node list symbol=Integer ]
              ]
             ]
            
            [Node list symbol=: symbol=cols 
            
             [Node list symbol=List 
             
              [Node list symbol=Integer ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=: symbol=fgb 
         
          [Node list symbol=List symbol=GR ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=k symbol=npc symbol=ps ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=rcl 
       
        [Node list symbol=cons symbol=pcl symbol=rcl ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 rcl
    [Node list symbol=exit int=1 symbol=rcl ]
    
   ]
   
  CAPSULEDef:
   [DEF redpps pps zz SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET pv
    [Node list symbol=LET symbol=pv 
    
     [Node list symbol=pps symbol=partsol ]
     ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=# symbol=pv ]
     ]
    
   DEFSubnode:atts= LET pb
    [Node list symbol=LET symbol=pb 
    
     [Node list symbol=pps symbol=basis ]
     ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=+ 
     
      [Node list symbol=# symbol=pb ]
      
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nummat 
     
      [Node list symbol=Matrix symbol=GR ]
      ]
     
     [Node list symbol=zero symbol=r symbol=n ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=denmat 
     
      [Node list symbol=Matrix symbol=GR ]
      ]
     
     [Node list symbol=zero symbol=r symbol=n ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=r 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=nummat symbol=i 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=pr2dmp 
       
        [Node list 
        
         [Node list symbol=Sel symbol=numer 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         
         [Node list symbol=pv symbol=i ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=denmat symbol=i 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=pr2dmp 
        
         [Node list 
         
          [Node list symbol=Sel symbol=denom 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          
          [Node list symbol=pv symbol=i ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=SEGMENT int=2 symbol=n ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=r 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=nummat symbol=i symbol=j ]
        
        [Node list symbol=pr2dmp 
        
         [Node list 
         
          [Node list symbol=Sel symbol=numer 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          
          [Node list symbol=i 
          
           [Node list symbol=pb 
           
            [Node list symbol=- symbol=j 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET 
        
         [Node list symbol=denmat symbol=i symbol=j ]
         
         [Node list symbol=pr2dmp 
         
          [Node list 
          
           [Node list symbol=Sel symbol=denom 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           
           [Node list symbol=i 
           
            [Node list symbol=pb 
            
             [Node list symbol=- symbol=j 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET nummat
    [Node list symbol=LET symbol=nummat 
    
     [Node list symbol=redmat symbol=nummat symbol=zz ]
     ]
    
   DEFSubnode:atts= LET denmat
    [Node list symbol=LET symbol=denmat 
    
     [Node list symbol=redmat symbol=denmat symbol=zz ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=r 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=pv symbol=i ]
      
      [Node list symbol=/ 
      
       [Node list symbol=dmp2rfi 
       
        [Node list symbol=nummat symbol=i 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=dmp2rfi 
       
        [Node list symbol=denmat symbol=i 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=SEGMENT int=2 symbol=n ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=pbj 
       
        [Node list symbol=Vector 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        ]
       
       [Node list symbol=new symbol=r 
       
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=r 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=pbj symbol=i ]
        
        [Node list symbol=/ 
        
         [Node list symbol=dmp2rfi 
         
          [Node list symbol=nummat symbol=i symbol=j ]
          ]
         
         [Node list symbol=dmp2rfi 
         
          [Node list symbol=denmat symbol=i symbol=j ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=pbj 
       
        [Node list symbol=pb 
        
         [Node list symbol=- symbol=j 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=pv symbol=pb ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF dmp2rfi mat SEQ
   DEFSubnode:atts= Matrix
    [Node list symbol=Matrix 
    
     [Node list symbol=Fraction 
     
      [Node list symbol=Polynomial symbol=R ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=nrows symbol=mat ]
     ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=ncols symbol=mat ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nmat 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     
     [Node list symbol=zero symbol=r symbol=n ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=r 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT symbol=n 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=nmat symbol=i symbol=j ]
       
       [Node list symbol=dmp2rfi 
       
        [Node list symbol=mat symbol=i symbol=j ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 nmat
    [Node list symbol=exit int=1 symbol=nmat ]
    
   ]
   
  CAPSULEDef:
   [DEF dmp2rfi vl COLLECT
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Fraction 
     
      [Node list symbol=Polynomial symbol=R ]
      ]
     ]
    
   DEFSubnode:atts= List GR
    [Node list symbol=List symbol=GR ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= IN v vl
    [Node list symbol=IN symbol=v symbol=vl ]
    
   DEFSubnode:atts= dmp2rfi v
    [Node list symbol=dmp2rfi symbol=v ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w rgl
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=eqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=neqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=wcond 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      
      [Node list symbol=: symbol=bsoln 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=partsol 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=basis 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List GR
    [Node list symbol=List symbol=GR ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat nofile
    [Node list symbol=bsolve symbol=mat string=nofile 
    
     [Node list symbol=dmp2rfi symbol=w ]
     
     [Node list symbol=One ]
     
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w rgl
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=eqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=neqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=wcond 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      
      [Node list symbol=: symbol=bsoln 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=partsol 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=basis 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Symbol ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat nofile 2
    [Node list symbol=bsolve symbol=mat string=nofile int=2 
    
     [Node list symbol=se2rfi symbol=w ]
     
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat rgl
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=eqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=neqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=wcond 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      
      [Node list symbol=: symbol=bsoln 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=partsol 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=basis 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat nofile 3
    [Node list symbol=bsolve symbol=mat string=nofile int=3 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=nrows symbol=mat ]
        ]
       ]
      
      [Node list symbol=Sel 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w h rgl
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=eqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=neqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=wcond 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      
      [Node list symbol=: symbol=bsoln 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=partsol 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=basis 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List GR
    [Node list symbol=List symbol=GR ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat nofile 4
    [Node list symbol=bsolve symbol=mat string=nofile int=4 
    
     [Node list symbol=dmp2rfi symbol=w ]
     
     [Node list symbol=:: symbol=h 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w h rgl
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=eqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=neqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=wcond 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      
      [Node list symbol=: symbol=bsoln 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=partsol 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=basis 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Symbol ]
     ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat nofile 5
    [Node list symbol=bsolve symbol=mat string=nofile int=5 
    
     [Node list symbol=se2rfi symbol=w ]
     
     [Node list symbol=:: symbol=h 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat h rgl
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=eqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=neqzro 
      
       [Node list symbol=List symbol=GR ]
       ]
      
      [Node list symbol=: symbol=wcond 
      
       [Node list symbol=List 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      
      [Node list symbol=: symbol=bsoln 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=partsol 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         ]
        
        [Node list symbol=: symbol=basis 
        
         [Node list symbol=List 
         
          [Node list symbol=Vector 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat nofile 6
    [Node list symbol=bsolve symbol=mat string=nofile int=6 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=nrows symbol=mat ]
        ]
       ]
      
      [Node list symbol=Sel 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=:: symbol=h 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w outname rgsz
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List GR
    [Node list symbol=List symbol=GR ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat outname 7
    [Node list symbol=bsolve symbol=mat symbol=outname int=7 
    
     [Node list symbol=dmp2rfi symbol=w ]
     
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w outname rgsz
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Symbol ]
     ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat outname 8
    [Node list symbol=bsolve symbol=mat symbol=outname int=8 
    
     [Node list symbol=se2rfi symbol=w ]
     
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat outname rgsz
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat outname 9
    [Node list symbol=bsolve symbol=mat symbol=outname int=9 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=nrows symbol=mat ]
        ]
       ]
      
      [Node list symbol=Sel 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF nextSublist n k IF
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= <= n
    [Node list symbol=<= symbol=n 
    
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol=<= symbol=k 
     
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=construct 
     
      [Node list 
      
       [Node list symbol=Sel symbol=construct 
       
        [Node list symbol=List 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=IF 
     
      [Node list symbol=> symbol=k symbol=n ]
      
      [Node list symbol=construct ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=n 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol== symbol=k 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=construct 
          
           [Node list symbol=construct 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=mslist 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        
        [Node list symbol=construct ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=ms 
        
         [Node list symbol=nextSublist 
         
          [Node list symbol=- symbol=n 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=- symbol=k 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=mslist 
        
         [Node list symbol=cons symbol=mslist 
         
          [Node list symbol=append symbol=ms 
          
           [Node list symbol=construct symbol=n ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=append symbol=mslist 
        
         [Node list symbol=nextSublist symbol=k 
         
          [Node list symbol=- symbol=n 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w h outname rgsz
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List GR
    [Node list symbol=List symbol=GR ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat outname 10
    [Node list symbol=bsolve symbol=mat symbol=outname int=10 
    
     [Node list symbol=dmp2rfi symbol=w ]
     
     [Node list symbol=:: symbol=h 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat w h outname rgsz
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Symbol ]
     ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat outname 11
    [Node list symbol=bsolve symbol=mat symbol=outname int=11 
    
     [Node list symbol=se2rfi symbol=w ]
     
     [Node list symbol=:: symbol=h 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF psolve mat h outname rgsz
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Matrix GR
    [Node list symbol=Matrix symbol=GR ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= bsolve mat outname 12
    [Node list symbol=bsolve symbol=mat symbol=outname int=12 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=nrows symbol=mat ]
        ]
       ]
      
      [Node list symbol=Sel 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Polynomial symbol=R ]
        ]
       
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=:: symbol=h 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF hasoln zro nzro SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476862 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=zro ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476862 
     
      [Node list symbol=construct symbol=true symbol=zro symbol=nzro ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=zro 
       
        [Node list symbol=zro 
        
         [Node list symbol=Sel symbol=euclideanGroebner 
         
          [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G11476863 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=inconsistent? symbol=zro ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G11476863 
        
         [Node list symbol=construct symbol=false symbol=zro symbol=nzro ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G11476864 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=nzro ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G11476864 
           
            [Node list symbol=construct symbol=true symbol=zro symbol=nzro ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=pnzro symbol=GR ]
              
              [Node list symbol=zro 
              
               [Node list symbol=Sel symbol=euclideanNormalForm 
               
                [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
                ]
               
               [Node list symbol=REDUCE symbol=* int=0 
               
                [Node list symbol=COLLECT symbol=G11476844 
                
                 [Node list symbol=IN symbol=G11476844 symbol=nzro ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF 
              
               [Node list symbol== symbol=pnzro 
               
                [Node list symbol=Zero ]
                ]
               
               [Node list symbol=construct symbol=false symbol=zro symbol=nzro ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=nzro 
                
                 [Node list symbol=factorset symbol=pnzro ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=psbf 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=List symbol=GR ]
                   ]
                  ]
                 
                 [Node list symbol=minset 
                 
                  [Node list symbol=COLLECT 
                  
                   [Node list symbol=IN symbol=p symbol=zro ]
                   
                   [Node list symbol=factorset symbol=p ]
                   ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=psbf 
                
                 [Node list symbol=COLLECT 
                 
                  [Node list symbol=IN symbol=x symbol=psbf ]
                  
                  [Node list symbol=setDifference symbol=x symbol=nzro ]
                  ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G11476865 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=entry? symbol=psbf 
                 
                  [Node list symbol=construct ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G11476865 
                 
                  [Node list symbol=construct symbol=false symbol=zro symbol=nzro ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET symbol=zro 
                   
                    [Node list 
                    
                     [Node list symbol=Sel symbol=euclideanGroebner 
                     
                      [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
                      ]
                     
                     [Node list symbol=COLLECT 
                     
                      [Node list symbol=IN symbol=x symbol=psbf ]
                      
                      [Node list symbol=REDUCE symbol=* int=0 
                      
                       [Node list symbol=COLLECT symbol=G11476845 
                       
                        [Node list symbol=IN symbol=G11476845 symbol=x ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=G11476866 
                    
                     [Node list symbol=Boolean ]
                     ]
                    
                    [Node list symbol=inconsistent? symbol=zro ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=IF symbol=G11476866 
                    
                     [Node list symbol=construct symbol=false symbol=zro symbol=nzro ]
                     
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET symbol=nzro 
                      
                       [Node list symbol=COLLECT 
                       
                        [Node list symbol=IN symbol=p symbol=nzro ]
                        
                        [Node list symbol=p symbol=zro 
                        
                         [Node list symbol=Sel symbol=euclideanNormalForm 
                         
                          [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
                          ]
                         ]
                        ]
                       ]
                      
                      [Node list symbol=LET symbol=nzro 
                      
                       [Node list symbol=COLLECT symbol=p 
                       
                        [Node list symbol=IN symbol=p symbol=nzro ]
                        
                        [Node list symbol=| 
                        
                         [Node list symbol=SEQ 
                         
                          [Node list symbol=LET 
                          
                           [Node list symbol=: symbol=G11476867 
                           
                            [Node list symbol=Boolean ]
                            ]
                           
                           [Node list symbol=ground? symbol=p ]
                           ]
                          
                          [Node list symbol=exit int=1 
                          
                           [Node list symbol=IF symbol=G11476867 symbol=false symbol=true ]
                           ]
                          ]
                         ]
                        ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=construct symbol=true symbol=zro symbol=nzro ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF se2rfi w COLLECT
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= IN wi w
    [Node list symbol=IN symbol=wi symbol=w ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=coerce 
     
      [Node list symbol=Fraction 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     
     [Node list symbol=wi 
     
      [Node list symbol=Sel symbol=monomial 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      
      [Node list symbol=Sel 
      
       [Node list symbol=Polynomial symbol=R ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=One ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF pr2dmp p SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476868 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=ground? symbol=p ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476868 
     
      [Node list symbol=:: symbol=GR 
      
       [Node list symbol=ground symbol=p ]
       ]
      
      [Node list symbol=pretend symbol=GR 
      
       [Node list symbol=p symbol=GR 
       
        [Node list symbol=Sel symbol=Lisp symbol=algCoerceInteractive ]
        
        [Node list symbol=Polynomial symbol=R ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF wrregime lrec3 outname SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newfile 
     
      [Node list symbol=FileName ]
      ]
     
     [Node list string=symbol=outname string=regime 
     
      [Node list symbol=Sel symbol=new 
      
       [Node list symbol=FileName ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rksoln 
     
      [Node list symbol=File 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=eqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=neqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=wcond 
        
         [Node list symbol=List 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        
        [Node list symbol=: symbol=bsoln 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=partsol 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          
          [Node list symbol=: symbol=basis 
          
           [Node list symbol=List 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=newfile 
     
      [Node list symbol=Sel symbol=open 
      
       [Node list symbol=File 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=eqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=neqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=wcond 
         
          [Node list symbol=List 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         
         [Node list symbol=: symbol=bsoln 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=partsol 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           
           [Node list symbol=: symbol=basis 
           
            [Node list symbol=List 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=count 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=rec3 symbol=lrec3 ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=write! symbol=rksoln symbol=rec3 ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=count 
       
        [Node list symbol=+ symbol=count 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= close! rksoln
    [Node list symbol=close! symbol=rksoln ]
    
   DEFSubnode:atts= exit 1 count
    [Node list symbol=exit int=1 symbol=count ]
    
   ]
   
  CAPSULEDef:
   [DEF dmp2rfi p GR p
   DEFSubnode:atts= Fraction
    [Node list symbol=Fraction 
    
     [Node list symbol=Polynomial symbol=R ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel map
    [Node list symbol=Sel symbol=map 
    
     [Node list symbol=PolynomialCategoryLifting symbol=Expon symbol=Var symbol=R symbol=GR 
     
      [Node list symbol=Fraction 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     ]
    
   DEFSubnode:atts= +->
    [Node list symbol=+-> 
    
     [Node list symbol=: 
     
      [Node list symbol=: symbol=v1 symbol=Var ]
      
      [Node list symbol=Fraction 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=@ 
      
       [Node list symbol=convert symbol=v1 ]
       
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=Fraction 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     ]
    
   DEFSubnode:atts= +->
    [Node list symbol=+-> 
    
     [Node list symbol=: 
     
      [Node list symbol=: symbol=r1 symbol=R ]
      
      [Node list symbol=Fraction 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=:: symbol=r1 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      
      [Node list symbol=Fraction 
      
       [Node list symbol=Polynomial symbol=R ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF rdregime inname SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET infilename
    [Node list symbol=LET symbol=infilename 
    
     [Node list string=symbol=inname string=regime 
     
      [Node list symbol=Sel symbol=filename 
      
       [Node list symbol=FileName ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=infile 
     
      [Node list symbol=File 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=eqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=neqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=wcond 
        
         [Node list symbol=List 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        
        [Node list symbol=: symbol=bsoln 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=partsol 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          
          [Node list symbol=: symbol=basis 
          
           [Node list symbol=List 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=infilename string=input 
     
      [Node list symbol=Sel symbol=open 
      
       [Node list symbol=File 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=eqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=neqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=wcond 
         
          [Node list symbol=List 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         
         [Node list symbol=: symbol=bsoln 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=partsol 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           
           [Node list symbol=: symbol=basis 
           
            [Node list symbol=List 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rksoln 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=eqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=neqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=wcond 
        
         [Node list symbol=List 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        
        [Node list symbol=: symbol=bsoln 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=partsol 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          
          [Node list symbol=: symbol=basis 
          
           [Node list symbol=List 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rec3 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=eqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=neqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=wcond 
        
         [Node list symbol=List 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        
        [Node list symbol=: symbol=bsoln 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=partsol 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          
          [Node list symbol=: symbol=basis 
          
           [Node list symbol=List 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=infile 
     
      [Node list symbol=Sel symbol=readIfCan! 
      
       [Node list symbol=File 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=eqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=neqzro 
         
          [Node list symbol=List symbol=GR ]
          ]
         
         [Node list symbol=: symbol=wcond 
         
          [Node list symbol=List 
          
           [Node list symbol=Polynomial symbol=R ]
           ]
          ]
         
         [Node list symbol=: symbol=bsoln 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=partsol 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           
           [Node list symbol=: symbol=basis 
           
            [Node list symbol=List 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=case symbol=rec3 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=eqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=neqzro 
        
         [Node list symbol=List symbol=GR ]
         ]
        
        [Node list symbol=: symbol=wcond 
        
         [Node list symbol=List 
         
          [Node list symbol=Polynomial symbol=R ]
          ]
         ]
        
        [Node list symbol=: symbol=bsoln 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=partsol 
          
           [Node list symbol=Vector 
           
            [Node list symbol=Fraction 
            
             [Node list symbol=Polynomial symbol=R ]
             ]
            ]
           ]
          
          [Node list symbol=: symbol=basis 
          
           [Node list symbol=List 
           
            [Node list symbol=Vector 
            
             [Node list symbol=Fraction 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=rksoln 
      
       [Node list symbol=cons symbol=rksoln 
       
        [Node list symbol=:: symbol=rec3 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=eqzro 
          
           [Node list symbol=List symbol=GR ]
           ]
          
          [Node list symbol=: symbol=neqzro 
          
           [Node list symbol=List symbol=GR ]
           ]
          
          [Node list symbol=: symbol=wcond 
          
           [Node list symbol=List 
           
            [Node list symbol=Polynomial symbol=R ]
            ]
           ]
          
          [Node list symbol=: symbol=bsoln 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=partsol 
            
             [Node list symbol=Vector 
             
              [Node list symbol=Fraction 
              
               [Node list symbol=Polynomial symbol=R ]
               ]
              ]
             ]
            
            [Node list symbol=: symbol=basis 
            
             [Node list symbol=List 
             
              [Node list symbol=Vector 
              
               [Node list symbol=Fraction 
               
                [Node list symbol=Polynomial symbol=R ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=rec3 
       
        [Node list symbol=infile 
        
         [Node list symbol=Sel symbol=readIfCan! 
         
          [Node list symbol=File 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=eqzro 
            
             [Node list symbol=List symbol=GR ]
             ]
            
            [Node list symbol=: symbol=neqzro 
            
             [Node list symbol=List symbol=GR ]
             ]
            
            [Node list symbol=: symbol=wcond 
            
             [Node list symbol=List 
             
              [Node list symbol=Polynomial symbol=R ]
              ]
             ]
            
            [Node list symbol=: symbol=bsoln 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=partsol 
              
               [Node list symbol=Vector 
               
                [Node list symbol=Fraction 
                
                 [Node list symbol=Polynomial symbol=R ]
                 ]
                ]
               ]
              
              [Node list symbol=: symbol=basis 
              
               [Node list symbol=List 
               
                [Node list symbol=Vector 
                
                 [Node list symbol=Fraction 
                 
                  [Node list symbol=Polynomial symbol=R ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= close! infile
    [Node list symbol=close! symbol=infile ]
    
   DEFSubnode:atts= exit 1 rksoln
    [Node list symbol=exit int=1 symbol=rksoln ]
    
   ]
   
  CAPSULEDef:
   [DEF maxrank rcl SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476869 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=rcl ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476869 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=REDUCE symbol=max int=0 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=j symbol=rcl ]
        
        [Node list symbol=j symbol=rank ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF minrank rcl SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476870 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=rcl ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476870 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=REDUCE symbol=min int=0 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=j symbol=rcl ]
        
        [Node list symbol=j symbol=rank ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF minset lset SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476871 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=lset ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476871 symbol=lset 
     
      [Node list symbol=COLLECT symbol=x 
      
       [Node list symbol=IN symbol=x symbol=lset ]
       
       [Node list symbol=| 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G11476872 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=overset? symbol=x symbol=lset ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G11476872 symbol=false symbol=true ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF sqfree p REDUCE * 0
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=factors 
      
       [Node list symbol=squareFree symbol=p ]
       ]
      ]
     
     [Node list symbol=j symbol=factor ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ParCond mat k IF
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= = k
    [Node list symbol== symbol=k 
    
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list 
     
      [Node list symbol=Sel symbol=construct 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=det symbol=GR ]
        
        [Node list symbol=: symbol=rows 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=: symbol=cols 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=One ]
      
      [Node list symbol=construct ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=j 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: symbol=k 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=DetEqn 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=det symbol=GR ]
         
         [Node list symbol=: symbol=rows 
         
          [Node list symbol=List 
          
           [Node list symbol=Integer ]
           ]
          ]
         
         [Node list symbol=: symbol=cols 
         
          [Node list symbol=List 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=r 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=nrows symbol=mat ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=n 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=ncols symbol=mat ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G11476873 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> symbol=k 
      
       [Node list symbol=min symbol=r symbol=n ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G11476873 
      
       [Node list symbol=error string=k exceeds maximum possible rank  ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=false 
        
         [Node list symbol=: symbol=found 
         
          [Node list symbol=Boolean ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=rss 
         
          [Node list symbol=nextSublist symbol=r symbol=k ]
          ]
         
         [Node list symbol=UNTIL symbol=found ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=nss 
          
           [Node list symbol=nextSublist symbol=n symbol=k ]
           ]
          
          [Node list symbol=UNTIL symbol=found ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=matsub 
           
            [Node list symbol=pretend 
            
             [Node list symbol=mat symbol=rss symbol=nss ]
             
             [Node list symbol=SquareMatrix symbol=j symbol=GR ]
             ]
            ]
           
           [Node list symbol=LET symbol=detmat 
           
            [Node list symbol=determinant symbol=matsub ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G11476874 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=~= symbol=detmat 
            
             [Node list symbol=Zero ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G11476874 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=found 
              
               [Node list symbol=ground? symbol=detmat ]
               ]
              
              [Node list symbol=LET symbol=detmat 
              
               [Node list symbol=sqfree symbol=detmat ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=neweqn 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=det symbol=GR ]
                 
                 [Node list symbol=: symbol=rows 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Integer ]
                   ]
                  ]
                 
                 [Node list symbol=: symbol=cols 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Integer ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=detmat symbol=rss symbol=nss ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=DetEqn 
               
                [Node list symbol=cons symbol=neweqn symbol=DetEqn ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=found 
         
          [Node list 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=det symbol=GR ]
              
              [Node list symbol=: symbol=rows 
              
               [Node list symbol=List 
               
                [Node list symbol=Integer ]
                ]
               ]
              
              [Node list symbol=: symbol=cols 
              
               [Node list symbol=List 
               
                [Node list symbol=Integer ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=first symbol=DetEqn ]
           ]
          
          [Node list symbol=sort symbol=DetEqn 
          
           [Node list symbol=+-> 
           
            [Node list symbol=: 
            
             [Node list symbol=@Tuple 
             
              [Node list symbol=: symbol=z1 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=det symbol=GR ]
                
                [Node list symbol=: symbol=rows 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Integer ]
                  ]
                 ]
                
                [Node list symbol=: symbol=cols 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Integer ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=: symbol=z2 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=det symbol=GR ]
                
                [Node list symbol=: symbol=rows 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Integer ]
                  ]
                 ]
                
                [Node list symbol=: symbol=cols 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Integer ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=< 
            
             [Node list symbol=degree 
             
              [Node list symbol=z1 symbol=det ]
              ]
             
             [Node list symbol=degree 
             
              [Node list symbol=z2 symbol=det ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF overset? p qlist SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G11476875 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=qlist ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G11476875 symbol=false 
     
      [Node list symbol=REDUCE symbol=or int=0 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=q symbol=qlist ]
        
        [Node list 
        
         [Node list symbol=Sel symbol=< 
         
          [Node list symbol=Set symbol=GR ]
          ]
         
         [Node list symbol=q 
         
          [Node list symbol=Sel symbol=set 
          
           [Node list symbol=Set symbol=GR ]
           ]
          ]
         
         [Node list symbol=p 
         
          [Node list symbol=Sel symbol=set 
          
           [Node list symbol=Set symbol=GR ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF redmat mat psb SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=i symbol=j ]
     
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=nrows symbol=mat ]
     ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=ncols symbol=mat ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newmat 
     
      [Node list symbol=Matrix symbol=GR ]
      ]
     
     [Node list symbol=zero symbol=r symbol=n ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=r 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT symbol=n 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=p symbol=GR ]
        
        [Node list symbol=mat symbol=i symbol=j ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G11476876 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=ground? symbol=p ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G11476876 
        
         [Node list symbol=LET symbol=p 
         
          [Node list symbol=newmat symbol=i symbol=j ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=newmat symbol=i symbol=j ]
          
          [Node list symbol=p symbol=psb 
          
           [Node list symbol=Sel symbol=euclideanNormalForm 
           
            [Node list symbol=EuclideanGroebnerBasisPackage symbol=R symbol=Expon symbol=Var symbol=GR ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newmat
    [Node list symbol=exit int=1 symbol=newmat ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=EuclideanDomain ]
   
   [Node list symbol=CharacteristicZero ]
   ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=OrderedSet ]
   
   [Node list symbol=ConvertibleTo 
   
    [Node list symbol=Symbol ]
    ]
   ]
  
 DEFSubnode:atts= OrderedAbelianMonoidSup
  [Node list symbol=OrderedAbelianMonoidSup ]
  
 DEFSubnode:atts= PolynomialCategory R Expon Var
  [Node list symbol=PolynomialCategory symbol=R symbol=Expon symbol=Var ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 