[File 

 [DEF JetBundleCategory add
 DEFSubnode:atts= Category
  [Node list symbol=Category ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=OrderedSet ]
   
   [Node list symbol=CoercibleTo 
   
    [Node list symbol=Expression 
    
     [Node list symbol=Integer ]
     ]
    ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=setNotation 
    
     [Node list 
     
      [Node list symbol=Symbol ]
      
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=getNotation 
    
     [Node list 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=multiIndex 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=repeatedIndex 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=r2m 
    
     [Node list 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=m2r 
    
     [Node list 
     
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=allRepeated 
    
     [Node list 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=index 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=type 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=name 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=class 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=class 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=order 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weight 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=> 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=differentiate 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union symbol=$ string=0 ]
      
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=derivativeOf? 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integrateIfCan 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union symbol=$ string=failed ]
      
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=integrate 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=X 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=U 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=Pm 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=Pr 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=constant 
    
     [Node list symbol=One ]
     
     [Node list symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=one? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=X 
    
     [Node list symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=U 
    
     [Node list symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=variables 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=variables 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dimJ 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dimS 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=numIndVar 
    
     [Node list 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=numDepVar 
    
     [Node list 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=import 
   
    [Node list symbol=Symbol ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list symbol=numIndVar ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mm 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list symbol=numDepVar ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=m2r symbol=mi ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=PositiveInteger ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=ri 
      
       [Node list symbol=List 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=k 
      
       [Node list symbol=PositiveInteger ]
       ]
      
      [Node list symbol=One ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=mi ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=SEGMENT symbol=i 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=LET symbol=ri 
        
         [Node list symbol=cons symbol=k symbol=ri ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=k 
        
         [Node list symbol=+ symbol=k 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=ri ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=r2m symbol=ri ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=mi 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=new 
      
       [Node list symbol=numIndVar ]
       
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=ri ]
      
      [Node list symbol=IF 
      
       [Node list symbol=> symbol=i symbol=nn ]
       
       [Node list symbol=error string=Improper multi-index ]
       
       [Node list symbol=LET 
       
        [Node list symbol=mi symbol=i ]
        
        [Node list symbol=+ 
        
         [Node list symbol=One ]
         
         [Node list symbol=mi symbol=i ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=mi ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=allRepeated symbol=mu ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=PositiveInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=IN symbol=k symbol=mu ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4943656 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=k ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4943656 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=nu 
          
           [Node list symbol=copy symbol=mu ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=nu symbol=i ]
           
           [Node list symbol=:: 
           
            [Node list symbol=- symbol=k 
            
             [Node list symbol=One ]
             ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          
          [Node list symbol=LET symbol=tmp 
          
           [Node list symbol=allRepeated symbol=nu ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=res 
           
            [Node list symbol=concat! symbol=res 
            
             [Node list symbol=map symbol=tmp 
             
              [Node list symbol=+-> 
              
               [Node list symbol=: 
               
                [Node list symbol=: symbol=x 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=PositiveInteger ]
                  ]
                 ]
                
                [Node list symbol=List 
                
                 [Node list symbol=PositiveInteger ]
                 ]
                ]
               
               [Node list symbol=cons symbol=x 
               
                [Node list symbol=:: symbol=i 
                
                 [Node list symbol=PositiveInteger ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943657 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=res ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943657 symbol=res 
      
       [Node list symbol=construct 
       
        [Node list symbol=Sel symbol=empty 
        
         [Node list symbol=List 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=repeatedIndex symbol=jv ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=m2r 
    
     [Node list symbol=multiIndex symbol=jv ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=class symbol=l ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=PositiveInteger ]
       ]
      
      [Node list symbol=One ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=l ]
      
      [Node list symbol=WHILE 
      
       [Node list symbol=zero? symbol=i ]
       ]
      
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=+ symbol=res 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=class symbol=jv ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943658 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=type symbol=jv ]
       
       [Node list symbol=:: string=Deriv 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943658 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=class 
       
        [Node list symbol=multiIndex symbol=jv ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=order symbol=jv ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943659 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=type symbol=jv ]
       
       [Node list symbol=:: string=Deriv 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943659 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=sum 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=multiIndex symbol=jv ]
          ]
         
         [Node list symbol=LET symbol=sum 
         
          [Node list symbol=+ symbol=sum symbol=i ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=sum ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimJ symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=* symbol=mm 
    
     [Node list symbol=:: 
     
      [Node list symbol=nn 
      
       [Node list symbol=Sel symbol=binomial 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=+ symbol=q symbol=nn ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimS symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=* symbol=mm 
    
     [Node list symbol=:: 
     
      [Node list 
      
       [Node list symbol=Sel symbol=binomial 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=- 
       
        [Node list symbol=+ symbol=q symbol=nn ]
        
        [Node list symbol=One ]
        ]
       
       [Node list symbol=- symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=X ]
    
    [Node list symbol=$ ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=X 
    
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=U ]
    
    [Node list symbol=$ ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=U 
    
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=lo ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=P symbol=lo 
    
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=up symbol=lo ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=Pm symbol=up 
    
     [Node list symbol=construct symbol=lo ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=lo ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=Pm 
    
     [Node list symbol=One ]
     
     [Node list symbol=construct symbol=lo ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=up symbol=lo ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol== 
     
      [Node list symbol=getNotation ]
      
      [Node list symbol=:: string=Multi 
      
       [Node list symbol=Symbol ]
       ]
      ]
     
     [Node list symbol=Pm symbol=up symbol=lo ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=empty 
      
       [Node list symbol=: symbol=lop 
       
        [Node list symbol=List 
        
         [Node list symbol=PositiveInteger ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=i symbol=lo ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4943660 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=i ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4943660 
         
          [Node list symbol=error string=Improper multi-index ]
          
          [Node list symbol=LET symbol=lop 
          
           [Node list symbol=cons symbol=lop 
           
            [Node list symbol=:: symbol=i 
            
             [Node list symbol=PositiveInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=Pr symbol=up 
       
        [Node list symbol=reverse! symbol=lop ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=Pr symbol=up symbol=lo ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=Pm symbol=up 
    
     [Node list symbol=r2m symbol=lo ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=jv ]
    
    [Node list symbol=$ 
    
     [Node list symbol=OutputForm ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: 
    
     [Node list symbol=name symbol=jv ]
     
     [Node list symbol=OutputForm ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=dimJV 
    
     [Node list symbol=Vector 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=new symbol=mm 
    
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=dimSV 
    
     [Node list symbol=Vector 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=new symbol=mm 
    
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mn 
    
     [Node list symbol=Integer ]
     ]
    
    [Node list symbol=minIndex symbol=dimJV ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimJ symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943661 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=< symbol=q 
      
       [Node list symbol=# symbol=dimJV ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943661 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=qelt symbol=dimJV 
         
          [Node list symbol=+ symbol=mn symbol=q ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=res 
         
          [Node list symbol=> symbol=res 
          
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=res 
           
            [Node list symbol=* symbol=mm 
            
             [Node list symbol=:: 
             
              [Node list symbol=nn 
              
               [Node list symbol=Sel symbol=binomial 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=+ symbol=q symbol=nn ]
               ]
              
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           
           [Node list symbol=qsetelt! symbol=dimJV symbol=res 
           
            [Node list symbol=+ symbol=mn symbol=q ]
            ]
           
           [Node list symbol=exit int=1 symbol=res ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=oldJV 
        
         [Node list symbol=copy symbol=dimJV ]
         ]
        
        [Node list symbol=LET symbol=dimJV 
        
         [Node list symbol=new 
         
          [Node list symbol=+ symbol=q 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=qq 
         
          [Node list symbol=SEGMENT symbol=mn 
          
           [Node list symbol=- 
           
            [Node list symbol=+ symbol=mn 
            
             [Node list symbol=# symbol=oldJV ]
             ]
            
            [Node list symbol=One ]
            ]
           ]
          ]
         
         [Node list symbol=qsetelt! symbol=dimJV symbol=qq 
         
          [Node list symbol=qelt symbol=oldJV symbol=qq ]
          ]
         ]
        
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=* symbol=mm 
         
          [Node list symbol=:: 
          
           [Node list symbol=nn 
           
            [Node list symbol=Sel symbol=binomial 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=+ symbol=q symbol=nn ]
            ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=qsetelt! symbol=dimJV symbol=res 
        
         [Node list symbol=+ symbol=mn symbol=q ]
         ]
        
        [Node list symbol=exit int=1 symbol=res ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimS symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943662 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=< symbol=q 
      
       [Node list symbol=# symbol=dimSV ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943662 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=qelt symbol=dimSV 
         
          [Node list symbol=+ symbol=mn symbol=q ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=res 
         
          [Node list symbol=> symbol=res 
          
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=res 
           
            [Node list symbol=* symbol=mm 
            
             [Node list symbol=:: 
             
              [Node list 
              
               [Node list symbol=Sel symbol=binomial 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=- 
               
                [Node list symbol=+ symbol=q symbol=nn ]
                
                [Node list symbol=One ]
                ]
               
               [Node list symbol=- symbol=nn 
               
                [Node list symbol=One ]
                ]
               ]
              
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           
           [Node list symbol=qsetelt! symbol=dimSV symbol=res 
           
            [Node list symbol=+ symbol=mn symbol=q ]
            ]
           
           [Node list symbol=exit int=1 symbol=res ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=oldSV 
        
         [Node list symbol=copy symbol=dimSV ]
         ]
        
        [Node list symbol=LET symbol=dimSV 
        
         [Node list symbol=new 
         
          [Node list symbol=+ symbol=q 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=qq 
         
          [Node list symbol=SEGMENT symbol=mn 
          
           [Node list symbol=- 
           
            [Node list symbol=+ symbol=mn 
            
             [Node list symbol=# symbol=oldSV ]
             ]
            
            [Node list symbol=One ]
            ]
           ]
          ]
         
         [Node list symbol=qsetelt! symbol=dimSV symbol=qq 
         
          [Node list symbol=qelt symbol=oldSV symbol=qq ]
          ]
         ]
        
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=* symbol=mm 
         
          [Node list symbol=:: 
          
           [Node list 
           
            [Node list symbol=Sel symbol=binomial 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=- 
            
             [Node list symbol=+ symbol=q symbol=nn ]
             
             [Node list symbol=One ]
             ]
            
            [Node list symbol=- symbol=nn 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=qsetelt! symbol=dimSV symbol=res 
        
         [Node list symbol=+ symbol=mn symbol=q ]
         ]
        
        [Node list symbol=exit int=1 symbol=res ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=differentiate symbol=jv symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Union symbol=$ string=0 ]
     
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=> symbol=i symbol=nn ]
     
     [Node list symbol=error string=Improper upper index ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=jt 
      
       [Node list symbol=type symbol=jv ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF string=0 
       
        [Node list symbol== symbol=jt 
        
         [Node list symbol=:: string=Const 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=jt 
         
          [Node list symbol=:: string=Indep 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4943663 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=i 
           
            [Node list symbol=index symbol=jv ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4943663 string=0 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol== 
          
           [Node list symbol=getNotation ]
           
           [Node list symbol=:: string=Multi 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=mind 
           
            [Node list symbol=multiIndex symbol=jv ]
            ]
           
           [Node list symbol=setelt! symbol=mind symbol=i 
           
            [Node list symbol=+ 
            
             [Node list symbol=elt symbol=mind 
             
              [Node list symbol=+ 
              
               [Node list symbol=- symbol=i 
               
                [Node list symbol=One ]
                ]
               
               [Node list symbol=minIndex symbol=mind ]
               ]
              ]
             
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=Pm symbol=mind 
            
             [Node list symbol=index symbol=jv ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=rind 
           
            [Node list symbol=repeatedIndex symbol=jv ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4943664 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=rind ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4943664 
            
             [Node list symbol=Pr 
             
              [Node list symbol=index symbol=jv ]
              
              [Node list symbol=construct symbol=i ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=empty 
              
               [Node list symbol=: symbol=nind 
               
                [Node list symbol=List 
                
                 [Node list symbol=PositiveInteger ]
                 ]
                ]
               ]
              
              [Node list symbol=REPEAT 
              
               [Node list symbol=WHILE 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G4943665 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=empty? symbol=rind ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G4943665 symbol=false symbol=true ]
                  ]
                 ]
                ]
               
               [Node list symbol=WHILE 
               
                [Node list symbol=> symbol=i 
                
                 [Node list symbol=first symbol=rind ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=nind 
                
                 [Node list symbol=cons symbol=nind 
                 
                  [Node list symbol=first symbol=rind ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=rind 
                 
                  [Node list symbol=rest symbol=rind ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=nind 
              
               [Node list symbol=concat! 
               
                [Node list symbol=reverse! symbol=nind ]
                
                [Node list symbol=cons symbol=i symbol=rind ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=Pr symbol=nind 
               
                [Node list symbol=index symbol=jv ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=derivativeOf? symbol=jv1 symbol=jv2 ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943666 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=type symbol=jv1 ]
       
       [Node list symbol=:: string=Deriv 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943666 symbol=empty 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=jt 
        
         [Node list symbol=type symbol=jv2 ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4943667 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=jt 
          
           [Node list symbol=:: string=Deriv 
           
            [Node list symbol=Symbol ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4943667 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4943668 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=~= symbol=jt 
             
              [Node list symbol=:: string=Dep 
              
               [Node list symbol=Symbol ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4943668 symbol=noBranch 
             
              [Node list symbol=exit int=3 symbol=empty ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4943669 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= 
         
          [Node list symbol=index symbol=jv1 ]
          
          [Node list symbol=index symbol=jv2 ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4943669 symbol=empty 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=res 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=i1 
            
             [Node list symbol=multiIndex symbol=jv1 ]
             ]
            
            [Node list symbol=IN symbol=i2 
            
             [Node list symbol=multiIndex symbol=jv2 ]
             ]
            
            [Node list symbol=IF 
            
             [Node list symbol=< symbol=i1 symbol=i2 ]
             
             [Node list symbol=return symbol=empty ]
             
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=cons symbol=res 
              
               [Node list symbol=:: 
               
                [Node list symbol=- symbol=i1 symbol=i2 ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=reverse! symbol=res ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integrateIfCan symbol=jv symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Union symbol=$ string=failed ]
     
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=> symbol=i symbol=nn ]
     
     [Node list symbol=error string=Improper upper index ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4943670 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=type symbol=jv ]
        
        [Node list symbol=:: string=Deriv 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4943670 string=failed 
       
        [Node list symbol=IF 
        
         [Node list symbol== 
         
          [Node list symbol=getNotation ]
          
          [Node list symbol=:: string=Multi 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=mind 
          
           [Node list symbol=multiIndex symbol=jv ]
           ]
          
          [Node list symbol=LET symbol=pos 
          
           [Node list symbol=+ 
           
            [Node list symbol=- symbol=i 
            
             [Node list symbol=One ]
             ]
            
            [Node list symbol=minIndex symbol=mind ]
            ]
           ]
          
          [Node list symbol=LET symbol=mi 
          
           [Node list symbol=qelt symbol=mind symbol=pos ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4943671 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=mi ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4943671 string=failed 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=setelt! symbol=mind symbol=pos 
             
              [Node list symbol=:: 
              
               [Node list symbol=- symbol=mi 
               
                [Node list symbol=One ]
                ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=Pm symbol=mind 
              
               [Node list symbol=index symbol=jv ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=rind 
          
           [Node list symbol=repeatedIndex symbol=jv ]
           ]
          
          [Node list symbol=LET symbol=pos 
          
           [Node list symbol=position symbol=i symbol=rind ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4943672 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=< symbol=pos 
           
            [Node list symbol=minIndex symbol=rind ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4943672 string=failed 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=rind 
             
              [Node list symbol=delete symbol=rind symbol=pos ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=Pr symbol=rind 
              
               [Node list symbol=index symbol=jv ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=integrate symbol=jv symbol=i ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=ji 
     
      [Node list symbol=integrateIfCan symbol=jv symbol=i ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=ji string=failed ]
       
       [Node list symbol=error string=Integration not possible ]
       
       [Node list symbol=:: symbol=ji symbol=$ ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=weight symbol=jv ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=t 
     
      [Node list symbol=type symbol=jv ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol== symbol=t 
       
        [Node list symbol=:: string=Const 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=Zero ]
       
       [Node list symbol=IF 
       
        [Node list symbol== symbol=t 
        
         [Node list symbol=:: string=Indep 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=index symbol=jv ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=t 
         
          [Node list symbol=:: string=Dep 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=* 
         
          [Node list symbol=+ symbol=nn 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=index symbol=jv ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=pos 
          
           [Node list symbol=+ symbol=nn 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=* symbol=pos 
           
            [Node list symbol=index symbol=jv ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=repeatedIndex symbol=jv ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=pos 
            
             [Node list symbol=* symbol=pos 
             
              [Node list symbol=+ symbol=nn 
              
               [Node list symbol=One ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=+ symbol=res 
              
               [Node list symbol=* symbol=i symbol=pos ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 symbol=res ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=one? symbol=jv ]
    
    [Node list symbol=$ 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol== 
    
     [Node list symbol=type symbol=jv ]
     
     [Node list symbol=:: string=Const 
     
      [Node list symbol=Symbol ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol== symbol=jv1 symbol=jv2 ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=t1 
     
      [Node list symbol=type symbol=jv1 ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol== symbol=t1 
       
        [Node list symbol=:: string=Const 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol== 
       
        [Node list symbol=type symbol=jv2 ]
        
        [Node list symbol=:: string=Const 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=IF 
       
        [Node list symbol== symbol=t1 
        
         [Node list symbol=:: string=Indep 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4943673 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol== 
          
           [Node list symbol=type symbol=jv2 ]
           
           [Node list symbol=:: string=Indep 
           
            [Node list symbol=Symbol ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4943673 symbol=false 
          
           [Node list symbol== 
           
            [Node list symbol=index symbol=jv1 ]
            
            [Node list symbol=index symbol=jv2 ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4943674 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol== 
          
           [Node list symbol=index symbol=jv1 ]
           
           [Node list symbol=index symbol=jv2 ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4943674 symbol=false 
          
           [Node list symbol== 
           
            [Node list symbol=multiIndex symbol=jv1 ]
            
            [Node list symbol=multiIndex symbol=jv2 ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=< symbol=jv1 symbol=jv2 ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=t1 
     
      [Node list symbol=type symbol=jv1 ]
      ]
     
     [Node list symbol=LET symbol=t2 
     
      [Node list symbol=type symbol=jv2 ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=false 
      
       [Node list symbol== symbol=t2 
       
        [Node list symbol=:: string=Const 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=IF symbol=true 
       
        [Node list symbol== symbol=t1 
        
         [Node list symbol=:: string=Const 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=t1 
         
          [Node list symbol=:: string=Indep 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=IF symbol=true 
         
          [Node list symbol== symbol=t2 
          
           [Node list symbol=:: string=Indep 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=< 
          
           [Node list symbol=index symbol=jv1 ]
           
           [Node list symbol=index symbol=jv2 ]
           ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol== symbol=t1 
          
           [Node list symbol=:: string=Dep 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=IF symbol=false 
          
           [Node list symbol== symbol=t2 
           
            [Node list symbol=:: string=Indep 
            
             [Node list symbol=Symbol ]
             ]
            ]
           
           [Node list symbol=IF symbol=true 
           
            [Node list symbol== symbol=t2 
            
             [Node list symbol=:: string=Dep 
             
              [Node list symbol=Symbol ]
              ]
             ]
            
            [Node list symbol=< 
            
             [Node list symbol=index symbol=jv1 ]
             
             [Node list symbol=index symbol=jv2 ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=IF 
           
            [Node list symbol== symbol=t2 
            
             [Node list symbol=:: string=Indep 
             
              [Node list symbol=Symbol ]
              ]
             ]
            
            [Node list symbol=exit int=1 symbol=false ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=t2 
             
              [Node list symbol=:: string=Dep 
              
               [Node list symbol=Symbol ]
               ]
              ]
             
             [Node list symbol=exit int=1 symbol=false ]
             ]
            ]
           
           [Node list symbol=LET symbol=o1 
           
            [Node list symbol=order symbol=jv1 ]
            ]
           
           [Node list symbol=LET symbol=o2 
           
            [Node list symbol=order symbol=jv2 ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF 
            
             [Node list symbol== symbol=o1 symbol=o2 ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=REPEAT 
              
               [Node list symbol=IN symbol=i1 
               
                [Node list symbol=multiIndex symbol=jv1 ]
                ]
               
               [Node list symbol=IN symbol=i2 
               
                [Node list symbol=multiIndex symbol=jv2 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G4943675 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=~= symbol=i1 symbol=i2 ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G4943675 symbol=noBranch 
                 
                  [Node list symbol=return 
                  
                   [Node list symbol=> symbol=i1 symbol=i2 ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=< 
               
                [Node list symbol=index symbol=jv1 ]
                
                [Node list symbol=index symbol=jv2 ]
                ]
               ]
              ]
             
             [Node list symbol=< symbol=o1 symbol=o2 ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=> symbol=jv1 symbol=jv2 ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=< symbol=jv2 symbol=jv1 ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=variables symbol=q ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943676 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=q ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943676 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=INBY symbol=i 
        
         [Node list symbol=SEGMENT symbol=nn 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=X 
        
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=OIndList 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT symbol=nn 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=construct 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=IndList 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=INBY symbol=i 
          
           [Node list symbol=SEGMENT symbol=nn 
           
            [Node list symbol=One ]
            ]
           
           [Node list symbol=- 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=construct 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=qq 
         
          [Node list symbol=SEGMENT int=2 symbol=q ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=NIndList 
           
            [Node list symbol=List 
            
             [Node list symbol=List 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=ind symbol=OIndList ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=j 
            
             [Node list symbol=SEGMENT symbol=nn 
             
              [Node list symbol=first symbol=ind ]
              ]
             ]
            
            [Node list symbol=LET symbol=NIndList 
            
             [Node list symbol=cons symbol=NIndList 
             
              [Node list symbol=cons symbol=ind 
              
               [Node list symbol=:: symbol=j 
               
                [Node list symbol=PositiveInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=OIndList 
          
           [Node list symbol=reverse symbol=NIndList ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=IndList 
           
            [Node list symbol=concat! symbol=NIndList symbol=IndList ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=JV 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=ind symbol=IndList ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=k 
          
           [Node list symbol=SEGMENT symbol=mm 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=LET symbol=JV 
          
           [Node list symbol=cons symbol=JV 
           
            [Node list symbol=Pr symbol=ind 
            
             [Node list symbol=:: symbol=k 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=concat! symbol=JV 
         
          [Node list symbol=concat! 
          
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=i 
            
             [Node list symbol=SEGMENT symbol=nn 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=X 
            
             [Node list symbol=:: symbol=i 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=i 
            
             [Node list symbol=SEGMENT symbol=mm 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=U 
            
             [Node list symbol=:: symbol=i 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=variables symbol=q symbol=c ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4943677 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=q ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4943677 symbol=empty 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=OIndList 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT symbol=c symbol=nn ]
           ]
          
          [Node list symbol=construct 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=qq 
         
          [Node list symbol=SEGMENT int=2 symbol=q ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=NIndList 
           
            [Node list symbol=List 
            
             [Node list symbol=List 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=ind symbol=OIndList ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=j 
            
             [Node list symbol=SEGMENT symbol=nn 
             
              [Node list symbol=first symbol=ind ]
              ]
             ]
            
            [Node list symbol=LET symbol=NIndList 
            
             [Node list symbol=cons symbol=NIndList 
             
              [Node list symbol=cons symbol=ind 
              
               [Node list symbol=:: symbol=j 
               
                [Node list symbol=PositiveInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=OIndList 
           
            [Node list symbol=reverse! symbol=NIndList ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=JV 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=ind symbol=OIndList ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=k 
          
           [Node list symbol=SEGMENT symbol=mm 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=LET symbol=JV 
          
           [Node list symbol=cons symbol=JV 
           
            [Node list symbol=Pr symbol=ind 
            
             [Node list symbol=:: symbol=k 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=JV ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF JetBundleFunctionCategory JB add
 DEFSubnode:atts= Category
  [Node list symbol=Category ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=PartialDifferentialRing 
   
    [Node list symbol=Symbol ]
    ]
   
   [Node list symbol=GcdDomain ]
   
   [Node list symbol=RetractableTo symbol=JB ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=X 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=U 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=X 
    
     [Node list symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=U 
    
     [Node list symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=P 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=setNotation 
    
     [Node list 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=getNotation 
    
     [Node list 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=numIndVar 
    
     [Node list 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=numDepVar 
    
     [Node list 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ symbol=JB ]
     ]
    
    [Node list symbol=SIGNATURE symbol=jetVariables 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=const? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=order 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=class 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=numerator 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=denominator 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=jacobiMatrix 
    
     [Node list 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=jacobiMatrix 
    
     [Node list 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=extractSymbol 
    
     [Node list 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=symbol 
    
     [Node list 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=differentiate 
    
     [Node list symbol=$ symbol=$ symbol=JB ]
     ]
    
    [Node list symbol=SIGNATURE symbol=formalDiff 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=formalDiff 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=formalDiff 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=formalDiff2 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=DPhi symbol=$ ]
       
       [Node list symbol=: symbol=JVars 
       
        [Node list symbol=List symbol=JB ]
        ]
       ]
      
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=formalDiff2 
    
     [Node list 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=DSys 
       
        [Node list symbol=List symbol=$ ]
        ]
       
       [Node list symbol=: symbol=JVars 
       
        [Node list symbol=List 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dimension 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=orderDim 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=freeOf? 
    
     [Node list symbol=$ symbol=JB 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=subst 
    
     [Node list symbol=$ symbol=$ symbol=JB symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=leadingDer 
    
     [Node list symbol=JB symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=sortLD 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=solveFor 
    
     [Node list symbol=$ symbol=JB 
     
      [Node list symbol=Union symbol=$ string=failed ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dSubst 
    
     [Node list symbol=$ symbol=$ symbol=JB symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=simplify 
    
     [Node list 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Sys 
       
        [Node list symbol=List symbol=$ ]
        ]
       
       [Node list symbol=: symbol=JM 
       
        [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=Union string=failed 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=simpOne 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=simpMod 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=simpMod 
    
     [Node list 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Sys 
       
        [Node list symbol=List symbol=$ ]
        ]
       
       [Node list symbol=: symbol=JM 
       
        [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=Union string=failed 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=reduceMod 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=autoReduce 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=import 
   
    [Node list symbol=List symbol=$ ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=List symbol=JB ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=List 
    
     [Node list symbol=List symbol=JB ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numIndVar ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=X symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list symbol=i 
     
      [Node list symbol=Sel symbol=JB symbol=X ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=U symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list symbol=i 
     
      [Node list symbol=Sel symbol=JB symbol=U ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=i symbol=l ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list symbol=i symbol=l 
     
      [Node list symbol=Sel symbol=JB symbol=P ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=X ]
    
    [Node list symbol=$ ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list 
     
      [Node list symbol=Sel symbol=JB symbol=X ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=U ]
    
    [Node list symbol=$ ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list 
     
      [Node list symbol=Sel symbol=JB symbol=U ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=l ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list symbol=l 
     
      [Node list symbol=Sel symbol=JB symbol=P ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=i symbol=l ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list symbol=i symbol=l 
     
      [Node list symbol=Sel symbol=JB symbol=P ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list symbol=i 
     
      [Node list symbol=Sel symbol=JB symbol=P ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=setNotation symbol=s ]
    
    [Node list 
    
     [Node list symbol=Void ]
     
     [Node list symbol=Symbol ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=s 
    
     [Node list symbol=Sel symbol=JB symbol=setNotation ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=getNotation ]
    
    [Node list 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=getNotation ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=numIndVar ]
    
    [Node list 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numIndVar ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=numDepVar ]
    
    [Node list 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numDepVar ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=gcd symbol=f1 symbol=f2 ]
    
    [Node list symbol=$ symbol=$ symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=One ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=retractIfCan symbol=f ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Union symbol=JB string=failed ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=JV 
     
      [Node list symbol=jetVariables symbol=f ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949540 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=one? 
      
       [Node list symbol=# symbol=JV ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949540 string=failed 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=jv 
        
         [Node list symbol=first symbol=JV ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949539 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=one? 
         
          [Node list symbol=differentiate symbol=f symbol=jv ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949539 symbol=jv string=failed ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=const? symbol=Phi ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=JV 
     
      [Node list symbol=jetVariables symbol=Phi ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949541 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=JV ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949541 symbol=true 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949542 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=> 
         
          [Node list symbol=# symbol=JV ]
          
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949542 symbol=false 
         
          [Node list symbol== 
          
           [Node list symbol=first symbol=JV ]
           
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=order symbol=Phi ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=order 
    
     [Node list symbol=leadingDer symbol=Phi ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=class symbol=Phi ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=class 
    
     [Node list symbol=leadingDer symbol=Phi ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=leadingDer symbol=fun ]
    
    [Node list symbol=JB symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=JV 
     
      [Node list symbol=jetVariables symbol=fun ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949543 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=JV ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949543 
      
       [Node list symbol=One ]
       
       [Node list symbol=first symbol=JV ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=freeOf? symbol=fun symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949544 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=member? symbol=jv 
      
       [Node list symbol=jetVariables symbol=fun ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949544 symbol=false symbol=true ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=characteristic ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=Zero ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dSubst symbol=f symbol=jv symbol=exp ]
    
    [Node list symbol=$ symbol=$ symbol=JB symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=of symbol=$ ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET symbol=f 
     
      [Node list symbol=: symbol=nf symbol=$ ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=WHILE 
      
       [Node list symbol=~= symbol=nf symbol=of ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=of symbol=nf ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=JVar 
        
         [Node list symbol=List symbol=JB ]
         ]
        
        [Node list symbol=jetVariables symbol=of ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=jvar symbol=JVar ]
         
         [Node list symbol=UNTIL 
         
          [Node list symbol=< symbol=jvar symbol=jv ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=d 
          
           [Node list symbol=derivativeOf? symbol=jvar symbol=jv ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4949545 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=d ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4949545 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=dexp 
             
              [Node list symbol=formalDiff symbol=exp symbol=d ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=nf 
              
               [Node list symbol=subst symbol=nf symbol=jvar symbol=dexp ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=nf ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimension symbol=sys symbol=jm symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: 
    
     [Node list symbol=- 
     
      [Node list symbol=q 
      
       [Node list symbol=Sel symbol=JB symbol=dimJ ]
       ]
      
      [Node list symbol=# symbol=sys ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=orderDim symbol=sys symbol=jm symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: 
    
     [Node list symbol=- 
     
      [Node list symbol=q 
      
       [Node list symbol=Sel symbol=JB symbol=dimS ]
       ]
      
      [Node list symbol=# symbol=sys ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=noChecks? 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list symbol=has symbol=$ 
    
     [Node list symbol=lazyRepresentation ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=jacobiMatrix symbol=funs ]
    
    [Node list 
    
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=jacobiMatrix symbol=funs 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=fun symbol=funs ]
      
      [Node list symbol=jetVariables symbol=fun ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=jacobiMatrix symbol=funs symbol=varlist ]
    
    [Node list 
    
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=JvList 
     
      [Node list symbol=first symbol=varlist ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=vars 
      
       [Node list symbol=rest symbol=varlist ]
       ]
      
      [Node list symbol=LET symbol=JvList 
      
       [Node list symbol=removeDuplicates! 
       
        [Node list symbol=merge string=> symbol=JvList symbol=vars ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=JM 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
       ]
      
      [Node list symbol=new symbol=JvList 
      
       [Node list symbol=# symbol=funs ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=f symbol=funs ]
      
      [Node list symbol=IN symbol=vars symbol=varlist ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=ents 
        
         [Node list symbol=List symbol=$ ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=inds 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=jv symbol=vars ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=df 
         
          [Node list symbol=differentiate symbol=f symbol=jv ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=noChecks? 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=ents 
            
             [Node list symbol=cons symbol=df symbol=ents ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=inds 
             
              [Node list symbol=cons symbol=jv symbol=inds ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4949546 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=zero? symbol=df ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4949546 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=ents 
               
                [Node list symbol=cons symbol=df symbol=ents ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=inds 
                
                 [Node list symbol=cons symbol=jv symbol=inds ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=setRow! symbol=JM symbol=i 
        
         [Node list symbol=reverse! symbol=inds ]
         
         [Node list symbol=reverse! symbol=ents ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=JM ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=symbol symbol=funs ]
    
    [Node list 
    
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=JVL 
      
       [Node list symbol=List 
       
        [Node list symbol=List symbol=JB ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=fun symbol=funs ]
       
       [Node list symbol=jetVariables symbol=fun ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ol 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=jl symbol=JVL ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=JB symbol=order ]
        
        [Node list symbol=first symbol=jl ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=ord 
     
      [Node list symbol=reduce symbol=max symbol=ol 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=oJV 
      
       [Node list symbol=List 
       
        [Node list symbol=List symbol=JB ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=allJV 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=jl symbol=JVL ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=ojl 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4949547 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=jl ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4949547 symbol=false 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4949548 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=< symbol=ord 
              
               [Node list 
               
                [Node list symbol=Sel symbol=JB symbol=order ]
                
                [Node list symbol=first symbol=jl ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4949548 symbol=false symbol=true ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=ojl 
         
          [Node list symbol=cons symbol=ojl 
          
           [Node list symbol=first symbol=jl ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=jl 
          
           [Node list symbol=rest symbol=jl ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=ojl 
       
        [Node list symbol=reverse! symbol=ojl ]
        ]
       
       [Node list symbol=LET symbol=oJV 
       
        [Node list symbol=cons symbol=ojl symbol=oJV ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=allJV 
        
         [Node list symbol=removeDuplicates! 
         
          [Node list symbol=merge string=> symbol=allJV symbol=ojl ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=oJV 
     
      [Node list symbol=reverse! symbol=oJV ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=symb 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
       ]
      
      [Node list symbol=new symbol=allJV 
      
       [Node list symbol=# symbol=funs ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=f symbol=funs ]
      
      [Node list symbol=IN symbol=ojl symbol=oJV ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=ents 
        
         [Node list symbol=List symbol=$ ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=inds 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=jv symbol=ojl ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=df 
         
          [Node list symbol=differentiate symbol=f symbol=jv ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=noChecks? 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=ents 
            
             [Node list symbol=cons symbol=df symbol=ents ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=inds 
             
              [Node list symbol=cons symbol=jv symbol=inds ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4949549 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=zero? symbol=df ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4949549 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=ents 
               
                [Node list symbol=cons symbol=df symbol=ents ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=inds 
                
                 [Node list symbol=cons symbol=jv symbol=inds ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=setRow! symbol=symb symbol=i 
        
         [Node list symbol=reverse! symbol=inds ]
         
         [Node list symbol=reverse! symbol=ents ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=symb ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=extractSymbol symbol=jm ]
    
    [Node list 
    
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=allIndices symbol=jm ]
      ]
     
     [Node list symbol=LET symbol=o 
     
      [Node list symbol=order 
      
       [Node list symbol=first symbol=inds ]
       ]
      ]
     
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=rest symbol=inds ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=WHILE 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949550 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? symbol=inds ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949550 symbol=false 
         
          [Node list symbol== symbol=o 
          
           [Node list symbol=order 
           
            [Node list symbol=first symbol=inds ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=inds 
      
       [Node list symbol=rest symbol=inds ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949551 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=inds ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949551 symbol=jm 
      
       [Node list symbol=Left 
       
        [Node list symbol=horizSplit symbol=jm 
        
         [Node list symbol=first symbol=inds ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=formalDiff symbol=Sys symbol=i ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=JM 
     
      [Node list symbol=jacobiMatrix symbol=Sys ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DSys 
      
       [Node list symbol=formalDiff2 symbol=Sys symbol=i symbol=JM ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=formalDiff symbol=Eq symbol=i ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=first 
    
     [Node list symbol=formalDiff symbol=i 
     
      [Node list symbol=construct symbol=Eq ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=formalDiff symbol=f symbol=mu ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=JV 
      
       [Node list symbol=List symbol=JB ]
       ]
      
      [Node list symbol=jetVariables symbol=f ]
      ]
     
     [Node list symbol=LET symbol=df symbol=f ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=IN symbol=j symbol=mu ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=k 
       
        [Node list symbol=SEGMENT symbol=j 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=jm 
        
         [Node list symbol=jacobiMatrix 
         
          [Node list symbol=construct symbol=df ]
          
          [Node list symbol=construct symbol=JV ]
          ]
         ]
        
        [Node list symbol=LET symbol=tmp 
        
         [Node list symbol=formalDiff2 symbol=df symbol=jm 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=PositiveInteger ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=df 
        
         [Node list symbol=tmp symbol=DPhi ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=JV 
         
          [Node list symbol=tmp symbol=JVars ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=df ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=formalDiff2 symbol=Sys symbol=i symbol=JM ]
    
    [Node list 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=DSys 
      
       [Node list symbol=List symbol=$ ]
       ]
      
      [Node list symbol=: symbol=JVars 
      
       [Node list symbol=List 
       
        [Node list symbol=List symbol=JB ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=allIndices symbol=JM ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949552 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=inds ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949552 
      
       [Node list symbol=construct 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=eq symbol=Sys ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=COLLECT symbol=empty 
        
         [Node list symbol=IN symbol=eq symbol=Sys ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=LRes 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=LJV 
         
          [Node list symbol=List 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=l 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           
           [Node list symbol=nrows symbol=JM ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=r 
          
           [Node list symbol=row symbol=JM symbol=l ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=res symbol=$ ]
           
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=JV 
           
            [Node list symbol=List symbol=JB ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=df 
           
            [Node list symbol=reverse 
            
             [Node list symbol=r symbol=Entries ]
             ]
            ]
           
           [Node list symbol=IN symbol=jv 
           
            [Node list symbol=reverse 
            
             [Node list symbol=r symbol=Indices ]
             ]
            ]
           
           [Node list symbol=IF symbol=noChecks? 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=djv 
             
              [Node list symbol=differentiate symbol=jv symbol=i ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF 
              
               [Node list symbol=case symbol=djv string=0 ]
               
               [Node list symbol=LET symbol=JV 
               
                [Node list symbol=cons symbol=jv symbol=JV ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=djv 
                
                 [Node list symbol=One ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=res 
                 
                  [Node list symbol=+ symbol=res symbol=df ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=JV 
                  
                   [Node list symbol=cons symbol=jv symbol=JV ]
                   ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=res 
                 
                  [Node list symbol=+ symbol=res 
                  
                   [Node list symbol=* symbol=df 
                   
                    [Node list symbol=:: symbol=$ 
                    
                     [Node list symbol=:: symbol=djv symbol=JB ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=JV 
                  
                   [Node list symbol=cons symbol=djv 
                   
                    [Node list symbol=cons symbol=jv symbol=JV ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4949553 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=zero? symbol=df ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4949553 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=djv 
                
                 [Node list symbol=differentiate symbol=jv symbol=i ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF 
                 
                  [Node list symbol=case symbol=djv string=0 ]
                  
                  [Node list symbol=LET symbol=JV 
                  
                   [Node list symbol=cons symbol=jv symbol=JV ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=djv 
                   
                    [Node list symbol=One ]
                    ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=res 
                    
                     [Node list symbol=+ symbol=res symbol=df ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=JV 
                     
                      [Node list symbol=cons symbol=jv symbol=JV ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=res 
                    
                     [Node list symbol=+ symbol=res 
                     
                      [Node list symbol=* symbol=df 
                      
                       [Node list symbol=:: symbol=$ 
                       
                        [Node list symbol=:: symbol=djv symbol=JB ]
                        ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=JV 
                     
                      [Node list symbol=cons symbol=djv 
                      
                       [Node list symbol=cons symbol=jv symbol=JV ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=LRes 
          
           [Node list symbol=cons symbol=res symbol=LRes ]
           ]
          
          [Node list symbol=LET symbol=JV 
          
           [Node list symbol=sort! string=> 
           
            [Node list symbol=removeDuplicates! symbol=JV ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=LJV 
           
            [Node list symbol=cons symbol=JV symbol=LJV ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=construct 
         
          [Node list symbol=reverse! symbol=LRes ]
          
          [Node list symbol=reverse! symbol=LJV ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=formalDiff2 symbol=Eq symbol=i symbol=JM ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=DPhi symbol=$ ]
      
      [Node list symbol=: symbol=JVars 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=tmp 
     
      [Node list symbol=formalDiff2 symbol=i symbol=JM 
      
       [Node list symbol=construct symbol=Eq ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct 
      
       [Node list symbol=first 
       
        [Node list symbol=tmp symbol=DSys ]
        ]
       
       [Node list symbol=first 
       
        [Node list symbol=tmp symbol=JVars ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=greater symbol=r1 symbol=r2 ]
    
    [Node list 
    
     [Node list symbol=Boolean ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=LD symbol=JB ]
      
      [Node list symbol=: symbol=Fake? 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=: symbol=Dep 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=: symbol=Fun symbol=$ ]
      ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=LD symbol=JB ]
      
      [Node list symbol=: symbol=Fake? 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=: symbol=Dep 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=: symbol=Fun symbol=$ ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=> 
    
     [Node list symbol=r1 symbol=LD ]
     
     [Node list symbol=r2 symbol=LD ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=sortLD symbol=sys ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=sl 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=LD symbol=JB ]
         
         [Node list symbol=: symbol=Fake? 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=: symbol=Dep 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=Fun symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=f symbol=sys ]
       
       [Node list symbol=construct symbol=false symbol=f 
       
        [Node list symbol=leadingDer symbol=f ]
        
        [Node list symbol=construct 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=sl 
     
      [Node list symbol=sort! symbol=greater symbol=sl ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=l symbol=sl ]
       
       [Node list symbol=l symbol=Fun ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpLD symbol=l ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=LD symbol=JB ]
       
       [Node list symbol=: symbol=Fake? 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=: symbol=Dep 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=: symbol=Fun symbol=$ ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=LD symbol=JB ]
       
       [Node list symbol=: symbol=Fake? 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=: symbol=Dep 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=: symbol=Fun symbol=$ ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949554 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=< int=2 
      
       [Node list symbol=# symbol=l ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949554 symbol=l 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=cur 
        
         [Node list symbol=first symbol=l ]
         ]
        
        [Node list symbol=LET symbol=l 
        
         [Node list symbol=rest symbol=l ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949555 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= 
         
          [Node list symbol=cur symbol=LD ]
          
          [Node list symbol=LD 
          
           [Node list symbol=first symbol=l ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949555 
         
          [Node list symbol=cons symbol=cur 
          
           [Node list symbol=simpLD symbol=l ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=eqLD 
            
             [Node list symbol=List 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=LD symbol=JB ]
               
               [Node list symbol=: symbol=Fake? 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=: symbol=Dep 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               
               [Node list symbol=: symbol=Fun symbol=$ ]
               ]
              ]
             ]
            
            [Node list symbol=construct symbol=cur ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=WHILE 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4949556 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=l ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4949556 symbol=false 
               
                [Node list symbol== 
                
                 [Node list symbol=cur symbol=LD ]
                 
                 [Node list symbol=LD 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=fl 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=LD symbol=JB ]
                     
                     [Node list symbol=: symbol=Fake? 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=: symbol=Dep 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     
                     [Node list symbol=: symbol=Fun symbol=$ ]
                     ]
                    ]
                   
                   [Node list symbol=first symbol=l ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4949557 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=fl symbol=Fake? ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4949557 
              
               [Node list symbol=error string=cannot simplify ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=eqLD 
                
                 [Node list symbol=cons symbol=fl symbol=eqLD ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=l 
                 
                  [Node list symbol=rest symbol=l ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=false 
           
            [Node list symbol=: symbol=solvable? 
            
             [Node list symbol=Boolean ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=eq symbol=eqLD ]
            
            [Node list symbol=UNTIL symbol=solvable? ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=s 
             
              [Node list symbol=solveFor 
              
               [Node list symbol=eq symbol=Fun ]
               
               [Node list symbol=cur symbol=LD ]
               ]
              ]
             
             [Node list symbol=LET symbol=solvable? 
             
              [Node list symbol=case symbol=s symbol=$ ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=seq symbol=eq ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=newL 
            
             [Node list symbol=List 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=LD symbol=JB ]
               
               [Node list symbol=: symbol=Fake? 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=: symbol=Dep 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               
               [Node list symbol=: symbol=Fun symbol=$ ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=IF symbol=solvable? 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=IN symbol=eq symbol=eqLD ]
             
             [Node list symbol=| 
             
              [Node list symbol=~= symbol=eq symbol=seq ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=neweq 
              
               [Node list symbol=simpOne 
               
                [Node list symbol=subst 
                
                 [Node list symbol=eq symbol=Fun ]
                 
                 [Node list symbol=cur symbol=LD ]
                 
                 [Node list symbol=:: symbol=s symbol=$ ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4949558 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=zero? symbol=neweq ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4949558 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=newld 
                 
                  [Node list symbol=leadingDer symbol=neweq ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newL 
                  
                   [Node list symbol=merge symbol=greater symbol=newL 
                   
                    [Node list symbol=construct 
                    
                     [Node list symbol=newld symbol=false symbol=neweq 
                     
                      [Node list symbol=Sel symbol=construct 
                      
                       [Node list symbol=Record 
                       
                        [Node list symbol=: symbol=LD symbol=JB ]
                        
                        [Node list symbol=: symbol=Fake? 
                        
                         [Node list symbol=Boolean ]
                         ]
                        
                        [Node list symbol=: symbol=Dep 
                        
                         [Node list symbol=List 
                         
                          [Node list symbol=NonNegativeInteger ]
                          ]
                         ]
                        
                        [Node list symbol=: symbol=Fun symbol=$ ]
                        ]
                       ]
                      
                      [Node list symbol=append 
                      
                       [Node list symbol=eq symbol=Dep ]
                       
                       [Node list symbol=seq symbol=Dep ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=seq 
             
              [Node list symbol=first symbol=eqLD ]
              ]
             
             [Node list symbol=LET symbol=sj 
             
              [Node list symbol=jetVariables 
              
               [Node list symbol=seq symbol=Fun ]
               ]
              ]
             
             [Node list symbol=LET symbol=minlen 
             
              [Node list symbol=# symbol=sj ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=lJV 
              
               [Node list symbol=List 
               
                [Node list symbol=List symbol=JB ]
                ]
               ]
              
              [Node list symbol=construct symbol=sj ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=eq 
              
               [Node list symbol=rest symbol=eqLD ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=JV 
               
                [Node list symbol=jetVariables 
                
                 [Node list symbol=eq symbol=Fun ]
                 ]
                ]
               
               [Node list symbol=LET symbol=len 
               
                [Node list symbol=# symbol=JV ]
                ]
               
               [Node list symbol=LET symbol=lJV 
               
                [Node list symbol=cons symbol=JV symbol=lJV ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=noBranch 
                
                 [Node list symbol=< symbol=len symbol=minlen ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=seq symbol=eq ]
                  
                  [Node list symbol=LET symbol=sj symbol=JV ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=minlen symbol=len ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=lJV 
             
              [Node list symbol=reverse! symbol=lJV ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4949560 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=one? symbol=minlen ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4949560 
              
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=eq symbol=eqLD ]
                
                [Node list symbol=IN symbol=JV symbol=lJV ]
                
                [Node list symbol=| 
                
                 [Node list symbol=~= symbol=eq symbol=seq ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G4949559 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=one? 
                  
                   [Node list symbol=# symbol=JV ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G4949559 
                  
                   [Node list symbol=error string=cannot simplify ]
                   
                   [Node list symbol=LET symbol=newL 
                   
                    [Node list symbol=merge symbol=greater symbol=newL 
                    
                     [Node list symbol=construct 
                     
                      [Node list symbol=true 
                      
                       [Node list symbol=Sel symbol=construct 
                       
                        [Node list symbol=Record 
                        
                         [Node list symbol=: symbol=LD symbol=JB ]
                         
                         [Node list symbol=: symbol=Fake? 
                         
                          [Node list symbol=Boolean ]
                          ]
                         
                         [Node list symbol=: symbol=Dep 
                         
                          [Node list symbol=List 
                          
                           [Node list symbol=NonNegativeInteger ]
                           ]
                          ]
                         
                         [Node list symbol=: symbol=Fun symbol=$ ]
                         ]
                        ]
                       
                       [Node list symbol=second symbol=JV ]
                       
                       [Node list symbol=eq symbol=Dep ]
                       
                       [Node list symbol=eq symbol=Fun ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=sjv 
                
                 [Node list symbol=second symbol=sj ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=REPEAT 
                 
                  [Node list symbol=IN symbol=eq symbol=eqLD ]
                  
                  [Node list symbol=IN symbol=JV symbol=lJV ]
                  
                  [Node list symbol=| 
                  
                   [Node list symbol=~= symbol=eq symbol=seq ]
                   ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET symbol=newld 
                   
                    [Node list symbol=max symbol=sjv 
                    
                     [Node list symbol=second symbol=JV ]
                     ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=LET symbol=newL 
                    
                     [Node list symbol=merge symbol=greater symbol=newL 
                     
                      [Node list symbol=construct 
                      
                       [Node list symbol=newld symbol=true 
                       
                        [Node list symbol=Sel symbol=construct 
                        
                         [Node list symbol=Record 
                         
                          [Node list symbol=: symbol=LD symbol=JB ]
                          
                          [Node list symbol=: symbol=Fake? 
                          
                           [Node list symbol=Boolean ]
                           ]
                          
                          [Node list symbol=: symbol=Dep 
                          
                           [Node list symbol=List 
                           
                            [Node list symbol=NonNegativeInteger ]
                            ]
                           ]
                          
                          [Node list symbol=: symbol=Fun symbol=$ ]
                          ]
                         ]
                        
                        [Node list symbol=eq symbol=Dep ]
                        
                        [Node list symbol=eq symbol=Fun ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=cons symbol=seq 
            
             [Node list symbol=simpLD 
             
              [Node list symbol=merge symbol=greater symbol=l symbol=newL ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simplify symbol=sys symbol=jm ]
    
    [Node list 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Sys 
      
       [Node list symbol=List symbol=$ ]
       ]
      
      [Node list symbol=: symbol=JM 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
       ]
      
      [Node list symbol=: symbol=Depend 
      
       [Node list symbol=Union string=failed 
       
        [Node list symbol=List 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=newSys 
      
       [Node list symbol=List symbol=$ ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq symbol=sys ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=neq 
       
        [Node list symbol=simpOne symbol=eq ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949561 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= symbol=neq symbol=eq ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949561 symbol=noBranch 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=jmi 
           
            [Node list symbol=jacobiMatrix 
            
             [Node list symbol=construct symbol=neq ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=setRow! symbol=jm symbol=i 
            
             [Node list symbol=row symbol=jmi 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=newSys 
        
         [Node list symbol=cons symbol=neq symbol=newSys ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=newSys 
     
      [Node list symbol=reverse! symbol=newSys ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=sl 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=LD symbol=JB ]
         
         [Node list symbol=: symbol=Fake? 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=: symbol=Dep 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=Fun symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=f symbol=newSys ]
       
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=construct symbol=false symbol=f 
       
        [Node list symbol=first 
        
         [Node list symbol=Indices 
         
          [Node list symbol=row symbol=jm symbol=i ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=sl 
     
      [Node list symbol=simpLD 
      
       [Node list symbol=sort! symbol=greater symbol=sl ]
       ]
      ]
     
     [Node list symbol=LET symbol=resSys 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=l symbol=sl ]
       
       [Node list symbol=l symbol=Fun ]
       ]
      ]
     
     [Node list symbol=LET symbol=resDep 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=l symbol=sl ]
       
       [Node list symbol=l symbol=Dep ]
       ]
      ]
     
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=allIndices symbol=jm ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=resJM 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
       ]
      
      [Node list symbol=new symbol=inds 
      
       [Node list symbol=# symbol=sl ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq symbol=resSys ]
      
      [Node list symbol=IN symbol=dep symbol=resDep ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949562 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=one? 
         
          [Node list symbol=# symbol=dep ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949562 
         
          [Node list symbol=LET symbol=r 
          
           [Node list symbol=row symbol=jm 
           
            [Node list symbol=first symbol=dep ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=tmp 
           
            [Node list symbol=jacobiMatrix 
            
             [Node list symbol=construct symbol=eq ]
             
             [Node list symbol=construct symbol=inds ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=r 
            
             [Node list symbol=row symbol=tmp 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=setRow! symbol=resJM symbol=i symbol=r ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct symbol=resSys symbol=resJM symbol=resDep ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpOne symbol=f ]
    
    [Node list symbol=$ symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=numerator symbol=f ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpMod symbol=sys1 symbol=sys2 ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4949563 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=sys1 ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4949563 
       
        [Node list symbol=exit int=2 symbol=sys1 ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4949564 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=sys2 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4949564 symbol=noBranch 
          
           [Node list symbol=exit int=3 symbol=sys1 ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=LD 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=LS 
      
       [Node list symbol=List symbol=$ ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq2 symbol=sys2 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ld 
       
        [Node list symbol=leadingDer symbol=eq2 ]
        ]
       
       [Node list symbol=LET symbol=ls 
       
        [Node list symbol=solveFor symbol=eq2 symbol=ld ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol=case symbol=ls symbol=$ ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=i 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=jv symbol=LD ]
           
           [Node list symbol=WHILE 
           
            [Node list symbol=> symbol=jv symbol=ld ]
            ]
           
           [Node list symbol=LET symbol=i 
           
            [Node list symbol=+ symbol=i 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=LD 
          
           [Node list symbol=insert symbol=ld symbol=LD symbol=i ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=LS 
           
            [Node list symbol=insert symbol=LS symbol=i 
            
             [Node list symbol=:: symbol=ls symbol=$ ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=newSys 
      
       [Node list symbol=List symbol=$ ]
       ]
      
      [Node list symbol=sys1 
      
       [Node list symbol=Sel symbol=map 
       
        [Node list symbol=List symbol=$ ]
        ]
       
       [Node list symbol=@ symbol=simpOne 
       
        [Node list symbol=Mapping symbol=$ symbol=$ ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949565 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=LD ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949565 symbol=newSys 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=res 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=eq1 symbol=newSys ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=neq symbol=eq1 ]
          
          [Node list symbol=LET symbol=LD 
          
           [Node list symbol=: symbol=LD1 
           
            [Node list symbol=List symbol=JB ]
            ]
           ]
          
          [Node list symbol=LET symbol=LS 
          
           [Node list symbol=: symbol=LS1 
           
            [Node list symbol=List symbol=$ ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=UNTIL 
           
            [Node list symbol=empty? symbol=LD1 ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=ld 
            
             [Node list symbol=leadingDer symbol=neq ]
             ]
            
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4949566 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=LD1 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4949566 symbol=false 
                
                 [Node list symbol=> symbol=ld 
                 
                  [Node list symbol=first symbol=LD1 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=LD1 
              
               [Node list symbol=rest symbol=LD1 ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=LS1 
               
                [Node list symbol=rest symbol=LS1 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4949567 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=LD1 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4949567 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=neq 
               
                [Node list symbol=subst symbol=neq 
                
                 [Node list symbol=first symbol=LD1 ]
                 
                 [Node list symbol=first symbol=LS1 ]
                 ]
                ]
               
               [Node list symbol=LET symbol=LD1 
               
                [Node list symbol=rest symbol=LD1 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=LS1 
                
                 [Node list symbol=rest symbol=LS1 ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4949568 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=~= symbol=neq symbol=eq1 ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4949568 symbol=noBranch 
            
             [Node list symbol=LET symbol=neq 
             
              [Node list symbol=simpOne symbol=neq ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4949569 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=neq ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4949569 symbol=noBranch 
           
            [Node list symbol=LET symbol=res 
            
             [Node list symbol=cons symbol=neq symbol=res ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=sortLD 
         
          [Node list symbol=reverse! symbol=res ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpMod symbol=sys1 symbol=jm symbol=sys2 ]
    
    [Node list 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Sys 
      
       [Node list symbol=List symbol=$ ]
       ]
      
      [Node list symbol=: symbol=JM 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
       ]
      
      [Node list symbol=: symbol=Depend 
      
       [Node list symbol=Union string=failed 
       
        [Node list symbol=List 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4949570 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=sys1 ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4949570 
       
        [Node list symbol=exit int=2 
        
         [Node list symbol=construct symbol=sys1 symbol=jm 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=One ]
             
             [Node list symbol=# symbol=sys1 ]
             ]
            ]
           
           [Node list symbol=construct 
           
            [Node list symbol=:: symbol=i 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4949571 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=sys2 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4949571 symbol=noBranch 
          
           [Node list symbol=exit int=3 
           
            [Node list symbol=construct symbol=sys1 symbol=jm 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=i 
              
               [Node list symbol=SEGMENT 
               
                [Node list symbol=One ]
                
                [Node list symbol=# symbol=sys1 ]
                ]
               ]
              
              [Node list symbol=construct 
              
               [Node list symbol=:: symbol=i 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=osys symbol=sys1 ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=LD 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=LS 
      
       [Node list symbol=List symbol=$ ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq2 symbol=sys2 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ld 
       
        [Node list symbol=leadingDer symbol=eq2 ]
        ]
       
       [Node list symbol=LET symbol=ls 
       
        [Node list symbol=solveFor symbol=eq2 symbol=ld ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol=case symbol=ls symbol=$ ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=i 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=jv symbol=LD ]
           
           [Node list symbol=WHILE 
           
            [Node list symbol=> symbol=jv symbol=ld ]
            ]
           
           [Node list symbol=LET symbol=i 
           
            [Node list symbol=+ symbol=i 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=LD 
          
           [Node list symbol=insert symbol=ld symbol=LD symbol=i ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=LS 
           
            [Node list symbol=insert symbol=LS symbol=i 
            
             [Node list symbol=:: symbol=ls symbol=$ ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=newSys 
      
       [Node list symbol=List symbol=$ ]
       ]
      
      [Node list symbol=map symbol=simpOne symbol=sys1 ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=List symbol=$ ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq1 symbol=newSys ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=neq symbol=eq1 ]
       
       [Node list symbol=LET symbol=LD 
       
        [Node list symbol=: symbol=LD1 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=LET symbol=LS 
       
        [Node list symbol=: symbol=LS1 
        
         [Node list symbol=List symbol=$ ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=UNTIL 
        
         [Node list symbol=empty? symbol=LD1 ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=ld 
         
          [Node list symbol=leadingDer symbol=neq ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=WHILE 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4949572 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=LD1 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4949572 symbol=false 
             
              [Node list symbol=> symbol=ld 
              
               [Node list symbol=first symbol=LD1 ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=LD1 
           
            [Node list symbol=rest symbol=LD1 ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=LS1 
            
             [Node list symbol=rest symbol=LS1 ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4949573 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=LD1 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4949573 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=neq 
            
             [Node list symbol=subst symbol=neq 
             
              [Node list symbol=first symbol=LD1 ]
              
              [Node list symbol=first symbol=LS1 ]
              ]
             ]
            
            [Node list symbol=LET symbol=LD1 
            
             [Node list symbol=rest symbol=LD1 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=LS1 
             
              [Node list symbol=rest symbol=LS1 ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949574 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= symbol=neq symbol=eq1 ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949574 symbol=noBranch 
         
          [Node list symbol=LET symbol=neq 
          
           [Node list symbol=simpOne symbol=neq ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=cons symbol=neq symbol=res ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=resSys 
      
       [Node list symbol=List symbol=$ ]
       ]
      ]
     
     [Node list symbol=LET symbol=resJM symbol=jm ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=neq symbol=res ]
      
      [Node list symbol=IN symbol=oeq 
      
       [Node list symbol=reverse! symbol=osys ]
       ]
      
      [Node list symbol=INBY symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=# symbol=res ]
        
        [Node list symbol=One ]
        ]
       
       [Node list symbol=- 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949575 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= symbol=neq symbol=oeq ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949575 symbol=noBranch 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=njm 
           
            [Node list symbol=jacobiMatrix 
            
             [Node list symbol=construct symbol=neq ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=setRow! symbol=resJM symbol=i 
            
             [Node list symbol=row symbol=njm 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=resSys 
        
         [Node list symbol=cons symbol=neq symbol=resSys ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct symbol=resSys symbol=resJM 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=resSys ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=reduceMod symbol=sys1 symbol=sys2 ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4949576 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=sys1 ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4949576 
       
        [Node list symbol=exit int=2 symbol=sys1 ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4949577 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=sys2 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4949577 symbol=noBranch 
          
           [Node list symbol=exit int=3 symbol=sys1 ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=LD 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=LS 
      
       [Node list symbol=List symbol=$ ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq2 symbol=sys2 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ld 
       
        [Node list symbol=leadingDer symbol=eq2 ]
        ]
       
       [Node list symbol=LET symbol=ls 
       
        [Node list symbol=solveFor symbol=eq2 symbol=ld ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol=case symbol=ls symbol=$ ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=i 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=jv symbol=LD ]
           
           [Node list symbol=WHILE 
           
            [Node list symbol=> symbol=jv symbol=ld ]
            ]
           
           [Node list symbol=LET symbol=i 
           
            [Node list symbol=+ symbol=i 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=LD 
          
           [Node list symbol=insert symbol=ld symbol=LD symbol=i ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=LS 
           
            [Node list symbol=insert symbol=LS symbol=i 
            
             [Node list symbol=:: symbol=ls symbol=$ ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=newSys 
     
      [Node list symbol=map symbol=simpOne symbol=sys1 ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949578 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=LD ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949578 symbol=newSys 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=res 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=eq1 symbol=newSys ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=eq symbol=eq1 ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=oeq symbol=$ ]
           
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=LET symbol=eq1 
          
           [Node list symbol=: symbol=neq symbol=$ ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=WHILE 
           
            [Node list symbol=~= symbol=neq symbol=oeq ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=oeq symbol=neq ]
            
            [Node list symbol=LET symbol=LD 
            
             [Node list symbol=: symbol=LD1 
             
              [Node list symbol=List symbol=JB ]
              ]
             ]
            
            [Node list symbol=LET symbol=LS 
            
             [Node list symbol=: symbol=LS1 
             
              [Node list symbol=List symbol=$ ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=REPEAT 
             
              [Node list symbol=UNTIL 
              
               [Node list symbol=empty? symbol=LD1 ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=ld 
               
                [Node list symbol=leadingDer symbol=neq ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=WHILE 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=G4949579 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol=empty? symbol=LD1 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=IF symbol=G4949579 symbol=false 
                   
                    [Node list symbol=> symbol=ld 
                    
                     [Node list symbol=first symbol=LD1 ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=LD1 
                 
                  [Node list symbol=rest symbol=LD1 ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=LS1 
                  
                   [Node list symbol=rest symbol=LS1 ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4949580 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=LD1 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4949580 symbol=noBranch 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=neq 
                  
                   [Node list symbol=dSubst symbol=neq 
                   
                    [Node list symbol=first symbol=LD1 ]
                    
                    [Node list symbol=first symbol=LS1 ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=LD1 
                  
                   [Node list symbol=rest symbol=LD1 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=LS1 
                   
                    [Node list symbol=rest symbol=LS1 ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4949581 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=neq ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4949581 symbol=noBranch 
           
            [Node list symbol=IF 
            
             [Node list symbol== symbol=neq symbol=eq ]
             
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=cons symbol=neq symbol=res ]
              ]
             
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=cons symbol=res 
              
               [Node list symbol=simpOne symbol=neq ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=sortLD 
         
          [Node list symbol=reverse! symbol=res ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=autoReduce symbol=sys ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4949582 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=sys ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4949582 symbol=empty 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4949583 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=one? 
         
          [Node list symbol=# symbol=sys ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4949583 symbol=sys 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=nl 
            
             [Node list symbol=List symbol=$ ]
             ]
            
            [Node list symbol=map symbol=simpOne symbol=sys ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=nsl 
            
             [Node list symbol=List symbol=$ ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=sl 
            
             [Node list symbol=List 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=LD symbol=JB ]
               
               [Node list symbol=: symbol=Fake? 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=: symbol=Dep 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               
               [Node list symbol=: symbol=Fun symbol=$ ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=osl symbol=sl ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=WHILE 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4949584 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=nl ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4949584 symbol=false symbol=true ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=eq symbol=nl ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=ld 
               
                [Node list symbol=leadingDer symbol=eq ]
                ]
               
               [Node list symbol=LET symbol=su 
               
                [Node list symbol=solveFor symbol=eq symbol=ld ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF 
                
                 [Node list symbol=case symbol=su string=failed ]
                 
                 [Node list symbol=LET symbol=nsl 
                 
                  [Node list symbol=cons symbol=eq symbol=nsl ]
                  ]
                 
                 [Node list symbol=LET symbol=sl 
                 
                  [Node list symbol=merge! symbol=greater symbol=sl 
                  
                   [Node list symbol=construct 
                   
                    [Node list symbol=construct symbol=ld symbol=true symbol=empty 
                    
                     [Node list symbol=:: symbol=su symbol=$ ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=nl symbol=empty ]
             
             [Node list symbol=LET symbol=osl symbol=empty ]
             
             [Node list symbol=LET symbol=sl 
             
              [Node list symbol=reverse! symbol=sl ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=WHILE 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G4949585 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=empty? symbol=sl ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G4949585 symbol=false symbol=true ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=sub 
               
                [Node list symbol=first symbol=sl ]
                ]
               
               [Node list symbol=LET symbol=osl 
               
                [Node list symbol=cons symbol=sub symbol=osl ]
                ]
               
               [Node list symbol=LET symbol=sl 
               
                [Node list symbol=rest symbol=sl ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=WHILE 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=G4949586 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol=empty? symbol=sl ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=IF symbol=G4949586 symbol=false symbol=true ]
                   ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=rec 
                 
                  [Node list symbol=first symbol=sl ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G4949587 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=> 
                  
                   [Node list symbol=rec symbol=LD ]
                   
                   [Node list symbol=sub symbol=LD ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G4949587 
                  
                   [Node list symbol=leave int=1 symbol=$NoValue ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=sl 
                    
                     [Node list symbol=rest symbol=sl ]
                     ]
                    
                    [Node list symbol=LET symbol=ic 
                    
                     [Node list symbol=simpOne 
                     
                      [Node list symbol=- 
                      
                       [Node list symbol=rec symbol=Fun ]
                       
                       [Node list symbol=sub symbol=Fun ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G4949588 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=zero? symbol=ic ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G4949588 symbol=noBranch 
                     
                      [Node list symbol=LET symbol=nl 
                      
                       [Node list symbol=cons symbol=ic symbol=nl ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=empty 
               
                [Node list symbol=: symbol=tmp 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=LD symbol=JB ]
                   
                   [Node list symbol=: symbol=Fake? 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol=: symbol=Dep 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   
                   [Node list symbol=: symbol=Fun symbol=$ ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=rec symbol=sl ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=d 
                 
                  [Node list symbol=derivativeOf? 
                  
                   [Node list symbol=rec symbol=LD ]
                   
                   [Node list symbol=sub symbol=LD ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G4949590 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=empty? symbol=d ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G4949590 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=seq 
                    
                     [Node list symbol=dSubst 
                     
                      [Node list symbol=rec symbol=Fun ]
                      
                      [Node list symbol=sub symbol=LD ]
                      
                      [Node list symbol=sub symbol=Fun ]
                      ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=tmp 
                     
                      [Node list symbol=cons symbol=tmp 
                      
                       [Node list symbol=construct symbol=true symbol=empty symbol=seq 
                       
                        [Node list symbol=rec symbol=LD ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=ic 
                    
                     [Node list symbol=dSubst 
                     
                      [Node list symbol=- 
                      
                       [Node list symbol=formalDiff symbol=d 
                       
                        [Node list symbol=sub symbol=Fun ]
                        ]
                       
                       [Node list symbol=rec symbol=Fun ]
                       ]
                      
                      [Node list symbol=sub symbol=LD ]
                      
                      [Node list symbol=sub symbol=Fun ]
                      ]
                     ]
                    
                    [Node list symbol=LET symbol=ic 
                    
                     [Node list symbol=simpOne symbol=ic ]
                     ]
                    
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G4949589 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=zero? symbol=ic ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G4949589 symbol=noBranch 
                     
                      [Node list symbol=LET symbol=nl 
                      
                       [Node list symbol=cons symbol=ic symbol=nl ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=sl 
                
                 [Node list symbol=reverse! symbol=tmp ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=sl symbol=osl ]
             
             [Node list symbol=LET symbol=empty 
             
              [Node list symbol=: symbol=ol 
              
               [Node list symbol=List symbol=$ ]
               ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=eq symbol=nsl ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=seq symbol=eq ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=sub symbol=sl ]
                
                [Node list symbol=LET symbol=seq 
                
                 [Node list symbol=dSubst symbol=seq 
                 
                  [Node list symbol=sub symbol=LD ]
                  
                  [Node list symbol=sub symbol=Fun ]
                  ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF 
                
                 [Node list symbol== symbol=seq symbol=eq ]
                 
                 [Node list symbol=LET symbol=ol 
                 
                  [Node list symbol=cons symbol=eq symbol=ol ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=G4949591 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol=zero? symbol=seq ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=IF symbol=G4949591 symbol=noBranch 
                   
                    [Node list symbol=LET symbol=nl 
                    
                     [Node list symbol=cons symbol=nl 
                     
                      [Node list symbol=simpOne symbol=seq ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=nsl symbol=ol ]
             
             [Node list symbol=LET symbol=empty 
             
              [Node list symbol=: symbol=ol 
              
               [Node list symbol=List symbol=$ ]
               ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=eq symbol=nl ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=seq symbol=eq ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=sub symbol=sl ]
                
                [Node list symbol=LET symbol=seq 
                
                 [Node list symbol=dSubst symbol=seq 
                 
                  [Node list symbol=sub symbol=LD ]
                  
                  [Node list symbol=sub symbol=Fun ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4949592 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=zero? symbol=seq ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4949592 symbol=noBranch 
                
                 [Node list symbol=LET symbol=ol 
                 
                  [Node list symbol=cons symbol=ol 
                  
                   [Node list symbol=simpOne symbol=seq ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=nl symbol=ol ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=tmp1 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=eq symbol=nsl ]
             
             [Node list symbol=construct symbol=true symbol=empty symbol=eq 
             
              [Node list symbol=leadingDer symbol=eq ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=tmp2 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=rec symbol=sl ]
             
             [Node list symbol=construct symbol=true symbol=empty 
             
              [Node list symbol=rec symbol=LD ]
              
              [Node list symbol=simpOne 
              
               [Node list symbol=- 
               
                [Node list symbol=:: symbol=$ 
                
                 [Node list symbol=rec symbol=LD ]
                 ]
                
                [Node list symbol=rec symbol=Fun ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=tmp1 
           
            [Node list symbol=sort! symbol=greater 
            
             [Node list symbol=concat! symbol=tmp1 symbol=tmp2 ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=rec symbol=tmp1 ]
             
             [Node list symbol=rec symbol=Fun ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF JetBundleBaseFunctionCategory JB add
 DEFSubnode:atts= Category
  [Node list symbol=Category ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= JetBundleFunctionCategory JB
  [Node list symbol=JetBundleFunctionCategory symbol=JB ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=DEF 
   
    [Node list symbol=U symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=error string=Only functions of independent variables allowed ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=U ]
    
    [Node list symbol=$ ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=error string=Only functions of independent variables allowed ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=i symbol=l ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=error string=Only functions of independent variables allowed ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=l ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=error string=Only functions of independent variables allowed ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=i symbol=l ]
    
    [Node list symbol=$ 
    
     [Node list symbol=PositiveInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=error string=Only functions of independent variables allowed ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=P symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=error string=Only functions of independent variables allowed ]
    ]
   ]
  
 ]
 
 [DEF SparseEchelonMatrix C D
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=minInd 
    
     [Node list symbol=Integer ]
     ]
    
    [Node list symbol=minIndex 
    
     [Node list symbol=COLLECT symbol=i 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=offset 
    
     [Node list symbol=Integer ]
     ]
    
    [Node list symbol=- symbol=minInd 
    
     [Node list symbol=One ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=emptyRec 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Indices 
      
       [Node list symbol=List symbol=C ]
       ]
      
      [Node list symbol=: symbol=Entries 
      
       [Node list symbol=List symbol=D ]
       ]
      ]
     ]
    
    [Node list symbol=construct symbol=empty symbol=empty ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=noChecks? 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list symbol=has symbol=D 
    
     [Node list symbol=lazyRepresentation ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET int=113 
   
    [Node list symbol=: symbol=seed 
    
     [Node list symbol=Integer ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=GCDmode 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list symbol=:: string=iterated 
    
     [Node list symbol=Symbol ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=NCols 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=NRows 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=AllInds 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Rows 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=D 
    
     [Node list symbol=GcdDomain ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=DEF 
     
      [Node list symbol=setGcdMode symbol=s ]
      
      [Node list 
      
       [Node list symbol=Symbol ]
       
       [Node list symbol=Symbol ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=tmp symbol=GCDmode ]
       
       [Node list symbol=IF 
       
        [Node list symbol== symbol=s 
        
         [Node list symbol=:: string=iterated 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=GCDmode symbol=s ]
          
          [Node list symbol=exit int=1 symbol=tmp ]
          ]
         ]
        
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol== symbol=s 
         
          [Node list symbol=:: string=random 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=GCDmode symbol=s ]
           
           [Node list symbol=exit int=1 symbol=tmp ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=error string=unknown gcd mode ]
        ]
       ]
      ]
     
     [Node list symbol=DEF 
     
      [Node list symbol=randomGCD symbol=le ]
      
      [Node list symbol=D 
      
       [Node list symbol=List symbol=D ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951272 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== int=2 
        
         [Node list symbol=# symbol=le ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951272 
        
         [Node list symbol=gcd 
         
          [Node list symbol=first symbol=le ]
          
          [Node list symbol=second symbol=le ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=f 
          
           [Node list symbol=first symbol=le ]
           ]
          
          [Node list symbol=LET symbol=g 
          
           [Node list symbol=second symbol=le ]
           ]
          
          [Node list symbol=LET symbol=l 
          
           [Node list symbol=rest 
           
            [Node list symbol=rest symbol=le ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=WHILE 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951273 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=l ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951273 symbol=false symbol=true ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951274 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=one? 
             
              [Node list symbol=first symbol=l ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951274 
             
              [Node list symbol=return 
              
               [Node list symbol=Sel symbol=D 
               
                [Node list symbol=One ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=f 
               
                [Node list symbol=+ symbol=f 
                
                 [Node list symbol=* 
                 
                  [Node list symbol=+ 
                  
                   [Node list symbol=One ]
                   
                   [Node list int=113 
                   
                    [Node list symbol=Sel symbol=random 
                    
                     [Node list symbol=Integer ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=first symbol=l ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=l 
               
                [Node list symbol=rest symbol=l ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4951275 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=l ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4951275 symbol=noBranch 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=G4951276 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol=one? 
                   
                    [Node list symbol=first symbol=l ]
                    ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=IF symbol=G4951276 
                   
                    [Node list symbol=return 
                    
                     [Node list symbol=Sel symbol=D 
                     
                      [Node list symbol=One ]
                      ]
                     ]
                    
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=LET symbol=g 
                     
                      [Node list symbol=+ symbol=g 
                      
                       [Node list symbol=* 
                       
                        [Node list symbol=+ 
                        
                         [Node list symbol=One ]
                         
                         [Node list int=113 
                         
                          [Node list symbol=Sel symbol=random 
                          
                           [Node list symbol=Integer ]
                           ]
                          ]
                         ]
                        
                        [Node list symbol=first symbol=l ]
                        ]
                       ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=LET symbol=l 
                      
                       [Node list symbol=rest symbol=l ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=h 
          
           [Node list symbol=gcd symbol=f symbol=g ]
           ]
          
          [Node list symbol=LET symbol=l 
          
           [Node list symbol=construct symbol=h ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=e symbol=le ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=tmp 
            
             [Node list symbol=exquo symbol=e symbol=h ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=noBranch 
             
              [Node list symbol=case symbol=tmp string=failed ]
              
              [Node list symbol=LET symbol=l 
              
               [Node list symbol=cons symbol=e symbol=l ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4951277 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=one? 
           
            [Node list symbol=# symbol=l ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4951277 symbol=h 
           
            [Node list symbol=randomGCD symbol=l ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=DEF 
     
      [Node list symbol=iteratedGCD symbol=le ]
      
      [Node list symbol=D 
      
       [Node list symbol=List symbol=D ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=gcd 
        
         [Node list symbol=first symbol=le ]
         
         [Node list symbol=second symbol=le ]
         ]
        ]
       
       [Node list symbol=LET symbol=l 
       
        [Node list symbol=rest 
        
         [Node list symbol=rest symbol=le ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4951278 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=l ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4951278 symbol=false 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951279 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=one? symbol=res ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951279 symbol=false symbol=true ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=res 
         
          [Node list symbol=gcd symbol=res 
          
           [Node list symbol=first symbol=l ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=l 
          
           [Node list symbol=rest symbol=l ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     
     [Node list symbol=DEF 
     
      [Node list symbol=makePrimitive symbol=r ]
      
      [Node list 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=GCD symbol=D ]
        
        [Node list symbol=: symbol=Row 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=Indices 
          
           [Node list symbol=List symbol=C ]
           ]
          
          [Node list symbol=: symbol=Entries 
          
           [Node list symbol=List symbol=D ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=le 
       
        [Node list symbol=r symbol=Entries ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951280 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? 
        
         [Node list symbol=# symbol=le ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951280 
        
         [Node list symbol=construct 
         
          [Node list symbol=first symbol=le ]
          
          [Node list symbol=construct 
          
           [Node list symbol=r symbol=Indices ]
           
           [Node list symbol=construct 
           
            [Node list symbol=Sel symbol=D 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=: symbol=g symbol=D ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4951281 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol== symbol=GCDmode 
            
             [Node list symbol=QUOTE symbol=iterated ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4951281 
            
             [Node list symbol=LET symbol=g 
             
              [Node list symbol=iteratedGCD symbol=le ]
              ]
             
             [Node list symbol=LET symbol=g 
             
              [Node list symbol=randomGCD symbol=le ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4951282 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=one? symbol=g ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4951282 
           
            [Node list symbol=construct symbol=r 
            
             [Node list symbol=One ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=le 
             
              [Node list symbol=COLLECT 
              
               [Node list symbol=IN symbol=e symbol=le ]
               
               [Node list symbol=:: symbol=D 
               
                [Node list symbol=exquo symbol=e symbol=g ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=construct symbol=g 
              
               [Node list symbol=construct symbol=le 
               
                [Node list symbol=r symbol=Indices ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DEF 
      
       [Node list symbol=primitiveRowEchelon symbol=AA ]
       
       [Node list symbol=$ 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Ech symbol=$ ]
         
         [Node list symbol=: symbol=Lt 
         
          [Node list symbol=Matrix 
          
           [Node list symbol=Fraction symbol=D ]
           ]
          ]
         
         [Node list symbol=: symbol=Pivots 
         
          [Node list symbol=List symbol=D ]
          ]
         
         [Node list symbol=: symbol=Rank 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=A 
        
         [Node list symbol=copy symbol=AA ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=LTr 
         
          [Node list symbol=Matrix 
          
           [Node list symbol=Fraction symbol=D ]
           ]
          ]
         
         [Node list symbol=diagonalMatrix 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=One ]
             
             [Node list symbol=A symbol=NRows ]
             ]
            ]
           
           [Node list symbol=Sel 
           
            [Node list symbol=Fraction symbol=D ]
            
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=Pivs 
         
          [Node list symbol=List symbol=D ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           
           [Node list symbol=A symbol=NRows ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=r 
          
           [Node list symbol=qelt symbol=i 
           
            [Node list symbol=A symbol=Rows ]
            ]
           ]
          
          [Node list symbol=LET symbol=false 
          
           [Node list symbol=: symbol=changed? 
           
            [Node list symbol=Boolean ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=WHILE 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951283 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? 
              
               [Node list symbol=r symbol=Entries ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951283 symbol=false 
              
               [Node list symbol=zero? 
               
                [Node list symbol=first 
                
                 [Node list symbol=r symbol=Entries ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=r symbol=Entries ]
             
             [Node list symbol=rest 
             
              [Node list symbol=r symbol=Entries ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=r symbol=Indices ]
             
             [Node list symbol=rest 
             
              [Node list symbol=r symbol=Indices ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=changed? symbol=true ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=changed? symbol=noBranch 
           
            [Node list symbol=qsetelt! symbol=i symbol=r 
            
             [Node list symbol=A symbol=Rows ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=false 
        
         [Node list symbol=: symbol=sorted? 
         
          [Node list symbol=Boolean ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=UNTIL symbol=sorted? ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=sorted? symbol=true ]
          
          [Node list symbol=LET symbol=oldr 
          
           [Node list symbol=qelt 
           
            [Node list symbol=A symbol=Rows ]
            
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=i 
            
             [Node list symbol=SEGMENT int=2 
             
              [Node list symbol=A symbol=NRows ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=newr 
             
              [Node list symbol=qelt symbol=i 
              
               [Node list symbol=A symbol=Rows ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951284 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=greater symbol=newr symbol=oldr ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951284 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=qsetelt! symbol=i symbol=oldr 
                
                 [Node list symbol=A symbol=Rows ]
                 ]
                
                [Node list symbol=qsetelt! symbol=newr 
                
                 [Node list symbol=A symbol=Rows ]
                 
                 [Node list symbol=- symbol=i 
                 
                  [Node list symbol=One ]
                  ]
                 ]
                
                [Node list symbol=swapRows! symbol=LTr symbol=i 
                
                 [Node list symbol=- symbol=i 
                 
                  [Node list symbol=One ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=sorted? symbol=false ]
                 ]
                ]
               
               [Node list symbol=LET symbol=oldr symbol=newr ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=false 
        
         [Node list symbol=: symbol=finished? 
         
          [Node list symbol=Boolean ]
          ]
         ]
        
        [Node list symbol=: 
        
         [Node list symbol=LISTOF symbol=pivlen symbol=pivrow symbol=rk ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           
           [Node list symbol=A symbol=NRows ]
           ]
          ]
         
         [Node list symbol=UNTIL symbol=finished? ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=r 
          
           [Node list symbol=qelt symbol=i 
           
            [Node list symbol=A symbol=Rows ]
            ]
           ]
          
          [Node list symbol=LET symbol=finished? 
          
           [Node list symbol=empty? 
           
            [Node list symbol=r symbol=Indices ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=finished? 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=rk 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=:: 
             
              [Node list symbol=- symbol=i 
              
               [Node list symbol=One ]
               ]
              
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=pivind 
             
              [Node list symbol=first 
              
               [Node list symbol=r symbol=Indices ]
               ]
              ]
             
             [Node list symbol=LET symbol=pivlen 
             
              [Node list symbol=# 
              
               [Node list symbol=r symbol=Indices ]
               ]
              ]
             
             [Node list symbol=LET symbol=pivrow symbol=i ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=k 
              
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=Zero ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=j 
              
               [Node list symbol=SEGMENT 
               
                [Node list symbol=+ symbol=i 
                
                 [Node list symbol=One ]
                 ]
                
                [Node list symbol=A symbol=NRows ]
                ]
               ]
              
              [Node list symbol=WHILE 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G4951285 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=empty? 
                 
                  [Node list symbol=Indices 
                  
                   [Node list symbol=qelt symbol=j 
                   
                    [Node list symbol=A symbol=Rows ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G4951285 symbol=false 
                 
                  [Node list symbol== symbol=pivind 
                  
                   [Node list symbol=first 
                   
                    [Node list symbol=Indices 
                    
                     [Node list symbol=qelt symbol=j 
                     
                      [Node list symbol=A symbol=Rows ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=len 
               
                [Node list symbol=# 
                
                 [Node list symbol=Indices 
                 
                  [Node list symbol=qelt symbol=j 
                  
                   [Node list symbol=A symbol=Rows ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=k 
               
                [Node list symbol=+ symbol=k 
                
                 [Node list symbol=One ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=noBranch 
                
                 [Node list symbol=< symbol=len symbol=pivlen ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=pivlen symbol=len ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=pivrow symbol=j ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=tmp 
             
              [Node list symbol=makePrimitive 
              
               [Node list symbol=qelt symbol=pivrow 
               
                [Node list symbol=A symbol=Rows ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4951286 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=one? 
               
                [Node list symbol=tmp symbol=GCD ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4951286 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=qsetelt! symbol=pivrow 
                 
                  [Node list symbol=A symbol=Rows ]
                  
                  [Node list symbol=tmp symbol=Row ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=q 
                  
                   [Node list symbol=Fraction symbol=D ]
                   ]
                  
                  [Node list symbol=/ 
                  
                   [Node list symbol=One ]
                   
                   [Node list symbol=tmp symbol=GCD ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=REPEAT 
                  
                   [Node list symbol=IN symbol=l 
                   
                    [Node list symbol=SEGMENT 
                    
                     [Node list symbol=One ]
                     
                     [Node list symbol=A symbol=NRows ]
                     ]
                    ]
                   
                   [Node list symbol=| 
                   
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=LET 
                     
                      [Node list symbol=: symbol=G4951287 
                      
                       [Node list symbol=Boolean ]
                       ]
                      
                      [Node list symbol=zero? 
                      
                       [Node list symbol=qelt symbol=LTr symbol=pivrow symbol=l ]
                       ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=IF symbol=G4951287 symbol=false symbol=true ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=qsetelt! symbol=LTr symbol=pivrow symbol=l 
                   
                    [Node list symbol=* symbol=q 
                    
                     [Node list symbol=qelt symbol=LTr symbol=pivrow symbol=l ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=piv symbol=D ]
              
              [Node list symbol=first 
              
               [Node list symbol=Entries 
               
                [Node list symbol=qelt symbol=pivrow 
                
                 [Node list symbol=A symbol=Rows ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=Pivs 
             
              [Node list symbol=cons symbol=piv symbol=Pivs ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=noBranch 
              
               [Node list symbol=> symbol=k 
               
                [Node list symbol=Zero ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G4951288 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=~= symbol=pivrow symbol=i ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G4951288 symbol=noBranch 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=pr 
                    
                     [Node list symbol=qelt symbol=pivrow 
                     
                      [Node list symbol=A symbol=Rows ]
                      ]
                     ]
                    
                    [Node list symbol=qsetelt! symbol=pivrow 
                    
                     [Node list symbol=A symbol=Rows ]
                     
                     [Node list symbol=qelt symbol=i 
                     
                      [Node list symbol=A symbol=Rows ]
                      ]
                     ]
                    
                    [Node list symbol=qsetelt! symbol=i symbol=pr 
                    
                     [Node list symbol=A symbol=Rows ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=swapRows! symbol=LTr symbol=i symbol=pivrow ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=pr 
                
                 [Node list symbol=copy 
                 
                  [Node list symbol=tmp symbol=Row ]
                  ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=pr symbol=Indices ]
                 
                 [Node list symbol=rest 
                 
                  [Node list symbol=pr symbol=Indices ]
                  ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=pr symbol=Entries ]
                 
                 [Node list symbol=rest 
                 
                  [Node list symbol=pr symbol=Entries ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=REPEAT 
                 
                  [Node list symbol=IN symbol=j 
                  
                   [Node list symbol=SEGMENT 
                   
                    [Node list symbol=+ symbol=i 
                    
                     [Node list symbol=One ]
                     ]
                    
                    [Node list symbol=+ symbol=i symbol=k ]
                    ]
                   ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET symbol=r 
                   
                    [Node list symbol=copy 
                    
                     [Node list symbol=qelt 
                     
                      [Node list symbol=A symbol=Rows ]
                      
                      [Node list symbol=+ symbol=i 
                      
                       [Node list symbol=One ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=LET symbol=c 
                   
                    [Node list symbol=first 
                    
                     [Node list symbol=r symbol=Entries ]
                     ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=r symbol=Indices ]
                    
                    [Node list symbol=rest 
                    
                     [Node list symbol=r symbol=Indices ]
                     ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=r symbol=Entries ]
                    
                    [Node list symbol=rest 
                    
                     [Node list symbol=r symbol=Entries ]
                     ]
                    ]
                   
                   [Node list symbol=LET symbol=r 
                   
                    [Node list symbol=addRows symbol=piv symbol=r symbol=pr 
                    
                     [Node list symbol=- symbol=c ]
                     ]
                    ]
                   
                   [Node list symbol=REPEAT 
                   
                    [Node list symbol=IN symbol=l 
                    
                     [Node list symbol=SEGMENT 
                     
                      [Node list symbol=One ]
                      
                      [Node list symbol=A symbol=NRows ]
                      ]
                     ]
                    
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=LET 
                     
                      [Node list symbol=: symbol=fd 
                      
                       [Node list symbol=Fraction symbol=D ]
                       ]
                      
                      [Node list symbol=- 
                      
                       [Node list symbol=piv 
                       
                        [Node list symbol=Sel symbol=* 
                        
                         [Node list symbol=Fraction symbol=D ]
                         ]
                        
                        [Node list symbol=qelt symbol=LTr symbol=l 
                        
                         [Node list symbol=+ symbol=i 
                         
                          [Node list symbol=One ]
                          ]
                         ]
                        ]
                       
                       [Node list symbol=:: 
                       
                        [Node list symbol=* symbol=c 
                        
                         [Node list symbol=qelt symbol=LTr symbol=i symbol=l ]
                         ]
                        
                        [Node list symbol=Fraction symbol=D ]
                        ]
                       ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=qsetelt! symbol=LTr symbol=l symbol=fd 
                      
                       [Node list symbol=+ symbol=i 
                       
                        [Node list symbol=One ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=REPEAT 
                   
                    [Node list symbol=IN symbol=l 
                    
                     [Node list symbol=SEGMENT 
                     
                      [Node list symbol=+ symbol=i int=2 ]
                      
                      [Node list symbol=- symbol=j 
                      
                       [Node list symbol=+ 
                       
                        [Node list symbol=+ symbol=k 
                        
                         [Node list symbol=* int=2 symbol=i ]
                         ]
                        
                        [Node list symbol=One ]
                        ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=qsetelt! 
                     
                      [Node list symbol=A symbol=Rows ]
                      
                      [Node list symbol=- symbol=l 
                      
                       [Node list symbol=One ]
                       ]
                      
                      [Node list symbol=qelt symbol=l 
                      
                       [Node list symbol=A symbol=Rows ]
                       ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=swapRows! symbol=LTr symbol=l 
                      
                       [Node list symbol=- symbol=l 
                       
                        [Node list symbol=One ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=REPEAT 
                   
                    [Node list symbol=IN symbol=l 
                    
                     [Node list symbol=SEGMENT 
                     
                      [Node list symbol=- symbol=j 
                      
                       [Node list symbol=+ int=2 
                       
                        [Node list symbol=+ symbol=k 
                        
                         [Node list symbol=* int=2 symbol=i ]
                         ]
                        ]
                       ]
                      
                      [Node list symbol=A symbol=NRows ]
                      ]
                     ]
                    
                    [Node list symbol=WHILE 
                    
                     [Node list symbol=greater symbol=r 
                     
                      [Node list symbol=qelt symbol=l 
                      
                       [Node list symbol=A symbol=Rows ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=qsetelt! 
                     
                      [Node list symbol=A symbol=Rows ]
                      
                      [Node list symbol=- symbol=l 
                      
                       [Node list symbol=One ]
                       ]
                      
                      [Node list symbol=qelt symbol=l 
                      
                       [Node list symbol=A symbol=Rows ]
                       ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=swapRows! symbol=LTr symbol=l 
                      
                       [Node list symbol=- symbol=l 
                       
                        [Node list symbol=One ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=qsetelt! symbol=r 
                    
                     [Node list symbol=A symbol=Rows ]
                     
                     [Node list symbol=- symbol=l 
                     
                      [Node list symbol=One ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=IF symbol=finished? symbol=noBranch 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=rk 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=A symbol=NRows ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=construct symbol=A symbol=LTr symbol=Pivs symbol=rk ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=D 
    
     [Node list symbol=IntegralDomain ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=DEF 
     
      [Node list symbol=mult symbol=f symbol=d ]
      
      [Node list symbol=D symbol=D 
      
       [Node list symbol=Fraction symbol=D ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=* symbol=d 
        
         [Node list symbol=numer symbol=f ]
         ]
        ]
       
       [Node list symbol=LET symbol=tmp 
       
        [Node list symbol=exquo symbol=res 
        
         [Node list symbol=denom symbol=f ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF 
        
         [Node list symbol=case symbol=tmp string=failed ]
         
         [Node list symbol=error string=cannot divide in mult ]
         
         [Node list symbol=:: symbol=tmp symbol=D ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DEF 
      
       [Node list symbol=* symbol=LM symbol=AA ]
       
       [Node list symbol=$ 
       
        [Node list ]
        
        [Node list symbol=Matrix 
        
         [Node list symbol=Fraction symbol=D ]
         ]
        ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4951294 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= 
         
          [Node list symbol=ncols symbol=LM ]
          
          [Node list symbol=AA symbol=NRows ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4951294 
         
          [Node list symbol=error string=improper matrix dimensions ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=A 
           
            [Node list symbol=copy symbol=AA ]
            ]
           
           [Node list symbol=LET symbol=rlen 
           
            [Node list symbol=nrows symbol=LM ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=res symbol=$ ]
            
            [Node list symbol=new symbol=rlen 
            
             [Node list symbol=A symbol=AllInds ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=c 
            
             [Node list symbol=A symbol=AllInds ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=tmp 
              
               [Node list symbol=Vector 
               
                [Node list symbol=Fraction symbol=D ]
                ]
               ]
              
              [Node list symbol=new symbol=rlen 
              
               [Node list symbol=Sel 
               
                [Node list symbol=Fraction symbol=D ]
                
                [Node list symbol=Zero ]
                ]
               ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=i 
              
               [Node list symbol=SEGMENT 
               
                [Node list symbol=One ]
                
                [Node list symbol=A symbol=NRows ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=r 
               
                [Node list symbol=qelt symbol=i 
                
                 [Node list symbol=A symbol=Rows ]
                 ]
                ]
               
               [Node list symbol=LET symbol=inds 
               
                [Node list symbol=r symbol=Indices ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4951295 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=inds ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4951295 symbol=noBranch 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=G4951297 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol== symbol=c 
                   
                    [Node list symbol=first symbol=inds ]
                    ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=IF symbol=G4951297 symbol=noBranch 
                   
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=REPEAT 
                     
                      [Node list symbol=IN symbol=k 
                      
                       [Node list symbol=SEGMENT symbol=rlen 
                       
                        [Node list symbol=One ]
                        ]
                       ]
                      
                      [Node list symbol=| 
                      
                       [Node list symbol=SEQ 
                       
                        [Node list symbol=LET 
                        
                         [Node list symbol=: symbol=G4951296 
                         
                          [Node list symbol=Boolean ]
                          ]
                         
                         [Node list symbol=zero? 
                         
                          [Node list symbol=qelt symbol=LM symbol=k symbol=i ]
                          ]
                         ]
                        
                        [Node list symbol=exit int=1 
                        
                         [Node list symbol=IF symbol=G4951296 symbol=false symbol=true ]
                         ]
                        ]
                       ]
                      
                      [Node list symbol=qsetelt! symbol=tmp symbol=k 
                      
                       [Node list symbol=+ 
                       
                        [Node list symbol=qelt symbol=tmp symbol=k ]
                        
                        [Node list symbol=* 
                        
                         [Node list symbol=qelt symbol=LM symbol=k symbol=i ]
                         
                         [Node list symbol=first 
                         
                          [Node list symbol=r symbol=Entries ]
                          ]
                         ]
                        ]
                       ]
                      ]
                     
                     [Node list symbol=LET 
                     
                      [Node list symbol=r symbol=Entries ]
                      
                      [Node list symbol=rest 
                      
                       [Node list symbol=r symbol=Entries ]
                       ]
                      ]
                     
                     [Node list symbol=LET 
                     
                      [Node list symbol=r symbol=Indices ]
                      
                      [Node list symbol=rest symbol=inds ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=qsetelt! symbol=i symbol=r 
                      
                       [Node list symbol=A symbol=Rows ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=REPEAT 
              
               [Node list symbol=IN symbol=k 
               
                [Node list symbol=SEGMENT symbol=rlen 
                
                 [Node list symbol=One ]
                 ]
                ]
               
               [Node list symbol=| 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G4951298 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=zero? 
                  
                   [Node list symbol=qelt symbol=tmp symbol=k ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G4951298 symbol=false symbol=true ]
                  ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=d 
                 
                  [Node list symbol=Union symbol=D string=failed ]
                  ]
                 
                 [Node list symbol=retractIfCan 
                 
                  [Node list symbol=qelt symbol=tmp symbol=k ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF 
                 
                  [Node list symbol=case symbol=d string=failed ]
                  
                  [Node list symbol=error string=cannot divide in * ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET symbol=r 
                   
                    [Node list symbol=qelt symbol=k 
                    
                     [Node list symbol=res symbol=Rows ]
                     ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=r symbol=Indices ]
                    
                    [Node list symbol=cons symbol=c 
                    
                     [Node list symbol=r symbol=Indices ]
                     ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=r symbol=Entries ]
                    
                    [Node list symbol=cons 
                    
                     [Node list symbol=:: symbol=d symbol=D ]
                     
                     [Node list symbol=r symbol=Entries ]
                     ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=qsetelt! symbol=k symbol=r 
                    
                     [Node list symbol=res symbol=Rows ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=k 
            
             [Node list symbol=SEGMENT symbol=rlen 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=r 
             
              [Node list symbol=qelt symbol=k 
              
               [Node list symbol=res symbol=Rows ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=r symbol=Indices ]
              
              [Node list symbol=reverse! 
              
               [Node list symbol=r symbol=Indices ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=r symbol=Entries ]
              
              [Node list symbol=reverse! 
              
               [Node list symbol=r symbol=Entries ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=qsetelt! symbol=k symbol=r 
              
               [Node list symbol=res symbol=Rows ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 symbol=res ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF greater r1 r2 SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951233 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=r1 symbol=Indices ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951233 symbol=false 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951234 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? 
        
         [Node list symbol=r2 symbol=Indices ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951234 symbol=true 
        
         [Node list symbol=< 
         
          [Node list symbol=first 
          
           [Node list symbol=r2 symbol=Indices ]
           ]
          
          [Node list symbol=first 
          
           [Node list symbol=r1 symbol=Indices ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ncols A $ A NCols
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF nrows A $ A NRows
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF allIndices A $ copy
   DEFSubnode:atts= List C
    [Node list symbol=List symbol=C ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= A AllInds
    [Node list symbol=A symbol=AllInds ]
    
   ]
   
  CAPSULEDef:
   [DEF row A i $ qelt i
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= A Rows
    [Node list symbol=A symbol=Rows ]
    
   ]
   
  CAPSULEDef:
   [DEF setRow! A i r $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= qsetelt! i r
    [Node list symbol=qsetelt! symbol=i symbol=r 
    
     [Node list symbol=A symbol=Rows ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF setRow! A i inds ents $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= List C
    [Node list symbol=List symbol=C ]
    
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= qsetelt! i
    [Node list symbol=qsetelt! symbol=i 
    
     [Node list symbol=A symbol=Rows ]
     
     [Node list symbol=construct symbol=inds symbol=ents ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF new inds n $ construct inds
   DEFSubnode:atts= List C
    [Node list symbol=List symbol=C ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= # inds
    [Node list symbol=# symbol=inds ]
    
   DEFSubnode:atts= :: n
    [Node list symbol=:: symbol=n 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=n 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=copy symbol=emptyRec ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF elt A i c D $ C SEQ
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=row symbol=A symbol=i ]
     ]
    
   DEFSubnode:atts= LET pos
    [Node list symbol=LET symbol=pos 
    
     [Node list symbol=position symbol=c 
     
      [Node list symbol=r symbol=Indices ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol=< symbol=pos symbol=minInd ]
      
      [Node list symbol=Sel symbol=D 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=qelt symbol=pos 
      
       [Node list symbol=r symbol=Entries ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF setelt! A i c d $ C D SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=row symbol=A symbol=i ]
     ]
    
   DEFSubnode:atts= LET pos
    [Node list symbol=LET symbol=pos 
    
     [Node list symbol=position symbol=c 
     
      [Node list symbol=r symbol=Indices ]
      ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol=>= symbol=pos symbol=minInd ]
     
     [Node list symbol=qsetelt! symbol=pos symbol=d 
     
      [Node list symbol=r symbol=Entries ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=j symbol=minInd ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=ind 
       
        [Node list symbol=r symbol=Indices ]
        ]
       
       [Node list symbol=WHILE 
       
        [Node list symbol=< symbol=c symbol=ind ]
        ]
       
       [Node list symbol=LET symbol=j 
       
        [Node list symbol=+ symbol=j 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=r symbol=Indices ]
       
       [Node list symbol=insert! symbol=c symbol=j 
       
        [Node list symbol=r symbol=Indices ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=r symbol=Entries ]
        
        [Node list symbol=insert! symbol=d symbol=j 
        
         [Node list symbol=r symbol=Entries ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= qsetelt! i r
    [Node list symbol=qsetelt! symbol=i symbol=r 
    
     [Node list symbol=A symbol=Rows ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce A $ SEQ
   DEFSubnode:atts= Matrix D
    [Node list symbol=Matrix symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951235 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? 
     
      [Node list symbol=A symbol=NCols ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951235 
     
      [Node list symbol=error string=cannot coerce matrix with zero columns ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=AA 
        
         [Node list symbol=Matrix symbol=D ]
         ]
        
        [Node list symbol=new 
        
         [Node list symbol=A symbol=NRows ]
         
         [Node list symbol=A symbol=NCols ]
         
         [Node list symbol=Sel symbol=D 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=r 
        
         [Node list symbol=entries 
         
          [Node list symbol=A symbol=Rows ]
          ]
         ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=minRowIndex symbol=AA ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=inds 
         
          [Node list symbol=r symbol=Indices ]
          ]
         
         [Node list symbol=LET symbol=ents 
         
          [Node list symbol=r symbol=Entries ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=ind 
           
            [Node list symbol=A symbol=AllInds ]
            ]
           
           [Node list symbol=IN symbol=j 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=minColIndex symbol=AA ]
             ]
            ]
           
           [Node list symbol=WHILE 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951236 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=inds ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951236 symbol=false symbol=true ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951237 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol== symbol=ind 
             
              [Node list symbol=first symbol=inds ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951237 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=qsetelt! symbol=AA symbol=i symbol=j 
               
                [Node list symbol=first symbol=ents ]
                ]
               
               [Node list symbol=LET symbol=inds 
               
                [Node list symbol=rest symbol=inds ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=ents 
                
                 [Node list symbol=rest symbol=ents ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=AA ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce A $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951238 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? 
     
      [Node list symbol=A symbol=NCols ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951238 
     
      [Node list symbol=:: 
      
       [Node list symbol=Sel symbol=D 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=:: symbol=A 
       
        [Node list symbol=Matrix symbol=D ]
        ]
       
       [Node list symbol=OutputForm ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF copy A $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resRows 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=new symbol=emptyRec 
     
      [Node list symbol=A symbol=NRows ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=l 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=A symbol=NRows ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=r 
      
       [Node list symbol=qelt symbol=l 
       
        [Node list symbol=A symbol=Rows ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=qsetelt! symbol=resRows symbol=l 
       
        [Node list symbol=construct 
        
         [Node list symbol=copy 
         
          [Node list symbol=r symbol=Indices ]
          ]
         
         [Node list symbol=copy 
         
          [Node list symbol=r symbol=Entries ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=resRows 
     
      [Node list symbol=A symbol=NCols ]
      
      [Node list symbol=A symbol=NRows ]
      
      [Node list symbol=copy 
      
       [Node list symbol=A symbol=AllInds ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF elimZeroCols! A $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=newInds 
     
      [Node list symbol=List symbol=C ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=r 
     
      [Node list symbol=entries 
      
       [Node list symbol=A symbol=Rows ]
       ]
      ]
     
     [Node list symbol=LET symbol=newInds 
     
      [Node list symbol=removeDuplicates! 
      
       [Node list symbol=merge! symbol=newInds 
       
        [Node list symbol=+-> 
        
         [Node list symbol=@Tuple symbol=x symbol=y ]
         
         [Node list symbol=< symbol=y symbol=x ]
         ]
        
        [Node list symbol=r symbol=Indices ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET newInds
    [Node list symbol=LET symbol=newInds 
    
     [Node list symbol=A symbol=AllInds ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF purge! A crit $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Mapping C
    [Node list symbol=Mapping symbol=C 
    
     [Node list symbol=Boolean ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=newInds 
     
      [Node list symbol=List symbol=C ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=A symbol=AllInds ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4951239 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=crit symbol=c ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4951239 symbol=noBranch 
       
        [Node list symbol=LET symbol=newInds 
        
         [Node list symbol=cons symbol=c symbol=newInds ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET newInds
    [Node list symbol=LET symbol=newInds 
    
     [Node list symbol=reverse! symbol=newInds ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4951241 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=# symbol=newInds ]
       
       [Node list symbol=# 
       
        [Node list symbol=A symbol=AllInds ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4951241 symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=newInds 
        
         [Node list symbol=A symbol=AllInds ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=l 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=One ]
            
            [Node list symbol=A symbol=NRows ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=r 
           
            [Node list symbol=qelt symbol=l 
            
             [Node list symbol=A symbol=Rows ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=newInds 
            
             [Node list symbol=List symbol=C ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=newEnts 
            
             [Node list symbol=List symbol=D ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=c 
            
             [Node list symbol=r symbol=Indices ]
             ]
            
            [Node list symbol=IN symbol=e 
            
             [Node list symbol=r symbol=Entries ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951240 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=crit symbol=c ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951240 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=newInds 
                
                 [Node list symbol=cons symbol=c symbol=newInds ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=newEnts 
                 
                  [Node list symbol=cons symbol=e symbol=newEnts ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=qsetelt! symbol=l 
            
             [Node list symbol=A symbol=Rows ]
             
             [Node list symbol=construct 
             
              [Node list symbol=reverse! symbol=newInds ]
              
              [Node list symbol=reverse! symbol=newEnts ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF sortedPurge! A crit $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Mapping C
    [Node list symbol=Mapping symbol=C 
    
     [Node list symbol=Boolean ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4951244 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=crit 
      
       [Node list symbol=first 
       
        [Node list symbol=A symbol=AllInds ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4951244 symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=REPEAT 
        
         [Node list symbol=WHILE 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4951242 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? 
            
             [Node list symbol=A symbol=AllInds ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4951242 symbol=false 
            
             [Node list symbol=crit 
             
              [Node list symbol=first 
              
               [Node list symbol=A symbol=AllInds ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=A symbol=AllInds ]
          
          [Node list symbol=rest 
          
           [Node list symbol=A symbol=AllInds ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=l 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=One ]
            
            [Node list symbol=A symbol=NRows ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=r 
           
            [Node list symbol=qelt symbol=l 
            
             [Node list symbol=A symbol=Rows ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=WHILE 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4951243 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? 
               
                [Node list symbol=r symbol=Indices ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4951243 symbol=false 
               
                [Node list symbol=crit 
                
                 [Node list symbol=first 
                 
                  [Node list symbol=r symbol=Indices ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=r symbol=Indices ]
              
              [Node list symbol=rest 
              
               [Node list symbol=r symbol=Indices ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET 
              
               [Node list symbol=r symbol=Entries ]
               
               [Node list symbol=rest 
               
                [Node list symbol=r symbol=Entries ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=qsetelt! symbol=l symbol=r 
            
             [Node list symbol=A symbol=Rows ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF deleteRow! A i $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951245 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=> symbol=i 
     
      [Node list symbol=A symbol=NRows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951245 symbol=A 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=nr 
       
        [Node list symbol=:: 
        
         [Node list symbol=- 
         
          [Node list symbol=A symbol=NRows ]
          
          [Node list symbol=One ]
          ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=resRows 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=Indices 
           
            [Node list symbol=List symbol=C ]
            ]
           
           [Node list symbol=: symbol=Entries 
           
            [Node list symbol=List symbol=D ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=new symbol=nr symbol=emptyRec ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=l 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=- symbol=i 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        
        [Node list symbol=qsetelt! symbol=resRows symbol=l 
        
         [Node list symbol=qelt symbol=l 
         
          [Node list symbol=A symbol=Rows ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=l 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=+ symbol=i 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=A symbol=NRows ]
          ]
         ]
        
        [Node list symbol=qsetelt! symbol=resRows 
        
         [Node list symbol=- symbol=l 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=qelt symbol=l 
         
          [Node list symbol=A symbol=Rows ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=nr 
       
        [Node list symbol=A symbol=NRows ]
        ]
       
       [Node list symbol=LET symbol=resRows 
       
        [Node list symbol=A symbol=Rows ]
        ]
       
       [Node list symbol=exit int=1 symbol=void ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF consRow! A r $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=A symbol=NRows ]
     
     [Node list symbol=+ 
     
      [Node list symbol=A symbol=NRows ]
      
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newRows 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=cons symbol=r 
     
      [Node list symbol=entries 
      
       [Node list symbol=A symbol=Rows ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=A symbol=Rows ]
     
     [Node list symbol=construct symbol=newRows ]
     ]
    
   DEFSubnode:atts= LET newInds
    [Node list symbol=LET symbol=newInds 
    
     [Node list symbol=setDifference 
     
      [Node list symbol=r symbol=Indices ]
      
      [Node list symbol=A symbol=AllInds ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4951246 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=newInds ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4951246 symbol=noBranch 
      
       [Node list symbol=LET 
       
        [Node list symbol=A symbol=AllInds ]
        
        [Node list symbol=merge 
        
         [Node list symbol=+-> 
         
          [Node list symbol=@Tuple symbol=x symbol=y ]
          
          [Node list symbol=< symbol=y symbol=x ]
          ]
         
         [Node list symbol=A symbol=AllInds ]
         
         [Node list symbol=sort! symbol=newInds 
         
          [Node list symbol=+-> 
          
           [Node list symbol=@Tuple symbol=x symbol=y ]
           
           [Node list symbol=< symbol=y symbol=x ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF appendRow! A r $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=A symbol=NRows ]
     
     [Node list symbol=+ 
     
      [Node list symbol=A symbol=NRows ]
      
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newRows 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=r 
     
      [Node list symbol=entries 
      
       [Node list symbol=A symbol=Rows ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=A symbol=Rows ]
     
     [Node list symbol=construct symbol=newRows ]
     ]
    
   DEFSubnode:atts= LET newInds
    [Node list symbol=LET symbol=newInds 
    
     [Node list symbol=setDifference 
     
      [Node list symbol=r symbol=Indices ]
      
      [Node list symbol=A symbol=AllInds ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4951247 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=newInds ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4951247 symbol=noBranch 
      
       [Node list symbol=LET 
       
        [Node list symbol=A symbol=AllInds ]
        
        [Node list symbol=merge 
        
         [Node list symbol=+-> 
         
          [Node list symbol=@Tuple symbol=x symbol=y ]
          
          [Node list symbol=< symbol=y symbol=x ]
          ]
         
         [Node list symbol=A symbol=AllInds ]
         
         [Node list symbol=sort! symbol=newInds 
         
          [Node list symbol=+-> 
          
           [Node list symbol=@Tuple symbol=x symbol=y ]
           
           [Node list symbol=< symbol=y symbol=x ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF extract A i1 i2 $ $ SEQ
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET nr
    [Node list symbol=LET symbol=nr 
    
     [Node list symbol=:: 
     
      [Node list symbol=+ 
      
       [Node list symbol=- symbol=i2 symbol=i1 ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resRows 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=new symbol=nr symbol=emptyRec ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=newInds 
     
      [Node list symbol=List symbol=C ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=i1 symbol=i2 ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=qsetelt! symbol=resRows 
      
       [Node list symbol=+ 
       
        [Node list symbol=- symbol=i symbol=i1 ]
        
        [Node list symbol=One ]
        ]
       
       [Node list symbol=row symbol=A symbol=i ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newInds 
       
        [Node list symbol=removeDuplicates! 
        
         [Node list symbol=merge symbol=newInds 
         
          [Node list symbol=+-> 
          
           [Node list symbol=@Tuple symbol=x symbol=y ]
           
           [Node list symbol=< symbol=y symbol=x ]
           ]
          
          [Node list symbol=Indices 
          
           [Node list symbol=row symbol=A symbol=i ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=nr symbol=newInds symbol=resRows 
     
      [Node list symbol=A symbol=NCols ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF join A1 A2 $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET newInds
    [Node list symbol=LET symbol=newInds 
    
     [Node list symbol=removeDuplicates! 
     
      [Node list symbol=merge 
      
       [Node list symbol=+-> 
       
        [Node list symbol=: 
        
         [Node list symbol=@Tuple 
         
          [Node list symbol=: symbol=x symbol=C ]
          
          [Node list symbol=: symbol=y symbol=C ]
          ]
         
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=< symbol=y symbol=x ]
        ]
       
       [Node list symbol=A1 symbol=AllInds ]
       
       [Node list symbol=A2 symbol=AllInds ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET newNRows
    [Node list symbol=LET symbol=newNRows 
    
     [Node list symbol=+ 
     
      [Node list symbol=A1 symbol=NRows ]
      
      [Node list symbol=A2 symbol=NRows ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newRows 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=C ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=new symbol=newNRows symbol=emptyRec ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=l 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=A1 symbol=NRows ]
       ]
      ]
     
     [Node list symbol=qsetelt! symbol=newRows symbol=l 
     
      [Node list symbol=qelt symbol=l 
      
       [Node list symbol=A1 symbol=Rows ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=l 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=A2 symbol=NRows ]
       ]
      ]
     
     [Node list symbol=qsetelt! symbol=newRows 
     
      [Node list symbol=+ symbol=l 
      
       [Node list symbol=A1 symbol=NRows ]
       ]
      
      [Node list symbol=qelt symbol=l 
      
       [Node list symbol=A2 symbol=Rows ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newNRows symbol=newInds symbol=newRows 
     
      [Node list symbol=# symbol=newInds ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF horizJoin A1 A2 $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951248 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= 
     
      [Node list symbol=A1 symbol=NRows ]
      
      [Node list symbol=A2 symbol=NRows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951248 
     
      [Node list symbol=error string=incompatible dimensions in horizJoin ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=newInds 
       
        [Node list symbol=append 
        
         [Node list symbol=A1 symbol=AllInds ]
         
         [Node list symbol=A2 symbol=AllInds ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res symbol=$ ]
        
        [Node list symbol=new symbol=newInds 
        
         [Node list symbol=A1 symbol=NRows ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=A1 symbol=NRows ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=r1 
         
          [Node list symbol=row symbol=A1 symbol=i ]
          ]
         
         [Node list symbol=LET symbol=r2 
         
          [Node list symbol=row symbol=A2 symbol=i ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=setRow! symbol=res symbol=i 
          
           [Node list symbol=append 
           
            [Node list symbol=r1 symbol=Indices ]
            
            [Node list symbol=r2 symbol=Indices ]
            ]
           
           [Node list symbol=append 
           
            [Node list symbol=r1 symbol=Entries ]
            
            [Node list symbol=r2 symbol=Entries ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF horizSplit A c $ C SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Left symbol=$ ]
     
     [Node list symbol=: symbol=Right symbol=$ ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rinds 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=allIndices symbol=A ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=linds 
     
      [Node list symbol=List symbol=C ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951249 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=rinds ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951249 symbol=false 
        
         [Node list symbol=> symbol=c 
         
          [Node list symbol=first symbol=rinds ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=linds 
      
       [Node list symbol=cons symbol=linds 
       
        [Node list symbol=first symbol=rinds ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=rinds 
       
        [Node list symbol=rest symbol=rinds ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951250 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=linds ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951250 
     
      [Node list symbol=construct symbol=A 
      
       [Node list symbol=new symbol=linds 
       
        [Node list symbol=A symbol=NRows ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=linds 
       
        [Node list symbol=reverse! symbol=linds ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951251 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=rinds ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951251 
        
         [Node list symbol=construct symbol=A 
         
          [Node list symbol=new symbol=rinds 
          
           [Node list symbol=A symbol=NRows ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=LA symbol=$ ]
           
           [Node list symbol=new symbol=linds 
           
            [Node list symbol=A symbol=NRows ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=RA symbol=$ ]
           
           [Node list symbol=new symbol=rinds 
           
            [Node list symbol=A symbol=NRows ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=One ]
             
             [Node list symbol=A symbol=NRows ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=r 
            
             [Node list symbol=row symbol=A symbol=i ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=ri 
             
              [Node list symbol=List symbol=C ]
              ]
             
             [Node list symbol=r symbol=Indices ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=re 
             
              [Node list symbol=List symbol=D ]
              ]
             
             [Node list symbol=r symbol=Entries ]
             ]
            
            [Node list symbol=LET symbol=empty 
            
             [Node list symbol=: symbol=li 
             
              [Node list symbol=List symbol=C ]
              ]
             ]
            
            [Node list symbol=LET symbol=empty 
            
             [Node list symbol=: symbol=le 
             
              [Node list symbol=List symbol=D ]
              ]
             ]
            
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4951252 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=ri ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4951252 symbol=false 
                
                 [Node list symbol=> symbol=c 
                 
                  [Node list symbol=first symbol=ri ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=li 
              
               [Node list symbol=cons symbol=li 
               
                [Node list symbol=first symbol=ri ]
                ]
               ]
              
              [Node list symbol=LET symbol=le 
              
               [Node list symbol=cons symbol=le 
               
                [Node list symbol=first symbol=re ]
                ]
               ]
              
              [Node list symbol=LET symbol=ri 
              
               [Node list symbol=rest symbol=ri ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=re 
               
                [Node list symbol=rest symbol=re ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951253 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=li ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951253 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=li 
                
                 [Node list symbol=reverse! symbol=li ]
                 ]
                
                [Node list symbol=LET symbol=le 
                
                 [Node list symbol=reverse! symbol=le ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=setRow! symbol=LA symbol=i symbol=li symbol=le ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951254 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=ri ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951254 symbol=noBranch 
             
              [Node list symbol=setRow! symbol=RA symbol=i symbol=ri symbol=re ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=construct symbol=LA symbol=RA ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addRows d1 r1 d2 r2 D D SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951256 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=r1 symbol=Indices ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951256 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951255 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? symbol=d2 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951255 symbol=r2 
        
         [Node list symbol=construct 
         
          [Node list symbol=r2 symbol=Indices ]
          
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=e2 
           
            [Node list symbol=r2 symbol=Entries ]
            ]
           
           [Node list symbol=* symbol=d2 symbol=e2 ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951258 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? 
        
         [Node list symbol=r2 symbol=Indices ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951258 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4951257 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=one? symbol=d1 ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4951257 symbol=r1 
           
            [Node list symbol=construct 
            
             [Node list symbol=r1 symbol=Indices ]
             
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=e1 
              
               [Node list symbol=r1 symbol=Entries ]
               ]
              
              [Node list symbol=* symbol=d1 symbol=e1 ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resI 
           
            [Node list symbol=List symbol=C ]
            ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resE 
           
            [Node list symbol=List symbol=D ]
            ]
           ]
          
          [Node list symbol=: symbol=lent1 
          
           [Node list symbol=List symbol=D ]
           ]
          
          [Node list symbol=: symbol=lent2 
          
           [Node list symbol=List symbol=D ]
           ]
          
          [Node list symbol=IF symbol=noChecks? 
          
           [Node list symbol=LET symbol=lent1 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=e1 
             
              [Node list symbol=r1 symbol=Entries ]
              ]
             
             [Node list symbol=* symbol=d1 symbol=e1 ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951259 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=one? symbol=d1 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951259 
             
              [Node list symbol=LET symbol=lent1 
              
               [Node list symbol=r1 symbol=Entries ]
               ]
              
              [Node list symbol=LET symbol=lent1 
              
               [Node list symbol=COLLECT 
               
                [Node list symbol=IN symbol=e1 
                
                 [Node list symbol=r1 symbol=Entries ]
                 ]
                
                [Node list symbol=* symbol=d1 symbol=e1 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=IF symbol=noChecks? 
          
           [Node list symbol=LET symbol=lent2 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=e2 
             
              [Node list symbol=r2 symbol=Entries ]
              ]
             
             [Node list symbol=* symbol=d2 symbol=e2 ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951260 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=one? symbol=d2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951260 
             
              [Node list symbol=LET symbol=lent2 
              
               [Node list symbol=copy 
               
                [Node list symbol=r2 symbol=Entries ]
                ]
               ]
              
              [Node list symbol=LET symbol=lent2 
              
               [Node list symbol=COLLECT 
               
                [Node list symbol=IN symbol=e2 
                
                 [Node list symbol=r2 symbol=Entries ]
                 ]
                
                [Node list symbol=* symbol=d2 symbol=e2 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=lind2 
          
           [Node list symbol=copy 
           
            [Node list symbol=r2 symbol=Indices ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=c1 
           
            [Node list symbol=r1 symbol=Indices ]
            ]
           
           [Node list symbol=IN symbol=e1 symbol=lent1 ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4951261 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=lind2 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4951261 symbol=false 
                
                 [Node list symbol=< symbol=c1 
                 
                  [Node list symbol=first symbol=lind2 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=resI 
              
               [Node list symbol=cons symbol=resI 
               
                [Node list symbol=first symbol=lind2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=resE 
              
               [Node list symbol=cons symbol=resE 
               
                [Node list symbol=first symbol=lent2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=lind2 
              
               [Node list symbol=rest symbol=lind2 ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=lent2 
               
                [Node list symbol=rest symbol=lent2 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951262 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=lind2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951262 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=resI 
               
                [Node list symbol=cons symbol=c1 symbol=resI ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=resE 
                
                 [Node list symbol=cons symbol=e1 symbol=resE ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G4951264 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol== symbol=c1 
                
                 [Node list symbol=first symbol=lind2 ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G4951264 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=sum 
                  
                   [Node list symbol=+ symbol=e1 
                   
                    [Node list symbol=first symbol=lent2 ]
                    ]
                   ]
                  
                  [Node list symbol=IF symbol=noChecks? 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=resI 
                    
                     [Node list symbol=cons symbol=c1 symbol=resI ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=resE 
                     
                      [Node list symbol=cons symbol=sum symbol=resE ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G4951263 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=zero? symbol=sum ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G4951263 symbol=noBranch 
                     
                      [Node list symbol=SEQ 
                      
                       [Node list symbol=LET symbol=resI 
                       
                        [Node list symbol=cons symbol=c1 symbol=resI ]
                        ]
                       
                       [Node list symbol=exit int=1 
                       
                        [Node list symbol=LET symbol=resE 
                        
                         [Node list symbol=cons symbol=sum symbol=resE ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=lind2 
                  
                   [Node list symbol=rest symbol=lind2 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=lent2 
                   
                    [Node list symbol=rest symbol=lent2 ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=resI 
                  
                   [Node list symbol=cons symbol=c1 symbol=resI ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=resE 
                   
                    [Node list symbol=cons symbol=e1 symbol=resE ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=resI 
          
           [Node list symbol=concat! symbol=lind2 
           
            [Node list symbol=reverse! symbol=resI ]
            ]
           ]
          
          [Node list symbol=LET symbol=resE 
          
           [Node list symbol=concat! symbol=lent2 
           
            [Node list symbol=reverse! symbol=resE ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=WHILE 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951265 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=resE ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951265 symbol=false 
              
               [Node list symbol=zero? 
               
                [Node list symbol=first symbol=resE ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=resI 
            
             [Node list symbol=rest symbol=resI ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=resE 
             
              [Node list symbol=rest symbol=resE ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=construct symbol=resI symbol=resE ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF pivot A i $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Index symbol=C ]
     
     [Node list symbol=: symbol=Entry symbol=D ]
     ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET r
    [Node list symbol=LET symbol=r 
    
     [Node list symbol=row symbol=A symbol=i ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951266 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=r symbol=Indices ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951266 
     
      [Node list symbol=error string=empty row ]
      
      [Node list symbol=construct 
      
       [Node list symbol=first 
       
        [Node list symbol=r symbol=Indices ]
        ]
       
       [Node list symbol=first 
       
        [Node list symbol=r symbol=Entries ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF pivots A $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Indices 
     
      [Node list symbol=List symbol=C ]
      ]
     
     [Node list symbol=: symbol=Entries 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resI 
     
      [Node list symbol=List symbol=C ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resE 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=r 
     
      [Node list symbol=entries 
      
       [Node list symbol=A symbol=Rows ]
       ]
      ]
     
     [Node list symbol=| 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4951267 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? 
        
         [Node list symbol=r symbol=Indices ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4951267 symbol=false symbol=true ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=resI 
      
       [Node list symbol=cons symbol=resI 
       
        [Node list symbol=first 
        
         [Node list symbol=r symbol=Indices ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=resE 
       
        [Node list symbol=cons symbol=resE 
        
         [Node list symbol=first 
         
          [Node list symbol=r symbol=Entries ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=resI ]
      
      [Node list symbol=reverse! symbol=resE ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF rowEchelon AA $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Ech symbol=$ ]
     
     [Node list symbol=: symbol=Lt 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     
     [Node list symbol=: symbol=Pivots 
     
      [Node list symbol=List symbol=D ]
      ]
     
     [Node list symbol=: symbol=Rank 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET A
    [Node list symbol=LET symbol=A 
    
     [Node list symbol=copy symbol=AA ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=LTr 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     
     [Node list symbol=diagonalMatrix 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=A symbol=NRows ]
         ]
        ]
       
       [Node list symbol=Sel symbol=D 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=Pivs 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=A symbol=NRows ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=r 
      
       [Node list symbol=qelt symbol=i 
       
        [Node list symbol=A symbol=Rows ]
        ]
       ]
      
      [Node list symbol=LET symbol=false 
      
       [Node list symbol=: symbol=changed? 
       
        [Node list symbol=Boolean ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=WHILE 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4951268 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? 
          
           [Node list symbol=r symbol=Entries ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4951268 symbol=false 
          
           [Node list symbol=zero? 
           
            [Node list symbol=first 
            
             [Node list symbol=r symbol=Entries ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=r symbol=Entries ]
         
         [Node list symbol=rest 
         
          [Node list symbol=r symbol=Entries ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=r symbol=Indices ]
         
         [Node list symbol=rest 
         
          [Node list symbol=r symbol=Indices ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=changed? symbol=true ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=changed? symbol=noBranch 
       
        [Node list symbol=qsetelt! symbol=i symbol=r 
        
         [Node list symbol=A symbol=Rows ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET false
    [Node list symbol=LET symbol=false 
    
     [Node list symbol=: symbol=sorted? 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=UNTIL symbol=sorted? ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=sorted? symbol=true ]
      
      [Node list symbol=LET symbol=oldr 
      
       [Node list symbol=qelt 
       
        [Node list symbol=A symbol=Rows ]
        
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT int=2 
         
          [Node list symbol=A symbol=NRows ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=newr 
         
          [Node list symbol=qelt symbol=i 
          
           [Node list symbol=A symbol=Rows ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4951269 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=greater symbol=newr symbol=oldr ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4951269 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=qsetelt! symbol=i symbol=oldr 
            
             [Node list symbol=A symbol=Rows ]
             ]
            
            [Node list symbol=qsetelt! symbol=newr 
            
             [Node list symbol=A symbol=Rows ]
             
             [Node list symbol=- symbol=i 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=swapRows! symbol=LTr symbol=i 
            
             [Node list symbol=- symbol=i 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=sorted? symbol=false ]
             ]
            ]
           
           [Node list symbol=LET symbol=oldr symbol=newr ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET false
    [Node list symbol=LET symbol=false 
    
     [Node list symbol=: symbol=finished? 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=pivlen symbol=pivrow symbol=rk ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=A symbol=NRows ]
       ]
      ]
     
     [Node list symbol=UNTIL symbol=finished? ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=r 
      
       [Node list symbol=qelt symbol=i 
       
        [Node list symbol=A symbol=Rows ]
        ]
       ]
      
      [Node list symbol=LET symbol=finished? 
      
       [Node list symbol=empty? 
       
        [Node list symbol=r symbol=Indices ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=finished? 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=rk 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=- symbol=i 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=pivind 
         
          [Node list symbol=first 
          
           [Node list symbol=r symbol=Indices ]
           ]
          ]
         
         [Node list symbol=LET symbol=pivlen 
         
          [Node list symbol=# 
          
           [Node list symbol=r symbol=Indices ]
           ]
          ]
         
         [Node list symbol=LET symbol=pivrow symbol=i ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=k 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=Zero ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=+ symbol=i 
            
             [Node list symbol=One ]
             ]
            
            [Node list symbol=A symbol=NRows ]
            ]
           ]
          
          [Node list symbol=WHILE 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G4951270 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? 
             
              [Node list symbol=Indices 
              
               [Node list symbol=qelt symbol=j 
               
                [Node list symbol=A symbol=Rows ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G4951270 symbol=false 
             
              [Node list symbol== symbol=pivind 
              
               [Node list symbol=first 
               
                [Node list symbol=Indices 
                
                 [Node list symbol=qelt symbol=j 
                 
                  [Node list symbol=A symbol=Rows ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=len 
           
            [Node list symbol=# 
            
             [Node list symbol=Indices 
             
              [Node list symbol=qelt symbol=j 
              
               [Node list symbol=A symbol=Rows ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=k 
           
            [Node list symbol=+ symbol=k 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol=< symbol=len symbol=pivlen ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=pivlen symbol=len ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=pivrow symbol=j ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=piv symbol=D ]
          
          [Node list symbol=first 
          
           [Node list symbol=Entries 
           
            [Node list symbol=qelt symbol=pivrow 
            
             [Node list symbol=A symbol=Rows ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=Pivs 
         
          [Node list symbol=cons symbol=piv symbol=Pivs ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=noBranch 
          
           [Node list symbol=> symbol=k 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951271 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=~= symbol=pivrow symbol=i ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951271 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=pr 
                
                 [Node list symbol=qelt symbol=pivrow 
                 
                  [Node list symbol=A symbol=Rows ]
                  ]
                 ]
                
                [Node list symbol=qsetelt! symbol=pivrow 
                
                 [Node list symbol=A symbol=Rows ]
                 
                 [Node list symbol=qelt symbol=i 
                 
                  [Node list symbol=A symbol=Rows ]
                  ]
                 ]
                
                [Node list symbol=qsetelt! symbol=i symbol=pr 
                
                 [Node list symbol=A symbol=Rows ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=swapRows! symbol=LTr symbol=i symbol=pivrow ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=pr 
            
             [Node list symbol=copy 
             
              [Node list symbol=qelt symbol=i 
              
               [Node list symbol=A symbol=Rows ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=pr symbol=Indices ]
             
             [Node list symbol=rest 
             
              [Node list symbol=pr symbol=Indices ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=pr symbol=Entries ]
             
             [Node list symbol=rest 
             
              [Node list symbol=pr symbol=Entries ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=j 
              
               [Node list symbol=SEGMENT 
               
                [Node list symbol=+ symbol=i 
                
                 [Node list symbol=One ]
                 ]
                
                [Node list symbol=+ symbol=i symbol=k ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=r 
               
                [Node list symbol=copy 
                
                 [Node list symbol=qelt 
                 
                  [Node list symbol=A symbol=Rows ]
                  
                  [Node list symbol=+ symbol=i 
                  
                   [Node list symbol=One ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=c 
               
                [Node list symbol=first 
                
                 [Node list symbol=r symbol=Entries ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=r symbol=Indices ]
                
                [Node list symbol=rest 
                
                 [Node list symbol=r symbol=Indices ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=r symbol=Entries ]
                
                [Node list symbol=rest 
                
                 [Node list symbol=r symbol=Entries ]
                 ]
                ]
               
               [Node list symbol=LET symbol=r 
               
                [Node list symbol=addRows symbol=piv symbol=r symbol=pr 
                
                 [Node list symbol=- symbol=c ]
                 ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=l 
                
                 [Node list symbol=SEGMENT 
                 
                  [Node list symbol=One ]
                  
                  [Node list symbol=A symbol=NRows ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=f 
                 
                  [Node list symbol=- 
                  
                   [Node list symbol=* symbol=piv 
                   
                    [Node list symbol=qelt symbol=LTr symbol=l 
                    
                     [Node list symbol=+ symbol=i 
                     
                      [Node list symbol=One ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=* symbol=c 
                   
                    [Node list symbol=qelt symbol=LTr symbol=i symbol=l ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=qsetelt! symbol=LTr symbol=l symbol=f 
                  
                   [Node list symbol=+ symbol=i 
                   
                    [Node list symbol=One ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=l 
                
                 [Node list symbol=SEGMENT 
                 
                  [Node list symbol=+ symbol=i int=2 ]
                  
                  [Node list symbol=- symbol=j 
                  
                   [Node list symbol=+ 
                   
                    [Node list symbol=+ symbol=k 
                    
                     [Node list symbol=* int=2 symbol=i ]
                     ]
                    
                    [Node list symbol=One ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=qsetelt! 
                 
                  [Node list symbol=A symbol=Rows ]
                  
                  [Node list symbol=- symbol=l 
                  
                   [Node list symbol=One ]
                   ]
                  
                  [Node list symbol=qelt symbol=l 
                  
                   [Node list symbol=A symbol=Rows ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=swapRows! symbol=LTr symbol=l 
                  
                   [Node list symbol=- symbol=l 
                   
                    [Node list symbol=One ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=l 
                
                 [Node list symbol=SEGMENT 
                 
                  [Node list symbol=- symbol=j 
                  
                   [Node list symbol=+ int=2 
                   
                    [Node list symbol=+ symbol=k 
                    
                     [Node list symbol=* int=2 symbol=i ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=A symbol=NRows ]
                  ]
                 ]
                
                [Node list symbol=WHILE 
                
                 [Node list symbol=greater symbol=r 
                 
                  [Node list symbol=qelt symbol=l 
                  
                   [Node list symbol=A symbol=Rows ]
                   ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=qsetelt! 
                 
                  [Node list symbol=A symbol=Rows ]
                  
                  [Node list symbol=- symbol=l 
                  
                   [Node list symbol=One ]
                   ]
                  
                  [Node list symbol=qelt symbol=l 
                  
                   [Node list symbol=A symbol=Rows ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=swapRows! symbol=LTr symbol=l 
                  
                   [Node list symbol=- symbol=l 
                   
                    [Node list symbol=One ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=qsetelt! symbol=r 
                
                 [Node list symbol=A symbol=Rows ]
                 
                 [Node list symbol=- symbol=l 
                 
                  [Node list symbol=One ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF finished? noBranch
    [Node list symbol=IF symbol=finished? symbol=noBranch 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=rk 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=A symbol=NRows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=A symbol=LTr symbol=Pivs symbol=rk ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * LM AA $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Matrix D
    [Node list symbol=Matrix symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4951289 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= 
     
      [Node list symbol=ncols symbol=LM ]
      
      [Node list symbol=AA symbol=NRows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4951289 
     
      [Node list symbol=error string=improper matrix dimensions ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=A 
       
        [Node list symbol=copy symbol=AA ]
        ]
       
       [Node list symbol=LET symbol=rlen 
       
        [Node list symbol=nrows symbol=LM ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res symbol=$ ]
        
        [Node list symbol=new symbol=rlen 
        
         [Node list symbol=A symbol=AllInds ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=A symbol=AllInds ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=tmp 
          
           [Node list symbol=Vector symbol=D ]
           ]
          
          [Node list symbol=new symbol=rlen 
          
           [Node list symbol=Sel symbol=D 
           
            [Node list symbol=Zero ]
            ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=One ]
            
            [Node list symbol=A symbol=NRows ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=r 
           
            [Node list symbol=qelt symbol=i 
            
             [Node list symbol=A symbol=Rows ]
             ]
            ]
           
           [Node list symbol=LET symbol=inds 
           
            [Node list symbol=r symbol=Indices ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4951290 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=inds ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4951290 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4951292 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol== symbol=c 
               
                [Node list symbol=first symbol=inds ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4951292 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=REPEAT 
                 
                  [Node list symbol=IN symbol=k 
                  
                   [Node list symbol=SEGMENT symbol=rlen 
                   
                    [Node list symbol=One ]
                    ]
                   ]
                  
                  [Node list symbol=| 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G4951291 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=zero? 
                     
                      [Node list symbol=qelt symbol=LM symbol=k symbol=i ]
                      ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G4951291 symbol=false symbol=true ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=qsetelt! symbol=tmp symbol=k 
                  
                   [Node list symbol=+ 
                   
                    [Node list symbol=qelt symbol=tmp symbol=k ]
                    
                    [Node list symbol=* 
                    
                     [Node list symbol=qelt symbol=LM symbol=k symbol=i ]
                     
                     [Node list symbol=first 
                     
                      [Node list symbol=r symbol=Entries ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=r symbol=Entries ]
                  
                  [Node list symbol=rest 
                  
                   [Node list symbol=r symbol=Entries ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=r symbol=Indices ]
                  
                  [Node list symbol=rest symbol=inds ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=qsetelt! symbol=i symbol=r 
                  
                   [Node list symbol=A symbol=Rows ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=k 
           
            [Node list symbol=SEGMENT symbol=rlen 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=| 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4951293 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=zero? 
              
               [Node list symbol=qelt symbol=tmp symbol=k ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4951293 symbol=false symbol=true ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=r 
            
             [Node list symbol=qelt symbol=k 
             
              [Node list symbol=res symbol=Rows ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=r symbol=Indices ]
             
             [Node list symbol=cons symbol=c 
             
              [Node list symbol=r symbol=Indices ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=r symbol=Entries ]
             
             [Node list symbol=cons 
             
              [Node list symbol=qelt symbol=tmp symbol=k ]
              
              [Node list symbol=r symbol=Entries ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=qsetelt! symbol=k symbol=r 
             
              [Node list symbol=res symbol=Rows ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=k 
        
         [Node list symbol=SEGMENT symbol=rlen 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=r 
         
          [Node list symbol=qelt symbol=k 
          
           [Node list symbol=res symbol=Rows ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=r symbol=Indices ]
          
          [Node list symbol=reverse! 
          
           [Node list symbol=r symbol=Indices ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=r symbol=Entries ]
          
          [Node list symbol=reverse! 
          
           [Node list symbol=r symbol=Entries ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=qsetelt! symbol=k symbol=r 
          
           [Node list symbol=res symbol=Rows ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=CoercibleTo 
   
    [Node list symbol=OutputForm ]
    ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=ATTRIBUTE 
    
     [Node list symbol=shallowlyMutable ]
     ]
    
    [Node list symbol=ATTRIBUTE 
    
     [Node list symbol=finiteAggregate ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=copy 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ncols 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=nrows 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=allIndices 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=C ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=elimZeroCols! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=purge! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Mapping symbol=C 
      
       [Node list symbol=Boolean ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=sortedPurge! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Mapping symbol=C 
      
       [Node list symbol=Boolean ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=new 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=C ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=elt 
    
     [Node list symbol=D symbol=$ symbol=C 
     
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=setelt! 
    
     [Node list symbol=$ symbol=C symbol=D 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=row 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Indices 
       
        [Node list symbol=List symbol=C ]
        ]
       
       [Node list symbol=: symbol=Entries 
       
        [Node list symbol=List symbol=D ]
        ]
       ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=setRow! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Integer ]
      
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Indices 
       
        [Node list symbol=List symbol=C ]
        ]
       
       [Node list symbol=: symbol=Entries 
       
        [Node list symbol=List symbol=D ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=setRow! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Integer ]
      
      [Node list symbol=List symbol=C ]
      
      [Node list symbol=List symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=deleteRow! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=consRow! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Indices 
       
        [Node list symbol=List symbol=C ]
        ]
       
       [Node list symbol=: symbol=Entries 
       
        [Node list symbol=List symbol=D ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=appendRow! 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Indices 
       
        [Node list symbol=List symbol=C ]
        ]
       
       [Node list symbol=: symbol=Entries 
       
        [Node list symbol=List symbol=D ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=extract 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Integer ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=rowEchelon 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Ech symbol=$ ]
       
       [Node list symbol=: symbol=Lt 
       
        [Node list symbol=Matrix symbol=D ]
        ]
       
       [Node list symbol=: symbol=Pivots 
       
        [Node list symbol=List symbol=D ]
        ]
       
       [Node list symbol=: symbol=Rank 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=D 
     
      [Node list symbol=GcdDomain ]
      ]
     
     [Node list symbol=PROGN 
     
      [Node list symbol=SIGNATURE symbol=setGcdMode 
      
       [Node list 
       
        [Node list symbol=Symbol ]
        
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=SIGNATURE symbol=primitiveRowEchelon 
      
       [Node list symbol=$ 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Ech symbol=$ ]
         
         [Node list symbol=: symbol=Lt 
         
          [Node list symbol=Matrix 
          
           [Node list symbol=Fraction symbol=D ]
           ]
          ]
         
         [Node list symbol=: symbol=Pivots 
         
          [Node list symbol=List symbol=D ]
          ]
         
         [Node list symbol=: symbol=Rank 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=pivot 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Index symbol=C ]
       
       [Node list symbol=: symbol=Entry symbol=D ]
       ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=pivots 
    
     [Node list symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Indices 
       
        [Node list symbol=List symbol=C ]
        ]
       
       [Node list symbol=: symbol=Entries 
       
        [Node list symbol=List symbol=D ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     ]
    
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=D 
     
      [Node list symbol=IntegralDomain ]
      ]
     
     [Node list symbol=SIGNATURE symbol=* 
     
      [Node list symbol=$ symbol=$ 
      
       [Node list symbol=Matrix 
       
        [Node list symbol=Fraction symbol=D ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=join 
    
     [Node list symbol=$ symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=horizJoin 
    
     [Node list symbol=$ symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=horizSplit 
    
     [Node list symbol=$ symbol=C 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Left symbol=$ ]
       
       [Node list symbol=: symbol=Right symbol=$ ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= OrderedSet
  [Node list symbol=OrderedSet ]
  
 DEFSubnode:atts= Ring
  [Node list symbol=Ring ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetBundle IVar DVar
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=MDEF string=Improper multi-index 
   
    [Node list symbol=errmsg1 ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=MDEF string=Improper upper index 
   
    [Node list symbol=errmsg2 ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=MDEF string=illegal symbol in JetBundle 
   
    [Node list symbol=errmsg4 ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=# symbol=IVar ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mm 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=# symbol=DVar ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=nameX 
   
    [Node list symbol=IVar 
    
     [Node list symbol=Sel symbol=construct 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=nameU 
   
    [Node list symbol=DVar 
    
     [Node list symbol=Sel symbol=construct 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
  CAPSULEDef:
   [DEF setNotation s SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=print 
     
      [Node list symbol=OutputForm ]
      ]
     
     [Node list symbol=message string=only repeated index notation possible ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=QUOTE symbol=Repeated ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF getNotation QUOTE Repeated
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF multiIndex jv $ :: Rep
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= copy
    [Node list symbol=copy 
    
     [Node list symbol=rest 
     
      [Node list symbol=rest symbol=jv ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF index jv $ ::
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= first
    [Node list symbol=first 
    
     [Node list symbol=rest symbol=jv ]
     ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   ]
   
  CAPSULEDef:
   [DEF type jv $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET t
    [Node list symbol=LET symbol=t 
    
     [Node list symbol=first symbol=jv ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4954883 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=t ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4954883 
     
      [Node list symbol=QUOTE symbol=Const ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4954884 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? symbol=t ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4954884 
        
         [Node list symbol=QUOTE symbol=Indep ]
         
         [Node list symbol=IF 
         
          [Node list symbol== symbol=t int=2 ]
          
          [Node list symbol=QUOTE symbol=Dep ]
          
          [Node list symbol=QUOTE symbol=Deriv ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF CheckZeroIndex il SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i symbol=il ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4954885 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? symbol=i ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4954885 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 true
    [Node list symbol=exit int=1 symbol=true ]
    
   ]
   
  CAPSULEDef:
   [DEF X up $ IF
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > up nn
    [Node list symbol=> symbol=up symbol=nn ]
    
   DEFSubnode:atts= error errmsg2
    [Node list symbol=error symbol=errmsg2 ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=One ]
     
     [Node list symbol=:: symbol=up 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF U up $ IF
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > up mm
    [Node list symbol=> symbol=up symbol=mm ]
    
   DEFSubnode:atts= error errmsg2
    [Node list symbol=error symbol=errmsg2 ]
    
   DEFSubnode:atts= cons 2
    [Node list symbol=cons int=2 
    
     [Node list symbol=cons 
     
      [Node list symbol=:: symbol=up 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=nn 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=Sel 
       
        [Node list symbol=NonNegativeInteger ]
        
        [Node list symbol=Zero ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF Pm up lo $ IF
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > up mm
    [Node list symbol=> symbol=up symbol=mm ]
    
   DEFSubnode:atts= error errmsg2
    [Node list symbol=error symbol=errmsg2 ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4954886 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=nn 
      
       [Node list symbol=# symbol=lo ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4954886 
      
       [Node list symbol=error symbol=errmsg1 ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4954887 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=CheckZeroIndex symbol=lo ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4954887 
         
          [Node list symbol=U symbol=up ]
          
          [Node list symbol=cons int=3 
          
           [Node list symbol=cons symbol=lo 
           
            [Node list symbol=:: symbol=up 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce s $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET pos
    [Node list symbol=LET symbol=pos 
    
     [Node list symbol=position symbol=s symbol=IVar ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4954889 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=< symbol=pos 
     
      [Node list symbol=minIndex symbol=IVar ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4954889 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=pos 
       
        [Node list symbol=position symbol=s symbol=DVar ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4954888 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=< symbol=pos 
        
         [Node list symbol=minIndex symbol=DVar ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4954888 
        
         [Node list symbol=error symbol=errmsg4 ]
         
         [Node list symbol=U 
         
          [Node list symbol=:: symbol=pos 
          
           [Node list symbol=PositiveInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=X 
      
       [Node list symbol=:: symbol=pos 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF D u der $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Symbol ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET up
    [Node list symbol=LET symbol=up 
    
     [Node list symbol=position symbol=u symbol=DVar ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4954890 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=< symbol=up 
     
      [Node list symbol=minIndex symbol=DVar ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4954890 
     
      [Node list symbol=error symbol=errmsg4 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=lower 
        
         [Node list symbol=List 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=d symbol=der ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=pos 
         
          [Node list symbol=position symbol=d symbol=IVar ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4954891 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=< symbol=pos 
          
           [Node list symbol=minIndex symbol=IVar ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4954891 
          
           [Node list symbol=error symbol=errmsg4 ]
           
           [Node list symbol=LET symbol=lower 
           
            [Node list symbol=cons symbol=lower 
            
             [Node list symbol=:: symbol=pos 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=lower 
       
        [Node list symbol=reverse! symbol=lower ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=Pr symbol=lower 
        
         [Node list symbol=:: symbol=up 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF One $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Zero
    [Node list symbol=Zero ]
    
   DEFSubnode:atts= One
    [Node list symbol=One ]
    
   ]
   
  CAPSULEDef:
   [DEF numIndVar :: nn
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   ]
   
  CAPSULEDef:
   [DEF numDepVar :: mm
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   ]
   
  CAPSULEDef:
   [DEF name jv $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4954892 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=LET symbol=jt 
      
       [Node list symbol=type symbol=jv ]
       ]
      
      [Node list symbol=QUOTE symbol=Const ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4954892 
     
      [Node list symbol=:: string=1 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=i 
       
        [Node list symbol=index symbol=jv ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4954893 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=jt 
        
         [Node list symbol=QUOTE symbol=Indep ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4954893 
        
         [Node list symbol=qelt symbol=nameX symbol=i ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4954894 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=jt 
           
            [Node list symbol=QUOTE symbol=Dep ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4954894 
           
            [Node list symbol=qelt symbol=nameU symbol=i ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=mu 
             
              [Node list symbol=repeatedIndex symbol=jv ]
              ]
             
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=qelt symbol=nameU symbol=i ]
              ]
             
             [Node list symbol=LET symbol=empty 
             
              [Node list symbol=: symbol=lower 
              
               [Node list symbol=List 
               
                [Node list symbol=OutputForm ]
                ]
               ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=j symbol=mu ]
              
              [Node list symbol=LET symbol=lower 
              
               [Node list symbol=cons symbol=lower 
               
                [Node list symbol=:: 
                
                 [Node list symbol=qelt symbol=nameX symbol=j ]
                 
                 [Node list symbol=OutputForm ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=lower 
             
              [Node list symbol=reverse! symbol=lower ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=subscript symbol=res symbol=lower ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF opdisp l first l
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=OutputForm ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce jv $ SEQ
   DEFSubnode:atts= Expression
    [Node list symbol=Expression 
    
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4954895 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=type symbol=jv ]
      
      [Node list symbol=QUOTE symbol=Const ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4954895 
     
      [Node list symbol=One ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=opname 
        
         [Node list symbol=Symbol ]
         ]
        
        [Node list symbol=name symbol=jv ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=opname 
        
         [Node list symbol=Sel symbol=operator 
         
          [Node list symbol=BasicOperator ]
          ]
         ]
        ]
       
       [Node list symbol=display symbol=jop symbol=opdisp ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=tmp 
        
         [Node list symbol=None ]
         ]
        
        [Node list symbol=jv 
        
         [Node list symbol=Sel symbol=coerce 
         
          [Node list symbol=NoneFunctions1 symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=jop symbol=tmp 
        
         [Node list symbol=Sel symbol=setProperty 
         
          [Node list symbol=BasicOperator ]
          ]
         
         [Node list symbol=:: string=%symbol 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=tmp 
       
        [Node list 
        
         [Node list symbol=Sel symbol=coerce 
         
          [Node list symbol=NoneFunctions1 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=weight symbol=jv ]
         ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=jop symbol=tmp 
        
         [Node list symbol=Sel symbol=setProperty 
         
          [Node list symbol=BasicOperator ]
          ]
         
         [Node list symbol=:: string=%weight 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=tmp 
       
        [Node list 
        
         [Node list symbol=Sel symbol=coerce 
         
          [Node list symbol=NoneFunctions1 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=type symbol=jv ]
         ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=jop symbol=tmp 
        
         [Node list symbol=Sel symbol=setProperty 
         
          [Node list symbol=BasicOperator ]
          ]
         
         [Node list symbol=:: string=%jet 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=arg 
        
         [Node list symbol=List 
         
          [Node list symbol=Expression 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        
        [Node list symbol=concat! 
        
         [Node list symbol=construct 
         
          [Node list symbol=:: symbol=opname 
          
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          
          [Node list symbol=:: 
          
           [Node list symbol=index symbol=jv ]
           
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=repeatedIndex symbol=jv ]
           ]
          
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=kernel symbol=jop symbol=arg ]
        ]
       ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleCategory ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=D 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      
      [Node list symbol=List 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= List
  [Node list symbol=List 
  
   [Node list symbol=Symbol ]
   ]
  
 DEFSubnode:atts= List
  [Node list symbol=List 
  
   [Node list symbol=Symbol ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF IndexedJetBundle x u p n m
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=MDEF string=Improper multi-index 
   
    [Node list symbol=errmsg1 ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=MDEF string=Improper upper index 
   
    [Node list symbol=errmsg2 ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=notation 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list symbol=:: string=Repeated 
    
     [Node list symbol=Symbol ]
     ]
    ]
   
  CAPSULEDef:
   [DEF setNotation s SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957204 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=member? symbol=s 
      
       [Node list symbol=@ 
       
        [Node list symbol=construct 
        
         [Node list symbol=:: string=Multi 
         
          [Node list symbol=Symbol ]
          ]
         
         [Node list symbol=:: string=Repeated 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=List 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957204 symbol=noBranch 
      
       [Node list symbol=exit int=2 
       
        [Node list symbol=error string=Unknown notation ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET t notation
    [Node list symbol=LET symbol=t symbol=notation ]
    
   DEFSubnode:atts= LET notation s
    [Node list symbol=LET symbol=notation symbol=s ]
    
   DEFSubnode:atts= exit 1 t
    [Node list symbol=exit int=1 symbol=t ]
    
   ]
   
  CAPSULEDef:
   [DEFatts= DEF notation
    getNotation
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF multiIndex jv $ :: Rep
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= copy
    [Node list symbol=copy 
    
     [Node list symbol=rest 
     
      [Node list symbol=rest symbol=jv ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF index jv $ ::
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= first
    [Node list symbol=first 
    
     [Node list symbol=rest symbol=jv ]
     ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   ]
   
  CAPSULEDef:
   [DEF type jv $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET t
    [Node list symbol=LET symbol=t 
    
     [Node list symbol=first symbol=jv ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4957205 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=t ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4957205 
     
      [Node list symbol=:: string=Const 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G4957206 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? symbol=t ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G4957206 
        
         [Node list symbol=:: string=Indep 
         
          [Node list symbol=Symbol ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol== symbol=t int=2 ]
          
          [Node list symbol=:: string=Dep 
          
           [Node list symbol=Symbol ]
           ]
          
          [Node list symbol=:: string=Deriv 
          
           [Node list symbol=Symbol ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF CheckZeroIndex il SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i symbol=il ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4957207 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? symbol=i ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4957207 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 true
    [Node list symbol=exit int=1 symbol=true ]
    
   ]
   
  CAPSULEDef:
   [DEF X up $ IF
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > up n
    [Node list symbol=> symbol=up symbol=n ]
    
   DEFSubnode:atts= error errmsg2
    [Node list symbol=error symbol=errmsg2 ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=One ]
     
     [Node list symbol=:: symbol=up 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF U up $ IF
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > up m
    [Node list symbol=> symbol=up symbol=m ]
    
   DEFSubnode:atts= error errmsg2
    [Node list symbol=error symbol=errmsg2 ]
    
   DEFSubnode:atts= cons 2
    [Node list symbol=cons int=2 
    
     [Node list symbol=cons 
     
      [Node list symbol=:: symbol=up 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=n 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=Sel 
       
        [Node list symbol=NonNegativeInteger ]
        
        [Node list symbol=Zero ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF Pm up lo $ IF
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > up m
    [Node list symbol=> symbol=up symbol=m ]
    
   DEFSubnode:atts= error errmsg2
    [Node list symbol=error symbol=errmsg2 ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957208 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=n 
      
       [Node list symbol=# symbol=lo ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957208 
      
       [Node list symbol=error symbol=errmsg1 ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4957209 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=CheckZeroIndex symbol=lo ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4957209 
         
          [Node list symbol=U symbol=up ]
          
          [Node list symbol=cons int=3 
          
           [Node list symbol=cons symbol=lo 
           
            [Node list symbol=:: symbol=up 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF One $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Zero
    [Node list symbol=Zero ]
    
   DEFSubnode:atts= One
    [Node list symbol=One ]
    
   ]
   
  CAPSULEDef:
   [DEFatts= DEF n
    numIndVar
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEFatts= DEF m
    numDepVar
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF name jv $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET jt
    [Node list symbol=LET symbol=jt 
    
     [Node list symbol=type symbol=jv ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol== symbol=jt 
      
       [Node list symbol=:: string=Const 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=:: string=1 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=IF 
      
       [Node list symbol== symbol=jt 
       
        [Node list symbol=:: string=Indep 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=IF symbol=x 
       
        [Node list symbol=> symbol=n 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=superscript symbol=x 
        
         [Node list symbol=construct 
         
          [Node list symbol=:: 
          
           [Node list symbol=index symbol=jv ]
           
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF 
       
        [Node list symbol== symbol=jt 
        
         [Node list symbol=:: string=Dep 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=IF symbol=u 
        
         [Node list symbol=> symbol=m 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=superscript symbol=u 
         
          [Node list symbol=construct 
          
           [Node list symbol=:: 
           
            [Node list symbol=index symbol=jv ]
            
            [Node list symbol=OutputForm ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== 
         
          [Node list symbol=getNotation ]
          
          [Node list symbol=:: string=Multi 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol=> symbol=m 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=script symbol=p 
          
           [Node list symbol=construct 
           
            [Node list symbol=construct 
            
             [Node list symbol=bracket 
             
              [Node list symbol=COLLECT 
              
               [Node list symbol=IN symbol=i 
               
                [Node list symbol=multiIndex symbol=jv ]
                ]
               
               [Node list symbol=:: symbol=i 
               
                [Node list symbol=OutputForm ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=construct 
            
             [Node list symbol=:: 
             
              [Node list symbol=index symbol=jv ]
              
              [Node list symbol=OutputForm ]
              ]
             ]
            
            [Node list symbol=construct ]
            
            [Node list symbol=construct ]
            
            [Node list symbol=construct ]
            ]
           ]
          
          [Node list symbol=subscript symbol=p 
          
           [Node list symbol=construct 
           
            [Node list symbol=bracket 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=i 
              
               [Node list symbol=multiIndex symbol=jv ]
               ]
              
              [Node list symbol=:: symbol=i 
              
               [Node list symbol=OutputForm ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol=> symbol=m 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=script symbol=p 
          
           [Node list symbol=construct 
           
            [Node list symbol=construct 
            
             [Node list symbol=blankSeparate 
             
              [Node list symbol=COLLECT 
              
               [Node list symbol=IN symbol=j 
               
                [Node list symbol=repeatedIndex symbol=jv ]
                ]
               
               [Node list symbol=:: symbol=j 
               
                [Node list symbol=OutputForm ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=construct 
            
             [Node list symbol=:: 
             
              [Node list symbol=index symbol=jv ]
              
              [Node list symbol=OutputForm ]
              ]
             ]
            
            [Node list symbol=construct ]
            
            [Node list symbol=construct ]
            
            [Node list symbol=construct ]
            ]
           ]
          
          [Node list symbol=subscript symbol=p 
          
           [Node list symbol=construct 
           
            [Node list symbol=blankSeparate 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=j 
              
               [Node list symbol=repeatedIndex symbol=jv ]
               ]
              
              [Node list symbol=:: symbol=j 
              
               [Node list symbol=OutputForm ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF opdisp l first l
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=OutputForm ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce jv $ SEQ
   DEFSubnode:atts= Expression
    [Node list symbol=Expression 
    
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G4957210 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=type symbol=jv ]
      
      [Node list symbol=:: string=Const 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G4957210 
     
      [Node list symbol=One ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=opname 
        
         [Node list symbol=Symbol ]
         ]
        
        [Node list symbol=name symbol=jv ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=opname 
        
         [Node list symbol=Sel symbol=operator 
         
          [Node list symbol=BasicOperator ]
          ]
         ]
        ]
       
       [Node list symbol=display symbol=jop symbol=opdisp ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=tmp 
        
         [Node list symbol=None ]
         ]
        
        [Node list symbol=jv 
        
         [Node list symbol=Sel symbol=coerce 
         
          [Node list symbol=NoneFunctions1 symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=jop symbol=tmp 
        
         [Node list symbol=Sel symbol=setProperty 
         
          [Node list symbol=BasicOperator ]
          ]
         
         [Node list symbol=:: string=%symbol 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=tmp 
       
        [Node list 
        
         [Node list symbol=Sel symbol=coerce 
         
          [Node list symbol=NoneFunctions1 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=weight symbol=jv ]
         ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=jop symbol=tmp 
        
         [Node list symbol=Sel symbol=setProperty 
         
          [Node list symbol=BasicOperator ]
          ]
         
         [Node list symbol=:: string=%weight 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=tmp 
       
        [Node list 
        
         [Node list symbol=Sel symbol=coerce 
         
          [Node list symbol=NoneFunctions1 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=type symbol=jv ]
         ]
        ]
       
       [Node list symbol=LET symbol=jop 
       
        [Node list symbol=jop symbol=tmp 
        
         [Node list symbol=Sel symbol=setProperty 
         
          [Node list symbol=BasicOperator ]
          ]
         
         [Node list symbol=:: string=%jet 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=IF 
       
        [Node list symbol== 
        
         [Node list symbol=getNotation ]
         
         [Node list symbol=:: string=Multi 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=LET symbol=arg 
        
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=multiIndex symbol=jv ]
           ]
          
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=arg 
        
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=repeatedIndex symbol=jv ]
           ]
          
          [Node list symbol=:: symbol=j 
          
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=arg 
       
        [Node list symbol=concat! symbol=arg 
        
         [Node list symbol=construct 
         
          [Node list symbol=:: symbol=opname 
          
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          
          [Node list symbol=:: 
          
           [Node list symbol=index symbol=jv ]
           
           [Node list symbol=Expression 
           
            [Node list symbol=Integer ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=kernel symbol=jop symbol=arg ]
        ]
       ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= Symbol
  [Node list symbol=Symbol ]
  
 DEFSubnode:atts= Symbol
  [Node list symbol=Symbol ]
  
 DEFSubnode:atts= Symbol
  [Node list symbol=Symbol ]
  
 DEFSubnode:atts= PositiveInteger
  [Node list symbol=PositiveInteger ]
  
 DEFSubnode:atts= PositiveInteger
  [Node list symbol=PositiveInteger ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetBundleExpression JB add
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleFunctionCategory symbol=JB ]
   
   [Node list symbol=FunctionSpace 
   
    [Node list symbol=Integer ]
    ]
   
   [Node list symbol=AlgebraicallyClosedFunctionSpace 
   
    [Node list symbol=Integer ]
    ]
   
   [Node list symbol=TranscendentalFunctionCategory ]
   
   [Node list symbol=CombinatorialOpsCategory ]
   
   [Node list symbol=LiouvillianFunctionCategory ]
   
   [Node list symbol=SpecialFunctionCategory ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=SparseMultivariatePolynomial 
      
       [Node list symbol=Integer ]
       
       [Node list symbol=Kernel symbol=$ ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=SparseMultivariatePolynomial symbol=JB 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=numerJP 
    
     [Node list symbol=$ 
     
      [Node list symbol=SparseMultivariatePolynomial symbol=JB 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=reduce 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=function 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= Expression
  [Node list symbol=Expression 
  
   [Node list symbol=Integer ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Expression 
    
     [Node list symbol=Integer ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=jv ]
    
    [Node list symbol=$ symbol=JB ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=jv 
    
     [Node list symbol=Expression 
     
      [Node list symbol=Integer ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=exp ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Expression 
     
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=@ symbol=exp symbol=Rep ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=f ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Expression 
     
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=f symbol=Rep ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=SparseMultivariatePolynomial 
     
      [Node list symbol=Integer ]
      
      [Node list symbol=Kernel symbol=$ ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=/ symbol=p 
    
     [Node list symbol=Sel 
     
      [Node list symbol=SparseMultivariatePolynomial 
      
       [Node list symbol=Integer ]
       
       [Node list symbol=Kernel symbol=$ ]
       ]
      
      [Node list symbol=One ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=numerJP symbol=f ]
    
    [Node list symbol=$ 
    
     [Node list symbol=SparseMultivariatePolynomial symbol=JB 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=SparseMultivariatePolynomial symbol=JB 
       
        [Node list symbol=Expression 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=p 
      
       [Node list symbol=SparseMultivariatePolynomial 
       
        [Node list symbol=Integer ]
        
        [Node list symbol=Kernel symbol=$ ]
        ]
       ]
      
      [Node list symbol=numer symbol=f ]
      ]
     
     [Node list symbol=LET symbol=PM 
     
      [Node list symbol=primitiveMonomials symbol=p ]
      ]
     
     [Node list symbol=LET symbol=CO 
     
      [Node list symbol=coefficients symbol=p ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=mon symbol=PM ]
      
      [Node list symbol=IN symbol=co symbol=CO ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=JV 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=Exp 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=newco 
        
         [Node list symbol=Expression 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=:: symbol=co 
        
         [Node list symbol=Expression 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=v 
        
         [Node list symbol=variables symbol=mon ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=vs 
         
          [Node list symbol=:: symbol=v symbol=$ ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=jv 
          
           [Node list symbol=Union symbol=JB string=failed ]
           ]
          
          [Node list symbol=retractIfCan symbol=vs ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF 
          
           [Node list symbol=case symbol=jv string=failed ]
           
           [Node list symbol=LET symbol=newco 
           
            [Node list symbol=* symbol=newco 
            
             [Node list symbol=:: symbol=vs 
             
              [Node list symbol=Expression 
              
               [Node list symbol=Integer ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=JV 
            
             [Node list symbol=cons symbol=JV 
             
              [Node list symbol=:: symbol=jv symbol=JB ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=Exp 
             
              [Node list symbol=cons symbol=Exp 
              
               [Node list symbol=degree symbol=mon symbol=v ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=+ symbol=res 
         
          [Node list symbol=* symbol=newco 
          
           [Node list symbol=monomial 
           
            [Node list symbol=One ]
            
            [Node list symbol=reverse! symbol=JV ]
            
            [Node list symbol=reverse! symbol=Exp ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=SparseMultivariatePolynomial symbol=JB 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res symbol=$ ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET symbol=PM 
     
      [Node list symbol=primitiveMonomials symbol=p ]
      ]
     
     [Node list symbol=LET symbol=CO 
     
      [Node list symbol=coefficients symbol=p ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=mon symbol=PM ]
      
      [Node list symbol=IN symbol=co symbol=CO ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=prod symbol=co ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=v 
        
         [Node list symbol=variables symbol=mon ]
         ]
        
        [Node list symbol=LET symbol=prod 
        
         [Node list symbol=* symbol=prod 
         
          [Node list symbol=^ 
          
           [Node list symbol=:: symbol=v symbol=$ ]
           
           [Node list symbol=degree symbol=p symbol=v ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=+ symbol=res symbol=prod ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=gcd symbol=f1 symbol=f2 ]
    
    [Node list symbol=$ symbol=$ symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=$ 
    
     [Node list 
     
      [Node list symbol=Sel symbol=gcd 
      
       [Node list symbol=SparseMultivariatePolynomial 
       
        [Node list symbol=Integer ]
        
        [Node list symbol=Kernel symbol=$ ]
        ]
       ]
      
      [Node list symbol=numer symbol=f1 ]
      
      [Node list symbol=numer symbol=f2 ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=exquo symbol=f1 symbol=f2 ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=p 
     
      [Node list 
      
       [Node list symbol=Sel symbol=exquo 
       
        [Node list symbol=SparseMultivariatePolynomial 
        
         [Node list symbol=Integer ]
         
         [Node list symbol=Kernel symbol=$ ]
         ]
        ]
       
       [Node list symbol=numer symbol=f1 ]
       
       [Node list symbol=numer symbol=f2 ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF string=failed 
      
       [Node list symbol=case symbol=p string=failed ]
       
       [Node list symbol=:: symbol=$ 
       
        [Node list symbol=:: symbol=p 
        
         [Node list symbol=SparseMultivariatePolynomial 
         
          [Node list symbol=Integer ]
          
          [Node list symbol=Kernel symbol=$ ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=recip symbol=f ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Union symbol=$ string=failed ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=/ symbol=f 
    
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=purge symbol=l symbol=q ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Kernel symbol=$ ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Kernel symbol=$ ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT symbol=k 
    
     [Node list symbol=IN symbol=k symbol=l ]
     
     [Node list symbol=| 
     
      [Node list symbol== symbol=q 
      
       [Node list symbol=order 
       
        [Node list symbol=:: symbol=k symbol=$ ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimrec symbol=lmv symbol=indVars symbol=remVars symbol=sets ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=List 
      
       [Node list symbol=Kernel symbol=$ ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=List 
      
       [Node list symbol=Kernel symbol=$ ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Kernel symbol=$ ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Kernel symbol=$ ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=List 
      
       [Node list symbol=Kernel symbol=$ ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=res symbol=sets ]
     
     [Node list symbol=LET symbol=newVars symbol=remVars ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=WHILE 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4957872 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? symbol=newVars ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4957872 symbol=false symbol=true ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=jk 
       
        [Node list symbol=first symbol=newVars ]
        ]
       
       [Node list symbol=LET symbol=newVars 
       
        [Node list symbol=rest symbol=newVars ]
        ]
       
       [Node list symbol=LET symbol=false 
       
        [Node list symbol=: symbol=elem 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=LET symbol=indK 
       
        [Node list symbol=concat symbol=indVars symbol=jk ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=lv symbol=lmv ]
        
        [Node list symbol=UNTIL symbol=elem ]
        
        [Node list symbol=LET symbol=elem 
        
         [Node list symbol== symbol=lv symbol=indK ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=elem symbol=noBranch 
        
         [Node list symbol=LET symbol=res 
         
          [Node list symbol=dimrec symbol=lmv symbol=indK symbol=newVars symbol=res ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=elem symbol=false ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=m symbol=res ]
      
      [Node list symbol=UNTIL symbol=elem ]
      
      [Node list symbol=LET symbol=elem 
      
       [Node list symbol=reduce string=and symbol=true 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=ik symbol=indVars ]
         
         [Node list symbol=member? symbol=ik symbol=m ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=IF symbol=elem symbol=noBranch 
     
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=cons symbol=indVars symbol=res ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=dimension symbol=sys symbol=jm symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=polys 
      
       [Node list symbol=List 
       
        [Node list symbol=SparseMultivariatePolynomial 
        
         [Node list symbol=Integer ]
         
         [Node list symbol=Kernel symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=numer symbol=sys 
      
       [Node list symbol=Sel symbol=map 
       
        [Node list symbol=FiniteLinearAggregateFunctions2 symbol=$ 
        
         [Node list symbol=List symbol=$ ]
         
         [Node list symbol=SparseMultivariatePolynomial 
         
          [Node list symbol=Integer ]
          
          [Node list symbol=Kernel symbol=$ ]
          ]
         
         [Node list symbol=List 
         
          [Node list symbol=SparseMultivariatePolynomial 
          
           [Node list symbol=Integer ]
           
           [Node list symbol=Kernel symbol=$ ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=lmv 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=p symbol=polys ]
       
       [Node list symbol=sort! 
       
        [Node list symbol=variables 
        
         [Node list symbol=leadingMonomial symbol=p ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=allvars 
     
      [Node list symbol=first symbol=lmv ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=lv 
      
       [Node list symbol=rest symbol=lmv ]
       ]
      
      [Node list symbol=LET symbol=allvars 
      
       [Node list symbol=removeDuplicates! 
       
        [Node list symbol=merge symbol=lv symbol=allvars ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=dim0 
     
      [Node list symbol=:: 
      
       [Node list symbol=- 
       
        [Node list symbol=q 
        
         [Node list symbol=Sel symbol=JB symbol=dimJ ]
         ]
        
        [Node list symbol=# symbol=allvars ]
        ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=LET symbol=indSets 
     
      [Node list symbol=dimrec symbol=lmv symbol=empty symbol=allvars symbol=empty ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=dim 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=ind symbol=indSets ]
      
      [Node list symbol=LET symbol=dim 
      
       [Node list symbol=max symbol=dim 
       
        [Node list symbol=# symbol=ind ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=+ symbol=dim0 symbol=dim ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=orderDim symbol=sys symbol=jm symbol=q ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=polys 
      
       [Node list symbol=List 
       
        [Node list symbol=SparseMultivariatePolynomial 
        
         [Node list symbol=Integer ]
         
         [Node list symbol=Kernel symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=numer symbol=sys 
      
       [Node list symbol=Sel symbol=map 
       
        [Node list symbol=FiniteLinearAggregateFunctions2 symbol=$ 
        
         [Node list symbol=List symbol=$ ]
         
         [Node list symbol=SparseMultivariatePolynomial 
         
          [Node list symbol=Integer ]
          
          [Node list symbol=Kernel symbol=$ ]
          ]
         
         [Node list symbol=List 
         
          [Node list symbol=SparseMultivariatePolynomial 
          
           [Node list symbol=Integer ]
           
           [Node list symbol=Kernel symbol=$ ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=lmv 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=p symbol=polys ]
       
       [Node list symbol=sort! 
       
        [Node list symbol=purge symbol=q 
        
         [Node list symbol=variables 
         
          [Node list symbol=leadingMonomial symbol=p ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=allvars 
     
      [Node list symbol=first symbol=lmv ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=lv 
      
       [Node list symbol=rest symbol=lmv ]
       ]
      
      [Node list symbol=LET symbol=allvars 
      
       [Node list symbol=removeDuplicates! 
       
        [Node list symbol=merge symbol=lv symbol=allvars ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=dim0 
     
      [Node list symbol=:: 
      
       [Node list symbol=- 
       
        [Node list symbol=q 
        
         [Node list symbol=Sel symbol=JB symbol=dimS ]
         ]
        
        [Node list symbol=# symbol=allvars ]
        ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=LET symbol=indSets 
     
      [Node list symbol=dimrec symbol=lmv symbol=empty symbol=allvars symbol=empty ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=dim 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=ind symbol=indSets ]
      
      [Node list symbol=LET symbol=dim 
      
       [Node list symbol=max symbol=dim 
       
        [Node list symbol=# symbol=ind ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=+ symbol=dim0 symbol=dim ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpSMP symbol=p ]
    
    [Node list 
    
     [Node list symbol=SparseMultivariatePolynomial 
     
      [Node list symbol=Integer ]
      
      [Node list symbol=Kernel symbol=$ ]
      ]
     
     [Node list symbol=SparseMultivariatePolynomial 
     
      [Node list symbol=Integer ]
      
      [Node list symbol=Kernel symbol=$ ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957873 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=ground? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957873 
      
       [Node list symbol=One ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=tv 
        
         [Node list symbol=mainVariable symbol=p ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=case symbol=tv string=failed ]
          
          [Node list symbol=error string=inconsistent system ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=v 
           
            [Node list symbol=:: symbol=tv 
            
             [Node list symbol=Kernel symbol=$ ]
             ]
            ]
           
           [Node list symbol=LET symbol=up 
           
            [Node list symbol=univariate symbol=p symbol=v ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4957875 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=monomial? symbol=up ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4957875 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=lc 
              
               [Node list symbol=leadingCoefficient symbol=up ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4957874 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=case string=failed 
               
                [Node list symbol=mainVariable symbol=lc ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4957874 
               
                [Node list symbol=monomial symbol=v 
                
                 [Node list symbol=One ]
                 
                 [Node list symbol=One ]
                 ]
                
                [Node list symbol=monomial symbol=v 
                
                 [Node list symbol=simpSMP symbol=lc ]
                 
                 [Node list symbol=One ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=md 
              
               [Node list symbol=minimumDegree symbol=up ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=p 
               
                [Node list symbol=> symbol=md 
                
                 [Node list symbol=Zero ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=up 
                 
                  [Node list symbol=quotient 
                  
                   [Node list symbol=monicDivide symbol=up 
                   
                    [Node list symbol=monomial symbol=md 
                    
                     [Node list symbol=One ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=multivariate symbol=up symbol=v ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpOne symbol=f ]
    
    [Node list symbol=$ symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957876 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=f ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957876 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=:: symbol=$ 
       
        [Node list symbol=simpSMP 
        
         [Node list symbol=numer symbol=f ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=greaterLD symbol=r1 symbol=r2 ]
    
    [Node list 
    
     [Node list symbol=Boolean ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Fun symbol=$ ]
      
      [Node list symbol=: symbol=JMR 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=JB ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=: symbol=Depend 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Fun symbol=$ ]
      
      [Node list symbol=: symbol=JMR 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Indices 
        
         [Node list symbol=List symbol=JB ]
         ]
        
        [Node list symbol=: symbol=Entries 
        
         [Node list symbol=List symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=: symbol=Depend 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957877 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? 
      
       [Node list symbol=Indices 
       
        [Node list symbol=r1 symbol=JMR ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957877 symbol=false 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4957878 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? 
         
          [Node list symbol=Indices 
          
           [Node list symbol=r2 symbol=JMR ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4957878 symbol=true 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=ind1 
           
            [Node list symbol=Indices 
            
             [Node list symbol=r1 symbol=JMR ]
             ]
            ]
           
           [Node list symbol=LET symbol=ind2 
           
            [Node list symbol=Indices 
            
             [Node list symbol=r2 symbol=JMR ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4957879 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol== 
            
             [Node list symbol=first symbol=ind1 ]
             
             [Node list symbol=first symbol=ind2 ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4957879 
            
             [Node list symbol=< 
             
              [Node list symbol=# symbol=ind1 ]
              
              [Node list symbol=# symbol=ind2 ]
              ]
             
             [Node list symbol=> 
             
              [Node list symbol=first symbol=ind1 ]
              
              [Node list symbol=first symbol=ind2 ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=groebner symbol=sys ]
    
    [Node list 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=polys 
      
       [Node list symbol=List 
       
        [Node list symbol=SparseMultivariatePolynomial 
        
         [Node list symbol=Integer ]
         
         [Node list symbol=Kernel symbol=$ ]
         ]
        ]
       ]
      
      [Node list symbol=numer symbol=sys 
      
       [Node list symbol=Sel symbol=map 
       
        [Node list symbol=FiniteLinearAggregateFunctions2 symbol=$ 
        
         [Node list symbol=List symbol=$ ]
         
         [Node list symbol=SparseMultivariatePolynomial 
         
          [Node list symbol=Integer ]
          
          [Node list symbol=Kernel symbol=$ ]
          ]
         
         [Node list symbol=List 
         
          [Node list symbol=SparseMultivariatePolynomial 
          
           [Node list symbol=Integer ]
           
           [Node list symbol=Kernel symbol=$ ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=print 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=assign 
      
       [Node list symbol=message string=polys ]
       
       [Node list symbol=:: symbol=polys 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=gbase 
     
      [Node list symbol=polys 
      
       [Node list symbol=Sel symbol=groebner 
       
        [Node list symbol=GroebnerPackage 
        
         [Node list symbol=Integer ]
         
         [Node list symbol=IndexedExponents 
         
          [Node list symbol=Kernel symbol=$ ]
          ]
         
         [Node list symbol=Kernel symbol=$ ]
         
         [Node list symbol=SparseMultivariatePolynomial 
         
          [Node list symbol=Integer ]
          
          [Node list symbol=Kernel symbol=$ ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=coerce symbol=gbase 
      
       [Node list symbol=Sel symbol=map 
       
        [Node list symbol=FiniteLinearAggregateFunctions2 symbol=$ 
        
         [Node list symbol=SparseMultivariatePolynomial 
         
          [Node list symbol=Integer ]
          
          [Node list symbol=Kernel symbol=$ ]
          ]
         
         [Node list symbol=List 
         
          [Node list symbol=SparseMultivariatePolynomial 
          
           [Node list symbol=Integer ]
           
           [Node list symbol=Kernel symbol=$ ]
           ]
          ]
         
         [Node list symbol=List symbol=$ ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=groebnerSimp symbol=sysL symbol=ind ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list 
     
      [Node list symbol=Sel symbol=print 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=assign 
      
       [Node list symbol=message string=groebnerSimp: # ]
       
       [Node list symbol=:: 
       
        [Node list symbol=# symbol=sysL ]
        
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=tmp 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=rec symbol=sysL ]
       
       [Node list symbol=rec symbol=Depend ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=resDep 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=reduce symbol=setUnion symbol=tmp symbol=empty ]
      ]
     
     [Node list symbol=LET symbol=resSys 
     
      [Node list symbol=groebner 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=rec symbol=sysL ]
        
        [Node list symbol=rec symbol=Fun ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=resJM 
     
      [Node list symbol=jacobiMatrix symbol=resSys 
      
       [Node list symbol=COLLECT symbol=ind 
       
        [Node list symbol=IN symbol=eq symbol=resSys ]
        ]
       ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=print 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=message string=END groebnerSimp ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=fun symbol=resSys ]
       
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=construct symbol=fun symbol=resDep 
       
        [Node list symbol=row symbol=resJM symbol=i ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=linearSimp symbol=sysL symbol=ind ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=false 
     
      [Node list symbol=: symbol=solved? 
      
       [Node list symbol=Boolean ]
       ]
      ]
     
     [Node list symbol=: symbol=srec 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=sld symbol=JB ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=rsysL 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Fun symbol=$ ]
         
         [Node list symbol=: symbol=JMR 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=Indices 
           
            [Node list symbol=List symbol=JB ]
            ]
           
           [Node list symbol=: symbol=Entries 
           
            [Node list symbol=List symbol=$ ]
            ]
           ]
          ]
         
         [Node list symbol=: symbol=Depend 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=WHILE 
      
       [Node list symbol=IF symbol=solved? symbol=false 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G4957880 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=sysL ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G4957880 symbol=false symbol=true ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=rec 
       
        [Node list symbol=first symbol=sysL ]
        ]
       
       [Node list symbol=LET symbol=sysL 
       
        [Node list symbol=rest symbol=sysL ]
        ]
       
       [Node list symbol=LET symbol=ld 
       
        [Node list symbol=first 
        
         [Node list symbol=Indices 
         
          [Node list symbol=rec symbol=JMR ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=s 
       
        [Node list symbol=solveFor symbol=ld 
        
         [Node list symbol=rec symbol=Fun ]
         ]
        ]
       
       [Node list symbol=LET symbol=solved? 
       
        [Node list symbol=case symbol=s symbol=$ ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=solved? 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=srec symbol=rec ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=sld symbol=ld ]
           ]
          ]
         
         [Node list symbol=LET symbol=rsysL 
         
          [Node list symbol=cons symbol=rec symbol=rsysL ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=rsysL 
     
      [Node list symbol=concat! symbol=sysL 
      
       [Node list symbol=reverse! symbol=rsysL ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=solved? 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=ssub 
        
         [Node list symbol=:: symbol=s symbol=$ ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=res 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=Fun symbol=$ ]
            
            [Node list symbol=: symbol=JMR 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=Indices 
              
               [Node list symbol=List symbol=JB ]
               ]
              
              [Node list symbol=: symbol=Entries 
              
               [Node list symbol=List symbol=$ ]
               ]
              ]
             ]
            
            [Node list symbol=: symbol=Depend 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=construct symbol=srec ]
         ]
        
        [Node list symbol=LET symbol=sdep 
        
         [Node list symbol=srec symbol=Depend ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=rec symbol=rsysL ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=newFun 
          
           [Node list symbol=simpOne 
           
            [Node list symbol=subst symbol=sld symbol=ssub 
            
             [Node list symbol=rec symbol=Fun ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4957881 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=newFun ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4957881 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=newJMR 
             
              [Node list 
              
               [Node list symbol=Sel symbol=row 
               
                [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
                ]
               
               [Node list symbol=jacobiMatrix 
               
                [Node list symbol=construct symbol=newFun ]
                
                [Node list symbol=construct symbol=ind ]
                ]
               
               [Node list symbol=One ]
               ]
              ]
             
             [Node list symbol=LET symbol=newDep 
             
              [Node list symbol=removeDuplicates! 
              
               [Node list symbol=append symbol=sdep 
               
                [Node list symbol=rec symbol=Depend ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=res 
              
               [Node list symbol=cons symbol=res 
               
                [Node list symbol=construct symbol=newFun symbol=newJMR symbol=newDep ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=reverse! symbol=res ]
         ]
        ]
       
       [Node list symbol=groebnerSimp symbol=rsysL symbol=ind ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simpRec symbol=sysL symbol=ind ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=Fun symbol=$ ]
       
       [Node list symbol=: symbol=JMR 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Indices 
         
          [Node list symbol=List symbol=JB ]
          ]
         
         [Node list symbol=: symbol=Entries 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=: symbol=Depend 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957882 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=< int=2 
      
       [Node list symbol=# symbol=sysL ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957882 symbol=sysL 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=frec 
        
         [Node list symbol=first symbol=sysL ]
         ]
        
        [Node list symbol=LET symbol=fld 
        
         [Node list symbol=first 
         
          [Node list symbol=Indices 
          
           [Node list symbol=frec symbol=JMR ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=sysL 
        
         [Node list symbol=rest symbol=sysL ]
         ]
        
        [Node list symbol=LET symbol=srec 
        
         [Node list symbol=first symbol=sysL ]
         ]
        
        [Node list symbol=LET symbol=sld 
        
         [Node list symbol=first 
         
          [Node list symbol=Indices 
          
           [Node list symbol=srec symbol=JMR ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=> symbol=fld symbol=sld ]
          
          [Node list symbol=cons symbol=frec 
          
           [Node list symbol=simpRec symbol=sysL symbol=ind ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=eqLD 
            
             [Node list symbol=List 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=Fun symbol=$ ]
               
               [Node list symbol=: symbol=JMR 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=Indices 
                 
                  [Node list symbol=List symbol=JB ]
                  ]
                 
                 [Node list symbol=: symbol=Entries 
                 
                  [Node list symbol=List symbol=$ ]
                  ]
                 ]
                ]
               
               [Node list symbol=: symbol=Depend 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=construct symbol=frec ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=WHILE 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4957883 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=sysL ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4957883 symbol=false 
               
                [Node list symbol== symbol=sld symbol=fld ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=eqLD 
             
              [Node list symbol=cons symbol=srec symbol=eqLD ]
              ]
             
             [Node list symbol=LET symbol=sysL 
             
              [Node list symbol=rest symbol=sysL ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4957884 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=sysL ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4957884 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=srec 
                
                 [Node list symbol=first symbol=sysL ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=sld 
                 
                  [Node list symbol=first 
                  
                   [Node list symbol=Indices 
                   
                    [Node list symbol=srec symbol=JMR ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=eqLD 
           
            [Node list symbol=sort! symbol=greaterLD 
            
             [Node list symbol=linearSimp symbol=ind 
             
              [Node list symbol=reverse! symbol=eqLD ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=srec 
           
            [Node list symbol=first symbol=eqLD ]
            ]
           
           [Node list symbol=LET symbol=sld 
           
            [Node list symbol=first 
            
             [Node list symbol=Indices 
             
              [Node list symbol=srec symbol=JMR ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=resLD 
            
             [Node list symbol=List 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=Fun symbol=$ ]
               
               [Node list symbol=: symbol=JMR 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=Indices 
                 
                  [Node list symbol=List symbol=JB ]
                  ]
                 
                 [Node list symbol=: symbol=Entries 
                 
                  [Node list symbol=List symbol=$ ]
                  ]
                 ]
                ]
               
               [Node list symbol=: symbol=Depend 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=WHILE 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4957885 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=eqLD ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4957885 symbol=false 
               
                [Node list symbol== symbol=sld symbol=fld ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=resLD 
             
              [Node list symbol=cons symbol=srec symbol=resLD ]
              ]
             
             [Node list symbol=LET symbol=eqLD 
             
              [Node list symbol=rest symbol=eqLD ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G4957886 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=eqLD ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G4957886 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=srec 
                
                 [Node list symbol=first symbol=eqLD ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=sld 
                 
                  [Node list symbol=first 
                  
                   [Node list symbol=Indices 
                   
                    [Node list symbol=srec symbol=JMR ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=newSysL 
            
             [Node list symbol=List 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=Fun symbol=$ ]
               
               [Node list symbol=: symbol=JMR 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=Indices 
                 
                  [Node list symbol=List symbol=JB ]
                  ]
                 
                 [Node list symbol=: symbol=Entries 
                 
                  [Node list symbol=List symbol=$ ]
                  ]
                 ]
                ]
               
               [Node list symbol=: symbol=Depend 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=merge symbol=greaterLD symbol=eqLD symbol=sysL ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=concat! 
            
             [Node list symbol=reverse! symbol=resLD ]
             
             [Node list symbol=simpRec symbol=newSysL symbol=ind ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=simplify symbol=sys symbol=jm ]
    
    [Node list 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Sys 
      
       [Node list symbol=List symbol=$ ]
       ]
      
      [Node list symbol=: symbol=JM 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
       ]
      
      [Node list symbol=: symbol=Depend 
      
       [Node list symbol=Union string=failed 
       
        [Node list symbol=List 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=allIndices symbol=jm ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=sysL 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=Fun symbol=$ ]
         
         [Node list symbol=: symbol=JMR 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=Indices 
           
            [Node list symbol=List symbol=JB ]
            ]
           
           [Node list symbol=: symbol=Entries 
           
            [Node list symbol=List symbol=$ ]
            ]
           ]
          ]
         
         [Node list symbol=: symbol=Depend 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=eq symbol=sys ]
      
      [Node list symbol=| 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4957887 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=eq ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4957887 symbol=false symbol=true ]
         ]
        ]
       ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=neq 
       
        [Node list symbol=simpOne symbol=eq ]
        ]
       
       [Node list symbol=IF 
       
        [Node list symbol== symbol=neq symbol=eq ]
        
        [Node list symbol=LET symbol=r 
        
         [Node list symbol=row symbol=jm symbol=i ]
         ]
        
        [Node list symbol=LET symbol=r 
        
         [Node list symbol=row 
         
          [Node list symbol=jacobiMatrix 
          
           [Node list symbol=construct symbol=neq ]
           
           [Node list symbol=construct 
           
            [Node list symbol=Indices 
            
             [Node list symbol=row symbol=jm symbol=i ]
             ]
            ]
           ]
          
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4957888 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? 
         
          [Node list symbol=r symbol=Indices ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4957888 
         
          [Node list symbol=exit int=2 
          
           [Node list symbol=error string=inconsistent system ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4957889 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol== 
            
             [Node list symbol=type 
             
              [Node list symbol=first 
              
               [Node list symbol=r symbol=Indices ]
               ]
              ]
             
             [Node list symbol=:: string=Indep 
             
              [Node list symbol=Symbol ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4957889 symbol=noBranch 
            
             [Node list symbol=exit int=3 
             
              [Node list symbol=error string=inconsistent system ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=sysL 
        
         [Node list symbol=cons symbol=sysL 
         
          [Node list symbol=construct symbol=neq symbol=r 
          
           [Node list symbol=construct 
           
            [Node list symbol=:: symbol=i 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957890 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=sysL ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957890 
      
       [Node list symbol=construct symbol=empty symbol=empty 
       
        [Node list symbol=new symbol=empty 
        
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=sysL 
        
         [Node list symbol=simpRec symbol=inds 
         
          [Node list symbol=sort! symbol=greaterLD symbol=sysL ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=resSys 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=resJM 
         
          [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
          ]
         
         [Node list symbol=new symbol=inds 
         
          [Node list symbol=# symbol=sysL ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=resDep 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=rec symbol=sysL ]
         
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4957891 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? 
            
             [Node list symbol=Indices 
             
              [Node list symbol=rec symbol=JMR ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4957891 
            
             [Node list symbol=exit int=2 
             
              [Node list symbol=error string=inconsistent system ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G4957892 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=< 
               
                [Node list symbol=first 
                
                 [Node list symbol=Indices 
                 
                  [Node list symbol=rec symbol=JMR ]
                  ]
                 ]
                
                [Node list 
                
                 [Node list symbol=Sel symbol=JB symbol=U ]
                 
                 [Node list symbol=One ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G4957892 symbol=noBranch 
               
                [Node list symbol=exit int=3 
                
                 [Node list symbol=error string=inconsistent system ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=resSys 
          
           [Node list symbol=cons symbol=resSys 
           
            [Node list symbol=rec symbol=Fun ]
            ]
           ]
          
          [Node list symbol=setRow! symbol=resJM symbol=i 
          
           [Node list symbol=rec symbol=JMR ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=resDep 
           
            [Node list symbol=cons symbol=resDep 
            
             [Node list symbol=rec symbol=Depend ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=construct symbol=resJM 
         
          [Node list symbol=reverse! symbol=resSys ]
          
          [Node list symbol=reverse! symbol=resDep ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=jetVariables symbol=Phi ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=JV 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     
     [Node list symbol=LET symbol=LKernels 
     
      [Node list symbol=tower symbol=Phi ]
      ]
     
     [Node list symbol=LET symbol=LOps 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=Ke symbol=LKernels ]
       
       [Node list symbol=operator symbol=Ke ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=Ke symbol=LKernels ]
      
      [Node list symbol=IN symbol=Op symbol=LOps ]
      
      [Node list symbol=| 
      
       [Node list symbol=Op 
       
        [Node list symbol=Sel symbol=has? 
        
         [Node list symbol=BasicOperator ]
         ]
        
        [Node list symbol=:: string=%jet 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=typ 
       
        [Node list symbol=pretend 
        
         [Node list symbol=:: 
         
          [Node list symbol=property symbol=Op 
          
           [Node list symbol=:: string=%jet 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=None ]
          ]
         
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=LET symbol=arg 
       
        [Node list symbol=argument symbol=Ke ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF 
        
         [Node list symbol== symbol=typ 
         
          [Node list symbol=:: string=Indep 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=xindex 
           
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=retract 
           
            [Node list symbol=second symbol=arg ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=JV 
           
            [Node list symbol=cons symbol=JV 
            
             [Node list 
             
              [Node list symbol=Sel symbol=JB symbol=X ]
              
              [Node list symbol=:: symbol=xindex 
              
               [Node list symbol=PositiveInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol== symbol=typ 
          
           [Node list symbol=:: string=Dep 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=uindex 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=retract 
            
             [Node list symbol=second symbol=arg ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=JV 
            
             [Node list symbol=cons symbol=JV 
             
              [Node list 
              
               [Node list symbol=Sel symbol=JB symbol=U ]
               
               [Node list symbol=:: symbol=uindex 
               
                [Node list symbol=PositiveInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=pupindex 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=retract 
            
             [Node list symbol=second symbol=arg ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=mindex 
            
             [Node list symbol=List 
             
              [Node list symbol=Integer ]
              ]
             ]
            
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=i 
             
              [Node list symbol=rest 
              
               [Node list symbol=rest symbol=arg ]
               ]
              ]
             
             [Node list symbol=retract symbol=i ]
             ]
            ]
           
           [Node list symbol=LET symbol=pmindex 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=i symbol=mindex ]
             
             [Node list symbol=:: symbol=i 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=JV 
            
             [Node list symbol=cons symbol=JV 
             
              [Node list symbol=pmindex 
              
               [Node list symbol=Sel symbol=JB symbol=P ]
               
               [Node list symbol=:: symbol=pupindex 
               
                [Node list symbol=PositiveInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=sort string=> 
      
       [Node list symbol=removeDuplicates! symbol=JV ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=differentiate symbol=fun symbol=jv ]
    
    [Node list symbol=$ symbol=$ symbol=JB ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=x 
     
      [Node list symbol=name symbol=jv ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=differentiate symbol=fun symbol=x ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=differentiate symbol=fun symbol=x ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=x 
    
     [Node list symbol=Sel symbol=Rep symbol=differentiate ]
     
     [Node list symbol=:: symbol=fun 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=subst symbol=f symbol=jv symbol=exp ]
    
    [Node list symbol=$ symbol=$ symbol=JB symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=res 
     
      [Node list symbol=eval 
      
       [Node list symbol=:: symbol=f symbol=Rep ]
       
       [Node list symbol== 
       
        [Node list symbol=:: symbol=jv symbol=Rep ]
        
        [Node list symbol=:: symbol=exp symbol=Rep ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=solveFor symbol=f symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=Union symbol=$ string=failed ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=fun 
     
      [Node list symbol=numer symbol=f ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=var 
      
       [Node list symbol=Kernel symbol=$ ]
       ]
      
      [Node list symbol=retract 
      
       [Node list symbol=:: symbol=jv symbol=$ ]
       ]
      ]
     
     [Node list symbol=LET symbol=md 
     
      [Node list symbol=monicDivide symbol=fun symbol=var 
      
       [Node list symbol=:: symbol=var 
       
        [Node list symbol=SparseMultivariatePolynomial 
        
         [Node list symbol=Integer ]
         
         [Node list symbol=Kernel symbol=$ ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=vrem 
     
      [Node list symbol=variables 
      
       [Node list symbol=md symbol=remainder ]
       ]
      ]
     
     [Node list symbol=LET symbol=vquo 
     
      [Node list symbol=variables 
      
       [Node list symbol=md symbol=quotient ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957893 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=member? symbol=var 
      
       [Node list symbol=append symbol=vrem symbol=vquo ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957893 string=failed 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G4957895 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? 
         
          [Node list symbol=md symbol=remainder ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G4957895 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G4957894 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=vquo ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G4957894 string=failed 
            
             [Node list symbol=Zero ]
             ]
            ]
           ]
          
          [Node list symbol=- 
          
           [Node list symbol=/ 
           
            [Node list symbol=md symbol=remainder ]
            
            [Node list symbol=md symbol=quotient ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=kernel0 symbol=op symbol=ls ]
    
    [Node list symbol=$ 
    
     [Node list symbol=BasicOperator ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=op 
    
     [Node list symbol=Sel symbol=kernel 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=pretend symbol=ls 
     
      [Node list symbol=List 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=sy2jbe symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=:: symbol=s 
    
     [Node list symbol=Expression 
     
      [Node list symbol=Integer ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=hidedisp symbol=l ]
    
    [Node list 
    
     [Node list symbol=OutputForm ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=retract 
      
       [Node list symbol=first symbol=l ]
       ]
      ]
     
     [Node list symbol=LET symbol=l 
     
      [Node list symbol=rest symbol=l ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=num 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=retract 
      
       [Node list symbol=first symbol=l ]
       ]
      ]
     
     [Node list symbol=LET symbol=l 
     
      [Node list symbol=rest symbol=l ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=show 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=retract 
      
       [Node list symbol=first symbol=l ]
       ]
      ]
     
     [Node list symbol=LET symbol=l 
     
      [Node list symbol=rest symbol=l ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=args 
      
       [Node list symbol=List 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=k 
      
       [Node list symbol=SEGMENT symbol=show 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=args 
       
        [Node list symbol=concat! symbol=args 
        
         [Node list symbol=construct 
         
          [Node list symbol=:: 
          
           [Node list symbol=first symbol=l ]
           
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=l 
        
         [Node list symbol=rest symbol=l ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=k 
      
       [Node list symbol=SEGMENT symbol=num 
       
        [Node list symbol=+ symbol=show 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=l 
      
       [Node list symbol=rest symbol=l ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G4957896 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=l ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G4957896 
       
        [Node list symbol=LET symbol=op 
        
         [Node list symbol=:: symbol=name 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        
        [Node list symbol=LET symbol=op 
        
         [Node list symbol=sub 
         
          [Node list symbol=:: symbol=name 
          
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=commaSeparate 
          
           [Node list symbol=COLLECT 
           
            [Node list symbol=IN symbol=e symbol=l ]
            
            [Node list symbol=:: symbol=e 
            
             [Node list symbol=OutputForm ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957897 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=args ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957897 symbol=op 
      
       [Node list symbol=prefix symbol=op symbol=args ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=hidediff symbol=l symbol=x ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=Symbol ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=oldarg 
     
      [Node list symbol=copy symbol=l ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=retract 
      
       [Node list symbol=first symbol=l ]
       ]
      ]
     
     [Node list symbol=LET symbol=l 
     
      [Node list symbol=rest symbol=l ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=num 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=retract 
      
       [Node list symbol=first symbol=l ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G4957898 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=num ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G4957898 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=l 
        
         [Node list symbol=rest symbol=l ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=show 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=retract 
         
          [Node list symbol=first symbol=l ]
          ]
         ]
        
        [Node list symbol=LET symbol=l 
        
         [Node list symbol=rest symbol=l ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=args 
         
          [Node list symbol=List symbol=$ ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=k 
         
          [Node list symbol=SEGMENT symbol=num 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=args 
          
           [Node list symbol=cons symbol=args 
           
            [Node list symbol=first symbol=l ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=l 
           
            [Node list symbol=rest symbol=l ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=diff 
         
          [Node list symbol=List 
          
           [Node list symbol=Integer ]
           ]
          ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=k symbol=l ]
          
          [Node list symbol=retract symbol=k ]
          ]
         ]
        
        [Node list symbol=LET symbol=oldarg 
        
         [Node list symbol=first symbol=oldarg 
         
          [Node list symbol=:: 
          
           [Node list symbol=+ symbol=num int=3 ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=op 
        
         [Node list symbol=name 
         
          [Node list symbol=Sel symbol=operator 
          
           [Node list symbol=BasicOperator ]
           ]
          ]
         ]
        
        [Node list symbol=setProperty symbol=op 
        
         [Node list symbol=:: string=%specialDisp 
         
          [Node list symbol=Symbol ]
          ]
         
         [Node list symbol=pretend 
         
          [Node list symbol=@ symbol=hidedisp 
          
           [Node list symbol=Mapping 
           
            [Node list symbol=OutputForm ]
            
            [Node list symbol=List symbol=$ ]
            ]
           ]
          
          [Node list symbol=None ]
          ]
         ]
        
        [Node list symbol=setProperty symbol=op 
        
         [Node list symbol=:: string=%specialDiff 
         
          [Node list symbol=Symbol ]
          ]
         
         [Node list symbol=pretend 
         
          [Node list symbol=@ symbol=hidediff 
          
           [Node list symbol=Mapping symbol=$ 
           
            [Node list symbol=List symbol=$ ]
            
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=None ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=res symbol=$ ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=INBY symbol=k 
         
          [Node list symbol=SEGMENT symbol=num 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=- 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=IN symbol=arg symbol=args ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=da 
          
           [Node list symbol=differentiate symbol=arg symbol=x ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G4957899 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=da ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G4957899 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=newarg 
             
              [Node list symbol=append symbol=oldarg 
              
               [Node list symbol=COLLECT 
               
                [Node list symbol=IN symbol=j 
                
                 [Node list symbol=merge symbol=diff 
                 
                  [Node list symbol=construct symbol=k ]
                  ]
                 ]
                
                [Node list symbol=:: symbol=j symbol=$ ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=res 
              
               [Node list symbol=+ symbol=res 
               
                [Node list symbol=* symbol=da 
                
                 [Node list symbol=kernel0 symbol=op symbol=newarg ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=res ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=function symbol=f symbol=arg symbol=show ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Symbol ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=op 
     
      [Node list symbol=f 
      
       [Node list symbol=Sel symbol=operator 
       
        [Node list symbol=BasicOperator ]
        ]
       ]
      ]
     
     [Node list symbol=setProperty symbol=op 
     
      [Node list symbol=:: string=%specialDisp 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=pretend 
      
       [Node list symbol=@ symbol=hidedisp 
       
        [Node list symbol=Mapping 
        
         [Node list symbol=OutputForm ]
         
         [Node list symbol=List symbol=$ ]
         ]
        ]
       
       [Node list symbol=None ]
       ]
      ]
     
     [Node list symbol=setProperty symbol=op 
     
      [Node list symbol=:: string=%specialDiff 
      
       [Node list symbol=Symbol ]
       ]
      
      [Node list symbol=pretend 
      
       [Node list symbol=@ symbol=hidediff 
       
        [Node list symbol=Mapping symbol=$ 
        
         [Node list symbol=List symbol=$ ]
         
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=None ]
       ]
      ]
     
     [Node list symbol=LET symbol=args 
     
      [Node list symbol=append symbol=arg 
      
       [Node list symbol=construct 
       
        [Node list symbol=sy2jbe symbol=f ]
        
        [Node list symbol=:: symbol=$ 
        
         [Node list symbol=# symbol=arg ]
         ]
        
        [Node list symbol=:: symbol=show symbol=$ ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=kernel0 symbol=op symbol=args ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF JetBundleXExpression JB add
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleFunctionCategory symbol=JB ]
   
   [Node list symbol=JetBundleBaseFunctionCategory symbol=JB ]
   
   [Node list symbol=FunctionSpace 
   
    [Node list symbol=Integer ]
    ]
   
   [Node list symbol=AlgebraicallyClosedFunctionSpace 
   
    [Node list symbol=Integer ]
    ]
   
   [Node list symbol=TranscendentalFunctionCategory ]
   
   [Node list symbol=CombinatorialOpsCategory ]
   
   [Node list symbol=LiouvillianFunctionCategory ]
   
   [Node list symbol=SpecialFunctionCategory ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=retractIfCan 
    
     [Node list 
     
      [Node list symbol=Union symbol=$ string=failed ]
      
      [Node list symbol=JetBundleExpression symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=retract 
    
     [Node list symbol=$ 
     
      [Node list symbol=JetBundleExpression symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=reduce 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=function 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= JetBundleExpression JB
  [Node list symbol=JetBundleExpression symbol=JB ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=JetBundleExpression symbol=JB ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=jv ]
    
    [Node list symbol=$ symbol=JB ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5029397 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=type symbol=jv ]
       
       [Node list symbol=:: string=Indep 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5029397 
      
       [Node list symbol=error string=Only functions of independent variables allowed ]
       
       [Node list symbol=jv 
       
        [Node list symbol=Sel symbol=coerce 
        
         [Node list symbol=JetBundleExpression symbol=JB ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=retractIfCan symbol=p ]
    
    [Node list 
    
     [Node list symbol=Union symbol=$ string=failed ]
     
     [Node list symbol=JetBundleExpression symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5029398 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=reduce string=and symbol=true 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=jv 
        
         [Node list symbol=jetVariables symbol=p ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=type symbol=jv ]
         
         [Node list symbol=:: string=Indep 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5029398 string=failed 
      
       [Node list symbol=:: symbol=$ 
       
        [Node list symbol=:: symbol=p symbol=Rep ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=retract symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=JetBundleExpression symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=px 
      
       [Node list symbol=Union symbol=$ string=failed ]
       ]
      
      [Node list symbol=retractIfCan symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=px string=failed ]
       
       [Node list symbol=error string=Only functions of independent variables allowed ]
       
       [Node list symbol=:: symbol=px symbol=$ ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF JetBundleLinearFunction JB D
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Coeffs 
     
      [Node list symbol=List symbol=D ]
      ]
     
     [Node list symbol=: symbol=JVars 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numIndVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=D 
    
     [Node list symbol=SIGNATURE symbol=retractIfCan 
     
      [Node list 
      
       [Node list symbol=Union symbol=D string=failed ]
       
       [Node list symbol=JetBundleExpression symbol=JB ]
       ]
      ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=DEF 
     
      [Node list symbol=retractIfCan symbol=ex ]
      
      [Node list 
      
       [Node list symbol=Union symbol=$ string=failed ]
       
       [Node list symbol=JetBundleExpression symbol=JB ]
       ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=pd 
       
        [Node list symbol=ex 
        
         [Node list symbol=Sel symbol=D symbol=retractIfCan ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF 
        
         [Node list symbol=case symbol=pd symbol=D ]
         
         [Node list symbol=construct 
         
          [Node list symbol=construct 
          
           [Node list symbol=:: symbol=pd symbol=D ]
           ]
          
          [Node list symbol=construct 
          
           [Node list symbol=Sel symbol=JB 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=resJ 
          
           [Node list symbol=jetVariables symbol=ex ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resC 
           
            [Node list symbol=List symbol=D ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=jv symbol=resJ ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=cd 
            
             [Node list 
             
              [Node list symbol=Sel symbol=D symbol=retractIfCan ]
              
              [Node list symbol=differentiate symbol=ex symbol=jv ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF 
             
              [Node list symbol=case symbol=cd string=failed ]
              
              [Node list symbol=return string=failed ]
              
              [Node list symbol=LET symbol=resC 
              
               [Node list symbol=cons symbol=resC 
               
                [Node list symbol=:: symbol=cd symbol=D ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=construct symbol=resJ 
           
            [Node list symbol=reverse! symbol=resC ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DEF 
      
       [Node list symbol=retract symbol=ex ]
       
       [Node list symbol=$ 
       
        [Node list symbol=JetBundleExpression symbol=JB ]
        ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=pl 
         
          [Node list symbol=Union symbol=$ string=failed ]
          ]
         
         [Node list symbol=retractIfCan symbol=ex ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=case symbol=pl string=failed ]
          
          [Node list symbol=error string=non-linear function ]
          
          [Node list symbol=:: symbol=pl symbol=$ ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF monom c jv D JB SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058729 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=one? symbol=c ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058729 
     
      [Node list symbol=:: symbol=jv 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058730 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? symbol=jv ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058730 
        
         [Node list symbol=:: symbol=c 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=* 
         
          [Node list symbol=:: symbol=c 
          
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=:: symbol=jv 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce l $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058731 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=l ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058731 
     
      [Node list symbol=:: 
      
       [Node list symbol=Sel 
       
        [Node list symbol=NonNegativeInteger ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=monom 
        
         [Node list symbol=first 
         
          [Node list symbol=l symbol=Coeffs ]
          ]
         
         [Node list symbol=first 
         
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=rest 
         
          [Node list symbol=l symbol=Coeffs ]
          ]
         ]
        
        [Node list symbol=IN symbol=jv 
        
         [Node list symbol=rest 
         
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=+ symbol=res 
         
          [Node list symbol=monom symbol=c symbol=jv ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce jv $ JB SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET jt
    [Node list symbol=LET symbol=jt 
    
     [Node list symbol=type symbol=jv ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol== symbol=jt 
      
       [Node list symbol=:: string=Const 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=One ]
      
      [Node list symbol=IF 
      
       [Node list symbol== symbol=jt 
       
        [Node list symbol=:: string=Indep 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=construct 
        
         [Node list symbol=:: symbol=jv symbol=D ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=construct 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=construct symbol=jv ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce ex $ D SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058732 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=ex ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058732 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=construct 
      
       [Node list symbol=construct symbol=ex ]
       
       [Node list symbol=construct 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce jm SEQ
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=nrows symbol=jm ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=r 
      
       [Node list symbol=row symbol=jm symbol=i ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5058733 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? 
       
        [Node list symbol=r symbol=Indices ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5058733 symbol=noBranch 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=cons symbol=res 
         
          [Node list symbol=construct 
          
           [Node list symbol=r symbol=Entries ]
           
           [Node list symbol=r symbol=Indices ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=reverse! symbol=res ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce ll SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=inds 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=l symbol=ll ]
     
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=removeDuplicates! 
      
       [Node list symbol=merge string=> symbol=inds 
       
        [Node list symbol=l symbol=JVars ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
      ]
     
     [Node list symbol=new symbol=inds 
     
      [Node list symbol=# symbol=ll ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=l symbol=ll ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=setRow! symbol=res symbol=i 
     
      [Node list symbol=l symbol=JVars ]
      
      [Node list symbol=l symbol=Coeffs ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF ground? l $ SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058734 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=l ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058734 symbol=true 
     
      [Node list symbol=one? 
      
       [Node list symbol=first 
       
        [Node list symbol=l symbol=JVars ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ground l $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5058735 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=member? 
      
       [Node list symbol=Sel symbol=JB 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=l symbol=JVars ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5058735 symbol=noBranch 
      
       [Node list symbol=exit int=2 
       
        [Node list symbol=Zero ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct 
      
       [Node list symbol=last 
       
        [Node list symbol=l symbol=Coeffs ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=Sel symbol=JB 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF retractIfCan l $ SEQ
   DEFSubnode:atts= Union D failed
    [Node list symbol=Union symbol=D string=failed ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058736 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=l ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058736 
     
      [Node list symbol=Sel symbol=D 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058737 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list 
        
         [Node list symbol=Sel symbol=JB symbol=one? ]
         
         [Node list symbol=first 
         
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058737 string=failed 
        
         [Node list symbol=first 
         
          [Node list symbol=l symbol=Coeffs ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEFatts= DEF l
    numerator l $ $
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF denominator l $ $ One
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF zero? l $ empty?
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= l JVars
    [Node list symbol=l symbol=JVars ]
    
   ]
   
  CAPSULEDef:
   [DEF = l1 l2 $ $ zero?
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= - l1 l2
    [Node list symbol=- symbol=l1 symbol=l2 ]
    
   ]
   
  CAPSULEDef:
   [DEF Zero $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF One $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=One ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF - l $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=l symbol=Coeffs ]
      ]
     
     [Node list symbol=c 
     
      [Node list symbol=Sel symbol=D symbol=- ]
      ]
     ]
    
   DEFSubnode:atts= l JVars
    [Node list symbol=l symbol=JVars ]
    
   ]
   
  CAPSULEDef:
   [DEF + l1 l2 $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058738 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=l1 ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058738 symbol=l2 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058739 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=l2 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058739 symbol=l1 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=lc2 
          
           [Node list symbol=copy 
           
            [Node list symbol=l2 symbol=Coeffs ]
            ]
           ]
          
          [Node list symbol=LET symbol=lj2 
          
           [Node list symbol=copy 
           
            [Node list symbol=l2 symbol=JVars ]
            ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resC 
           
            [Node list symbol=List symbol=D ]
            ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resJ 
           
            [Node list symbol=List symbol=JB ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=c1 
           
            [Node list symbol=l1 symbol=Coeffs ]
            ]
           
           [Node list symbol=IN symbol=j1 
           
            [Node list symbol=l1 symbol=JVars ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5058740 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=lj2 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5058740 symbol=false 
                
                 [Node list symbol=> symbol=j1 
                 
                  [Node list symbol=first symbol=lj2 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=resC 
              
               [Node list symbol=cons symbol=resC 
               
                [Node list symbol=first symbol=lc2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=resJ 
              
               [Node list symbol=cons symbol=resJ 
               
                [Node list symbol=first symbol=lj2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=lc2 
              
               [Node list symbol=rest symbol=lc2 ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=lj2 
               
                [Node list symbol=rest symbol=lj2 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5058741 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=lj2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5058741 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=resC 
               
                [Node list symbol=cons symbol=c1 symbol=resC ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=resJ 
                
                 [Node list symbol=cons symbol=j1 symbol=resJ ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5058743 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol== symbol=j1 
                
                 [Node list symbol=first symbol=lj2 ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5058743 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=sum 
                  
                   [Node list symbol=c1 
                   
                    [Node list symbol=Sel symbol=D symbol=+ ]
                    
                    [Node list symbol=first symbol=lc2 ]
                    ]
                   ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=G5058742 
                    
                     [Node list symbol=Boolean ]
                     ]
                    
                    [Node list symbol=zero? symbol=sum ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=IF symbol=G5058742 symbol=noBranch 
                    
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET symbol=resC 
                      
                       [Node list symbol=cons symbol=sum symbol=resC ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=LET symbol=resJ 
                       
                        [Node list symbol=cons symbol=j1 symbol=resJ ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=lc2 
                  
                   [Node list symbol=rest symbol=lc2 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=lj2 
                   
                    [Node list symbol=rest symbol=lj2 ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=resC 
                  
                   [Node list symbol=cons symbol=c1 symbol=resC ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=resJ 
                   
                    [Node list symbol=cons symbol=j1 symbol=resJ ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=construct 
           
            [Node list symbol=concat! symbol=lc2 
            
             [Node list symbol=reverse! symbol=resC ]
             ]
            
            [Node list symbol=concat! symbol=lj2 
            
             [Node list symbol=reverse! symbol=resJ ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * i l $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058744 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=i ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058744 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058745 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? symbol=i ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058745 symbol=l 
        
         [Node list symbol=construct 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=c 
           
            [Node list symbol=l symbol=Coeffs ]
            ]
           
           [Node list symbol=i symbol=c 
           
            [Node list symbol=Sel symbol=D symbol=* ]
            ]
           ]
          
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * ex l D $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058746 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=ex ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058746 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058747 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? symbol=ex ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058747 symbol=l 
        
         [Node list symbol=construct 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=c 
           
            [Node list symbol=l symbol=Coeffs ]
            ]
           
           [Node list symbol=ex symbol=c 
           
            [Node list symbol=Sel symbol=D symbol=* ]
            ]
           ]
          
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * l1 l2 $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5058748 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=l1 ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5058748 
      
       [Node list symbol=exit int=2 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5058749 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=l2 ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5058749 symbol=noBranch 
         
          [Node list symbol=exit int=3 
          
           [Node list symbol=Zero ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058750 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=l1 symbol=JVars ]
      
      [Node list symbol=construct 
      
       [Node list symbol=One ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058750 
     
      [Node list symbol=* symbol=l2 
      
       [Node list symbol=first 
       
        [Node list symbol=l1 symbol=Coeffs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058751 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=l2 symbol=JVars ]
         
         [Node list symbol=construct 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058751 
        
         [Node list symbol=* symbol=l1 
         
          [Node list symbol=first 
          
           [Node list symbol=l2 symbol=Coeffs ]
           ]
          ]
         
         [Node list symbol=error string=non-linear function ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF recip l $ SEQ
   DEFSubnode:atts= Union $ failed
    [Node list symbol=Union symbol=$ string=failed ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058752 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=l symbol=JVars ]
      
      [Node list symbol=construct 
      
       [Node list symbol=One ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058752 string=failed 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=rc 
       
        [Node list 
        
         [Node list symbol=Sel symbol=D symbol=recip ]
         
         [Node list symbol=first 
         
          [Node list symbol=l symbol=Coeffs ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF string=failed 
        
         [Node list symbol=case symbol=rc symbol=D ]
         
         [Node list symbol=:: symbol=$ 
         
          [Node list symbol=:: symbol=rc symbol=D ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF exquo l1 l2 $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5058753 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=one? 
      
       [Node list symbol=first 
       
        [Node list symbol=l2 symbol=JVars ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5058753 symbol=noBranch 
      
       [Node list symbol=exit int=2 string=failed ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET d
    [Node list symbol=LET symbol=d 
    
     [Node list symbol=first 
     
      [Node list symbol=l2 symbol=Coeffs ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=newC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=l1 symbol=Coeffs ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=e 
      
       [Node list symbol=exquo symbol=c symbol=d ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol=case symbol=e string=failed ]
        
        [Node list symbol=return string=failed ]
        
        [Node list symbol=LET symbol=newC 
        
         [Node list symbol=cons symbol=e symbol=newC ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=newC ]
      
      [Node list symbol=l1 symbol=JVars ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF gcd l1 l2 $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5058754 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=# 
       
        [Node list symbol=l1 symbol=JVars ]
        ]
       
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5058754 
      
       [Node list symbol=exit int=2 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5058755 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=> 
         
          [Node list symbol=# 
          
           [Node list symbol=l2 symbol=JVars ]
           ]
          
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5058755 symbol=noBranch 
         
          [Node list symbol=exit int=3 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET g
    [Node list symbol=LET symbol=g 
    
     [Node list symbol=gcd 
     
      [Node list symbol=first 
      
       [Node list symbol=l1 symbol=Coeffs ]
       ]
      
      [Node list symbol=first 
      
       [Node list symbol=l2 symbol=Coeffs ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058756 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=first 
      
       [Node list symbol=l1 symbol=JVars ]
       ]
      
      [Node list symbol=first 
      
       [Node list symbol=l2 symbol=JVars ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058756 
     
      [Node list symbol=construct 
      
       [Node list symbol=construct symbol=g ]
       
       [Node list symbol=l1 symbol=JVars ]
       ]
      
      [Node list symbol=:: symbol=g symbol=$ ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF jetVariables l $ SEQ
   DEFSubnode:atts= List JB
    [Node list symbol=List symbol=JB ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058757 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=l ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058757 
     
      [Node list symbol=construct ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=l symbol=Coeffs ]
         ]
        
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=merge string=> symbol=res 
         
          [Node list symbol=jetVariables symbol=c ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=removeDuplicates! symbol=res ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5058758 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=member? 
         
          [Node list symbol=One ]
          
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5058758 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=concat! symbol=res 
           
            [Node list symbol=remove 
            
             [Node list symbol=One ]
             
             [Node list symbol=l symbol=JVars ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=append symbol=res 
           
            [Node list symbol=l symbol=JVars ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF differentiate l s $ $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resJ 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=l symbol=Coeffs ]
      ]
     
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=l symbol=JVars ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=dc 
      
       [Node list symbol=c symbol=s 
       
        [Node list symbol=Sel symbol=D symbol=differentiate ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5058759 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? symbol=dc ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5058759 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=resC 
         
          [Node list symbol=cons symbol=dc symbol=resC ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=resJ 
          
           [Node list symbol=cons symbol=j symbol=resJ ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=resC ]
      
      [Node list symbol=reverse! symbol=resJ ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF differentiate l jv $ $ JB SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET jt
    [Node list symbol=LET symbol=jt 
    
     [Node list symbol=type symbol=jv ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol== symbol=jt 
      
       [Node list symbol=:: string=Indep 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=resC 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=resJ 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=l symbol=Coeffs ]
         ]
        
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=l symbol=JVars ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=dc 
         
          [Node list symbol=c symbol=jv 
          
           [Node list symbol=Sel symbol=D symbol=differentiate ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5058760 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=zero? symbol=dc ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5058760 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=resC 
            
             [Node list symbol=cons symbol=dc symbol=resC ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=resJ 
             
              [Node list symbol=cons symbol=j symbol=resJ ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct 
        
         [Node list symbol=reverse! symbol=resC ]
         
         [Node list symbol=reverse! symbol=resJ ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=pos 
       
        [Node list symbol=position symbol=jv 
        
         [Node list symbol=l symbol=JVars ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058761 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=< symbol=pos 
        
         [Node list symbol=minIndex 
         
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058761 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=construct 
         
          [Node list symbol=construct 
          
           [Node list symbol=qelt symbol=pos 
           
            [Node list symbol=l symbol=Coeffs ]
            ]
           ]
          
          [Node list symbol=construct 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF jacobiMatrix sys SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB $
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=inds 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=cinds 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=eq symbol=sys ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=inds 
      
       [Node list symbol=removeDuplicates! 
       
        [Node list symbol=merge string=> symbol=inds 
        
         [Node list symbol=eq symbol=JVars ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=< symbol=nn 
         
          [Node list symbol=# symbol=cinds ]
          ]
         ]
        
        [Node list symbol=IN symbol=co 
        
         [Node list symbol=eq symbol=Coeffs ]
         ]
        
        [Node list symbol=LET symbol=cinds 
        
         [Node list symbol=removeDuplicates! 
         
          [Node list symbol=merge string=> symbol=cinds 
          
           [Node list symbol=co 
           
            [Node list symbol=Sel symbol=D symbol=jetVariables ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058762 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=cinds ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058762 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
         ]
        
        [Node list symbol=new symbol=inds 
        
         [Node list symbol=# symbol=sys ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=eq symbol=sys ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=setRow! symbol=res symbol=i 
        
         [Node list symbol=eq symbol=JVars ]
         
         [Node list symbol=COLLECT 
         
          [Node list symbol=IN symbol=co 
          
           [Node list symbol=eq symbol=Coeffs ]
           ]
          
          [Node list symbol=:: symbol=co symbol=$ ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
         ]
        
        [Node list symbol=new 
        
         [Node list symbol=append symbol=inds symbol=cinds ]
         
         [Node list symbol=# symbol=sys ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=eq symbol=sys ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=ents 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=co 
           
            [Node list symbol=eq symbol=Coeffs ]
            ]
           
           [Node list symbol=:: symbol=co symbol=$ ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=rowJ 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=rowC 
          
           [Node list symbol=List symbol=$ ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=cjv symbol=cinds ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=dJV 
            
             [Node list symbol=List symbol=JB ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=dCo 
            
             [Node list symbol=List symbol=D ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=co 
            
             [Node list symbol=eq symbol=Coeffs ]
             ]
            
            [Node list symbol=IN symbol=jv 
            
             [Node list symbol=eq symbol=JVars ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=dco 
             
              [Node list symbol=co symbol=cjv 
              
               [Node list symbol=Sel symbol=D symbol=differentiate ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5058763 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=zero? symbol=dco ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5058763 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=dJV 
                
                 [Node list symbol=cons symbol=jv symbol=dJV ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=dCo 
                 
                  [Node list symbol=cons symbol=dco symbol=dCo ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5058764 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=dJV ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5058764 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=rowJ 
              
               [Node list symbol=cons symbol=cjv symbol=rowJ ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=rowC 
               
                [Node list symbol=cons symbol=rowC 
                
                 [Node list symbol=construct 
                 
                  [Node list symbol=reverse! symbol=dCo ]
                  
                  [Node list symbol=reverse! symbol=dJV ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=setRow! symbol=res symbol=i 
          
           [Node list symbol=append 
           
            [Node list symbol=eq symbol=JVars ]
            
            [Node list symbol=reverse! symbol=rowJ ]
            ]
           
           [Node list symbol=append symbol=ents 
           
            [Node list symbol=reverse! symbol=rowC ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF jacobiMatrix sys varlist SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB $
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=List symbol=JB ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET inds
    [Node list symbol=LET symbol=inds 
    
     [Node list symbol=first symbol=varlist ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=vars 
     
      [Node list symbol=rest symbol=varlist ]
      ]
     
     [Node list symbol=LET symbol=inds 
     
      [Node list symbol=removeDuplicates! 
      
       [Node list symbol=merge string=> symbol=inds symbol=vars ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     
     [Node list symbol=new symbol=inds 
     
      [Node list symbol=# symbol=sys ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=eq symbol=sys ]
     
     [Node list symbol=IN symbol=vars symbol=varlist ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ents 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=co 
        
         [Node list symbol=eq symbol=Coeffs ]
         ]
        
        [Node list symbol=:: symbol=co symbol=$ ]
        ]
       ]
      
      [Node list symbol=LET symbol=ivars 
      
       [Node list symbol=sort! string=< 
       
        [Node list symbol=select symbol=vars 
        
         [Node list symbol=+-> 
         
          [Node list symbol=: 
          
           [Node list symbol=: symbol=x symbol=JB ]
           
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol== 
          
           [Node list symbol=type symbol=x ]
           
           [Node list symbol=:: string=Indep 
           
            [Node list symbol=Symbol ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5058767 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=ivars ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5058767 
       
        [Node list symbol=setRow! symbol=res symbol=i symbol=ents 
        
         [Node list symbol=eq symbol=JVars ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=rowJ 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=rowC 
          
           [Node list symbol=List symbol=$ ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=ijv symbol=ivars ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=dJV 
            
             [Node list symbol=List symbol=JB ]
             ]
            ]
           
           [Node list symbol=LET symbol=empty 
           
            [Node list symbol=: symbol=dCo 
            
             [Node list symbol=List symbol=D ]
             ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=co 
            
             [Node list symbol=eq symbol=Coeffs ]
             ]
            
            [Node list symbol=IN symbol=jv 
            
             [Node list symbol=eq symbol=JVars ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=dco 
             
              [Node list symbol=co symbol=ijv 
              
               [Node list symbol=Sel symbol=D symbol=differentiate ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5058765 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=zero? symbol=dco ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5058765 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=dJV 
                
                 [Node list symbol=cons symbol=jv symbol=dJV ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=dCo 
                 
                  [Node list symbol=cons symbol=dco symbol=dCo ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5058766 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=dJV ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5058766 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=rowJ 
              
               [Node list symbol=cons symbol=ijv symbol=rowJ ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=rowC 
               
                [Node list symbol=cons symbol=rowC 
                
                 [Node list symbol=construct 
                 
                  [Node list symbol=reverse! symbol=dCo ]
                  
                  [Node list symbol=reverse! symbol=dJV ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=setRow! symbol=res symbol=i 
          
           [Node list symbol=append 
           
            [Node list symbol=eq symbol=JVars ]
            
            [Node list symbol=reverse! symbol=rowJ ]
            ]
           
           [Node list symbol=append symbol=ents 
           
            [Node list symbol=reverse! symbol=rowC ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF leadingDer l JB $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058768 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=l ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058768 
     
      [Node list symbol=One ]
      
      [Node list symbol=first 
      
       [Node list symbol=l symbol=JVars ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF freeOf? l jv $ JB SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058769 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=type symbol=jv ]
      
      [Node list symbol=:: string=Indep 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058769 
     
      [Node list symbol=reduce string=and symbol=true 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=l symbol=Coeffs ]
         ]
        
        [Node list symbol=c symbol=jv 
        
         [Node list symbol=Sel symbol=D symbol=freeOf? ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058770 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=member? symbol=jv 
        
         [Node list symbol=l symbol=JVars ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058770 symbol=false symbol=true ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF solveFor l jv $ JB SEQ
   DEFSubnode:atts= Union $ failed
    [Node list symbol=Union symbol=$ string=failed ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET jt
    [Node list symbol=LET symbol=jt 
    
     [Node list symbol=type symbol=jv ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=jt 
     
      [Node list symbol=:: string=Const 
      
       [Node list symbol=Symbol ]
       ]
      ]
     
     [Node list symbol=exit int=1 string=failed ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=jt 
      
       [Node list symbol=:: string=Indep 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=exit int=1 string=failed ]
      ]
     ]
    
   DEFSubnode:atts= LET pos
    [Node list symbol=LET symbol=pos 
    
     [Node list symbol=position symbol=jv 
     
      [Node list symbol=l symbol=JVars ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058771 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=< symbol=pos 
     
      [Node list symbol=minIndex 
      
       [Node list symbol=l symbol=JVars ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058771 string=failed 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5058772 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? 
        
         [Node list symbol=# 
         
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5058772 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=rc 
          
           [Node list 
           
            [Node list symbol=Sel symbol=D symbol=recip ]
            
            [Node list symbol=pos 
            
             [Node list symbol=l symbol=Coeffs ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF string=failed 
           
            [Node list symbol=case symbol=rc string=failed ]
            
            [Node list symbol=construct 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=c 
              
               [Node list symbol=delete symbol=pos 
               
                [Node list symbol=l symbol=Coeffs ]
                ]
               ]
              
              [Node list symbol=- 
              
               [Node list symbol=* symbol=c symbol=rc ]
               ]
              ]
             
             [Node list symbol=delete symbol=pos 
             
              [Node list symbol=l symbol=JVars ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF subst l jv exp $ $ JB $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET jt
    [Node list symbol=LET symbol=jt 
    
     [Node list symbol=type symbol=jv ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol== symbol=jt 
      
       [Node list symbol=:: string=Const 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=error string=Substitution for 1 not allowed ]
      
      [Node list symbol=IF 
      
       [Node list symbol== symbol=jt 
       
        [Node list symbol=:: string=Indep 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=xexp symbol=D ]
         
         [Node list symbol=retract symbol=exp ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=resC 
         
          [Node list symbol=List symbol=D ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=resJ 
         
          [Node list symbol=List symbol=JB ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=c 
         
          [Node list symbol=l symbol=Coeffs ]
          ]
         
         [Node list symbol=IN symbol=cj 
         
          [Node list symbol=l symbol=JVars ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=nc 
          
           [Node list symbol=c symbol=jv symbol=xexp 
           
            [Node list symbol=Sel symbol=D symbol=subst ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5058773 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=nc ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5058773 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=resC 
             
              [Node list symbol=cons symbol=nc symbol=resC ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=resJ 
              
               [Node list symbol=cons symbol=cj symbol=resJ ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=construct 
         
          [Node list symbol=reverse! symbol=resC ]
          
          [Node list symbol=reverse! symbol=resJ ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=pos 
        
         [Node list symbol=position symbol=jv 
         
          [Node list symbol=l symbol=JVars ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5058774 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=pos ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5058774 symbol=l 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=c 
           
            [Node list symbol=qelt symbol=pos 
            
             [Node list symbol=l symbol=Coeffs ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=nl symbol=$ ]
            
            [Node list symbol=construct 
            
             [Node list symbol=delete symbol=pos 
             
              [Node list symbol=l symbol=Coeffs ]
              ]
             
             [Node list symbol=delete symbol=pos 
             
              [Node list symbol=l symbol=JVars ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=+ symbol=nl 
            
             [Node list symbol=* symbol=c symbol=exp ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF simplify sys jm SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Sys 
     
      [Node list symbol=List symbol=$ ]
      ]
     
     [Node list symbol=: symbol=JM 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     
     [Node list symbol=: symbol=Depend 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB $
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058775 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=one? 
     
      [Node list symbol=# symbol=sys ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058775 
     
      [Node list symbol=construct symbol=sys symbol=jm 
      
       [Node list symbol=construct 
       
        [Node list symbol=construct 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=RRec 
       
        [Node list 
        
         [Node list symbol=Sel symbol=primitiveRowEchelon 
         
          [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
          ]
         
         [Node list symbol=:: symbol=sys 
         
          [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=newSys 
       
        [Node list symbol=:: 
        
         [Node list symbol=RRec symbol=Ech ]
         
         [Node list symbol=List symbol=$ ]
         ]
        ]
       
       [Node list symbol=LET symbol=Trafo 
       
        [Node list symbol=RRec symbol=Lt ]
        ]
       
       [Node list symbol=LET symbol=minR 
       
        [Node list symbol=minRowIndex symbol=Trafo ]
        ]
       
       [Node list symbol=LET symbol=maxR 
       
        [Node list symbol=maxRowIndex symbol=Trafo ]
        ]
       
       [Node list symbol=LET symbol=inds 
       
        [Node list symbol=allIndices symbol=jm ]
        ]
       
       [Node list symbol=LET symbol=cinds 
       
        [Node list symbol=copy symbol=inds ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5058776 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=cinds ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5058776 symbol=false 
           
            [Node list symbol=~= 
            
             [Node list symbol=type 
             
              [Node list symbol=first symbol=cinds ]
              ]
             
             [Node list symbol=:: string=Indep 
             
              [Node list symbol=Symbol ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=cinds 
        
         [Node list symbol=rest symbol=cinds ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5058777 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? symbol=cinds ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5058777 symbol=noBranch 
         
          [Node list symbol=LET symbol=cinds 
          
           [Node list symbol=reverse! symbol=cinds ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=newJM 
        
         [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
         ]
        
        [Node list symbol=new symbol=inds 
        
         [Node list symbol=# symbol=newSys ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=dep 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=eq symbol=newSys ]
        
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5058780 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=cinds ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5058780 
           
            [Node list symbol=setRow! symbol=newJM symbol=j 
            
             [Node list symbol=eq symbol=JVars ]
             
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=co 
              
               [Node list symbol=eq symbol=Coeffs ]
               ]
              
              [Node list symbol=:: symbol=co symbol=$ ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=ents 
             
              [Node list symbol=COLLECT 
              
               [Node list symbol=IN symbol=co 
               
                [Node list symbol=eq symbol=Coeffs ]
                ]
               
               [Node list symbol=:: symbol=co symbol=$ ]
               ]
              ]
             
             [Node list symbol=LET symbol=empty 
             
              [Node list symbol=: symbol=rowJ 
              
               [Node list symbol=List symbol=JB ]
               ]
              ]
             
             [Node list symbol=LET symbol=empty 
             
              [Node list symbol=: symbol=rowC 
              
               [Node list symbol=List symbol=$ ]
               ]
              ]
             
             [Node list symbol=REPEAT 
             
              [Node list symbol=IN symbol=cjv symbol=cinds ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=empty 
               
                [Node list symbol=: symbol=dJV 
                
                 [Node list symbol=List symbol=JB ]
                 ]
                ]
               
               [Node list symbol=LET symbol=empty 
               
                [Node list symbol=: symbol=dCo 
                
                 [Node list symbol=List symbol=D ]
                 ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=co 
                
                 [Node list symbol=eq symbol=Coeffs ]
                 ]
                
                [Node list symbol=IN symbol=jv 
                
                 [Node list symbol=eq symbol=JVars ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=dco 
                 
                  [Node list symbol=co symbol=cjv 
                  
                   [Node list symbol=Sel symbol=D symbol=differentiate ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G5058778 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=zero? symbol=dco ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G5058778 symbol=noBranch 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=dJV 
                    
                     [Node list symbol=cons symbol=jv symbol=dJV ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=dCo 
                     
                      [Node list symbol=cons symbol=dco symbol=dCo ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5058779 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=dJV ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5058779 symbol=noBranch 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=rowJ 
                  
                   [Node list symbol=cons symbol=cjv symbol=rowJ ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=rowC 
                   
                    [Node list symbol=cons symbol=rowC 
                    
                     [Node list symbol=construct 
                     
                      [Node list symbol=reverse! symbol=dCo ]
                      
                      [Node list symbol=reverse! symbol=dJV ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=setRow! symbol=newJM symbol=j 
              
               [Node list symbol=append 
               
                [Node list symbol=eq symbol=JVars ]
                
                [Node list symbol=reverse! symbol=rowJ ]
                ]
               
               [Node list symbol=append symbol=ents 
               
                [Node list symbol=reverse! symbol=rowC ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=depj 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=INBY symbol=k 
          
           [Node list symbol=SEGMENT symbol=maxR symbol=minR ]
           
           [Node list symbol=- 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=kb 
           
            [Node list symbol=- symbol=minR 
            
             [Node list symbol=+ symbol=k 
             
              [Node list symbol=minIndex symbol=sys ]
              ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5058781 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? 
            
             [Node list symbol=qelt symbol=Trafo symbol=j symbol=k ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5058781 symbol=noBranch 
            
             [Node list symbol=LET symbol=depj 
             
              [Node list symbol=cons symbol=depj 
              
               [Node list symbol=:: 
               
                [Node list symbol=+ 
                
                 [Node list symbol=- symbol=k symbol=minR ]
                 
                 [Node list symbol=minIndex symbol=depj ]
                 ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=dep 
          
           [Node list symbol=cons symbol=depj symbol=dep ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct symbol=newSys symbol=newJM 
        
         [Node list symbol=reverse! symbol=dep ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF simpOne f $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5058782 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=one? 
     
      [Node list symbol=# 
      
       [Node list symbol=f symbol=JVars ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5058782 symbol=f 
     
      [Node list symbol=construct 
      
       [Node list symbol=construct 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=f symbol=JVars ]
       ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleFunctionCategory symbol=JB ]
   
   [Node list symbol=Module symbol=D ]
   
   [Node list symbol=RetractableTo symbol=D ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=D 
     
      [Node list symbol=lazyRepresentation ]
      ]
     
     [Node list symbol=ATTRIBUTE 
     
      [Node list symbol=lazyRepresentation ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ symbol=D ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ground? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ground 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=D 
     
      [Node list symbol=SIGNATURE symbol=retractIfCan 
      
       [Node list 
       
        [Node list symbol=Union symbol=D string=failed ]
        
        [Node list symbol=JetBundleExpression symbol=JB ]
        ]
       ]
      ]
     
     [Node list symbol=PROGN 
     
      [Node list symbol=SIGNATURE symbol=retractIfCan 
      
       [Node list 
       
        [Node list symbol=Union symbol=$ string=failed ]
        
        [Node list symbol=JetBundleExpression symbol=JB ]
        ]
       ]
      
      [Node list symbol=SIGNATURE symbol=retract 
      
       [Node list symbol=$ 
       
        [Node list symbol=JetBundleExpression symbol=JB ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleBaseFunctionCategory JB
  [Node list symbol=JetBundleBaseFunctionCategory symbol=JB ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetVectorField JB D
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numIndVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mm 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numDepVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Coeff 
     
      [Node list symbol=List symbol=D ]
      ]
     
     [Node list symbol=: symbol=Dir 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF diff jb $ JB construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= construct jb
    [Node list symbol=construct symbol=jb ]
    
   ]
   
  CAPSULEDef:
   [DEF diffX i $ diff
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= i
    [Node list symbol=i 
    
     [Node list symbol=Sel symbol=JB symbol=X ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF diffU i $ diff
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= i
    [Node list symbol=i 
    
     [Node list symbol=Sel symbol=JB symbol=U ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF diffP i mu $ diff
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= i mu
    [Node list symbol=i symbol=mu 
    
     [Node list symbol=Sel symbol=JB symbol=P ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF monom c jb D JB SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064601 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=one? symbol=c ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064601 
     
      [Node list symbol=sub 
      
       [Node list symbol=message string=D ]
       
       [Node list symbol=:: symbol=jb 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      
      [Node list symbol=* 
      
       [Node list symbol=:: symbol=c 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=sub 
       
        [Node list symbol=message string=D ]
        
        [Node list symbol=:: symbol=jb 
        
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce v $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064602 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=v symbol=Dir ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064602 
     
      [Node list symbol=:: 
      
       [Node list symbol=Sel symbol=D 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5064603 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? 
        
         [Node list symbol=# 
         
          [Node list symbol=v symbol=Dir ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5064603 
        
         [Node list symbol=monom 
         
          [Node list symbol=first 
          
           [Node list symbol=v symbol=Coeff ]
           ]
          
          [Node list symbol=first 
          
           [Node list symbol=v symbol=Dir ]
           ]
          ]
         
         [Node list symbol=reduce string=+ 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=c 
           
            [Node list symbol=v symbol=Coeff ]
            ]
           
           [Node list symbol=IN symbol=jb 
           
            [Node list symbol=v symbol=Dir ]
            ]
           
           [Node list symbol=monom symbol=c symbol=jb ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coefficients v $ copy
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= v Coeff
    [Node list symbol=v symbol=Coeff ]
    
   ]
   
  CAPSULEDef:
   [DEF directions v $ copy
   DEFSubnode:atts= List JB
    [Node list symbol=List symbol=JB ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= v Dir
    [Node list symbol=v symbol=Dir ]
    
   ]
   
  CAPSULEDef:
   [DEF coefficient v jb D $ JB SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET pos
    [Node list symbol=LET symbol=pos 
    
     [Node list symbol=position symbol=jb 
     
      [Node list symbol=v symbol=Dir ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064604 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=< symbol=pos 
     
      [Node list symbol=minIndex 
      
       [Node list symbol=v symbol=Dir ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064604 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=qelt symbol=pos 
      
       [Node list symbol=v symbol=Coeff ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF copy v $ $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= copy
    [Node list symbol=copy 
    
     [Node list symbol=v symbol=Coeff ]
     ]
    
   DEFSubnode:atts= copy
    [Node list symbol=copy 
    
     [Node list symbol=v symbol=Dir ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF Zero $ construct empty empty
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF zero? v $ empty?
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= v Dir
    [Node list symbol=v symbol=Dir ]
    
   ]
   
  CAPSULEDef:
   [DEF - v $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=v symbol=Coeff ]
      ]
     
     [Node list symbol=c 
     
      [Node list symbol=Sel symbol=D symbol=- ]
      ]
     ]
    
   DEFSubnode:atts= v Dir
    [Node list symbol=v symbol=Dir ]
    
   ]
   
  CAPSULEDef:
   [DEF + v w $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064605 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=v ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064605 symbol=w 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5064606 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=w ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5064606 symbol=v 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=lc2 
           
            [Node list symbol=List symbol=D ]
            ]
           
           [Node list symbol=copy 
           
            [Node list symbol=w symbol=Coeff ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=lj2 
           
            [Node list symbol=List symbol=JB ]
            ]
           
           [Node list symbol=copy 
           
            [Node list symbol=w symbol=Dir ]
            ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resC 
           
            [Node list symbol=List symbol=D ]
            ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=resJ 
           
            [Node list symbol=List symbol=JB ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=c1 
           
            [Node list symbol=v symbol=Coeff ]
            ]
           
           [Node list symbol=IN symbol=j1 
           
            [Node list symbol=v symbol=Dir ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5064607 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=lj2 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5064607 symbol=false 
                
                 [Node list symbol=< symbol=j1 
                 
                  [Node list symbol=first symbol=lj2 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=resC 
              
               [Node list symbol=cons symbol=resC 
               
                [Node list symbol=first symbol=lc2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=resJ 
              
               [Node list symbol=cons symbol=resJ 
               
                [Node list symbol=first symbol=lj2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=lc2 
              
               [Node list symbol=rest symbol=lc2 ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=lj2 
               
                [Node list symbol=rest symbol=lj2 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5064608 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=lj2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5064608 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=resC 
               
                [Node list symbol=cons symbol=c1 symbol=resC ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=resJ 
                
                 [Node list symbol=cons symbol=j1 symbol=resJ ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5064610 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol== symbol=j1 
                
                 [Node list symbol=first symbol=lj2 ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5064610 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=sum 
                  
                   [Node list symbol=c1 
                   
                    [Node list symbol=Sel symbol=D symbol=+ ]
                    
                    [Node list symbol=first symbol=lc2 ]
                    ]
                   ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=G5064609 
                    
                     [Node list symbol=Boolean ]
                     ]
                    
                    [Node list symbol=zero? symbol=sum ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=IF symbol=G5064609 symbol=noBranch 
                    
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET symbol=resC 
                      
                       [Node list symbol=cons symbol=sum symbol=resC ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=LET symbol=resJ 
                       
                        [Node list symbol=cons symbol=j1 symbol=resJ ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=lc2 
                  
                   [Node list symbol=rest symbol=lc2 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=lj2 
                   
                    [Node list symbol=rest symbol=lj2 ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=resC 
                  
                   [Node list symbol=cons symbol=c1 symbol=resC ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=resJ 
                   
                    [Node list symbol=cons symbol=j1 symbol=resJ ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=construct 
           
            [Node list symbol=concat! symbol=lc2 
            
             [Node list symbol=reverse! symbol=resC ]
             ]
            
            [Node list symbol=concat! symbol=lj2 
            
             [Node list symbol=reverse! symbol=resJ ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * f v D $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064611 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=f ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064611 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=construct 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=v symbol=Coeff ]
         ]
        
        [Node list symbol=f symbol=c 
        
         [Node list symbol=Sel symbol=D symbol=* ]
         ]
        ]
       
       [Node list symbol=v symbol=Dir ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF prolong v q $ $ SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064612 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=q ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064612 symbol=v 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=dirs 
       
        [Node list symbol=directions symbol=v ]
        ]
       
       [Node list symbol=LET symbol=coeffs 
       
        [Node list symbol=coefficients symbol=v ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=xi 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=eta 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=ind1 
        
         [Node list symbol=List 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=ind2 
        
         [Node list symbol=List 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=jv symbol=dirs ]
        
        [Node list symbol=IN symbol=co symbol=coeffs ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=jt 
         
          [Node list symbol=type symbol=jv ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF 
          
           [Node list symbol== symbol=jt 
           
            [Node list symbol=:: string=Indep 
            
             [Node list symbol=Symbol ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=xi 
            
             [Node list symbol=cons symbol=co symbol=xi ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=ind1 
             
              [Node list symbol=cons symbol=ind1 
              
               [Node list symbol=index symbol=jv ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=IF 
           
            [Node list symbol== symbol=jt 
            
             [Node list symbol=:: string=Dep 
             
              [Node list symbol=Symbol ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=eta 
             
              [Node list symbol=cons symbol=co symbol=eta ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=ind2 
              
               [Node list symbol=cons symbol=ind2 
               
                [Node list symbol=index symbol=jv ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=error string=not base vector field in prolong ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=dxi 
        
         [Node list symbol=Matrix symbol=D ]
         ]
        
        [Node list symbol=new symbol=nn 
        
         [Node list symbol=# symbol=xi ]
         
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=co symbol=xi ]
        
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=jm 
         
          [Node list symbol=jacobiMatrix 
          
           [Node list symbol=construct symbol=co ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=j 
           
            [Node list symbol=SEGMENT symbol=nn 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=qsetelt! symbol=dxi symbol=i symbol=j 
           
            [Node list symbol=DPhi 
            
             [Node list symbol=formalDiff2 symbol=co symbol=jm 
             
              [Node list symbol=:: symbol=j 
              
               [Node list symbol=PositiveInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=mm 
       
        [Node list symbol=: symbol=j 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=oldCo 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=co symbol=eta ]
        
        [Node list symbol=IN symbol=i symbol=ind2 ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=WHILE 
          
           [Node list symbol=> symbol=j symbol=i ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=oldCo 
           
            [Node list symbol=cons symbol=oldCo 
            
             [Node list symbol=Zero ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=j 
            
             [Node list symbol=- symbol=j 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=oldCo 
         
          [Node list symbol=cons symbol=co symbol=oldCo ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=j 
          
           [Node list symbol=- symbol=j 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5064613 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=j ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5064613 symbol=noBranch 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT symbol=j 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=LET symbol=oldCo 
           
            [Node list symbol=cons symbol=oldCo 
            
             [Node list symbol=Zero ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=oldDir 
        
         [Node list symbol=List symbol=JB ]
         ]
        
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT symbol=mm 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=U 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=PositiveInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=v 
       
        [Node list symbol=: symbol=res symbol=$ ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=qq 
        
         [Node list symbol=SEGMENT symbol=q 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=newCo 
          
           [Node list symbol=List symbol=D ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=newDir 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=jv symbol=oldDir ]
          
          [Node list symbol=IN symbol=co symbol=oldCo ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=jm 
           
            [Node list symbol=jacobiMatrix 
            
             [Node list symbol=construct symbol=co ]
             ]
            ]
           
           [Node list symbol=LET symbol=a 
           
            [Node list symbol=index symbol=jv ]
            ]
           
           [Node list symbol=LET symbol=mu 
           
            [Node list symbol=multiIndex symbol=jv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=IN symbol=k 
             
              [Node list symbol=SEGMENT symbol=nn 
              
               [Node list symbol=max 
               
                [Node list symbol=One ]
                
                [Node list symbol=class symbol=jv ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=newjv 
              
               [Node list symbol=:: symbol=JB 
               
                [Node list symbol=differentiate symbol=jv 
                
                 [Node list symbol=:: symbol=k 
                 
                  [Node list symbol=PositiveInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=newco 
              
               [Node list symbol=DPhi 
               
                [Node list symbol=formalDiff2 symbol=co symbol=jm 
                
                 [Node list symbol=:: symbol=k 
                 
                  [Node list symbol=PositiveInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=REPEAT 
              
               [Node list symbol=IN symbol=i symbol=ind1 ]
               
               [Node list symbol=IN symbol=j 
               
                [Node list symbol=SEGMENT 
                
                 [Node list symbol=One ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=nu 
                
                 [Node list symbol=copy symbol=mu ]
                 ]
                
                [Node list symbol=qsetelt! symbol=nu symbol=i 
                
                 [Node list symbol=+ 
                 
                  [Node list symbol=qelt symbol=nu symbol=i ]
                  
                  [Node list symbol=One ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=newco 
                 
                  [Node list symbol=- symbol=newco 
                  
                   [Node list symbol=* 
                   
                    [Node list symbol=qelt symbol=dxi symbol=j symbol=k ]
                    
                    [Node list symbol=:: symbol=D 
                    
                     [Node list symbol=a symbol=nu 
                     
                      [Node list symbol=Sel symbol=JB symbol=Pm ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=res 
              
               [Node list symbol=+ symbol=res 
               
                [Node list symbol=* symbol=newco 
                
                 [Node list symbol=diff symbol=newjv ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=newCo 
              
               [Node list symbol=cons symbol=newco symbol=newCo ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newDir 
               
                [Node list symbol=cons symbol=newjv symbol=newDir ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=oldCo symbol=newCo ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=oldDir symbol=newDir ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF eval v f D $ D SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=D ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=v symbol=Coeff ]
      ]
     
     [Node list symbol=IN symbol=jb 
     
      [Node list symbol=v symbol=Dir ]
      ]
     
     [Node list symbol=LET symbol=res 
     
      [Node list symbol=+ symbol=res 
      
       [Node list symbol=* symbol=c 
       
        [Node list symbol=differentiate symbol=f symbol=jb ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF commutator v w $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=rco 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=rjb 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=c1 
     
      [Node list symbol=v symbol=Coeff ]
      ]
     
     [Node list symbol=IN symbol=j1 
     
      [Node list symbol=v symbol=Dir ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=sum symbol=D ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=c2 
       
        [Node list symbol=w symbol=Coeff ]
        ]
       
       [Node list symbol=IN symbol=j2 
       
        [Node list symbol=w symbol=Dir ]
        ]
       
       [Node list symbol=LET symbol=sum 
       
        [Node list symbol=+ symbol=sum 
        
         [Node list symbol=* symbol=c2 
         
          [Node list symbol=differentiate symbol=c1 symbol=j2 ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5064614 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? symbol=sum ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5064614 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=rco 
         
          [Node list symbol=cons symbol=sum symbol=rco ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=rjb 
          
           [Node list symbol=cons symbol=j1 symbol=rjb ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res1 symbol=$ ]
     
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=rco ]
      
      [Node list symbol=reverse! symbol=rjb ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=rco 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=rjb 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=c2 
     
      [Node list symbol=w symbol=Coeff ]
      ]
     
     [Node list symbol=IN symbol=j2 
     
      [Node list symbol=w symbol=Dir ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=sum symbol=D ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=c1 
       
        [Node list symbol=v symbol=Coeff ]
        ]
       
       [Node list symbol=IN symbol=j1 
       
        [Node list symbol=v symbol=Dir ]
        ]
       
       [Node list symbol=LET symbol=sum 
       
        [Node list symbol=+ symbol=sum 
        
         [Node list symbol=* symbol=c1 
         
          [Node list symbol=differentiate symbol=c2 symbol=j1 ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5064615 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=zero? symbol=sum ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5064615 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=rco 
         
          [Node list symbol=cons symbol=sum symbol=rco ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=rjb 
          
           [Node list symbol=cons symbol=j2 symbol=rjb ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res2 symbol=$ ]
     
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=rco ]
      
      [Node list symbol=reverse! symbol=rjb ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=- symbol=res2 symbol=res1 ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF table lv SEQ
   DEFSubnode:atts= TwoDimensionalArray $
    [Node list symbol=TwoDimensionalArray symbol=$ ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET len
    [Node list symbol=LET symbol=len 
    
     [Node list symbol=# symbol=lv ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5064616 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=len ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5064616 
     
      [Node list symbol=error string=empty list in table ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=TwoDimensionalArray symbol=$ ]
         ]
        
        [Node list symbol=new symbol=len symbol=len 
        
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=UNTIL 
        
         [Node list symbol=empty? symbol=lv ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=v1 
         
          [Node list symbol=first symbol=lv ]
          ]
         
         [Node list symbol=LET symbol=lv 
         
          [Node list symbol=rest symbol=lv ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=v2 symbol=lv ]
           
           [Node list symbol=IN symbol=j 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=+ symbol=i 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=c 
            
             [Node list symbol=commutator symbol=v1 symbol=v2 ]
             ]
            
            [Node list symbol=qsetelt! symbol=res symbol=i symbol=j symbol=c ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=qsetelt! symbol=res symbol=j symbol=i 
             
              [Node list symbol=- symbol=c ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF lie v w $ $ $ commutator v w
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=Module symbol=D ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=diff 
    
     [Node list symbol=$ symbol=JB ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diffX 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diffU 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diffP 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coefficients 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directions 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coefficient 
    
     [Node list symbol=D symbol=$ symbol=JB ]
     ]
    
    [Node list symbol=SIGNATURE symbol=copy 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=commutator 
    
     [Node list symbol=$ symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=table 
    
     [Node list 
     
      [Node list symbol=TwoDimensionalArray symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=lie 
    
     [Node list symbol=$ symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=eval 
    
     [Node list symbol=D symbol=$ symbol=D ]
     ]
    
    [Node list symbol=SIGNATURE symbol=prolong 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleFunctionCategory JB
  [Node list symbol=JetBundleFunctionCategory symbol=JB ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetDifferential JB D
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Coeff 
     
      [Node list symbol=List symbol=D ]
      ]
     
     [Node list symbol=: symbol=Diff 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF d jb $ JB construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= construct jb
    [Node list symbol=construct symbol=jb ]
    
   ]
   
  CAPSULEDef:
   [DEF dX i $ d
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= i
    [Node list symbol=i 
    
     [Node list symbol=Sel symbol=JB symbol=X ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF dU i $ d
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= i
    [Node list symbol=i 
    
     [Node list symbol=Sel symbol=JB symbol=U ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF dP i mu $ d
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= i mu
    [Node list symbol=i symbol=mu 
    
     [Node list symbol=Sel symbol=JB symbol=P ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF monom c jb D JB SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065848 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=one? symbol=c ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065848 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=message string=d ]
       
       [Node list symbol=:: symbol=jb 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      
      [Node list symbol=* 
      
       [Node list symbol=:: symbol=c 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=hconcat 
       
        [Node list symbol=message string=d ]
        
        [Node list symbol=:: symbol=jb 
        
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce om $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065849 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=om symbol=Diff ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065849 
     
      [Node list symbol=:: 
      
       [Node list symbol=Sel symbol=D 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5065850 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? 
        
         [Node list symbol=# 
         
          [Node list symbol=om symbol=Diff ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5065850 
        
         [Node list symbol=monom 
         
          [Node list symbol=first 
          
           [Node list symbol=om symbol=Coeff ]
           ]
          
          [Node list symbol=first 
          
           [Node list symbol=om symbol=Diff ]
           ]
          ]
         
         [Node list symbol=reduce string=+ 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=c 
           
            [Node list symbol=om symbol=Coeff ]
            ]
           
           [Node list symbol=IN symbol=jb 
           
            [Node list symbol=om symbol=Diff ]
            ]
           
           [Node list symbol=monom symbol=c symbol=jb ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coefficients om $ copy
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= om Coeff
    [Node list symbol=om symbol=Coeff ]
    
   ]
   
  CAPSULEDef:
   [DEF differentials om $ copy
   DEFSubnode:atts= List JB
    [Node list symbol=List symbol=JB ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= om Diff
    [Node list symbol=om symbol=Diff ]
    
   ]
   
  CAPSULEDef:
   [DEF coefficient om jb D $ JB SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET pos
    [Node list symbol=LET symbol=pos 
    
     [Node list symbol=position symbol=jb 
     
      [Node list symbol=om symbol=Diff ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065851 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=< symbol=pos 
     
      [Node list symbol=minIndex 
      
       [Node list symbol=om symbol=Diff ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065851 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=qelt symbol=pos 
      
       [Node list symbol=om symbol=Coeff ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF copy om $ $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= copy
    [Node list symbol=copy 
    
     [Node list symbol=om symbol=Coeff ]
     ]
    
   DEFSubnode:atts= copy
    [Node list symbol=copy 
    
     [Node list symbol=om symbol=Diff ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF Zero $ construct empty empty
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF zero? om $ empty?
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= om Diff
    [Node list symbol=om symbol=Diff ]
    
   ]
   
  CAPSULEDef:
   [DEF - om $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=c 
     
      [Node list symbol=om symbol=Coeff ]
      ]
     
     [Node list symbol=c 
     
      [Node list symbol=Sel symbol=D symbol=- ]
      ]
     ]
    
   DEFSubnode:atts= om Diff
    [Node list symbol=om symbol=Diff ]
    
   ]
   
  CAPSULEDef:
   [DEF + om1 om2 $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065852 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=om1 ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065852 symbol=om2 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5065853 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=om2 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5065853 symbol=om1 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=lc2 
          
           [Node list symbol=copy 
           
            [Node list symbol=om2 symbol=Coeff ]
            ]
           ]
          
          [Node list symbol=LET symbol=lj2 
          
           [Node list symbol=copy 
           
            [Node list symbol=om2 symbol=Diff ]
            ]
           ]
          
          [Node list symbol=LET symbol=resC 
          
           [Node list 
           
            [Node list symbol=Sel symbol=empty 
            
             [Node list symbol=List symbol=D ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=resJ 
          
           [Node list 
           
            [Node list symbol=Sel symbol=empty 
            
             [Node list symbol=List symbol=JB ]
             ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=c1 
           
            [Node list symbol=om1 symbol=Coeff ]
            ]
           
           [Node list symbol=IN symbol=j1 
           
            [Node list symbol=om1 symbol=Diff ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5065854 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=lj2 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5065854 symbol=false 
                
                 [Node list symbol=< symbol=j1 
                 
                  [Node list symbol=first symbol=lj2 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=resC 
              
               [Node list symbol=cons symbol=resC 
               
                [Node list symbol=first symbol=lc2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=resJ 
              
               [Node list symbol=cons symbol=resJ 
               
                [Node list symbol=first symbol=lj2 ]
                ]
               ]
              
              [Node list symbol=LET symbol=lc2 
              
               [Node list symbol=rest symbol=lc2 ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=lj2 
               
                [Node list symbol=rest symbol=lj2 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5065855 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=lj2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5065855 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=resC 
               
                [Node list symbol=cons symbol=c1 symbol=resC ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=resJ 
                
                 [Node list symbol=cons symbol=j1 symbol=resJ ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5065857 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol== symbol=j1 
                
                 [Node list symbol=first symbol=lj2 ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5065857 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=sum 
                  
                   [Node list symbol=c1 
                   
                    [Node list symbol=Sel symbol=D symbol=+ ]
                    
                    [Node list symbol=first symbol=lc2 ]
                    ]
                   ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=G5065856 
                    
                     [Node list symbol=Boolean ]
                     ]
                    
                    [Node list symbol=zero? symbol=sum ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=IF symbol=G5065856 symbol=noBranch 
                    
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET symbol=resC 
                      
                       [Node list symbol=cons symbol=sum symbol=resC ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=LET symbol=resJ 
                       
                        [Node list symbol=cons symbol=j1 symbol=resJ ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=lc2 
                  
                   [Node list symbol=rest symbol=lc2 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=lj2 
                   
                    [Node list symbol=rest symbol=lj2 ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=resC 
                  
                   [Node list symbol=cons symbol=c1 symbol=resC ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=resJ 
                   
                    [Node list symbol=cons symbol=j1 symbol=resJ ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=construct 
           
            [Node list symbol=concat! symbol=lc2 
            
             [Node list symbol=reverse! symbol=resC ]
             ]
            
            [Node list symbol=concat! symbol=lj2 
            
             [Node list symbol=reverse! symbol=resJ ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * f om D $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065858 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=f ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065858 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=construct 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=c 
        
         [Node list symbol=om symbol=Coeff ]
         ]
        
        [Node list symbol=f symbol=c 
        
         [Node list symbol=Sel symbol=D symbol=* ]
         ]
        ]
       
       [Node list symbol=om symbol=Diff ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF d f $ D SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET JV
    [Node list symbol=LET symbol=JV 
    
     [Node list symbol=reverse! 
     
      [Node list symbol=jetVariables symbol=f ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065859 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=JV ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065859 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=Co 
        
         [Node list symbol=List symbol=D ]
         ]
        
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=jv symbol=JV ]
         
         [Node list symbol=differentiate symbol=f symbol=jv ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct symbol=Co symbol=JV ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF eval om v D $ SEQ
   DEFSubnode:atts= JetVectorField JB D
    [Node list symbol=JetVectorField symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5065860 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=om ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5065860 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5065861 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=v ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5065861 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=lc2 
           
            [Node list symbol=List symbol=D ]
            ]
           
           [Node list symbol=copy 
           
            [Node list symbol=coefficients symbol=v ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=lj2 
           
            [Node list symbol=List symbol=JB ]
            ]
           
           [Node list symbol=copy 
           
            [Node list symbol=directions symbol=v ]
            ]
           ]
          
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=Sel symbol=D 
           
            [Node list symbol=Zero ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=c1 
           
            [Node list symbol=om symbol=Coeff ]
            ]
           
           [Node list symbol=IN symbol=j1 
           
            [Node list symbol=om symbol=Diff ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5065862 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=lj2 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5065862 symbol=false 
                
                 [Node list symbol=< symbol=j1 
                 
                  [Node list symbol=first symbol=lj2 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=lc2 
              
               [Node list symbol=rest symbol=lc2 ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=lj2 
               
                [Node list symbol=rest symbol=lj2 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5065863 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=lj2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5065863 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5065864 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol== symbol=j1 
                
                 [Node list symbol=first symbol=lj2 ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5065864 symbol=noBranch 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=res 
                  
                   [Node list symbol=+ symbol=res 
                   
                    [Node list symbol=* symbol=c1 
                    
                     [Node list symbol=first symbol=lc2 ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=lc2 
                  
                   [Node list symbol=rest symbol=lc2 ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=lj2 
                   
                    [Node list symbol=rest symbol=lj2 ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 symbol=res ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF contract v om D $ eval om v
   DEFSubnode:atts= JetVectorField JB D
    [Node list symbol=JetVectorField symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=Module symbol=D ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=d 
    
     [Node list symbol=$ symbol=JB ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dX 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dU 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=dP 
    
     [Node list symbol=$ 
     
      [Node list symbol=PositiveInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=d 
    
     [Node list symbol=$ symbol=D ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coefficients 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=differentials 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coefficient 
    
     [Node list symbol=D symbol=$ symbol=JB ]
     ]
    
    [Node list symbol=SIGNATURE symbol=copy 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=lie 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=JetVectorField symbol=JB symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=contract 
    
     [Node list symbol=D symbol=$ 
     
      [Node list symbol=JetVectorField symbol=JB symbol=D ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=eval 
    
     [Node list symbol=D symbol=$ 
     
      [Node list symbol=JetVectorField symbol=JB symbol=D ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleFunctionCategory JB
  [Node list symbol=JetBundleFunctionCategory symbol=JB ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetDifferentialEquation JB D
 DEFCategories:
  [CATEGORY  domain
  CATEGORYSig:
   [SIGNATURE  order
   SIGNATURE params:NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  coerce
   SIGNATURE params:OutputForm 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  printSys
   SIGNATURE params:OutputForm 
   List D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  display
   SIGNATURE params:Void 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  copy
   SIGNATURE params:
   ]
   
  CATEGORYSig:
   [SIGNATURE  retract
   SIGNATURE params:List D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  jacobiMatrix
   SIGNATURE params:List SparseEchelonMatrix JB D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  makeSystem
   SIGNATURE params:List D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  join
   SIGNATURE params:
   ]
   
  CATEGORYSig:
   [SIGNATURE  insert
   SIGNATURE params:List D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  dimension
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  setSimpMode
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  simplify
   SIGNATURE params:Record : SDe $ : IC List D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  extractSymbol
   SIGNATURE params:SparseEchelonMatrix JB D 
   Boolean 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  analyseSymbol
   SIGNATURE params:Record : Rank NonNegativeInteger : NumMultVar NonNegativeInteger : Betas List NonNegativeInteger 
   SparseEchelonMatrix JB D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  prolongSymbol
   SIGNATURE params:SparseEchelonMatrix JB D 
   SparseEchelonMatrix JB D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  prolongMV
   SIGNATURE params:Record : Rank NonNegativeInteger : NumMultVar NonNegativeInteger : Betas List NonNegativeInteger 
   Record : Rank NonNegativeInteger : NumMultVar NonNegativeInteger : Betas List NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  project
   SIGNATURE params:NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  prolong
   SIGNATURE params:Record : SDe $ : IC List D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  prolong
   SIGNATURE params:Record : SDe $ : IC List D 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  tableau
   SIGNATURE params:SparseEchelonMatrix JB D 
   SparseEchelonMatrix JB D 
   JetDifferential JB D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  tableau
   SIGNATURE params:SparseEchelonMatrix JB D 
   SparseEchelonMatrix JB D 
   List JetDifferential JB D 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numIndVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mm 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numDepVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=simpMode 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=Zero ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=SysRec 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Eqs 
     
      [Node list symbol=List symbol=D ]
      ]
     
     [Node list symbol=: symbol=JM 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
      ]
     
     [Node list symbol=: symbol=Deriv 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=: symbol=Prolonged? 
     
      [Node list symbol=List 
      
       [Node list symbol=Boolean ]
       ]
      ]
     
     [Node list symbol=: symbol=Simp? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=Dim? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=Dim 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Sys 
     
      [Node list symbol=List symbol=SysRec ]
      ]
     
     [Node list symbol=: symbol=Order 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF setSimpMode i SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET j simpMode
    [Node list symbol=LET symbol=j symbol=simpMode ]
    
   DEFSubnode:atts= LET simpMode i
    [Node list symbol=LET symbol=simpMode symbol=i ]
    
   DEFSubnode:atts= exit 1 j
    [Node list symbol=exit int=1 symbol=j ]
    
   ]
   
  CAPSULEDef:
   [DEF adapt der pro? dep IF
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Der 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=: symbol=Pro? 
     
      [Node list symbol=List 
      
       [Node list symbol=Boolean ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Boolean ]
     ]
    
   DEFSubnode:atts= Union failed
    [Node list symbol=Union string=failed 
    
     [Node list symbol=List 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case dep failed
    [Node list symbol=case symbol=dep string=failed ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i symbol=der ]
      
      [Node list symbol=One ]
      ]
     
     [Node list symbol=COLLECT symbol=false 
     
      [Node list symbol=IN symbol=i symbol=der ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=resDer 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=empty 
     
      [Node list symbol=: symbol=resPro? 
      
       [Node list symbol=List 
       
        [Node list symbol=Boolean ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=d 
      
       [Node list symbol=:: symbol=dep 
       
        [Node list symbol=List 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066882 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? 
        
         [Node list symbol=# symbol=d ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066882 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=resDer 
          
           [Node list symbol=cons symbol=resDer 
           
            [Node list symbol=qelt symbol=der 
            
             [Node list symbol=first symbol=d ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=resPro? 
           
            [Node list symbol=cons symbol=resPro? 
            
             [Node list symbol=qelt symbol=pro? 
             
              [Node list symbol=first symbol=d ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=j 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=reduce symbol=min 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=i symbol=d ]
             
             [Node list symbol=qelt symbol=der symbol=i ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=b 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=reduce string=and 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=i symbol=d ]
             
             [Node list symbol=qelt symbol=pro? symbol=i ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=resDer 
          
           [Node list symbol=cons symbol=j symbol=resDer ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=resPro? 
           
            [Node list symbol=cons symbol=b symbol=resPro? ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct 
      
       [Node list symbol=reverse! symbol=resDer ]
       
       [Node list symbol=reverse! symbol=resPro? ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF copy De $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newSys 
     
      [Node list symbol=List symbol=SysRec ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=sys 
      
       [Node list symbol=De symbol=Sys ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=copy 
       
        [Node list symbol=sys symbol=Eqs ]
        ]
       
       [Node list symbol=copy 
       
        [Node list symbol=sys symbol=JM ]
        ]
       
       [Node list symbol=copy 
       
        [Node list symbol=sys symbol=Deriv ]
        ]
       
       [Node list symbol=copy 
       
        [Node list symbol=sys symbol=Prolonged? ]
        ]
       
       [Node list symbol=sys symbol=Simp? ]
       
       [Node list symbol=sys symbol=Dim? ]
       
       [Node list symbol=sys symbol=Dim ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET newOrd
    [Node list symbol=LET symbol=newOrd 
    
     [Node list symbol=copy 
     
      [Node list symbol=De symbol=Order ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newSys symbol=newOrd ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF order De $ SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5066883 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=De symbol=Order ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5066883 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=first 
      
       [Node list symbol=De symbol=Order ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF retract De $ SEQ
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET LSys
    [Node list symbol=LET symbol=LSys 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=sys 
      
       [Node list symbol=De symbol=Sys ]
       ]
      
      [Node list symbol=sys symbol=Eqs ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=reduce symbol=append symbol=LSys symbol=empty ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF jacobiMatrix De $ COLLECT
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= IN sys
    [Node list symbol=IN symbol=sys 
    
     [Node list symbol=De symbol=Sys ]
     ]
    
   DEFSubnode:atts= sys JM
    [Node list symbol=sys symbol=JM ]
    
   ]
   
  CAPSULEDef:
   [DEF printSys sys SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5066884 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=sys ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5066884 symbol=empty 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=leq 
        
         [Node list symbol=List 
         
          [Node list symbol=Equation symbol=D ]
          ]
         ]
        
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=eq symbol=sys ]
         
         [Node list symbol== symbol=eq 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=tmp 
        
         [Node list symbol=List 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=eq symbol=leq ]
        
        [Node list symbol=LET symbol=tmp 
        
         [Node list symbol=cons 
         
          [Node list symbol=:: symbol=eq 
          
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=cons symbol=tmp 
          
           [Node list symbol=message string=  ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=vconcat 
        
         [Node list symbol=reverse symbol=tmp ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce De $ printSys
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= retract De
    [Node list symbol=retract symbol=De ]
    
   ]
   
  CAPSULEDef:
   [DEF display De $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=sys 
     
      [Node list symbol=De symbol=Sys ]
      ]
     
     [Node list symbol=IN symbol=ord 
     
      [Node list symbol=De symbol=Order ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=hconcat 
       
        [Node list symbol=message string=Order:  ]
        
        [Node list symbol=:: symbol=ord 
        
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=message string=  System: ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=hconcat 
       
        [Node list symbol=message string=     ]
        
        [Node list symbol=printSys 
        
         [Node list symbol=sys symbol=Eqs ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066885 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=sys symbol=Simp? ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066885 symbol=noBranch 
        
         [Node list 
         
          [Node list symbol=Sel symbol=print 
          
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=message string=    (system simplified) ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066886 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=sys symbol=Dim? ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066886 symbol=noBranch 
        
         [Node list 
         
          [Node list symbol=Sel symbol=print 
          
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=hconcat 
          
           [Node list symbol=message string=  Dimension:  ]
           
           [Node list symbol=:: 
           
            [Node list symbol=sys symbol=Dim ]
            
            [Node list symbol=OutputForm ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=message string=  Jacobi matrix: ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=hconcat 
       
        [Node list symbol=message string=     ]
        
        [Node list symbol=:: 
        
         [Node list symbol=sys symbol=JM ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=hconcat 
       
        [Node list symbol=message string=     ]
        
        [Node list symbol=:: 
        
         [Node list symbol=allIndices 
         
          [Node list symbol=sys symbol=JM ]
          ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=message string=  Last derivations: ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list 
       
        [Node list symbol=Sel symbol=print 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=hconcat 
        
         [Node list symbol=message string=     ]
         
         [Node list symbol=:: 
         
          [Node list symbol=sys symbol=Deriv ]
          
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF makeSystem2 sys jm der $ SEQ
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lord 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=nrows symbol=jm ]
        ]
       ]
      
      [Node list symbol=order 
      
       [Node list symbol=first 
       
        [Node list symbol=Indices 
        
         [Node list symbol=row symbol=jm symbol=i ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resOrd
    [Node list symbol=LET symbol=resOrd 
    
     [Node list symbol=reverse 
     
      [Node list symbol=sort 
      
       [Node list symbol=removeDuplicates symbol=lord ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET nord
    [Node list symbol=LET symbol=nord 
    
     [Node list symbol=# symbol=resOrd ]
     ]
    
   DEFSubnode:atts= LET inds
    [Node list symbol=LET symbol=inds 
    
     [Node list symbol=allIndices symbol=jm ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=ljm 
     
      [Node list symbol=List 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=q symbol=resOrd ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=REPEAT 
      
       [Node list symbol=WHILE 
       
        [Node list symbol=> symbol=q 
        
         [Node list symbol=order 
         
          [Node list symbol=first symbol=inds ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=inds 
       
        [Node list symbol=rest symbol=inds ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=ljm 
       
        [Node list symbol=cons symbol=ljm 
        
         [Node list symbol=new symbol=inds 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=vsys 
     
      [Node list symbol=Vector 
      
       [Node list symbol=List symbol=D ]
       ]
      ]
     
     [Node list symbol=new symbol=nord symbol=empty ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=vder 
     
      [Node list symbol=Vector 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=new symbol=nord symbol=empty ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=vjm 
     
      [Node list symbol=Vector 
      
       [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
       ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=ljm ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=eq 
     
      [Node list symbol=reverse symbol=sys ]
      ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=reverse symbol=der ]
      ]
     
     [Node list symbol=IN symbol=q 
     
      [Node list symbol=reverse symbol=lord ]
      ]
     
     [Node list symbol=INBY symbol=j 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=nrows symbol=jm ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=- 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=pos 
      
       [Node list symbol=- 
       
        [Node list symbol=+ 
        
         [Node list symbol=position symbol=q symbol=resOrd ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=minIndex symbol=resOrd ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5066887 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? 
       
        [Node list symbol=qelt symbol=vsys symbol=pos ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5066887 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=qsetelt! symbol=vsys symbol=pos 
         
          [Node list symbol=construct symbol=eq ]
          ]
         
         [Node list symbol=setRow! 
         
          [Node list symbol=qelt symbol=vjm symbol=pos ]
          
          [Node list symbol=One ]
          
          [Node list symbol=row symbol=jm symbol=j ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=qsetelt! symbol=vder symbol=pos 
          
           [Node list symbol=construct symbol=i ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=qsetelt! symbol=vsys symbol=pos 
         
          [Node list symbol=cons symbol=eq 
          
           [Node list symbol=qelt symbol=vsys symbol=pos ]
           ]
          ]
         
         [Node list symbol=consRow! 
         
          [Node list symbol=qelt symbol=vjm symbol=pos ]
          
          [Node list symbol=row symbol=jm symbol=j ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=qsetelt! symbol=vder symbol=pos 
          
           [Node list symbol=cons symbol=i 
           
            [Node list symbol=qelt symbol=vder symbol=pos ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resSys 
     
      [Node list symbol=List symbol=SysRec ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ord symbol=resOrd ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=minIndex symbol=vsys ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=rec symbol=SysRec ]
       
       [Node list symbol=construct symbol=false symbol=false 
       
        [Node list symbol=qelt symbol=vsys symbol=i ]
        
        [Node list symbol=qelt symbol=vjm symbol=i ]
        
        [Node list symbol=qelt symbol=vder symbol=i ]
        
        [Node list symbol=new symbol=false 
        
         [Node list symbol=# 
         
          [Node list symbol=qelt symbol=vder symbol=i ]
          ]
         ]
        
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=resSys 
       
        [Node list symbol=cons symbol=rec symbol=resSys ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=resOrd 
     
      [Node list symbol=reverse! symbol=resSys ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF makeSystem sys $ SEQ
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5066888 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=sys ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5066888 
     
      [Node list symbol=construct 
      
       [Node list symbol=construct ]
       
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=nsys 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=eq symbol=sys ]
         
         [Node list symbol=numerator symbol=eq ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=der 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=eq symbol=nsys ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=jm 
        
         [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
         ]
        
        [Node list symbol=jacobiMatrix symbol=nsys ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=makeSystem2 symbol=nsys symbol=jm symbol=der ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF join De1 De2 $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET cDe1
    [Node list symbol=LET symbol=cDe1 
    
     [Node list symbol=copy symbol=De1 ]
     ]
    
   DEFSubnode:atts= LET cDe2
    [Node list symbol=LET symbol=cDe2 
    
     [Node list symbol=copy symbol=De2 ]
     ]
    
   DEFSubnode:atts= LET sys1
    [Node list symbol=LET symbol=sys1 
    
     [Node list symbol=cDe1 symbol=Sys ]
     ]
    
   DEFSubnode:atts= LET sys2
    [Node list symbol=LET symbol=sys2 
    
     [Node list symbol=cDe2 symbol=Sys ]
     ]
    
   DEFSubnode:atts= LET ord1
    [Node list symbol=LET symbol=ord1 
    
     [Node list symbol=cDe1 symbol=Order ]
     ]
    
   DEFSubnode:atts= LET ord2
    [Node list symbol=LET symbol=ord2 
    
     [Node list symbol=cDe2 symbol=Order ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resSys 
     
      [Node list symbol=List symbol=SysRec ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resOrd 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066889 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=ord1 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066889 symbol=true 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5066890 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=ord2 ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5066890 symbol=false symbol=true ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5066892 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=ord1 ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5066892 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=resSys 
         
          [Node list symbol=concat! symbol=resSys 
          
           [Node list symbol=reverse! symbol=sys2 ]
           ]
          ]
         
         [Node list symbol=LET symbol=resOrd 
         
          [Node list symbol=concat! symbol=resOrd 
          
           [Node list symbol=reverse! symbol=ord2 ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=ord2 symbol=empty ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5066891 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=ord2 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5066891 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=resSys 
            
             [Node list symbol=concat! symbol=resSys 
             
              [Node list symbol=reverse! symbol=sys1 ]
              ]
             ]
            
            [Node list symbol=LET symbol=resOrd 
            
             [Node list symbol=concat! symbol=resOrd 
             
              [Node list symbol=reverse! symbol=ord1 ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=ord1 symbol=empty ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=o1 
            
             [Node list symbol=first symbol=ord1 ]
             ]
            
            [Node list symbol=LET symbol=o2 
            
             [Node list symbol=first symbol=ord2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF 
             
              [Node list symbol=> symbol=o1 symbol=o2 ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=resSys 
               
                [Node list symbol=cons symbol=resSys 
                
                 [Node list symbol=first symbol=sys1 ]
                 ]
                ]
               
               [Node list symbol=LET symbol=resOrd 
               
                [Node list symbol=cons symbol=o1 symbol=resOrd ]
                ]
               
               [Node list symbol=LET symbol=sys1 
               
                [Node list symbol=rest symbol=sys1 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=ord1 
                
                 [Node list symbol=rest symbol=ord1 ]
                 ]
                ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol=> symbol=o2 symbol=o1 ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=resSys 
                
                 [Node list symbol=cons symbol=resSys 
                 
                  [Node list symbol=first symbol=sys2 ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=resOrd 
                
                 [Node list symbol=cons symbol=o2 symbol=resOrd ]
                 ]
                
                [Node list symbol=LET symbol=sys2 
                
                 [Node list symbol=rest symbol=sys2 ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=ord2 
                 
                  [Node list symbol=rest symbol=ord2 ]
                  ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=rec1 
                
                 [Node list symbol=first symbol=sys1 ]
                 ]
                
                [Node list symbol=LET symbol=rec2 
                
                 [Node list symbol=first symbol=sys2 ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=rec symbol=SysRec ]
                 
                 [Node list symbol=construct symbol=false symbol=false 
                 
                  [Node list symbol=concat! 
                  
                   [Node list symbol=rec1 symbol=Eqs ]
                   
                   [Node list symbol=rec2 symbol=Eqs ]
                   ]
                  
                  [Node list symbol=join 
                  
                   [Node list symbol=rec1 symbol=JM ]
                   
                   [Node list symbol=rec2 symbol=JM ]
                   ]
                  
                  [Node list symbol=concat! 
                  
                   [Node list symbol=rec1 symbol=Deriv ]
                   
                   [Node list symbol=rec2 symbol=Deriv ]
                   ]
                  
                  [Node list symbol=concat! 
                  
                   [Node list symbol=rec1 symbol=Prolonged? ]
                   
                   [Node list symbol=rec2 symbol=Prolonged? ]
                   ]
                  
                  [Node list symbol=Zero ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=resSys 
                
                 [Node list symbol=cons symbol=rec symbol=resSys ]
                 ]
                
                [Node list symbol=LET symbol=resOrd 
                
                 [Node list symbol=cons symbol=o1 symbol=resOrd ]
                 ]
                
                [Node list symbol=LET symbol=sys1 
                
                 [Node list symbol=rest symbol=sys1 ]
                 ]
                
                [Node list symbol=LET symbol=sys2 
                
                 [Node list symbol=rest symbol=sys2 ]
                 ]
                
                [Node list symbol=LET symbol=ord1 
                
                 [Node list symbol=rest symbol=ord1 ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=ord2 
                 
                  [Node list symbol=rest symbol=ord2 ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=resSys ]
      
      [Node list symbol=reverse! symbol=resOrd ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF insert sys De $ $ SEQ
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newDe symbol=$ ]
     
     [Node list symbol=makeSystem symbol=sys ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=join symbol=De symbol=newDe ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF dimension De q $ SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5066893 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=De symbol=Order ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5066893 
     
      [Node list symbol=q 
      
       [Node list symbol=Sel symbol=JB symbol=dimJ ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=simp? 
       
        [Node list symbol=Sel symbol=true 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=LET symbol=tsys 
       
        [Node list symbol=copy 
        
         [Node list symbol=De symbol=Sys ]
         ]
        ]
       
       [Node list symbol=LET symbol=tord 
       
        [Node list symbol=copy 
        
         [Node list symbol=De symbol=Order ]
         ]
        ]
       
       [Node list symbol=LET symbol=resSys 
       
        [Node list 
        
         [Node list symbol=Sel symbol=empty 
         
          [Node list symbol=List symbol=SysRec ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=> symbol=q 
         
          [Node list symbol=first symbol=tord ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=resSys 
         
          [Node list symbol=cons symbol=resSys 
          
           [Node list symbol=first symbol=tsys ]
           ]
          ]
         
         [Node list symbol=LET symbol=tsys 
         
          [Node list symbol=rest symbol=tsys ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=tord 
          
           [Node list symbol=rest symbol=tord ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=qq 
       
        [Node list symbol=:: symbol=q 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=Sel 
        
         [Node list symbol=NonNegativeInteger ]
         
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=sys symbol=tsys ]
        
        [Node list symbol=IN symbol=ord symbol=tord ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=SEGMENT symbol=qq 
           
            [Node list symbol=+ symbol=ord 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=+ symbol=res 
           
            [Node list symbol=j 
            
             [Node list symbol=Sel symbol=JB symbol=dimS ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=qq 
         
          [Node list symbol=- symbol=ord 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=LET symbol=simp? 
         
          [Node list symbol=IF symbol=simp? symbol=false 
          
           [Node list symbol=sys symbol=Simp? ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5066894 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=sys symbol=Dim? ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5066894 
           
            [Node list symbol=LET symbol=res 
            
             [Node list symbol=+ symbol=res 
             
              [Node list symbol=sys symbol=Dim ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=d 
             
              [Node list symbol=ord 
              
               [Node list symbol=Sel symbol=D symbol=orderDim ]
               
               [Node list symbol=sys symbol=Eqs ]
               
               [Node list symbol=sys symbol=JM ]
               ]
              ]
             
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=+ symbol=res symbol=d ]
              ]
             
             [Node list symbol=LET symbol=true 
             
              [Node list symbol=sys symbol=Dim? ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=d 
              
               [Node list symbol=sys symbol=Dim ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=resSys 
          
           [Node list symbol=cons symbol=sys symbol=resSys ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=simp? symbol=noBranch 
       
        [Node list 
        
         [Node list symbol=Sel symbol=print 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=message string=***** Warning: system not simplified in dimension ]
         ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol=>= symbol=qq 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=+ symbol=res 
         
          [Node list 
          
           [Node list symbol=Sel symbol=JB symbol=dimJ ]
           
           [Node list symbol=:: symbol=qq 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=De symbol=Sys ]
        
        [Node list symbol=reverse! symbol=resSys ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF simplify De $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=SDe symbol=$ ]
     
     [Node list symbol=: symbol=IC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET resSys
    [Node list symbol=LET symbol=resSys 
    
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List symbol=SysRec ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resOrd
    [Node list symbol=LET symbol=resOrd 
    
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ICs
    [Node list symbol=LET symbol=ICs 
    
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List symbol=D ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET cDe
    [Node list symbol=LET symbol=cDe 
    
     [Node list symbol=copy symbol=De ]
     ]
    
   DEFSubnode:atts= LET tsys
    [Node list symbol=LET symbol=tsys 
    
     [Node list symbol=cDe symbol=Sys ]
     ]
    
   DEFSubnode:atts= LET tord
    [Node list symbol=LET symbol=tord 
    
     [Node list symbol=cDe symbol=Order ]
     ]
    
   DEFSubnode:atts= LET AllEqs
    [Node list symbol=LET symbol=AllEqs 
    
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List symbol=D ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=> symbol=simpMode 
     
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET symbol=AllEqs 
     
      [Node list symbol=retract symbol=cDe ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066895 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=tord ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066895 symbol=false symbol=true ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=q 
      
       [Node list symbol=first symbol=tord ]
       ]
      
      [Node list symbol=LET symbol=sys 
      
       [Node list symbol=first symbol=tsys ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066901 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=sys symbol=Simp? ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066901 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=resSys 
          
           [Node list symbol=cons symbol=sys symbol=resSys ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=resOrd 
           
            [Node list symbol=cons symbol=q symbol=resOrd ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=IF symbol=noBranch 
          
           [Node list symbol=> symbol=simpMode 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=WHILE 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G5066896 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=AllEqs ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G5066896 symbol=false 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G5066897 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=< symbol=q 
                  
                   [Node list symbol=order 
                   
                    [Node list symbol=first symbol=AllEqs ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G5066897 symbol=false symbol=true ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=AllEqs 
            
             [Node list symbol=rest symbol=AllEqs ]
             ]
            ]
           ]
          
          [Node list symbol=IF 
          
           [Node list symbol=> symbol=simpMode 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=tmp 
            
             [Node list symbol=AllEqs 
             
              [Node list symbol=Sel symbol=D symbol=simpMod ]
              
              [Node list symbol=sys symbol=Eqs ]
              
              [Node list symbol=sys symbol=JM ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=tmp 
             
              [Node list 
              
               [Node list symbol=Sel symbol=D symbol=simplify ]
               
               [Node list symbol=tmp symbol=Sys ]
               
               [Node list symbol=tmp symbol=JM ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=tmp 
           
            [Node list 
            
             [Node list symbol=Sel symbol=D symbol=simplify ]
             
             [Node list symbol=sys symbol=Eqs ]
             
             [Node list symbol=sys symbol=JM ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=newEqs 
          
           [Node list symbol=tmp symbol=Sys ]
           ]
          
          [Node list symbol=LET symbol=newJM 
          
           [Node list symbol=tmp symbol=JM ]
           ]
          
          [Node list symbol=LET symbol=ad 
          
           [Node list symbol=adapt 
           
            [Node list symbol=sys symbol=Deriv ]
            
            [Node list symbol=sys symbol=Prolonged? ]
            
            [Node list symbol=tmp symbol=Depend ]
            ]
           ]
          
          [Node list symbol=LET symbol=newDer 
          
           [Node list symbol=ad symbol=Der ]
           ]
          
          [Node list symbol=LET symbol=newPro? 
          
           [Node list symbol=ad symbol=Pro? ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=j 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=eq symbol=newEqs ]
           
           [Node list symbol=IN symbol=pro? symbol=newPro? ]
           
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=o 
            
             [Node list symbol=order 
             
              [Node list symbol=first 
              
               [Node list symbol=Indices 
               
                [Node list symbol=row symbol=newJM 
                
                 [Node list symbol=- symbol=i symbol=j ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF 
             
              [Node list symbol=> symbol=o symbol=q ]
              
              [Node list symbol=error string=order raised in simplify ]
              
              [Node list symbol=IF symbol=noBranch 
              
               [Node list symbol=< symbol=o symbol=q ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=ICs 
                
                 [Node list symbol=cons symbol=eq symbol=ICs ]
                 ]
                
                [Node list symbol=LET symbol=j 
                
                 [Node list symbol=+ symbol=j 
                 
                  [Node list symbol=One ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=pos1 
                
                 [Node list symbol=+ 
                 
                  [Node list symbol=- symbol=i symbol=j ]
                  
                  [Node list symbol=One ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=pos2 
                
                 [Node list symbol=+ 
                 
                  [Node list symbol=- symbol=i symbol=j ]
                  
                  [Node list symbol=minIndex symbol=newEqs ]
                  ]
                 ]
                
                [Node list symbol=LET symbol=newEqs 
                
                 [Node list symbol=delete symbol=newEqs symbol=pos2 ]
                 ]
                
                [Node list symbol=LET symbol=newDer 
                
                 [Node list symbol=delete symbol=newDer symbol=pos2 ]
                 ]
                
                [Node list symbol=LET symbol=newPro? 
                
                 [Node list symbol=delete symbol=newPro? symbol=pos2 ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=djm 
                 
                  [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
                  ]
                 
                 [Node list symbol=extract symbol=newJM symbol=pos1 symbol=pos1 ]
                 ]
                
                [Node list symbol=sortedPurge! symbol=djm 
                
                 [Node list symbol=> symbol=o 
                 
                  [Node list symbol=order symbol=#1 ]
                  ]
                 ]
                
                [Node list symbol=deleteRow! symbol=newJM symbol=pos1 ]
                
                [Node list symbol=LET symbol=pos 
                
                 [Node list symbol=position symbol=o symbol=tord ]
                 ]
                
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G5066900 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=>= symbol=pos 
                 
                  [Node list symbol=minIndex symbol=tord ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G5066900 
                 
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=rec symbol=SysRec ]
                    
                    [Node list symbol=qelt symbol=tsys symbol=pos ]
                    ]
                   
                   [Node list symbol=concat! symbol=eq 
                   
                    [Node list symbol=rec symbol=Eqs ]
                    ]
                   
                   [Node list symbol=appendRow! 
                   
                    [Node list symbol=rec symbol=JM ]
                    
                    [Node list symbol=row symbol=djm 
                    
                     [Node list symbol=One ]
                     ]
                    ]
                   
                   [Node list symbol=concat! 
                   
                    [Node list symbol=rec symbol=Deriv ]
                    
                    [Node list symbol=One ]
                    ]
                   
                   [Node list symbol=concat! symbol=pro? 
                   
                    [Node list symbol=rec symbol=Prolonged? ]
                    ]
                   
                   [Node list symbol=LET symbol=false 
                   
                    [Node list symbol=rec symbol=Simp? ]
                    ]
                   
                   [Node list symbol=LET symbol=false 
                   
                    [Node list symbol=rec symbol=Dim? ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=rec symbol=Dim ]
                    
                    [Node list symbol=Zero ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=qsetelt! symbol=tsys symbol=pos symbol=rec ]
                    ]
                   ]
                  
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=rec symbol=SysRec ]
                    
                    [Node list symbol=construct symbol=djm symbol=false symbol=false 
                    
                     [Node list symbol=construct symbol=eq ]
                     
                     [Node list symbol=construct 
                     
                      [Node list symbol=One ]
                      ]
                     
                     [Node list symbol=construct symbol=pro? ]
                     
                     [Node list symbol=Zero ]
                     ]
                    ]
                   
                   [Node list symbol=LET symbol=empty 
                   
                    [Node list symbol=: symbol=hord 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=LET symbol=pos 
                   
                    [Node list symbol=- 
                    
                     [Node list symbol=minIndex symbol=tord ]
                     
                     [Node list symbol=One ]
                     ]
                    ]
                   
                   [Node list symbol=REPEAT 
                   
                    [Node list symbol=WHILE 
                    
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET 
                      
                       [Node list symbol=: symbol=G5066898 
                       
                        [Node list symbol=Boolean ]
                        ]
                       
                       [Node list symbol=empty? symbol=tord ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=IF symbol=G5066898 symbol=false 
                       
                        [Node list symbol=> symbol=o 
                        
                         [Node list symbol=first symbol=tord ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=LET symbol=hord 
                     
                      [Node list symbol=cons symbol=hord 
                      
                       [Node list symbol=first symbol=tord ]
                       ]
                      ]
                     
                     [Node list symbol=LET symbol=tord 
                     
                      [Node list symbol=rest symbol=tord ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=LET symbol=pos 
                      
                       [Node list symbol=+ symbol=pos 
                       
                        [Node list symbol=One ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=LET 
                   
                    [Node list symbol=: symbol=G5066899 
                    
                     [Node list symbol=Boolean ]
                     ]
                    
                    [Node list symbol=empty? symbol=tord ]
                    ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=IF symbol=G5066899 
                    
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET symbol=tord 
                      
                       [Node list symbol=reverse! 
                       
                        [Node list symbol=cons symbol=o symbol=hord ]
                        ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=concat! symbol=tsys symbol=rec ]
                       ]
                      ]
                     
                     [Node list symbol=SEQ 
                     
                      [Node list symbol=LET symbol=tord 
                      
                       [Node list symbol=concat! 
                       
                        [Node list symbol=reverse! symbol=hord ]
                        
                        [Node list symbol=cons symbol=o symbol=tord ]
                        ]
                       ]
                      
                      [Node list symbol=exit int=1 
                      
                       [Node list symbol=LET symbol=tsys 
                       
                        [Node list symbol=insert! symbol=rec symbol=tsys symbol=pos ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=rec symbol=SysRec ]
           
           [Node list symbol=construct symbol=newEqs symbol=newJM symbol=newDer symbol=newPro? symbol=true symbol=false 
           
            [Node list symbol=Zero ]
            ]
           ]
          
          [Node list symbol=LET symbol=resSys 
          
           [Node list symbol=cons symbol=rec symbol=resSys ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=resOrd 
           
            [Node list symbol=cons symbol=q symbol=resOrd ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=tsys 
      
       [Node list symbol=rest symbol=tsys ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=tord 
       
        [Node list symbol=rest symbol=tord ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5066903 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=q ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5066903 symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=jm0 
        
         [Node list symbol=JM 
         
          [Node list symbol=first symbol=resSys ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=eq 
          
           [Node list symbol=Eqs 
           
            [Node list symbol=first symbol=resSys ]
            ]
           ]
          
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=lj 
           
            [Node list symbol=Indices 
            
             [Node list symbol=row symbol=jm0 symbol=i ]
             ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5066902 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=empty? symbol=lj ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5066902 
            
             [Node list symbol=error string=inconsistent system ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=false 
              
               [Node list symbol=: symbol=u? 
               
                [Node list symbol=Boolean ]
                ]
               ]
              
              [Node list symbol=REPEAT 
              
               [Node list symbol=IN symbol=j 
               
                [Node list symbol=SEGMENT symbol=mm 
                
                 [Node list symbol=One ]
                 ]
                ]
               
               [Node list symbol=UNTIL symbol=u? ]
               
               [Node list symbol=LET symbol=u? 
               
                [Node list symbol=member? symbol=lj 
                
                 [Node list 
                 
                  [Node list symbol=Sel symbol=JB symbol=U ]
                  
                  [Node list symbol=:: symbol=j 
                  
                   [Node list symbol=PositiveInteger ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=u? symbol=noBranch 
               
                [Node list symbol=error string=independent variables not independent ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct 
      
       [Node list symbol=reverse! symbol=resSys ]
       
       [Node list symbol=reverse! symbol=resOrd ]
       ]
      
      [Node list symbol=reverse! symbol=ICs ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF project De q $ $ SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET cDe
    [Node list symbol=LET symbol=cDe 
    
     [Node list symbol=copy symbol=De ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5066904 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=>= symbol=q 
     
      [Node list symbol=order symbol=De ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5066904 symbol=cDe 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=resSys 
       
        [Node list symbol=cDe symbol=Sys ]
        ]
       
       [Node list symbol=LET symbol=resOrd 
       
        [Node list symbol=cDe symbol=Order ]
        ]
       
       [Node list symbol=LET symbol=true 
       
        [Node list symbol=: symbol=check 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5066905 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=resOrd ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5066905 symbol=false 
           
            [Node list symbol=> symbol=q 
            
             [Node list symbol=first symbol=resOrd ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=check 
         
          [Node list symbol=IF symbol=check symbol=false 
          
           [Node list symbol=Simp? 
           
            [Node list symbol=first symbol=resSys ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=resSys 
         
          [Node list symbol=rest symbol=resSys ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=resOrd 
          
           [Node list symbol=rest symbol=resOrd ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=check symbol=noBranch 
       
        [Node list 
        
         [Node list symbol=Sel symbol=print 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=message string=***** Warning: projection of not simplified system ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct symbol=resSys symbol=resOrd ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF prolong De $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=SDe symbol=$ ]
     
     [Node list symbol=: symbol=IC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pEqs 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pDer 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pJV 
     
      [Node list symbol=List 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pIC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=first 
     
      [Node list symbol=De symbol=Sys ]
      ]
     ]
    
   DEFSubnode:atts= LET q
    [Node list symbol=LET symbol=q 
    
     [Node list symbol=first 
     
      [Node list symbol=De symbol=Order ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=eq 
     
      [Node list symbol=rec symbol=Eqs ]
      ]
     
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=rec symbol=Deriv ]
      ]
     
     [Node list symbol=IN symbol=k 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=jmeq 
      
       [Node list symbol=extract symbol=k symbol=k 
       
        [Node list symbol=rec symbol=JM ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=INBY symbol=i 
        
         [Node list symbol=SEGMENT symbol=nn symbol=j ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=FDiff 
         
          [Node list symbol=formalDiff2 symbol=eq symbol=jmeq 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=pEqs 
         
          [Node list symbol=cons symbol=pEqs 
          
           [Node list symbol=FDiff symbol=DPhi ]
           ]
          ]
         
         [Node list symbol=LET symbol=pDer 
         
          [Node list symbol=cons symbol=pDer 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=pJV 
          
           [Node list symbol=cons symbol=pJV 
           
            [Node list symbol=FDiff symbol=JVars ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET pEqs
    [Node list symbol=LET symbol=pEqs 
    
     [Node list symbol=reverse! symbol=pEqs ]
     ]
    
   DEFSubnode:atts= LET pJV
    [Node list symbol=LET symbol=pJV 
    
     [Node list symbol=reverse! symbol=pJV ]
     ]
    
   DEFSubnode:atts= LET pDer
    [Node list symbol=LET symbol=pDer 
    
     [Node list symbol=reverse! symbol=pDer ]
     ]
    
   DEFSubnode:atts= LET pJM
    [Node list symbol=LET symbol=pJM 
    
     [Node list symbol=jacobiMatrix symbol=pEqs symbol=pJV ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=pRec symbol=SysRec ]
     
     [Node list symbol=construct symbol=pEqs symbol=pJM symbol=pDer symbol=false symbol=false 
     
      [Node list symbol=COLLECT symbol=false 
      
       [Node list symbol=IN symbol=i symbol=pDer ]
       ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=pSys 
     
      [Node list symbol=List symbol=SysRec ]
      ]
     
     [Node list symbol=construct symbol=pRec ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=pOrd 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=+ symbol=q 
      
       [Node list symbol=One ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET lastRec
    [Node list symbol=LET symbol=lastRec 
    
     [Node list symbol=copy symbol=rec ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=lastRec symbol=Prolonged? ]
     
     [Node list symbol=COLLECT symbol=true 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=rec symbol=Deriv ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET lastOrd q
    [Node list symbol=LET symbol=lastOrd symbol=q ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=rec 
     
      [Node list symbol=rest 
      
       [Node list symbol=De symbol=Sys ]
       ]
      ]
     
     [Node list symbol=IN symbol=ord 
     
      [Node list symbol=rest 
      
       [Node list symbol=De symbol=Order ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=pEqs symbol=empty ]
      
      [Node list symbol=LET symbol=pDer symbol=empty ]
      
      [Node list symbol=LET symbol=pJV symbol=empty ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=eq 
       
        [Node list symbol=rec symbol=Eqs ]
        ]
       
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=rec symbol=Deriv ]
        ]
       
       [Node list symbol=IN symbol=pro? 
       
        [Node list symbol=rec symbol=Prolonged? ]
        ]
       
       [Node list symbol=IN symbol=k 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=IF symbol=pro? symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=jmeq 
         
          [Node list symbol=extract symbol=k symbol=k 
          
           [Node list symbol=rec symbol=JM ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=INBY symbol=i 
           
            [Node list symbol=SEGMENT symbol=nn symbol=j ]
            
            [Node list symbol=- 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=FDiff 
            
             [Node list symbol=formalDiff2 symbol=eq symbol=jmeq 
             
              [Node list symbol=:: symbol=i 
              
               [Node list symbol=PositiveInteger ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=pEqs 
            
             [Node list symbol=cons symbol=pEqs 
             
              [Node list symbol=FDiff symbol=DPhi ]
              ]
             ]
            
            [Node list symbol=LET symbol=pDer 
            
             [Node list symbol=cons symbol=pDer 
             
              [Node list symbol=:: symbol=i 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=pJV 
             
              [Node list symbol=cons symbol=pJV 
              
               [Node list symbol=FDiff symbol=JVars ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066907 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=pEqs ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066907 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=pSys 
          
           [Node list symbol=cons symbol=lastRec symbol=pSys ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=pOrd 
           
            [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=pIC 
          
           [Node list symbol=append symbol=pIC symbol=pEqs ]
           ]
          
          [Node list symbol=LET symbol=pJM 
          
           [Node list symbol=jacobiMatrix symbol=pEqs symbol=pJV ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5066906 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=< symbol=lastOrd 
           
            [Node list symbol=+ symbol=ord 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5066906 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=pRec 
             
              [Node list symbol=construct symbol=pEqs symbol=pJM symbol=pDer symbol=false symbol=false 
              
               [Node list symbol=COLLECT symbol=false 
               
                [Node list symbol=IN symbol=i symbol=pDer ]
                ]
               
               [Node list symbol=Zero ]
               ]
              ]
             
             [Node list symbol=LET symbol=pSys 
             
              [Node list symbol=cons symbol=pRec 
              
               [Node list symbol=cons symbol=lastRec symbol=pSys ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=pOrd 
              
               [Node list symbol=cons 
               
                [Node list symbol=+ symbol=ord 
                
                 [Node list symbol=One ]
                 ]
                
                [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=pRec 
             
              [Node list symbol=construct symbol=false symbol=false 
              
               [Node list symbol=append symbol=pEqs 
               
                [Node list symbol=lastRec symbol=Eqs ]
                ]
               
               [Node list symbol=join symbol=pJM 
               
                [Node list symbol=lastRec symbol=JM ]
                ]
               
               [Node list symbol=append symbol=pDer 
               
                [Node list symbol=lastRec symbol=Deriv ]
                ]
               
               [Node list symbol=append 
               
                [Node list symbol=lastRec symbol=Prolonged? ]
                
                [Node list symbol=COLLECT symbol=false 
                
                 [Node list symbol=IN symbol=i symbol=pDer ]
                 ]
                ]
               
               [Node list symbol=Zero ]
               ]
              ]
             
             [Node list symbol=LET symbol=pSys 
             
              [Node list symbol=cons symbol=pRec symbol=pSys ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=pOrd 
              
               [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=lastRec 
      
       [Node list symbol=copy symbol=rec ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=lastRec symbol=Prolonged? ]
       
       [Node list symbol=COLLECT symbol=true 
       
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=rec symbol=Deriv ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lastOrd symbol=ord ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET pSys
    [Node list symbol=LET symbol=pSys 
    
     [Node list symbol=cons symbol=lastRec symbol=pSys ]
     ]
    
   DEFSubnode:atts= LET pOrd
    [Node list symbol=LET symbol=pOrd 
    
     [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=$ ]
     
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=pSys ]
      
      [Node list symbol=reverse! symbol=pOrd ]
      ]
     ]
    
   DEFSubnode:atts= LET tmp
    [Node list symbol=LET symbol=tmp 
    
     [Node list symbol=simplify symbol=res ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=tmp symbol=SDe ]
      
      [Node list symbol=concat! symbol=pIC 
      
       [Node list symbol=tmp symbol=IC ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF prolong De q $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=SDe symbol=$ ]
     
     [Node list symbol=: symbol=IC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET cDe
    [Node list symbol=LET symbol=cDe 
    
     [Node list symbol=copy symbol=De ]
     ]
    
   DEFSubnode:atts= LET tsys
    [Node list symbol=LET symbol=tsys 
    
     [Node list symbol=cDe symbol=Sys ]
     ]
    
   DEFSubnode:atts= LET tord
    [Node list symbol=LET symbol=tord 
    
     [Node list symbol=cDe symbol=Order ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pSys 
     
      [Node list symbol=List symbol=SysRec ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pOrd 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=pIC 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=> symbol=q 
      
       [Node list symbol=first symbol=tord ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=pSys 
      
       [Node list symbol=cons symbol=pSys 
       
        [Node list symbol=first symbol=tsys ]
        ]
       ]
      
      [Node list symbol=LET symbol=pOrd 
      
       [Node list symbol=cons symbol=pOrd 
       
        [Node list symbol=first symbol=tord ]
        ]
       ]
      
      [Node list symbol=LET symbol=tsys 
      
       [Node list symbol=rest symbol=tsys ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=tord 
       
        [Node list symbol=rest symbol=tord ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5066908 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol== symbol=q 
      
       [Node list symbol=first symbol=tord ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5066908 symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=pEqs 
         
          [Node list symbol=List symbol=D ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=pDer 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=pJV 
         
          [Node list symbol=List 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=rec 
        
         [Node list symbol=first symbol=tsys ]
         ]
        
        [Node list symbol=LET symbol=ord 
        
         [Node list symbol=first symbol=tord ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=eq 
         
          [Node list symbol=rec symbol=Eqs ]
          ]
         
         [Node list symbol=IN symbol=j 
         
          [Node list symbol=rec symbol=Deriv ]
          ]
         
         [Node list symbol=IN symbol=k 
         
          [Node list symbol=SEGMENT 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=jmeq 
          
           [Node list symbol=extract symbol=k symbol=k 
           
            [Node list symbol=rec symbol=JM ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=REPEAT 
           
            [Node list symbol=INBY symbol=i 
            
             [Node list symbol=SEGMENT symbol=nn symbol=j ]
             
             [Node list symbol=- 
             
              [Node list symbol=One ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=FDiff 
             
              [Node list symbol=formalDiff2 symbol=eq symbol=jmeq 
              
               [Node list symbol=:: symbol=i 
               
                [Node list symbol=PositiveInteger ]
                ]
               ]
              ]
             
             [Node list symbol=LET symbol=pEqs 
             
              [Node list symbol=cons symbol=pEqs 
              
               [Node list symbol=FDiff symbol=DPhi ]
               ]
              ]
             
             [Node list symbol=LET symbol=pDer 
             
              [Node list symbol=cons symbol=pDer 
              
               [Node list symbol=:: symbol=i 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=pJV 
              
               [Node list symbol=cons symbol=pJV 
               
                [Node list symbol=FDiff symbol=JVars ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=pEqs 
        
         [Node list symbol=reverse! symbol=pEqs ]
         ]
        
        [Node list symbol=LET symbol=pJV 
        
         [Node list symbol=reverse! symbol=pJV ]
         ]
        
        [Node list symbol=LET symbol=pDer 
        
         [Node list symbol=reverse! symbol=pDer ]
         ]
        
        [Node list symbol=LET symbol=pJM 
        
         [Node list symbol=jacobiMatrix symbol=pEqs symbol=pJV ]
         ]
        
        [Node list symbol=LET symbol=pIC symbol=pEqs ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=pRec symbol=SysRec ]
         
         [Node list symbol=construct symbol=pEqs symbol=pJM symbol=pDer symbol=false symbol=false 
         
          [Node list symbol=COLLECT symbol=false 
          
           [Node list symbol=IN symbol=i symbol=pDer ]
           ]
          
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=LET symbol=pSys 
        
         [Node list symbol=cons symbol=pRec symbol=pSys ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=pOrd 
         
          [Node list symbol=cons symbol=pOrd 
          
           [Node list symbol=+ symbol=ord 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET lastRec
    [Node list symbol=LET symbol=lastRec 
    
     [Node list symbol=first symbol=tsys ]
     ]
    
   DEFSubnode:atts= LET lastOrd
    [Node list symbol=LET symbol=lastOrd 
    
     [Node list symbol=first symbol=tord ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=rec 
     
      [Node list symbol=rest symbol=tsys ]
      ]
     
     [Node list symbol=IN symbol=ord 
     
      [Node list symbol=rest symbol=tord ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=empty 
      
       [Node list symbol=: symbol=pEqs 
       
        [Node list symbol=List symbol=D ]
        ]
       ]
      
      [Node list symbol=LET symbol=empty 
      
       [Node list symbol=: symbol=pDer 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=empty 
      
       [Node list symbol=: symbol=pJV 
       
        [Node list symbol=List 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=eq 
       
        [Node list symbol=rec symbol=Eqs ]
        ]
       
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=rec symbol=Deriv ]
        ]
       
       [Node list symbol=IN symbol=pro? 
       
        [Node list symbol=rec symbol=Prolonged? ]
        ]
       
       [Node list symbol=IN symbol=k 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=IF symbol=pro? symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=jmeq 
         
          [Node list symbol=extract symbol=k symbol=k 
          
           [Node list symbol=rec symbol=JM ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=REPEAT 
          
           [Node list symbol=INBY symbol=i 
           
            [Node list symbol=SEGMENT symbol=nn symbol=j ]
            
            [Node list symbol=- 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=FDiff 
            
             [Node list symbol=formalDiff2 symbol=eq symbol=jmeq 
             
              [Node list symbol=:: symbol=i 
              
               [Node list symbol=PositiveInteger ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=pEqs 
            
             [Node list symbol=cons symbol=pEqs 
             
              [Node list symbol=FDiff symbol=DPhi ]
              ]
             ]
            
            [Node list symbol=LET symbol=pDer 
            
             [Node list symbol=cons symbol=pDer 
             
              [Node list symbol=:: symbol=i 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=pJV 
             
              [Node list symbol=cons symbol=pJV 
              
               [Node list symbol=FDiff symbol=JVars ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066910 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=pEqs ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066910 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=pSys 
          
           [Node list symbol=cons symbol=lastRec symbol=pSys ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=pOrd 
           
            [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=pEqs 
          
           [Node list symbol=reverse! symbol=pEqs ]
           ]
          
          [Node list symbol=LET symbol=pJV 
          
           [Node list symbol=reverse! symbol=pJV ]
           ]
          
          [Node list symbol=LET symbol=pDer 
          
           [Node list symbol=reverse! symbol=pDer ]
           ]
          
          [Node list symbol=LET symbol=pJM 
          
           [Node list symbol=jacobiMatrix symbol=pEqs symbol=pJV ]
           ]
          
          [Node list symbol=LET symbol=pIC 
          
           [Node list symbol=append symbol=pIC symbol=pEqs ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5066909 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=< symbol=lastOrd 
            
             [Node list symbol=+ symbol=ord 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5066909 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=pRec symbol=SysRec ]
               
               [Node list symbol=construct symbol=pEqs symbol=pJM symbol=pDer symbol=false symbol=false 
               
                [Node list symbol=COLLECT symbol=false 
                
                 [Node list symbol=IN symbol=i symbol=pDer ]
                 ]
                
                [Node list symbol=Zero ]
                ]
               ]
              
              [Node list symbol=LET symbol=pSys 
              
               [Node list symbol=cons symbol=pRec 
               
                [Node list symbol=cons symbol=lastRec symbol=pSys ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=pOrd 
               
                [Node list symbol=cons 
                
                 [Node list symbol=+ symbol=ord 
                 
                  [Node list symbol=One ]
                  ]
                 
                 [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=pRec symbol=SysRec ]
               
               [Node list symbol=construct symbol=false symbol=false 
               
                [Node list symbol=concat! symbol=pEqs 
                
                 [Node list symbol=lastRec symbol=Eqs ]
                 ]
                
                [Node list symbol=join symbol=pJM 
                
                 [Node list symbol=lastRec symbol=JM ]
                 ]
                
                [Node list symbol=concat! symbol=pDer 
                
                 [Node list symbol=lastRec symbol=Deriv ]
                 ]
                
                [Node list symbol=concat! 
                
                 [Node list symbol=lastRec symbol=Prolonged? ]
                 
                 [Node list symbol=COLLECT symbol=false 
                 
                  [Node list symbol=IN symbol=i symbol=pDer ]
                  ]
                 ]
                
                [Node list symbol=Zero ]
                ]
               ]
              
              [Node list symbol=LET symbol=pSys 
              
               [Node list symbol=cons symbol=pRec symbol=pSys ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=pOrd 
               
                [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET 
           
            [Node list symbol=rec symbol=Prolonged? ]
            
            [Node list symbol=COLLECT symbol=true 
            
             [Node list symbol=IN symbol=j 
             
              [Node list symbol=rec symbol=Deriv ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=lastRec symbol=rec ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lastOrd symbol=ord ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET pSys
    [Node list symbol=LET symbol=pSys 
    
     [Node list symbol=cons symbol=lastRec symbol=pSys ]
     ]
    
   DEFSubnode:atts= LET pOrd
    [Node list symbol=LET symbol=pOrd 
    
     [Node list symbol=cons symbol=lastOrd symbol=pOrd ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=$ ]
     
     [Node list symbol=construct 
     
      [Node list symbol=reverse! symbol=pSys ]
      
      [Node list symbol=reverse! symbol=pOrd ]
      ]
     ]
    
   DEFSubnode:atts= LET tmp
    [Node list symbol=LET symbol=tmp 
    
     [Node list symbol=simplify symbol=res ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=tmp symbol=SDe ]
      
      [Node list symbol=concat! symbol=pIC 
      
       [Node list symbol=tmp symbol=IC ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF extractSymbol De solved? $ SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET res
    [Node list symbol=LET symbol=res 
    
     [Node list 
     
      [Node list symbol=Sel symbol=D symbol=extractSymbol ]
      
      [Node list symbol=JM 
      
       [Node list symbol=first 
       
        [Node list symbol=De symbol=Sys ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF solved? noBranch
    [Node list symbol=IF symbol=solved? symbol=noBranch 
    
     [Node list symbol=LET symbol=res 
     
      [Node list symbol=Ech 
      
       [Node list symbol=rowEchelon symbol=res ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF analyseSymbol Symb SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Rank 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=NumMultVar 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=Betas 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET tmp
    [Node list symbol=LET symbol=tmp 
    
     [Node list symbol=rowEchelon symbol=Symb ]
     ]
    
   DEFSubnode:atts= LET ech
    [Node list symbol=LET symbol=ech 
    
     [Node list symbol=tmp symbol=Ech ]
     ]
    
   DEFSubnode:atts= LET pivs
    [Node list symbol=LET symbol=pivs 
    
     [Node list symbol=pivots symbol=ech ]
     ]
    
   DEFSubnode:atts= LET MSum
    [Node list symbol=LET symbol=MSum 
    
     [Node list symbol=Sel 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET BetaI
    [Node list symbol=LET symbol=BetaI 
    
     [Node list symbol=Sel 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET nn
    [Node list symbol=LET symbol=nn 
    
     [Node list symbol=: symbol=LastClass 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=LBeta 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=jv 
     
      [Node list symbol=pivs symbol=Indices ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=CurClass 
      
       [Node list symbol=class symbol=jv ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol== symbol=CurClass symbol=LastClass ]
        
        [Node list symbol=LET symbol=BetaI 
        
         [Node list symbol=+ symbol=BetaI 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=LBeta 
         
          [Node list symbol=cons symbol=BetaI symbol=LBeta ]
          ]
         
         [Node list symbol=LET symbol=MSum 
         
          [Node list symbol=+ symbol=MSum 
          
           [Node list symbol=* symbol=BetaI symbol=LastClass ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=k 
          
           [Node list symbol=SEGMENT int=2 
           
            [Node list symbol=- symbol=LastClass symbol=CurClass ]
            ]
           ]
          
          [Node list symbol=LET symbol=LBeta 
          
           [Node list symbol=cons symbol=LBeta 
           
            [Node list symbol=Zero ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=BetaI 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=LastClass symbol=CurClass ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET LBeta
    [Node list symbol=LET symbol=LBeta 
    
     [Node list symbol=cons symbol=BetaI symbol=LBeta ]
     ]
    
   DEFSubnode:atts= LET MSum
    [Node list symbol=LET symbol=MSum 
    
     [Node list symbol=+ symbol=MSum 
     
      [Node list symbol=* symbol=BetaI symbol=LastClass ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=k 
     
      [Node list symbol=SEGMENT int=2 symbol=LastClass ]
      ]
     
     [Node list symbol=LET symbol=LBeta 
     
      [Node list symbol=cons symbol=LBeta 
      
       [Node list symbol=Zero ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=MSum symbol=LBeta 
     
      [Node list symbol=tmp symbol=Rank ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF prolongSymbol Symb SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET oldInds
    [Node list symbol=LET symbol=oldInds 
    
     [Node list symbol=allIndices symbol=Symb ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=newInds 
     
      [Node list symbol=List symbol=JB ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=jv 
     
      [Node list symbol=reverse symbol=oldInds ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET symbol=newInds 
      
       [Node list symbol=cons symbol=newInds 
       
        [Node list symbol=:: symbol=JB 
        
         [Node list symbol=differentiate symbol=jv 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=PositiveInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET newInds
    [Node list symbol=LET symbol=newInds 
    
     [Node list symbol=sort! 
     
      [Node list symbol=+-> 
      
       [Node list symbol=@Tuple symbol=x symbol=y ]
       
       [Node list symbol=< symbol=y symbol=x ]
       ]
      
      [Node list symbol=removeDuplicates! symbol=newInds ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
      ]
     
     [Node list symbol=new symbol=newInds 
     
      [Node list symbol=* symbol=nn 
      
       [Node list symbol=nrows symbol=Symb ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=nrows symbol=Symb ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=r 
      
       [Node list symbol=row symbol=Symb symbol=j ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=INBY symbol=i 
        
         [Node list symbol=SEGMENT symbol=nn 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=ninds 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=jv 
           
            [Node list symbol=r symbol=Indices ]
            ]
           
           [Node list symbol=:: symbol=JB 
           
            [Node list symbol=differentiate symbol=jv 
            
             [Node list symbol=:: symbol=i 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=setRow! symbol=res symbol=ninds 
          
           [Node list symbol=+ 
           
            [Node list symbol=- symbol=i 
            
             [Node list symbol=* symbol=nn symbol=j ]
             ]
            
            [Node list symbol=One ]
            ]
           
           [Node list symbol=r symbol=Entries ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF prolongMV mv SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Rank 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=NumMultVar 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=Betas 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Rank 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=NumMultVar 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=Betas 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET oldBeta
    [Node list symbol=LET symbol=oldBeta 
    
     [Node list symbol=reverse 
     
      [Node list symbol=mv symbol=Betas ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=newBeta 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=sum 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=rank 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=msum 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=beta symbol=oldBeta ]
     
     [Node list symbol=INBY symbol=k 
     
      [Node list symbol=SEGMENT symbol=nn 
      
       [Node list symbol=One ]
       ]
      
      [Node list symbol=- 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=sum 
      
       [Node list symbol=+ symbol=sum symbol=beta ]
       ]
      
      [Node list symbol=LET symbol=rank 
      
       [Node list symbol=+ symbol=rank symbol=sum ]
       ]
      
      [Node list symbol=LET symbol=msum 
      
       [Node list symbol=+ symbol=msum 
       
        [Node list symbol=* symbol=k symbol=sum ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newBeta 
       
        [Node list symbol=cons symbol=sum symbol=newBeta ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=rank symbol=msum 
     
      [Node list symbol=reverse! symbol=newBeta ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF power lc mu mask D SEQ
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=PositiveInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=D ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=k 
     
      [Node list symbol=PositiveInteger ]
      ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5066911 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=mask ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5066911 symbol=false symbol=true ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=REPEAT 
      
       [Node list symbol=WHILE 
       
        [Node list symbol=< symbol=k 
        
         [Node list symbol=first symbol=mask ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=mu 
        
         [Node list symbol=rest symbol=mu ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=k 
         
          [Node list symbol=+ symbol=k 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=* symbol=res 
       
        [Node list symbol=^ 
        
         [Node list symbol=first symbol=lc ]
         
         [Node list symbol=first symbol=mu ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=lc 
      
       [Node list symbol=rest symbol=lc ]
       ]
      
      [Node list symbol=LET symbol=mask 
      
       [Node list symbol=rest symbol=mask ]
       ]
      
      [Node list symbol=LET symbol=mu 
      
       [Node list symbol=rest symbol=mu ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=k 
       
        [Node list symbol=+ symbol=k 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF extPower llc mu nu D SEQ
   DEFSubnode:atts= Matrix D
    [Node list symbol=Matrix symbol=D ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET snu
    [Node list symbol=LET symbol=snu 
    
     [Node list symbol=nu 
     
      [Node list symbol=Sel symbol=JB symbol=allRepeated ]
      ]
     ]
    
   DEFSubnode:atts= LET rmu
    [Node list symbol=LET symbol=rmu 
    
     [Node list symbol=mu 
     
      [Node list symbol=Sel symbol=JB symbol=m2r ]
      ]
     ]
    
   DEFSubnode:atts= LET q
    [Node list symbol=LET symbol=q 
    
     [Node list symbol=# 
     
      [Node list symbol=first symbol=snu ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=D ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=s symbol=snu ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=prod symbol=D ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=si symbol=s ]
       
       [Node list symbol=IN symbol=mi symbol=rmu ]
       
       [Node list symbol=LET symbol=prod 
       
        [Node list symbol=* symbol=prod 
        
         [Node list symbol=qelt symbol=llc symbol=mi 
         
          [Node list symbol=+ 
          
           [Node list symbol=- symbol=nn symbol=si ]
           
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=+ symbol=res symbol=prod ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF tableau Symb chi SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= JetDifferential JB D
    [Node list symbol=JetDifferential symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET diffs
    [Node list symbol=LET symbol=diffs 
    
     [Node list symbol=differentials symbol=chi ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5066912 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=> 
     
      [Node list symbol=last symbol=diffs ]
      
      [Node list symbol=nn 
      
       [Node list symbol=Sel symbol=JB symbol=X ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5066912 
     
      [Node list symbol=error string=illegal differential in tableau ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=coeffs 
       
        [Node list symbol=coefficients symbol=chi ]
        ]
       
       [Node list symbol=LET symbol=cinds 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=d symbol=diffs ]
         
         [Node list symbol=index symbol=d ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
         ]
        
        [Node list symbol=new 
        
         [Node list symbol=COLLECT 
         
          [Node list symbol=INBY symbol=i 
          
           [Node list symbol=SEGMENT symbol=mm 
           
            [Node list symbol=One ]
            ]
           
           [Node list symbol=- 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=U 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         
         [Node list symbol=nrows symbol=Symb ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=k 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=nrows symbol=Symb ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=r 
         
          [Node list symbol=row symbol=Symb symbol=k ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sum 
          
           [Node list symbol=Vector symbol=D ]
           ]
          
          [Node list symbol=new symbol=mm 
          
           [Node list symbol=Zero ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=jv 
          
           [Node list symbol=r symbol=Indices ]
           ]
          
          [Node list symbol=IN symbol=ent 
          
           [Node list symbol=r symbol=Entries ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=a 
           
            [Node list symbol=index symbol=jv ]
            ]
           
           [Node list symbol=LET symbol=mu 
           
            [Node list symbol=multiIndex symbol=jv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=qsetelt! symbol=sum symbol=a 
            
             [Node list symbol=+ 
             
              [Node list symbol=qelt symbol=sum symbol=a ]
              
              [Node list symbol=* symbol=ent 
              
               [Node list symbol=power symbol=coeffs symbol=mu symbol=cinds ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=li 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=le 
          
           [Node list symbol=List symbol=D ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT symbol=mm 
           
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=IN symbol=s 
          
           [Node list symbol=entries symbol=sum ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5066913 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=s ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5066913 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=li 
              
               [Node list symbol=cons symbol=li 
               
                [Node list symbol=U 
                
                 [Node list symbol=:: symbol=i 
                 
                  [Node list symbol=PositiveInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=le 
               
                [Node list symbol=cons symbol=s symbol=le ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=setRow! symbol=res symbol=k symbol=li symbol=le ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF tableau Symb lchi SEQ
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetDifferential symbol=JB symbol=D ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET q
    [Node list symbol=LET symbol=q 
    
     [Node list symbol=order 
     
      [Node list symbol=first 
      
       [Node list symbol=allIndices symbol=Symb ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET inds
    [Node list symbol=LET symbol=inds 
    
     [Node list symbol=q 
     
      [Node list symbol=Sel symbol=JB symbol=variables ]
      
      [Node list symbol=:: 
      
       [Node list symbol=+ 
       
        [Node list symbol=- symbol=nn 
        
         [Node list symbol=# symbol=lchi ]
         ]
        
        [Node list symbol=One ]
        ]
       
       [Node list symbol=PositiveInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=mco 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     
     [Node list symbol=new symbol=nn 
     
      [Node list symbol=# symbol=lchi ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=IN symbol=chi symbol=lchi ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=qsetelt! symbol=mco symbol=i symbol=j 
      
       [Node list symbol=coefficient symbol=chi 
       
        [Node list 
        
         [Node list symbol=Sel symbol=JB symbol=X ]
         
         [Node list symbol=:: symbol=j 
         
          [Node list symbol=PositiveInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
      ]
     
     [Node list symbol=new symbol=inds 
     
      [Node list symbol=nrows symbol=Symb ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=vv 
     
      [Node list symbol=reverse symbol=inds ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=a 
      
       [Node list symbol=index symbol=vv ]
       ]
      
      [Node list symbol=LET symbol=nu 
      
       [Node list symbol=multiIndex symbol=vv ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=k 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=nrows symbol=Symb ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=r 
         
          [Node list symbol=row symbol=Symb symbol=k ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=s symbol=D ]
          
          [Node list symbol=Zero ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=jv 
          
           [Node list symbol=r symbol=Indices ]
           ]
          
          [Node list symbol=IN symbol=ent 
          
           [Node list symbol=r symbol=Entries ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5066914 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol== symbol=a 
            
             [Node list symbol=index symbol=jv ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5066914 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=mu 
              
               [Node list symbol=multiIndex symbol=jv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=s 
               
                [Node list symbol=+ symbol=s 
                
                 [Node list symbol=* symbol=ent 
                 
                  [Node list symbol=extPower symbol=mco symbol=mu symbol=nu ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5066915 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=zero? symbol=s ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5066915 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=rres 
            
             [Node list symbol=row symbol=res symbol=k ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=rres symbol=Indices ]
             
             [Node list symbol=cons symbol=vv 
             
              [Node list symbol=rres symbol=Indices ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=rres symbol=Entries ]
             
             [Node list symbol=cons symbol=s 
             
              [Node list symbol=rres symbol=Entries ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=setRow! symbol=res symbol=k symbol=rres ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleFunctionCategory JB
  [Node list symbol=JetBundleFunctionCategory symbol=JB ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF CartanKuranishi JB D
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  setOutMode
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  setSimpMode
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  setRedMode
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  stirling
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  alpha
   SIGNATURE params:List NonNegativeInteger 
   NonNegativeInteger 
   List NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  hilbert
   SIGNATURE params:SparseUnivariatePolynomial Fraction Integer 
   List NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  alphaHilbert
   SIGNATURE params:List NonNegativeInteger 
   SparseUnivariatePolynomial Fraction Integer 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  arbFunctions
   SIGNATURE params:List Integer 
   NonNegativeInteger 
   Integer 
   List NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  gauge
   SIGNATURE params:List Integer 
   NonNegativeInteger 
   Integer 
   List NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  gaugeHilbert
   SIGNATURE params:SparseUnivariatePolynomial Fraction Integer 
   NonNegativeInteger 
   List NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  bound
   SIGNATURE params:NonNegativeInteger 
   NonNegativeInteger 
   NonNegativeInteger 
   NonNegativeInteger 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  complete
   SIGNATURE params:Void 
   JetDifferentialEquation JB D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  complete2
   SIGNATURE params:Record : IDe JetDifferentialEquation JB D : ISys List D : Order NonNegativeInteger : NumProj NonNegativeInteger : Dim NonNegativeInteger : CarChar List NonNegativeInteger 
   JetDifferentialEquation JB D 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=JetDifferentialEquation symbol=JB symbol=D ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=n 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numIndVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=m 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB symbol=numDepVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=ode 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list symbol=one? symbol=n ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=redMode 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=Zero ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=false 
   
    [Node list symbol=: symbol=TeX 
    
     [Node list symbol=Boolean ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=Out 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=Zero ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=remember 
    
     [Node list symbol=Table 
     
      [Node list symbol=Record 
      
       [Node list symbol=: 
       
        [Node list symbol=Integer ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=K 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=Q 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=dictionary ]
    ]
   
  CAPSULEDef:
   [DEF setSimpMode i i
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel setSimpMode
    [Node list symbol=Sel symbol=setSimpMode 
    
     [Node list symbol=JetDifferentialEquation symbol=JB symbol=D ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF setRedMode i SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET j redMode
    [Node list symbol=LET symbol=j symbol=redMode ]
    
   DEFSubnode:atts= LET redMode i
    [Node list symbol=LET symbol=redMode symbol=i ]
    
   DEFSubnode:atts= exit 1 j
    [Node list symbol=exit int=1 symbol=j ]
    
   ]
   
  CAPSULEDef:
   [DEF setOutMode i SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET j Out
    [Node list symbol=LET symbol=j symbol=Out ]
    
   DEFSubnode:atts= IF TeX noBranch
    [Node list symbol=IF symbol=TeX symbol=noBranch 
    
     [Node list symbol=LET symbol=j 
     
      [Node list symbol=+ symbol=j int=10 ]
      ]
     ]
    
   DEFSubnode:atts= LET TeX
    [Node list symbol=LET symbol=TeX 
    
     [Node list symbol=> symbol=i int=10 ]
     ]
    
   DEFSubnode:atts= IF TeX
    [Node list symbol=IF symbol=TeX 
    
     [Node list symbol=LET symbol=Out 
     
      [Node list symbol=rem symbol=i int=10 ]
      ]
     
     [Node list symbol=LET symbol=Out symbol=i ]
     ]
    
   DEFSubnode:atts= exit 1 j
    [Node list symbol=exit int=1 symbol=j ]
    
   ]
   
  CAPSULEDef:
   [DEF write str SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= IF TeX
    [Node list symbol=IF symbol=TeX 
    
     [Node list 
     
      [Node list symbol=Sel symbol=display 
      
       [Node list symbol=TexFormat ]
       ]
      
      [Node list symbol=:: symbol=str 
      
       [Node list symbol=TexFormat ]
       ]
      ]
     
     [Node list symbol=str 
     
      [Node list symbol=Sel symbol=print 
      
       [Node list symbol=OutputForm ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF outR q s SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5073324 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=s ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5073324 
     
      [Node list symbol=sub 
      
       [Node list symbol=message string=R ]
       
       [Node list symbol=:: symbol=q 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      
      [Node list symbol=supersub 
      
       [Node list symbol=message string=R ]
       
       [Node list symbol=construct 
       
        [Node list symbol=:: symbol=q 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=paren 
        
         [Node list symbol=:: symbol=s 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF outM q s SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5073325 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=s ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5073325 
     
      [Node list symbol=sub 
      
       [Node list symbol=message string=M ]
       
       [Node list symbol=:: symbol=q 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      
      [Node list symbol=supersub 
      
       [Node list symbol=message string=M ]
       
       [Node list symbol=construct 
       
        [Node list symbol=:: symbol=q 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=paren 
        
         [Node list symbol=:: symbol=s 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF info flag q s dim IF void
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= < Out 4
    [Node list symbol=< symbol=Out int=4 ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=write 
     
      [Node list symbol=message string=  ]
      ]
     
     [Node list symbol=IF 
     
      [Node list symbol== symbol=flag 
      
       [Node list symbol=One ]
       ]
      
      [Node list symbol=write 
      
       [Node list symbol=hconcat 
       
        [Node list symbol=construct 
        
         [Node list symbol=message string=Symbol  ]
         
         [Node list symbol=outM symbol=q symbol=s ]
         
         [Node list symbol=message string= involutive!  ]
         
         [Node list symbol=message string=Dimension:  ]
         
         [Node list symbol=:: symbol=dim 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=IF 
      
       [Node list symbol== symbol=flag int=2 ]
       
       [Node list symbol=write 
       
        [Node list symbol=hconcat 
        
         [Node list symbol=construct 
         
          [Node list symbol=message string=Symbol  ]
          
          [Node list symbol=outM symbol=q symbol=s ]
          
          [Node list symbol=message string= not involutive!  ]
          
          [Node list symbol=message string=Dimension:  ]
          
          [Node list symbol=:: symbol=dim 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=write 
       
        [Node list symbol=hconcat 
        
         [Node list symbol=construct 
         
          [Node list symbol=message string=Equation  ]
          
          [Node list symbol=outR symbol=q symbol=s ]
          
          [Node list symbol=message string= not involutive!  ]
          
          [Node list symbol=message string=Dimension:  ]
          
          [Node list symbol=:: symbol=dim 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=void ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF display q s Sys Symb DimRq DimMq IF void
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB D
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= < Out 5
    [Node list symbol=< symbol=Out int=5 ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=write 
     
      [Node list symbol=message string=  ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=message string=**************************************** ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=message string=  ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=message string=Order:  ]
       
       [Node list symbol=:: symbol=q 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=message string=Projections:  ]
       
       [Node list symbol=:: symbol=s 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=message string=System without prolonged equations. Dimension:  ]
       
       [Node list symbol=:: symbol=DimRq 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=printSys symbol=Sys ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=> symbol=Out int=5 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=write 
       
        [Node list symbol=message string=  ]
        ]
       
       [Node list symbol=write 
       
        [Node list symbol=hconcat 
        
         [Node list symbol=message string=Symbol. Dimension:  ]
         
         [Node list symbol=:: symbol=DimMq 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=write 
        
         [Node list symbol=:: symbol=Symb 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=void ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF displayIntCond s Cond IF void
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= < Out 3
    [Node list symbol=< symbol=Out int=3 ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=write 
     
      [Node list symbol=message string=  ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=construct 
       
        [Node list symbol=message string========  ]
        
        [Node list symbol=:: symbol=s 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=message string=. Projection ======= ]
        ]
       ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=message string=Integrability condition(s) ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=printSys symbol=Cond ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=message string============================== ]
      ]
     
     [Node list symbol=exit int=1 symbol=void ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF displayCartan Sys dim q s CarChar IF void
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= List D
    [Node list symbol=List symbol=D ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= = Out
    [Node list symbol== symbol=Out 
    
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=write 
     
      [Node list symbol=message string=  ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=message string=*************** Final Result *************** ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=message string=  ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=construct 
       
        [Node list symbol=message string=Equation  ]
        
        [Node list symbol=outR symbol=q symbol=s ]
        
        [Node list symbol=message string= involutive! ]
        ]
       ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=hconcat 
      
       [Node list symbol=message string=System without prolonged equations. Dimension:  ]
       
       [Node list symbol=:: symbol=dim 
       
        [Node list symbol=OutputForm ]
        ]
       ]
      ]
     
     [Node list symbol=write 
     
      [Node list symbol=printSys symbol=Sys ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=> symbol=Out 
      
       [Node list symbol=One ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=write 
       
        [Node list symbol=message string=  ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5073326 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? 
        
         [Node list symbol=reduce string=+ symbol=CarChar 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5073326 
        
         [Node list symbol=write 
         
          [Node list symbol=message string=System of finite type. ]
          ]
         
         [Node list symbol=write 
         
          [Node list symbol=hconcat 
          
           [Node list symbol=message string=Cartan characters:  ]
           
           [Node list symbol=commaSeparate 
           
            [Node list symbol=COLLECT 
            
             [Node list symbol=IN symbol=cc symbol=CarChar ]
             
             [Node list symbol=:: symbol=cc 
             
              [Node list symbol=OutputForm ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=void ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF stirling i k q IF
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= > k i
    [Node list symbol=> symbol=k symbol=i ]
    
   DEFSubnode:atts= error Symmetric polynomial not defined
    [Node list symbol=error string=Symmetric polynomial not defined ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5073327 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=i ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5073327 
      
       [Node list symbol=One ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5073328 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=k ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5073328 
         
          [Node list symbol=One ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=ans 
           
            [Node list symbol=search symbol=remember 
            
             [Node list symbol=construct symbol=i symbol=k symbol=q ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF 
            
             [Node list symbol=case symbol=ans 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=:: symbol=ans 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5073329 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=one? symbol=k ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5073329 
                
                 [Node list symbol=LET symbol=res 
                 
                  [Node list symbol=reduce string=+ 
                  
                   [Node list symbol=COLLECT 
                   
                    [Node list symbol=IN symbol=j 
                    
                     [Node list symbol=SEGMENT symbol=i 
                     
                      [Node list symbol=One ]
                      ]
                     ]
                    
                    [Node list symbol=+ symbol=q symbol=j ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=IF 
                 
                  [Node list symbol== symbol=k symbol=i ]
                  
                  [Node list symbol=LET symbol=res 
                  
                   [Node list symbol=reduce string=* 
                   
                    [Node list symbol=COLLECT 
                    
                     [Node list symbol=IN symbol=j 
                     
                      [Node list symbol=SEGMENT symbol=i 
                      
                       [Node list symbol=One ]
                       ]
                      ]
                     
                     [Node list symbol=+ symbol=q symbol=j ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=res 
                  
                   [Node list symbol=+ 
                   
                    [Node list symbol=stirling symbol=k symbol=q 
                    
                     [Node list symbol=:: 
                     
                      [Node list symbol=- symbol=i 
                      
                       [Node list symbol=One ]
                       ]
                      
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    
                    [Node list symbol=* 
                    
                     [Node list symbol=+ symbol=q symbol=i ]
                     
                     [Node list symbol=stirling symbol=q 
                     
                      [Node list symbol=:: 
                      
                       [Node list symbol=- symbol=i 
                       
                        [Node list symbol=One ]
                        ]
                       
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      
                      [Node list symbol=:: 
                      
                       [Node list symbol=- symbol=k 
                       
                        [Node list symbol=One ]
                        ]
                       
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=setelt! symbol=remember symbol=res 
               
                [Node list symbol=construct symbol=i symbol=k symbol=q ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF alpha q beta COLLECT
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= IN bi beta
    [Node list symbol=IN symbol=bi symbol=beta ]
    
   DEFSubnode:atts= IN i
    [Node list symbol=IN symbol=i 
    
     [Node list symbol=SEGMENT symbol=n 
     
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= ::
    [Node list symbol=:: 
    
     [Node list symbol=- symbol=bi 
     
      [Node list symbol=* symbol=m 
      
       [Node list 
       
        [Node list symbol=Sel symbol=binomial 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=- 
        
         [Node list symbol=- symbol=i 
         
          [Node list symbol=+ symbol=q symbol=n ]
          ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=- symbol=q 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF hilbert CarChar SEQ
   DEFSubnode:atts= SparseUnivariatePolynomial
    [Node list symbol=SparseUnivariatePolynomial 
    
     [Node list symbol=Fraction 
     
      [Node list symbol=Integer ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=SparseUnivariatePolynomial 
      
       [Node list symbol=Fraction 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ifac 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=- symbol=n 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=coeff 
       
        [Node list symbol=Fraction 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=LET symbol=kfac symbol=ifac ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=k 
       
        [Node list symbol=SEGMENT symbol=i 
        
         [Node list symbol=- symbol=n 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol=> symbol=k 
         
          [Node list symbol=Zero ]
          ]
         
         [Node list symbol=LET symbol=kfac 
         
          [Node list symbol=* symbol=k symbol=kfac ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=coeff 
         
          [Node list symbol=+ symbol=coeff 
          
           [Node list symbol=/ symbol=kfac 
           
            [Node list symbol=* 
            
             [Node list symbol=qelt symbol=CarChar 
             
              [Node list symbol=+ symbol=k 
              
               [Node list symbol=One ]
               ]
              ]
             
             [Node list symbol=stirling 
             
              [Node list symbol=:: symbol=k 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=- symbol=k symbol=i ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=Zero ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=+ symbol=res 
       
        [Node list symbol=monomial 
        
         [Node list symbol=retract symbol=coeff ]
         
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol=> symbol=i 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=LET symbol=ifac 
        
         [Node list symbol=* symbol=i symbol=ifac ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF alphaHilbert hilp SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= SparseUnivariatePolynomial
    [Node list symbol=SparseUnivariatePolynomial 
    
     [Node list symbol=Fraction 
     
      [Node list symbol=Integer ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ifac
    [Node list symbol=LET symbol=ifac 
    
     [Node list symbol=n 
     
      [Node list symbol=Sel symbol=factorial 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=INBY symbol=i 
     
      [Node list symbol=SEGMENT symbol=n 
      
       [Node list symbol=One ]
       ]
      
      [Node list symbol=- 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=sum 
       
        [Node list symbol=Fraction 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=LET symbol=kfac symbol=ifac ]
      
      [Node list symbol=LET symbol=ifac 
      
       [Node list symbol=quo symbol=ifac symbol=i ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=k 
       
        [Node list symbol=SEGMENT symbol=n 
        
         [Node list symbol=+ symbol=i 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=sum 
        
         [Node list symbol=+ symbol=sum 
         
          [Node list symbol=/ symbol=kfac 
          
           [Node list symbol=* 
           
            [Node list symbol=stirling 
            
             [Node list symbol=:: 
             
              [Node list symbol=- symbol=k 
              
               [Node list symbol=One ]
               ]
              
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=:: 
             
              [Node list symbol=- symbol=k symbol=i ]
              
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=Zero ]
             ]
            
            [Node list symbol=qelt symbol=res 
            
             [Node list symbol=- symbol=k symbol=i ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=kfac 
         
          [Node list symbol=* symbol=k symbol=kfac ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=retract 
       
        [Node list symbol=* symbol=ifac 
        
         [Node list symbol=- symbol=sum 
         
          [Node list symbol=coefficient symbol=hilp 
          
           [Node list symbol=:: 
           
            [Node list symbol=- symbol=i 
            
             [Node list symbol=One ]
             ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=cons symbol=res 
        
         [Node list symbol=:: symbol=ai 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF arbFunctions q j CarChar SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=CarChar symbol=n ]
      ]
     ]
    
   DEFSubnode:atts= LET ifac
    [Node list symbol=LET symbol=ifac 
    
     [Node list 
     
      [Node list symbol=Sel symbol=factorial 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=- symbol=n 
      
       [Node list symbol=One ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=INBY symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=- symbol=n 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=- 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=t 
       
        [Node list symbol=Fraction 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=LET symbol=ifac 
      
       [Node list symbol=quo symbol=ifac symbol=i ]
       ]
      
      [Node list symbol=LET symbol=kfac symbol=ifac ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=k 
       
        [Node list symbol=SEGMENT symbol=i 
        
         [Node list symbol=- symbol=n 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=ki 
        
         [Node list symbol=:: 
         
          [Node list symbol=+ 
          
           [Node list symbol=- symbol=k symbol=i ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=LET symbol=kfac 
        
         [Node list symbol=* symbol=k symbol=kfac ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=t 
         
          [Node list symbol=+ symbol=t 
          
           [Node list symbol=/ symbol=kfac 
           
            [Node list symbol=- 
            
             [Node list symbol=* 
             
              [Node list symbol=qelt symbol=CarChar 
              
               [Node list symbol=+ symbol=k 
               
                [Node list symbol=One ]
                ]
               ]
              
              [Node list symbol=stirling symbol=ki 
              
               [Node list symbol=:: symbol=k 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=Zero ]
               ]
              ]
             
             [Node list symbol=* 
             
              [Node list symbol=qelt symbol=res symbol=ki ]
              
              [Node list symbol=stirling symbol=ki 
              
               [Node list symbol=:: symbol=k 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=+ symbol=q symbol=j ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=t 
      
       [Node list symbol=+ 
       
        [Node list symbol=:: 
        
         [Node list symbol=qelt symbol=CarChar symbol=i ]
         
         [Node list symbol=Fraction 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=* symbol=t symbol=ifac ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=cons symbol=res 
        
         [Node list symbol=retract symbol=t ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF gauge q j gamma SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET gp
    [Node list symbol=LET symbol=gp 
    
     [Node list symbol=# symbol=gamma ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5073330 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=gp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5073330 
     
      [Node list symbol=new symbol=n 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=List 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=reduce string=+ symbol=gamma ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=n1 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=- symbol=n 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=LET symbol=ifac 
       
        [Node list symbol=n1 
        
         [Node list symbol=Sel symbol=factorial 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=rnf 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=/ symbol=ifac 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=INBY symbol=i 
        
         [Node list symbol=SEGMENT symbol=n1 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=t 
          
           [Node list symbol=Fraction 
           
            [Node list symbol=Integer ]
            ]
           ]
          
          [Node list symbol=Zero ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=l 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=- symbol=gp 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=IN symbol=g symbol=gamma ]
          
          [Node list symbol=LET symbol=t 
          
           [Node list symbol=+ symbol=t 
           
            [Node list symbol=:: 
            
             [Node list symbol=:: 
             
              [Node list symbol=* symbol=g 
              
               [Node list symbol=stirling 
               
                [Node list symbol=:: symbol=n1 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=- symbol=n symbol=i ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=+ symbol=q symbol=l ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=Fraction 
             
              [Node list symbol=Integer ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=t 
         
          [Node list symbol=* symbol=t symbol=rnf ]
          ]
         
         [Node list symbol=LET symbol=ifac 
         
          [Node list symbol=quo symbol=ifac symbol=i ]
          ]
         
         [Node list symbol=LET symbol=kfac symbol=ifac ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=k 
          
           [Node list symbol=SEGMENT symbol=i symbol=n1 ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=ki 
           
            [Node list symbol=:: 
            
             [Node list symbol=+ 
             
              [Node list symbol=- symbol=k symbol=i ]
              
              [Node list symbol=One ]
              ]
             
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           
           [Node list symbol=LET symbol=kfac 
           
            [Node list symbol=* symbol=k symbol=kfac ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=t 
            
             [Node list symbol=- symbol=t 
             
              [Node list symbol=/ symbol=kfac 
              
               [Node list symbol=* 
               
                [Node list symbol=qelt symbol=res symbol=ki ]
                
                [Node list symbol=stirling symbol=ki 
                
                 [Node list symbol=:: symbol=k 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=+ symbol=q symbol=j ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=t 
         
          [Node list symbol=* symbol=t symbol=ifac ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=cons symbol=res 
           
            [Node list symbol=retract symbol=t ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF gaugeHilbert q gamma SEQ
   DEFSubnode:atts= SparseUnivariatePolynomial
    [Node list symbol=SparseUnivariatePolynomial 
    
     [Node list symbol=Fraction 
     
      [Node list symbol=Integer ]
      ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET gp
    [Node list symbol=LET symbol=gp 
    
     [Node list symbol=# symbol=gamma ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5073331 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=zero? symbol=gp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5073331 
     
      [Node list symbol=Zero ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=SparseUnivariatePolynomial 
         
          [Node list symbol=Fraction 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=rnf 
        
         [Node list symbol=Fraction 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=/ 
        
         [Node list symbol=One ]
         
         [Node list 
         
          [Node list symbol=Sel symbol=factorial 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=- symbol=n 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=k 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=Zero ]
          
          [Node list symbol=- symbol=n 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=t 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=Zero ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=l 
          
           [Node list symbol=SEGMENT 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=- symbol=gp 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=IN symbol=g symbol=gamma ]
          
          [Node list symbol=LET symbol=t 
          
           [Node list symbol=+ symbol=t 
           
            [Node list symbol=* symbol=g 
            
             [Node list symbol=stirling 
             
              [Node list symbol=:: 
              
               [Node list symbol=- symbol=n 
               
                [Node list symbol=One ]
                ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=- 
               
                [Node list symbol=- symbol=n symbol=k ]
                
                [Node list symbol=One ]
                ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=+ symbol=q symbol=l ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=+ symbol=res 
           
            [Node list symbol=monomial symbol=k 
            
             [Node list symbol=* symbol=t symbol=rnf ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF bound nn mm qq SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5073333 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=one? symbol=qq ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5073333 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5073332 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=nn ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5073332 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=tmp 
          
           [Node list symbol=bound symbol=mm 
           
            [Node list symbol=:: 
            
             [Node list symbol=- symbol=nn 
             
              [Node list symbol=One ]
              ]
             
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=:: 
           
            [Node list symbol=+ 
            
             [Node list symbol=+ symbol=tmp 
             
              [Node list symbol=One ]
              ]
             
             [Node list symbol=* symbol=mm 
             
              [Node list 
              
               [Node list symbol=Sel symbol=binomial 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=+ symbol=nn symbol=tmp ]
               
               [Node list symbol=- symbol=nn 
               
                [Node list symbol=One ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=bound symbol=nn 
      
       [Node list symbol=:: 
       
        [Node list symbol=* symbol=mm 
        
         [Node list symbol=nn 
         
          [Node list symbol=Sel symbol=binomial 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=- 
          
           [Node list symbol=+ symbol=qq symbol=nn ]
           
           [Node list symbol=One ]
           ]
          ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=One ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF complete De SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= JetDifferentialEquation JB D
    [Node list symbol=JetDifferentialEquation symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET tmp
    [Node list symbol=LET symbol=tmp 
    
     [Node list symbol=complete2 symbol=De ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF complete2 De SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=IDe 
     
      [Node list symbol=JetDifferentialEquation symbol=JB symbol=D ]
      ]
     
     [Node list symbol=: symbol=ISys 
     
      [Node list symbol=List symbol=D ]
      ]
     
     [Node list symbol=: symbol=Order 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=NumProj 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=Dim 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=CarChar 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= JetDifferentialEquation JB D
    [Node list symbol=JetDifferentialEquation symbol=JB symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=PrevDe symbol=CurDe symbol=ProjDe ]
     
     [Node list symbol=JetDifferentialEquation symbol=JB symbol=D ]
     ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=PrevSymb symbol=CurSymb ]
     
     [Node list symbol=SparseEchelonMatrix symbol=JB symbol=D ]
     ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=PrevSymbDim symbol=CurSymbDim ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=PrevDeDim symbol=CurDeDim symbol=ProjDeDim ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=PrevMV symbol=CurMV ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Rank 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=NumMultVar 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=Betas 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET PrevDe
    [Node list symbol=LET symbol=PrevDe 
    
     [Node list symbol=SDe 
     
      [Node list symbol=simplify symbol=De ]
      ]
     ]
    
   DEFSubnode:atts= LET CompSys
    [Node list symbol=LET symbol=CompSys 
    
     [Node list symbol=retract symbol=PrevDe ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=> symbol=redMode 
     
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET symbol=CompSys 
     
      [Node list symbol=autoReduce symbol=CompSys ]
      ]
     ]
    
   DEFSubnode:atts= LET PD
    [Node list symbol=LET symbol=PD 
    
     [Node list symbol=prolong symbol=PrevDe ]
     ]
    
   DEFSubnode:atts= LET CurDe
    [Node list symbol=LET symbol=CurDe 
    
     [Node list symbol=PD symbol=SDe ]
     ]
    
   DEFSubnode:atts= LET ICs
    [Node list symbol=LET symbol=ICs 
    
     [Node list symbol=PD symbol=IC ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=> symbol=redMode 
     
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5073334 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=empty? symbol=ICs ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5073334 symbol=noBranch 
       
        [Node list symbol=LET symbol=ICs 
        
         [Node list symbol=autoReduce 
         
          [Node list symbol=reduceMod symbol=ICs symbol=CompSys ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET q
    [Node list symbol=LET symbol=q 
    
     [Node list symbol=order symbol=De ]
     ]
    
   DEFSubnode:atts= LET s
    [Node list symbol=LET symbol=s 
    
     [Node list symbol=Sel 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET q1
    [Node list symbol=LET symbol=q1 
    
     [Node list symbol=+ symbol=q 
     
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= LET dimSq
    [Node list symbol=LET symbol=dimSq 
    
     [Node list symbol=q 
     
      [Node list symbol=Sel symbol=JB symbol=dimS ]
      ]
     ]
    
   DEFSubnode:atts= LET dimSq1
    [Node list symbol=LET symbol=dimSq1 
    
     [Node list symbol=q1 
     
      [Node list symbol=Sel symbol=JB symbol=dimS ]
      ]
     ]
    
   DEFSubnode:atts= LET false
    [Node list symbol=LET symbol=false 
    
     [Node list symbol=: symbol=InvDe 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= LET ode
    [Node list symbol=LET symbol=ode 
    
     [Node list symbol=: symbol=InvSymb 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=solved? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=> symbol=Out int=5 ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=UNTIL symbol=InvDe ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=PrevDeDim 
      
       [Node list symbol=dimension symbol=PrevDe symbol=q ]
       ]
      
      [Node list symbol=LET symbol=CurDeDim 
      
       [Node list symbol=dimension symbol=CurDe symbol=q1 ]
       ]
      
      [Node list symbol=IF symbol=ode symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=PrevSymb 
        
         [Node list symbol=extractSymbol symbol=PrevDe symbol=solved? ]
         ]
        
        [Node list symbol=LET symbol=PrevMV 
        
         [Node list symbol=analyseSymbol symbol=PrevSymb ]
         ]
        
        [Node list symbol=LET symbol=PrevSymbDim 
        
         [Node list symbol=:: 
         
          [Node list symbol=- symbol=dimSq 
          
           [Node list symbol=PrevMV symbol=Rank ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5073335 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=zero? symbol=PrevSymbDim ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5073335 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=CurSymb 
            
             [Node list symbol=prolongSymbol symbol=PrevSymb ]
             ]
            
            [Node list symbol=LET symbol=CurMV 
            
             [Node list symbol=prolongMV symbol=PrevMV ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=CurSymbDim 
             
              [Node list symbol=Sel 
              
               [Node list symbol=NonNegativeInteger ]
               
               [Node list symbol=Zero ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=CurSymb 
            
             [Node list symbol=extractSymbol symbol=CurDe symbol=solved? ]
             ]
            
            [Node list symbol=LET symbol=CurMV 
            
             [Node list symbol=analyseSymbol symbol=CurSymb ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=CurSymbDim 
             
              [Node list symbol=:: 
              
               [Node list symbol=- symbol=dimSq1 
               
                [Node list symbol=CurMV symbol=Rank ]
                ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=InvSymb 
         
          [Node list symbol== 
          
           [Node list symbol=PrevMV symbol=NumMultVar ]
           
           [Node list symbol=CurMV symbol=Rank ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=display symbol=q symbol=s symbol=CompSys symbol=PrevSymb symbol=PrevDeDim symbol=PrevSymbDim ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=WHILE 
       
        [Node list symbol=IF symbol=InvSymb symbol=false symbol=true ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5073336 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=< 
         
          [Node list symbol=CurMV symbol=Rank ]
          
          [Node list symbol=PrevMV symbol=NumMultVar ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5073336 
         
          [Node list symbol=error string=independent equations lost during prolongation!!! ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=info int=2 symbol=q symbol=s symbol=PrevSymbDim ]
           
           [Node list symbol=LET symbol=q symbol=q1 ]
           
           [Node list symbol=LET symbol=q1 
           
            [Node list symbol=+ symbol=q1 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=LET symbol=dimSq symbol=dimSq1 ]
           
           [Node list symbol=LET symbol=dimSq1 
           
            [Node list symbol=q1 
            
             [Node list symbol=Sel symbol=JB symbol=dimS ]
             ]
            ]
           
           [Node list symbol=LET symbol=PrevDe symbol=CurDe ]
           
           [Node list symbol=LET symbol=PrevSymb symbol=CurSymb ]
           
           [Node list symbol=LET symbol=PrevMV symbol=CurMV ]
           
           [Node list symbol=LET symbol=PrevDeDim symbol=CurDeDim ]
           
           [Node list symbol=LET symbol=PrevSymbDim symbol=CurSymbDim ]
           
           [Node list symbol=LET symbol=PD 
           
            [Node list symbol=prolong symbol=PrevDe ]
            ]
           
           [Node list symbol=LET symbol=CurDe 
           
            [Node list symbol=PD symbol=SDe ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5073337 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=zero? symbol=PrevSymbDim ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5073337 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=CurSymb 
               
                [Node list symbol=prolongSymbol symbol=PrevSymb ]
                ]
               
               [Node list symbol=LET symbol=CurMV 
               
                [Node list symbol=prolongMV symbol=PrevMV ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=CurSymbDim 
                
                 [Node list symbol=Sel 
                 
                  [Node list symbol=NonNegativeInteger ]
                  
                  [Node list symbol=Zero ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=CurSymb 
               
                [Node list symbol=extractSymbol symbol=CurDe symbol=solved? ]
                ]
               
               [Node list symbol=LET symbol=CurMV 
               
                [Node list symbol=analyseSymbol symbol=CurSymb ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=CurSymbDim 
                
                 [Node list symbol=:: 
                 
                  [Node list symbol=- symbol=dimSq1 
                  
                   [Node list symbol=CurMV symbol=Rank ]
                   ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=CurDeDim 
           
            [Node list symbol=dimension symbol=CurDe symbol=q1 ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5073338 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? 
             
              [Node list symbol=PD symbol=IC ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5073338 symbol=noBranch 
             
              [Node list symbol=IF 
              
               [Node list symbol=> symbol=redMode 
               
                [Node list symbol=Zero ]
                ]
               
               [Node list symbol=LET symbol=ICs 
               
                [Node list symbol=autoReduce 
                
                 [Node list symbol=concat! symbol=ICs 
                 
                  [Node list symbol=reduceMod symbol=CompSys 
                  
                   [Node list symbol=PD symbol=IC ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=ICs 
               
                [Node list symbol=concat! symbol=ICs 
                
                 [Node list symbol=PD symbol=IC ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=InvSymb 
            
             [Node list symbol== 
             
              [Node list symbol=PrevMV symbol=NumMultVar ]
              
              [Node list symbol=CurMV symbol=Rank ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=IF symbol=ode 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=ProjDe 
        
         [Node list symbol=project symbol=CurDe symbol=q ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=ProjDeDim 
         
          [Node list symbol=dimension symbol=ProjDe symbol=q ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=info symbol=q symbol=s symbol=PrevSymbDim 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=ProjDeDim 
         
          [Node list symbol=:: 
          
           [Node list symbol=- symbol=CurDeDim symbol=CurSymbDim ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=InvDe 
      
       [Node list symbol== symbol=ProjDeDim symbol=PrevDeDim ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=InvDe symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=info int=3 symbol=q symbol=s symbol=PrevDeDim ]
         
         [Node list symbol=LET symbol=s 
         
          [Node list symbol=+ symbol=s 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=displayIntCond symbol=s symbol=ICs ]
         
         [Node list symbol=IF 
         
          [Node list symbol=> symbol=redMode 
          
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=LET symbol=CompSys 
          
           [Node list symbol=autoReduce 
           
            [Node list symbol=concat! symbol=CompSys symbol=ICs ]
            ]
           ]
          
          [Node list symbol=LET symbol=CompSys 
          
           [Node list symbol=concat! symbol=CompSys symbol=ICs ]
           ]
          ]
         
         [Node list symbol=IF symbol=ode 
         
          [Node list symbol=LET symbol=PrevDe symbol=ProjDe ]
          
          [Node list symbol=LET symbol=PrevDe 
          
           [Node list symbol=project symbol=CurDe symbol=q ]
           ]
          ]
         
         [Node list symbol=LET symbol=PD 
         
          [Node list symbol=prolong symbol=CurDe symbol=q1 ]
          ]
         
         [Node list symbol=LET symbol=CurDe 
         
          [Node list symbol=PD symbol=SDe ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5073339 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? 
          
           [Node list symbol=PD symbol=IC ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5073339 
          
           [Node list symbol=LET symbol=ICs symbol=empty ]
           
           [Node list symbol=IF 
           
            [Node list symbol=> symbol=redMode 
            
             [Node list symbol=Zero ]
             ]
            
            [Node list symbol=LET symbol=ICs 
            
             [Node list symbol=autoReduce 
             
              [Node list symbol=reduceMod symbol=CompSys 
              
               [Node list symbol=PD symbol=IC ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=ICs 
            
             [Node list symbol=PD symbol=IC ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF ode
    [Node list symbol=IF symbol=ode 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=PrevSymb 
      
       [Node list symbol=extractSymbol symbol=PrevDe symbol=false ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=Cartan 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=Rank 
         
          [Node list symbol=rowEchelon symbol=PrevSymb ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=Cartan 
     
      [Node list symbol=alpha symbol=q 
      
       [Node list symbol=PrevMV symbol=Betas ]
       ]
      ]
     ]
    
   DEFSubnode:atts= displayCartan CompSys PrevDeDim q s Cartan
    [Node list symbol=displayCartan symbol=CompSys symbol=PrevDeDim symbol=q symbol=s symbol=Cartan ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=PrevDe symbol=CompSys symbol=q symbol=s symbol=PrevDeDim symbol=Cartan ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleFunctionCategory JB
  [Node list symbol=JetBundleFunctionCategory symbol=JB ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetBundleSymAna JB1 xi eta
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB1 symbol=numIndVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mm 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB1 symbol=numDepVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=vars 
    
     [Node list symbol=List symbol=JB1 ]
     ]
    
    [Node list symbol=concat! 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=JB1 symbol=X ]
       
       [Node list symbol=:: symbol=i 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=mm 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=JB1 symbol=U ]
       
       [Node list symbol=:: symbol=i 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=indVars 
    
     [Node list symbol=List 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=jv symbol=vars ]
     
     [Node list symbol=name symbol=jv ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=depVars 
    
     [Node list symbol=List 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=empty ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF 
   
    [Node list symbol=case symbol=xi 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=> symbol=nn 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=LET symbol=depVars 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=nn 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=superscript 
       
        [Node list symbol=:: symbol=xi 
        
         [Node list symbol=Symbol ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=depVars 
     
      [Node list symbol=construct 
      
       [Node list symbol=:: symbol=xi 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=LET symbol=depVars 
    
     [Node list symbol=:: symbol=xi 
     
      [Node list symbol=List 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF 
   
    [Node list symbol=case symbol=eta 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=> symbol=mm 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=LET symbol=depVars 
     
      [Node list symbol=append symbol=depVars 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=mm 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=superscript 
        
         [Node list symbol=:: symbol=eta 
         
          [Node list symbol=Symbol ]
          ]
         
         [Node list symbol=construct 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=depVars 
     
      [Node list symbol=append symbol=depVars 
      
       [Node list symbol=construct 
       
        [Node list symbol=:: symbol=eta 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=LET symbol=depVars 
    
     [Node list symbol=append symbol=depVars 
     
      [Node list symbol=:: symbol=eta 
      
       [Node list symbol=List 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=JetBundle symbol=indVars symbol=depVars ]
    ]
   
  CAPSULEDef:
   [DEF setNotation s SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=print 
     
      [Node list symbol=OutputForm ]
      ]
     
     [Node list symbol=message string=only repeated index notation possible ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=QUOTE symbol=Repeated ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF getNotation QUOTE Repeated
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF multiIndex jv $ jv
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep multiIndex
    [Node list symbol=Sel symbol=Rep symbol=multiIndex ]
    
   ]
   
  CAPSULEDef:
   [DEF index jv $ jv
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep index
    [Node list symbol=Sel symbol=Rep symbol=index ]
    
   ]
   
  CAPSULEDef:
   [DEF type jv $ jv
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep type
    [Node list symbol=Sel symbol=Rep symbol=type ]
    
   ]
   
  CAPSULEDef:
   [DEF X up $ up
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep X
    [Node list symbol=Sel symbol=Rep symbol=X ]
    
   ]
   
  CAPSULEDef:
   [DEF U up $ up
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep U
    [Node list symbol=Sel symbol=Rep symbol=U ]
    
   ]
   
  CAPSULEDef:
   [DEF Pm up lo $ up lo
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep Pm
    [Node list symbol=Sel symbol=Rep symbol=Pm ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce s $ s
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep coerce
    [Node list symbol=Sel symbol=Rep symbol=coerce ]
    
   ]
   
  CAPSULEDef:
   [DEF D u der $ u der
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Symbol ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep D
    [Node list symbol=Sel symbol=Rep symbol=D ]
    
   ]
   
  CAPSULEDef:
   [DEF One $ Sel Rep
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= One
    [Node list symbol=One ]
    
   ]
   
  CAPSULEDef:
   [DEF numIndVar ::
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= + nn mm
    [Node list symbol=+ symbol=nn symbol=mm ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   ]
   
  CAPSULEDef:
   [DEF numDepVar ::
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= + nn mm
    [Node list symbol=+ symbol=nn symbol=mm ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   ]
   
  CAPSULEDef:
   [DEF name jv $ jv
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep name
    [Node list symbol=Sel symbol=Rep symbol=name ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce jv $ jv
   DEFSubnode:atts= Expression
    [Node list symbol=Expression 
    
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel Rep coerce
    [Node list symbol=Sel symbol=Rep symbol=coerce ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleCategory ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=D 
    
     [Node list symbol=$ 
     
      [Node list symbol=Symbol ]
      
      [Node list symbol=List 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= Union
  [Node list symbol=Union 
  
   [Node list symbol=Symbol ]
   
   [Node list symbol=List 
   
    [Node list symbol=Symbol ]
    ]
   ]
  
 DEFSubnode:atts= Union
  [Node list symbol=Union 
  
   [Node list symbol=Symbol ]
   
   [Node list symbol=List 
   
    [Node list symbol=Symbol ]
    ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF SymmetryAnalysis JB1 xi eta
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  ansatz
   SIGNATURE params:JetVectorField JB1 JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  transform
   SIGNATURE params:JetBundleExpression JetBundleSymAna JB1 xi eta 
   JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  linearize
   SIGNATURE params:List JetBundleLinearFunction JetBundleSymAna JB1 xi eta JetBundleXExpression JetBundleSymAna JB1 xi eta 
   List JetBundleExpression JetBundleSymAna JB1 xi eta 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  detSys
   SIGNATURE params:List JetBundleExpression JetBundleSymAna JB1 xi eta 
   List JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  detSys
   SIGNATURE params:List JetBundleExpression JB1 
   List JetBundleExpression JB1 
   JetVectorField JB1 JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  detSys
   SIGNATURE params:List JetBundleExpression JB1 
   List JetBundleExpression JB1 
   List JB1 
   JetVectorField JB1 JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  ncDetSys
   SIGNATURE params:List JetBundleExpression JetBundleSymAna JB1 xi eta 
   List JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  ncDetSys
   SIGNATURE params:List JetBundleExpression JB1 
   List JetBundleExpression JB1 
   JetVectorField JB1 JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  ncDetSys
   SIGNATURE params:List JetBundleExpression JB1 
   List JetBundleExpression JB1 
   List JB1 
   JetVectorField JB1 JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  detSysNS
   SIGNATURE params:List JetBundleExpression JetBundleSymAna JB1 xi eta 
   List JetBundleExpression JB1 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  detSysNS
   SIGNATURE params:List JetBundleExpression JB1 
   List JetBundleExpression JB1 
   JetVectorField JB1 JetBundleExpression JB1 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=JetVectorField symbol=JB1 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nn 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB1 symbol=numIndVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=mm 
    
     [Node list symbol=PositiveInteger ]
     ]
    
    [Node list 
    
     [Node list symbol=Sel symbol=JB1 symbol=numDepVar ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=vars 
    
     [Node list symbol=List symbol=JB1 ]
     ]
    
    [Node list symbol=concat! 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=nn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=JB1 symbol=X ]
       
       [Node list symbol=:: symbol=i 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=mm 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=JB1 symbol=U ]
       
       [Node list symbol=:: symbol=i 
       
        [Node list symbol=PositiveInteger ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=indVars 
    
     [Node list symbol=List 
     
      [Node list symbol=Symbol ]
      ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=jv symbol=vars ]
     
     [Node list symbol=name symbol=jv ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=empty 
   
    [Node list symbol=: symbol=depVars 
    
     [Node list symbol=List 
     
      [Node list symbol=Symbol ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF 
   
    [Node list symbol=case symbol=xi 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=> symbol=nn 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=depVars 
      
       [Node list symbol=List 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=nn 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=superscript 
       
        [Node list symbol=:: symbol=xi 
        
         [Node list symbol=Symbol ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=OutputForm ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=depVars 
      
       [Node list symbol=List 
       
        [Node list symbol=Symbol ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=:: symbol=xi 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=depVars 
     
      [Node list symbol=List 
      
       [Node list symbol=Symbol ]
       ]
      ]
     
     [Node list symbol=:: symbol=xi 
     
      [Node list symbol=List 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=IF 
   
    [Node list symbol=case symbol=eta 
    
     [Node list symbol=Symbol ]
     ]
    
    [Node list symbol=IF 
    
     [Node list symbol=> symbol=mm 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=LET symbol=depVars 
     
      [Node list symbol=append symbol=depVars 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=mm 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=superscript 
        
         [Node list symbol=:: symbol=eta 
         
          [Node list symbol=Symbol ]
          ]
         
         [Node list symbol=construct 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=depVars 
     
      [Node list symbol=append symbol=depVars 
      
       [Node list symbol=construct 
       
        [Node list symbol=:: symbol=eta 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=depVars 
     
      [Node list symbol=List 
      
       [Node list symbol=Symbol ]
       ]
      ]
     
     [Node list symbol=append symbol=depVars 
     
      [Node list symbol=:: symbol=eta 
      
       [Node list symbol=List 
       
        [Node list symbol=Symbol ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=JVars 
    
     [Node list symbol=List 
     
      [Node list symbol=JetBundleExpression symbol=JB1 ]
      ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=jv symbol=vars ]
     
     [Node list symbol=:: symbol=jv 
     
      [Node list symbol=JetBundleExpression symbol=JB1 ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF ansatz SEQ
   DEFSubnode:atts= JetVectorField JB1
    [Node list symbol=JetVectorField symbol=JB1 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=JetVectorField symbol=JB1 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=nn 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=s 
      
       [Node list symbol=qelt symbol=depVars symbol=i ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=f 
       
        [Node list symbol=JetBundleExpression symbol=JB1 ]
        ]
       
       [Node list symbol=function symbol=s symbol=JVars 
       
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=+ symbol=res 
        
         [Node list symbol=* symbol=f 
         
          [Node list symbol=diffX 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=mm 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=s 
      
       [Node list symbol=qelt symbol=depVars 
       
        [Node list symbol=+ symbol=nn symbol=i ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=f 
       
        [Node list symbol=JetBundleExpression symbol=JB1 ]
        ]
       
       [Node list symbol=function symbol=s symbol=JVars 
       
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=+ symbol=res 
        
         [Node list symbol=* symbol=f 
         
          [Node list symbol=diffU 
          
           [Node list symbol=:: symbol=i 
           
            [Node list symbol=PositiveInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF transform f SEQ
   DEFSubnode:atts= JetBundleExpression
    [Node list symbol=JetBundleExpression 
    
     [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
     ]
    
   DEFSubnode:atts= JetBundleExpression JB1
    [Node list symbol=JetBundleExpression symbol=JB1 ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=JV 
     
      [Node list symbol=List 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=SubL 
     
      [Node list symbol=List 
      
       [Node list symbol=Kernel 
       
        [Node list symbol=Expression 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET LKernels
    [Node list symbol=LET symbol=LKernels 
    
     [Node list symbol=tower symbol=f ]
     ]
    
   DEFSubnode:atts= LET LOps
    [Node list symbol=LET symbol=LOps 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=Ke symbol=LKernels ]
      
      [Node list symbol=operator symbol=Ke ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=Ke symbol=LKernels ]
     
     [Node list symbol=IN symbol=Op symbol=LOps ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5155181 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=Op 
       
        [Node list symbol=Sel symbol=has? 
        
         [Node list symbol=BasicOperator ]
         ]
        
        [Node list symbol=:: string=%jet 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5155181 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=typ 
         
          [Node list symbol=pretend 
          
           [Node list symbol=:: 
           
            [Node list symbol=property symbol=Op 
            
             [Node list symbol=:: string=%jet 
             
              [Node list symbol=Symbol ]
              ]
             ]
            
            [Node list symbol=None ]
            ]
           
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5155180 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol== symbol=typ 
          
           [Node list symbol=QUOTE symbol=Deriv ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5155180 
          
           [Node list symbol=error string=function contains illegal jet variables in transform ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=ind 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=retract 
             
              [Node list symbol=second 
              
               [Node list symbol=argument symbol=Ke ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=JV 
            
             [Node list symbol=cons symbol=JV 
             
              [Node list symbol=:: 
              
               [Node list 
               
                [Node list symbol=Sel symbol=X 
                
                 [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
                 ]
                
                [Node list symbol=:: symbol=ind 
                
                 [Node list symbol=PositiveInteger ]
                 ]
                ]
               
               [Node list symbol=Expression 
               
                [Node list symbol=Integer ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF 
             
              [Node list symbol=> symbol=ind symbol=nn ]
              
              [Node list symbol=LET symbol=SubL 
              
               [Node list symbol=cons symbol=SubL 
               
                [Node list symbol=first 
                
                 [Node list symbol=kernels 
                 
                  [Node list symbol=:: 
                  
                   [Node list 
                   
                    [Node list symbol=Sel symbol=JB1 symbol=U ]
                    
                    [Node list symbol=:: 
                    
                     [Node list symbol=- symbol=ind symbol=nn ]
                     
                     [Node list symbol=PositiveInteger ]
                     ]
                    ]
                   
                   [Node list symbol=Expression 
                   
                    [Node list symbol=Integer ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=SubL 
              
               [Node list symbol=cons symbol=SubL 
               
                [Node list symbol=first 
                
                 [Node list symbol=kernels 
                 
                  [Node list symbol=:: 
                  
                   [Node list 
                   
                    [Node list symbol=Sel symbol=JB1 symbol=X ]
                    
                    [Node list symbol=:: symbol=ind 
                    
                     [Node list symbol=PositiveInteger ]
                     ]
                    ]
                   
                   [Node list symbol=Expression 
                   
                    [Node list symbol=Integer ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=fname 
         
          [Node list symbol=name symbol=Op ]
          ]
         
         [Node list symbol=LET symbol=pos 
         
          [Node list symbol=position symbol=fname symbol=depVars ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5155184 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=>= symbol=pos 
          
           [Node list symbol=minIndex symbol=depVars ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5155184 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=arg 
            
             [Node list symbol=argument symbol=Ke ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5155183 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=> int=3 
             
              [Node list symbol=# symbol=arg ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5155183 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=arg 
               
                [Node list symbol=rest symbol=arg ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=num 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=retract 
                
                 [Node list symbol=first symbol=arg ]
                 ]
                ]
               
               [Node list symbol=LET symbol=arg 
               
                [Node list symbol=rest 
                
                 [Node list symbol=rest symbol=arg ]
                 ]
                ]
               
               [Node list symbol=LET symbol=empty 
               
                [Node list symbol=: symbol=rarg 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=JetBundleExpression symbol=JB1 ]
                  ]
                 ]
                ]
               
               [Node list symbol=REPEAT 
               
                [Node list symbol=IN symbol=i 
                
                 [Node list symbol=SEGMENT symbol=num 
                 
                  [Node list symbol=One ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=rarg 
                 
                  [Node list symbol=cons symbol=rarg 
                  
                   [Node list symbol=first symbol=arg ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=arg 
                  
                   [Node list symbol=rest symbol=arg ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET symbol=rarg 
               
                [Node list symbol=reverse! symbol=rarg ]
                ]
               
               [Node list symbol=LET symbol=arg 
               
                [Node list symbol=: symbol=diff 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=JetBundleExpression symbol=JB1 ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5155182 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=empty? symbol=diff ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5155182 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=JV 
                  
                   [Node list symbol=cons symbol=JV 
                   
                    [Node list symbol=:: 
                    
                     [Node list 
                     
                      [Node list symbol=Sel symbol=U 
                      
                       [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
                       ]
                      
                      [Node list symbol=:: symbol=pos 
                      
                       [Node list symbol=PositiveInteger ]
                       ]
                      ]
                     
                     [Node list symbol=Expression 
                     
                      [Node list symbol=Integer ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=SubL 
                   
                    [Node list symbol=cons symbol=SubL 
                    
                     [Node list symbol=first 
                     
                      [Node list symbol=kernels 
                      
                       [Node list symbol=:: 
                       
                        [Node list symbol=:: symbol=Ke 
                        
                         [Node list symbol=JetBundleExpression symbol=JB1 ]
                         ]
                        
                        [Node list symbol=Expression 
                        
                         [Node list symbol=Integer ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=up 
                  
                   [Node list symbol=:: symbol=pos 
                   
                    [Node list symbol=PositiveInteger ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=empty 
                  
                   [Node list symbol=: symbol=lower 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=PositiveInteger ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=REPEAT 
                  
                   [Node list symbol=IN symbol=d symbol=diff ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=id 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=retract symbol=d ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=lower 
                     
                      [Node list symbol=cons symbol=lower 
                      
                       [Node list symbol=:: symbol=id 
                       
                        [Node list symbol=PositiveInteger ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=LET symbol=lower 
                  
                   [Node list symbol=reverse! symbol=lower ]
                   ]
                  
                  [Node list symbol=LET symbol=JV 
                  
                   [Node list symbol=cons symbol=JV 
                   
                    [Node list symbol=:: 
                    
                     [Node list symbol=up symbol=lower 
                     
                      [Node list symbol=Sel symbol=Pr 
                      
                       [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
                       ]
                      ]
                     
                     [Node list symbol=Expression 
                     
                      [Node list symbol=Integer ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=SubL 
                   
                    [Node list symbol=cons symbol=SubL 
                    
                     [Node list symbol=first 
                     
                      [Node list symbol=kernels 
                      
                       [Node list symbol=:: 
                       
                        [Node list symbol=:: symbol=Ke 
                        
                         [Node list symbol=JetBundleExpression symbol=JB1 ]
                         ]
                        
                        [Node list symbol=Expression 
                        
                         [Node list symbol=Integer ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=g 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=eval symbol=SubL symbol=JV 
     
      [Node list symbol=:: symbol=f 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=:: symbol=g 
     
      [Node list symbol=JetBundleExpression 
      
       [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF detSys sys SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression 
     
      [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ds
    [Node list symbol=LET symbol=ds 
    
     [Node list symbol=detSys symbol=sys 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=eq symbol=sys ]
       
       [Node list symbol=leadingDer symbol=eq ]
       ]
      
      [Node list symbol=ansatz ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=eq symbol=ds ]
      
      [Node list symbol=transform symbol=eq ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF detSys sys vf detSys sys vf
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= JetVectorField JB1
    [Node list symbol=JetVectorField symbol=JB1 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=eq symbol=sys ]
     
     [Node list symbol=leadingDer symbol=eq ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF detSys sys sjb vf SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= List JB1
    [Node list symbol=List symbol=JB1 ]
    
   DEFSubnode:atts= JetVectorField JB1
    [Node list symbol=JetVectorField symbol=JB1 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=solEq 
     
      [Node list symbol=List 
      
       [Node list symbol=Equation 
       
        [Node list symbol=JetBundleExpression symbol=JB1 ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=eq symbol=sys ]
     
     [Node list symbol=IN symbol=jv symbol=sjb ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=tmp 
      
       [Node list symbol=solveFor symbol=eq symbol=jv ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol=case symbol=tmp string=failed ]
        
        [Node list symbol=error string=cannot solve in detsys ]
        
        [Node list symbol=LET symbol=solEq 
        
         [Node list symbol=cons symbol=solEq 
         
          [Node list symbol== 
          
           [Node list symbol=:: symbol=jv 
           
            [Node list symbol=JetBundleExpression symbol=JB1 ]
            ]
           
           [Node list symbol=:: symbol=tmp 
           
            [Node list symbol=JetBundleExpression symbol=JB1 ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET solEq
    [Node list symbol=LET symbol=solEq 
    
     [Node list symbol=reverse! symbol=solEq ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ol 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=eq symbol=sys ]
      
      [Node list symbol=order symbol=eq ]
      ]
     ]
    
   DEFSubnode:atts= LET o
    [Node list symbol=LET symbol=o 
    
     [Node list symbol=reduce symbol=max symbol=ol 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET pvf
    [Node list symbol=LET symbol=pvf 
    
     [Node list symbol=prolong symbol=vf symbol=o ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=crit 
     
      [Node list symbol=List 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=eq symbol=sys ]
      
      [Node list symbol=eval symbol=pvf symbol=eq ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=pcrit 
     
      [Node list symbol=List 
      
       [Node list symbol=SparseMultivariatePolynomial symbol=JB1 
       
        [Node list symbol=Expression 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=eq symbol=crit ]
      
      [Node list symbol=numerJP 
      
       [Node list symbol=eval symbol=eq symbol=solEq ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET coL
    [Node list symbol=LET symbol=coL 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=jp symbol=pcrit ]
      
      [Node list symbol=coefficients symbol=jp ]
      ]
     ]
    
   DEFSubnode:atts= LET conds
    [Node list symbol=LET symbol=conds 
    
     [Node list symbol=reduce symbol=append symbol=coL symbol=empty ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=co symbol=conds ]
      
      [Node list symbol=:: symbol=co 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ncDetSys sys SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression 
     
      [Node list symbol=JetBundleSymAna symbol=JB1 symbol=xi symbol=eta ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ds
    [Node list symbol=LET symbol=ds 
    
     [Node list symbol=ncDetSys symbol=sys 
     
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=eq symbol=sys ]
       
       [Node list symbol=leadingDer symbol=eq ]
       ]
      
      [Node list symbol=ansatz ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=eq symbol=ds ]
      
      [Node list symbol=transform symbol=eq ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ncDetSys sys vf ncDetSys sys vf
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= JetVectorField JB1
    [Node list symbol=JetVectorField symbol=JB1 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=eq symbol=sys ]
     
     [Node list symbol=leadingDer symbol=eq ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ncDetSys sys sjb vf SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts= List JB1
    [Node list symbol=List symbol=JB1 ]
    
   DEFSubnode:atts= JetVectorField JB1
    [Node list symbol=JetVectorField symbol=JB1 
    
     [Node list symbol=JetBundleExpression symbol=JB1 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET dirs
    [Node list symbol=LET symbol=dirs 
    
     [Node list symbol=directions symbol=vf ]
     ]
    
   DEFSubnode:atts= LET coeffs
    [Node list symbol=LET symbol=coeffs 
    
     [Node list symbol=coefficients symbol=vf ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=Xi 
     
      [Node list symbol=List 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=tmp 
     
      [Node list symbol=List 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=ind1 
     
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=ind2 
     
      [Node list symbol=List 
      
       [Node list symbol=PositiveInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=jv symbol=dirs ]
     
     [Node list symbol=IN symbol=co symbol=coeffs ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=jt 
      
       [Node list symbol=type symbol=jv ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol== symbol=jt 
        
         [Node list symbol=:: string=Indep 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=Xi 
         
          [Node list symbol=cons symbol=co symbol=Xi ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=ind1 
          
           [Node list symbol=cons symbol=ind1 
           
            [Node list symbol=index symbol=jv ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=jt 
         
          [Node list symbol=:: string=Dep 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=tmp 
          
           [Node list symbol=cons symbol=co symbol=tmp ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ind2 
           
            [Node list symbol=cons symbol=ind2 
            
             [Node list symbol=index symbol=jv ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=error string=Only independent and dependent variables allowed ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET mm
    [Node list symbol=LET symbol=mm 
    
     [Node list symbol=: symbol=j 
     
      [Node list symbol=Integer ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=Eta 
     
      [Node list symbol=List 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=co symbol=tmp ]
     
     [Node list symbol=IN symbol=i symbol=ind2 ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=REPEAT 
      
       [Node list symbol=WHILE 
       
        [Node list symbol=> symbol=j symbol=i ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=Eta 
        
         [Node list symbol=cons symbol=Eta 
         
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=j 
         
          [Node list symbol=- symbol=j 
          
           [Node list symbol=One ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=Eta 
      
       [Node list symbol=cons symbol=co symbol=Eta ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=j 
       
        [Node list symbol=- symbol=j 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5155185 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=j ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5155185 symbol=noBranch 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=j 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=LET symbol=Eta 
        
         [Node list symbol=cons symbol=Eta 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=isc 
     
      [Node list symbol=List 
      
       [Node list symbol=JetBundleExpression symbol=JB1 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=ijb 
     
      [Node list symbol=List symbol=JB1 ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=e symbol=Eta ]
     
     [Node list symbol=IN symbol=j 
     
      [Node list symbol=SEGMENT symbol=mm 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=cond 
       
        [Node list symbol=JetBundleExpression symbol=JB1 ]
        ]
       
       [Node list symbol=- symbol=e ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=jv symbol=JB1 ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=x symbol=Xi ]
       
       [Node list symbol=IN symbol=i symbol=ind1 ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5155186 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=x ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5155186 symbol=noBranch 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=jv 
           
            [Node list 
            
             [Node list symbol=Sel symbol=JB1 symbol=Pr ]
             
             [Node list symbol=:: symbol=j 
             
              [Node list symbol=PositiveInteger ]
              ]
             
             [Node list symbol=construct 
             
              [Node list symbol=:: symbol=i 
              
               [Node list symbol=PositiveInteger ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=cond 
            
             [Node list symbol=+ symbol=cond 
             
              [Node list symbol=* symbol=x 
              
               [Node list symbol=:: symbol=jv 
               
                [Node list symbol=JetBundleExpression symbol=JB1 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5155187 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=one? symbol=jv ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5155187 
       
        [Node list symbol=error string=cannot solve invariant surface condition ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=ijb 
         
          [Node list symbol=cons symbol=jv symbol=ijb ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=isc 
          
           [Node list symbol=cons symbol=cond symbol=isc ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=detSys symbol=vf 
     
      [Node list symbol=append symbol=isc symbol=sys ]
      
      [Node list symbol=append symbol=ijb symbol=sjb ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= Union
  [Node list symbol=Union 
  
   [Node list symbol=Symbol ]
   
   [Node list symbol=List 
   
    [Node list symbol=Symbol ]
    ]
   ]
  
 DEFSubnode:atts= Union
  [Node list symbol=Union 
  
   [Node list symbol=Symbol ]
   
   [Node list symbol=List 
   
    [Node list symbol=Symbol ]
    ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetLazyFunction JB D
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=LazyDiff 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=Zero ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=LazyEval 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=Zero ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=LazyDer 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=DEval? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=DX 
     
      [Node list symbol=Union symbol=JB 
      
       [Node list symbol=Symbol ]
       ]
      ]
     
     [Node list symbol=: symbol=DFun 
     
      [Node list symbol=Union symbol=D symbol=$ ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=LazyTerm 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=LLD symbol=JB ]
     
     [Node list symbol=: symbol=LSharp? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=LEval? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=LCoeff 
     
      [Node list symbol=Union symbol=D symbol=$ ]
      ]
     
     [Node list symbol=: symbol=LDer 
     
      [Node list symbol=Reference symbol=LazyDer ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=RepRec 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=LD symbol=JB ]
     
     [Node list symbol=: symbol=Sharp? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=Ground? 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=: symbol=JV1 
     
      [Node list symbol=List symbol=JB ]
      ]
     
     [Node list symbol=: symbol=JV2 
     
      [Node list symbol=List symbol=JB ]
      ]
     
     [Node list symbol=: symbol=Lazy 
     
      [Node list symbol=List 
      
       [Node list symbol=Reference symbol=LazyTerm ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Reference symbol=RepRec ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=emptyDer symbol=LazyDer ]
    
    [Node list symbol=construct symbol=true 
    
     [Node list symbol=:: string=0 
     
      [Node list symbol=Symbol ]
      ]
     
     [Node list symbol=Sel symbol=D 
     
      [Node list symbol=One ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=zeroRec symbol=RepRec ]
    
    [Node list symbol=construct symbol=true symbol=true symbol=empty symbol=empty 
    
     [Node list symbol=Sel symbol=JB 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=ref 
      
       [Node list symbol=construct symbol=true symbol=true 
       
        [Node list symbol=Sel symbol=JB 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=Sel symbol=D 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=ref symbol=emptyDer ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF statistics SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=print 
     
      [Node list symbol=OutputForm ]
      ]
     
     [Node list symbol=assign 
     
      [Node list symbol=message string=Number of lazy differentiations ]
      
      [Node list symbol=:: symbol=LazyDiff 
      
       [Node list symbol=OutputForm ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=print 
     
      [Node list symbol=OutputForm ]
      ]
     
     [Node list symbol=assign 
     
      [Node list symbol=message string=Number of subsequent evaluations ]
      
      [Node list symbol=:: symbol=LazyEval 
      
       [Node list symbol=OutputForm ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 void
    [Node list symbol=exit int=1 symbol=void ]
    
   ]
   
  CAPSULEDef:
   [DEF emptyDer? der LazyDer SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160841 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= 
     
      [Node list symbol=der symbol=DX ]
      
      [Node list symbol=:: string=0 
      
       [Node list symbol=Symbol ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160841 symbol=false 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160842 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=case symbol=$ 
        
         [Node list symbol=der symbol=DFun ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160842 symbol=false 
        
         [Node list 
         
          [Node list symbol=Sel symbol=D symbol=one? ]
          
          [Node list symbol=:: symbol=D 
          
           [Node list symbol=der symbol=DFun ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF groundFlag? exp $ Ground?
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= deref exp
    [Node list symbol=deref symbol=exp ]
    
   ]
   
  CAPSULEDef:
   [DEF extract exp D $ :: D
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LCoeff
    [Node list symbol=LCoeff 
    
     [Node list symbol=deref 
     
      [Node list symbol=first 
      
       [Node list symbol=Lazy 
       
        [Node list symbol=deref symbol=exp ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF jetVars f IF
   DEFSubnode:atts= List JB
    [Node list symbol=List symbol=JB ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case f D
    [Node list symbol=case symbol=f symbol=D ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=D symbol=jetVariables ]
     
     [Node list symbol=:: symbol=f symbol=D ]
     ]
    
   DEFSubnode:atts= jetVariables
    [Node list symbol=jetVariables 
    
     [Node list symbol=:: symbol=f symbol=$ ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF greater lt1 lt2 >
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LLD
    [Node list symbol=LLD 
    
     [Node list symbol=deref symbol=lt1 ]
     ]
    
   DEFSubnode:atts= LLD
    [Node list symbol=LLD 
    
     [Node list symbol=deref symbol=lt2 ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF lazyTerm d LazyTerm D true true d
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel LazyTerm construct
    [Node list symbol=Sel symbol=LazyTerm symbol=construct ]
    
   DEFSubnode:atts= d
    [Node list symbol=d 
    
     [Node list symbol=Sel symbol=D symbol=leadingDer ]
     ]
    
   DEFSubnode:atts= ref emptyDer
    [Node list symbol=ref symbol=emptyDer ]
    
   ]
   
  CAPSULEDef:
   [DEF convert lt $ LazyTerm SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET JV
    [Node list symbol=LET symbol=JV 
    
     [Node list symbol=removeDuplicates! 
     
      [Node list symbol=merge string=> 
      
       [Node list symbol=jetVars 
       
        [Node list symbol=lt symbol=LCoeff ]
        ]
       
       [Node list symbol=jetVars 
       
        [Node list symbol=DFun 
        
         [Node list symbol=deref 
         
          [Node list symbol=lt symbol=LDer ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=empty symbol=JV 
      
       [Node list symbol=lt symbol=LLD ]
       
       [Node list symbol=lt symbol=LSharp? ]
       
       [Node list symbol=lt symbol=LEval? ]
       
       [Node list symbol=construct 
       
        [Node list symbol=ref symbol=lt ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF adapt rec newLazy RepRec RepRec SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Reference symbol=LazyTerm ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160843 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=newLazy ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160843 symbol=zeroRec 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=lt 
       
        [Node list symbol=deref 
        
         [Node list symbol=first symbol=newLazy ]
         ]
        ]
       
       [Node list symbol=LET symbol=newLD 
       
        [Node list symbol=lt symbol=LLD ]
        ]
       
       [Node list symbol=LET symbol=newSharp? 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5160845 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=lt symbol=LSharp? ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5160845 symbol=false 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5160844 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? 
             
              [Node list symbol=rest symbol=newLazy ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5160844 symbol=true 
             
              [Node list symbol=> symbol=newLD 
              
               [Node list symbol=LLD 
               
                [Node list symbol=deref 
                
                 [Node list symbol=second symbol=newLazy ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=newJV1 
       
        [Node list symbol=rec symbol=JV1 ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5160846 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=newJV1 ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5160846 symbol=false 
           
            [Node list symbol=> symbol=newLD 
            
             [Node list symbol=first symbol=newJV1 ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=newJV1 
        
         [Node list symbol=rest symbol=newJV1 ]
         ]
        ]
       
       [Node list symbol=LET symbol=newJV2 
       
        [Node list symbol=rec symbol=JV2 ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5160847 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=newJV2 ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5160847 symbol=false 
           
            [Node list symbol=> symbol=newLD 
            
             [Node list symbol=first symbol=newJV2 ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=newJV2 
        
         [Node list symbol=rest symbol=newJV2 ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct symbol=newLD symbol=newSharp? symbol=newJV1 symbol=newJV2 symbol=newLazy 
        
         [Node list symbol=rec symbol=Ground? ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF zeroU? f IF
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case f D
    [Node list symbol=case symbol=f symbol=D ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=D symbol=zero? ]
     
     [Node list symbol=:: symbol=f symbol=D ]
     ]
    
   DEFSubnode:atts= zero?
    [Node list symbol=zero? 
    
     [Node list symbol=:: symbol=f symbol=$ ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF oneU? f IF
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case f D
    [Node list symbol=case symbol=f symbol=D ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=D symbol=one? ]
     
     [Node list symbol=:: symbol=f symbol=D ]
     ]
    
   DEFSubnode:atts= one?
    [Node list symbol=one? 
    
     [Node list symbol=:: symbol=f symbol=$ ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF minus f IF
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case f D
    [Node list symbol=case symbol=f symbol=D ]
    
   DEFSubnode:atts=
    [Node list 
    
     [Node list symbol=Sel symbol=D symbol=- ]
     
     [Node list symbol=:: symbol=f symbol=D ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=fs 
     
      [Node list symbol=:: symbol=f symbol=$ ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160848 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=groundFlag? symbol=f ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160848 
      
       [Node list 
       
        [Node list symbol=Sel symbol=D symbol=- ]
        
        [Node list symbol=extract symbol=fs ]
        ]
       
       [Node list symbol=- symbol=fs ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mult f g IF
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case f D
    [Node list symbol=case symbol=f symbol=D ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=fd 
     
      [Node list symbol=:: symbol=f symbol=D ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=g symbol=D ]
       
       [Node list symbol=fd 
       
        [Node list symbol=Sel symbol=D symbol=* ]
        
        [Node list symbol=:: symbol=g symbol=D ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=gs 
        
         [Node list symbol=:: symbol=g symbol=$ ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160849 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=groundFlag? symbol=gs ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160849 
         
          [Node list symbol=fd 
          
           [Node list symbol=Sel symbol=D symbol=* ]
           
           [Node list symbol=extract symbol=gs ]
           ]
          
          [Node list symbol=* symbol=fd symbol=gs ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=fs 
     
      [Node list symbol=:: symbol=f symbol=$ ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=g symbol=D ]
       
       [Node list symbol=* symbol=fs 
       
        [Node list symbol=:: symbol=g symbol=D ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=gs 
        
         [Node list symbol=:: symbol=g symbol=$ ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160850 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=groundFlag? symbol=gs ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160850 
         
          [Node list symbol=* symbol=fs 
          
           [Node list symbol=extract symbol=gs ]
           ]
          
          [Node list symbol=* symbol=fs symbol=gs ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF multLazy rlt1 rlt2 SEQ
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= : resLD JB
    [Node list symbol=: symbol=resLD symbol=JB ]
    
   DEFSubnode:atts= :
    [Node list symbol=: 
    
     [Node list symbol=LISTOF symbol=resSharp? symbol=resEval? ]
     
     [Node list symbol=Boolean ]
     ]
    
   DEFSubnode:atts= : resCoeff
    [Node list symbol=: symbol=resCoeff 
    
     [Node list symbol=Union symbol=D symbol=$ ]
     ]
    
   DEFSubnode:atts= : resDer
    [Node list symbol=: symbol=resDer 
    
     [Node list symbol=Reference symbol=LazyDer ]
     ]
    
   DEFSubnode:atts= LET lt1
    [Node list symbol=LET symbol=lt1 
    
     [Node list symbol=deref symbol=rlt1 ]
     ]
    
   DEFSubnode:atts= LET lt2
    [Node list symbol=LET symbol=lt2 
    
     [Node list symbol=deref symbol=rlt2 ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160853 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=lt1 symbol=LLD ]
       
       [Node list symbol=lt2 symbol=LLD ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160853 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=resLD 
        
         [Node list symbol=lt1 symbol=LLD ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=resSharp? 
         
          [Node list symbol=lt1 symbol=LSharp? ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160852 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=< 
         
          [Node list symbol=lt1 symbol=LLD ]
          
          [Node list symbol=lt2 symbol=LLD ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160852 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resLD 
           
            [Node list symbol=lt2 symbol=LLD ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resSharp? 
            
             [Node list symbol=lt2 symbol=LSharp? ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resLD 
           
            [Node list symbol=lt1 symbol=LLD ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resSharp? 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G5160851 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=lt1 symbol=LSharp? ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G5160851 symbol=true 
               
                [Node list symbol=lt2 symbol=LSharp? ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resEval? false
    [Node list symbol=LET symbol=resEval? symbol=false ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160856 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=lt1 symbol=LEval? ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160856 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=resCoeff 
        
         [Node list symbol=mult 
         
          [Node list symbol=lt1 symbol=LCoeff ]
          
          [Node list symbol=lt2 symbol=LCoeff ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160854 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=lt2 symbol=LEval? ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160854 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resDer 
           
            [Node list symbol=ref symbol=emptyDer ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resEval? symbol=true ]
            ]
           ]
          
          [Node list symbol=LET symbol=resDer 
          
           [Node list symbol=lt2 symbol=LDer ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160855 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=lt2 symbol=LEval? ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160855 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resCoeff 
           
            [Node list symbol=mult 
            
             [Node list symbol=lt1 symbol=LCoeff ]
             
             [Node list symbol=lt2 symbol=LCoeff ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resDer 
            
             [Node list symbol=lt1 symbol=LDer ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resCoeff 
           
            [Node list symbol=mult 
            
             [Node list symbol=convert symbol=lt1 ]
             
             [Node list symbol=lt2 symbol=LCoeff ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resDer 
            
             [Node list symbol=lt2 symbol=LDer ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=resLD symbol=resSharp? symbol=resEval? symbol=resCoeff symbol=resDer 
      
       [Node list symbol=Sel symbol=LazyTerm symbol=construct ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce jv $ JB ref
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= jv true true empty
    [Node list symbol=jv symbol=true symbol=true symbol=empty 
    
     [Node list symbol=Sel symbol=RepRec symbol=construct ]
     
     [Node list symbol=construct symbol=jv ]
     
     [Node list symbol=construct 
     
      [Node list symbol=ref 
      
       [Node list symbol=jv symbol=true symbol=true 
       
        [Node list symbol=Sel symbol=LazyTerm symbol=construct ]
        
        [Node list symbol=:: symbol=jv symbol=D ]
        
        [Node list symbol=ref symbol=emptyDer ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce d $ D SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ld
    [Node list symbol=LET symbol=ld 
    
     [Node list symbol=d 
     
      [Node list symbol=Sel symbol=D symbol=leadingDer ]
      ]
     ]
    
   DEFSubnode:atts= LET JV
    [Node list symbol=LET symbol=JV 
    
     [Node list symbol=d 
     
      [Node list symbol=Sel symbol=D symbol=jetVariables ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=ld symbol=true symbol=true symbol=JV symbol=empty 
      
       [Node list symbol=Sel symbol=RepRec symbol=construct ]
       
       [Node list symbol=construct 
       
        [Node list symbol=ref 
        
         [Node list symbol=ld symbol=true symbol=true symbol=d 
         
          [Node list symbol=Sel symbol=LazyTerm symbol=construct ]
          
          [Node list symbol=ref symbol=emptyDer ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce exp D $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET exp
    [Node list symbol=LET symbol=exp 
    
     [Node list symbol=eval symbol=exp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=extract symbol=exp ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF printFun fun IF
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= Union D $
    [Node list symbol=Union symbol=D symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= case fun D
    [Node list symbol=case symbol=fun symbol=D ]
    
   DEFSubnode:atts= ::
    [Node list symbol=:: 
    
     [Node list symbol=:: symbol=fun symbol=D ]
     
     [Node list symbol=OutputForm ]
     ]
    
   DEFSubnode:atts= ::
    [Node list symbol=:: 
    
     [Node list symbol=:: symbol=fun symbol=$ ]
     
     [Node list symbol=OutputForm ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF printDiff der LazyDer SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160857 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=der symbol=DEval? ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160857 
     
      [Node list symbol=printFun 
      
       [Node list symbol=der symbol=DFun ]
       ]
      
      [Node list symbol=prefix 
      
       [Node list symbol=message 
       
        [Node list symbol=@ string=diff 
        
         [Node list symbol=String ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=printFun 
        
         [Node list symbol=der symbol=DFun ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=der symbol=DX ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF printLazyTerm lt LazyTerm SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160858 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=lt symbol=LEval? ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160858 
     
      [Node list symbol=printFun 
      
       [Node list symbol=lt symbol=LCoeff ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=co 
       
        [Node list symbol=lt symbol=LCoeff ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=* 
        
         [Node list symbol=printFun symbol=co ]
         
         [Node list symbol=printDiff 
         
          [Node list symbol=deref 
          
           [Node list symbol=lt symbol=LDer ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF printLazy llt SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Reference symbol=LazyTerm ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160859 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol== 
     
      [Node list symbol=# symbol=llt ]
      
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160859 
     
      [Node list symbol=printLazyTerm 
      
       [Node list symbol=deref 
       
        [Node list symbol=first symbol=llt ]
        ]
       ]
      
      [Node list symbol=+ 
      
       [Node list symbol=printLazyTerm 
       
        [Node list symbol=deref 
        
         [Node list symbol=first symbol=llt ]
         ]
        ]
       
       [Node list symbol=printLazy 
       
        [Node list symbol=rest symbol=llt ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce exp $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160860 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=groundFlag? symbol=exp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160860 
     
      [Node list symbol=:: 
      
       [Node list symbol=extract symbol=exp ]
       
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=printLazy 
      
       [Node list symbol=Lazy 
       
        [Node list symbol=deref symbol=exp ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF collect exp $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160861 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=rec symbol=Lazy ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160861 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=setref symbol=exp symbol=zeroRec ]
       
       [Node list symbol=exit int=1 symbol=exp ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=d symbol=D ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=LET symbol=true 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=newLazy 
        
         [Node list symbol=List 
         
          [Node list symbol=Reference symbol=LazyTerm ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=rlt 
        
         [Node list symbol=rec symbol=Lazy ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=lt 
         
          [Node list symbol=deref symbol=rlt ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5160868 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=lt symbol=LEval? ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5160868 
          
           [Node list symbol=LET symbol=d 
           
            [Node list symbol=d 
            
             [Node list symbol=Sel symbol=D symbol=+ ]
             
             [Node list symbol=:: symbol=D 
             
              [Node list symbol=lt symbol=LCoeff ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=der 
            
             [Node list symbol=deref 
             
              [Node list symbol=lt symbol=LDer ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5160867 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=der symbol=DEval? ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5160867 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G5160862 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=emptyDer? symbol=der ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G5160862 
                 
                  [Node list symbol=LET symbol=prod 
                  
                   [Node list symbol=lt symbol=LCoeff ]
                   ]
                  
                  [Node list symbol=LET symbol=prod 
                  
                   [Node list symbol=mult 
                   
                    [Node list symbol=der symbol=DFun ]
                    
                    [Node list symbol=lt symbol=LCoeff ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol=case symbol=prod symbol=D ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=IF 
                 
                  [Node list symbol=case symbol=prod symbol=D ]
                  
                  [Node list symbol=LET symbol=prod 
                  
                   [Node list symbol=: symbol=newCoeff 
                   
                    [Node list symbol=Union symbol=D symbol=$ ]
                    ]
                   ]
                  
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=newCoeff 
                   
                    [Node list symbol=Union symbol=D symbol=$ ]
                    ]
                   
                   [Node list symbol=extract 
                   
                    [Node list symbol=:: symbol=prod symbol=$ ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET symbol=newEval? symbol=true ]
                 
                 [Node list symbol=LET symbol=newLD 
                 
                  [Node list symbol=leadingDer 
                  
                   [Node list symbol=:: symbol=newCoeff symbol=D ]
                   ]
                  ]
                 
                 [Node list symbol=LET symbol=true 
                 
                  [Node list symbol=: symbol=newSharp? 
                  
                   [Node list symbol=Boolean ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=d 
                  
                   [Node list symbol=d 
                   
                    [Node list symbol=Sel symbol=D symbol=+ ]
                    
                    [Node list symbol=:: symbol=newCoeff symbol=D ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G5160863 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=ground? 
                  
                   [Node list symbol=:: symbol=prod symbol=$ ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G5160863 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=IF 
                    
                     [Node list symbol=case symbol=prod symbol=D ]
                     
                     [Node list symbol=LET symbol=prod 
                     
                      [Node list symbol=: symbol=newCoeff 
                      
                       [Node list symbol=Union symbol=D symbol=$ ]
                       ]
                      ]
                     
                     [Node list symbol=LET 
                     
                      [Node list symbol=: symbol=newCoeff 
                      
                       [Node list symbol=Union symbol=D symbol=$ ]
                       ]
                      
                      [Node list symbol=extract 
                      
                       [Node list symbol=:: symbol=prod symbol=$ ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=LET symbol=newEval? symbol=true ]
                    
                    [Node list symbol=LET symbol=newLD 
                    
                     [Node list symbol=leadingDer 
                     
                      [Node list symbol=:: symbol=newCoeff symbol=D ]
                      ]
                     ]
                    
                    [Node list symbol=LET symbol=true 
                    
                     [Node list symbol=: symbol=newSharp? 
                     
                      [Node list symbol=Boolean ]
                      ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=d 
                     
                      [Node list symbol=d 
                      
                       [Node list symbol=Sel symbol=D symbol=+ ]
                       
                       [Node list symbol=:: symbol=newCoeff symbol=D ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=newEval? symbol=false ]
                    
                    [Node list symbol=LET symbol=prod 
                    
                     [Node list symbol=: symbol=newCoeff 
                     
                      [Node list symbol=Union symbol=D symbol=$ ]
                      ]
                     ]
                    
                    [Node list symbol=LET symbol=newLD 
                    
                     [Node list symbol=lt symbol=LLD ]
                     ]
                    
                    [Node list symbol=LET symbol=newSharp? 
                    
                     [Node list symbol=lt symbol=LSharp? ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=res symbol=false ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=setref symbol=rlt 
               
                [Node list symbol=newLD symbol=newSharp? symbol=newEval? symbol=newCoeff 
                
                 [Node list symbol=Sel symbol=LazyTerm symbol=construct ]
                 
                 [Node list symbol=ref symbol=emptyDer ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=newEval? symbol=noBranch 
                
                 [Node list symbol=LET symbol=newLazy 
                 
                  [Node list symbol=append symbol=newLazy 
                  
                   [Node list symbol=construct symbol=rlt ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5160864 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=case symbol=$ 
                
                 [Node list symbol=lt symbol=LCoeff ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5160864 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET 
                  
                   [Node list symbol=: symbol=G5160866 
                   
                    [Node list symbol=Boolean ]
                    ]
                   
                   [Node list symbol=ground? 
                   
                    [Node list symbol=:: symbol=$ 
                    
                     [Node list symbol=lt symbol=LCoeff ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=IF symbol=G5160866 
                   
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=LET symbol=co 
                     
                      [Node list symbol=extract 
                      
                       [Node list symbol=:: symbol=$ 
                       
                        [Node list symbol=lt symbol=LCoeff ]
                        ]
                       ]
                      ]
                     
                     [Node list symbol=LET 
                     
                      [Node list symbol=: symbol=G5160865 
                      
                       [Node list symbol=Boolean ]
                       ]
                      
                      [Node list symbol=co 
                      
                       [Node list symbol=Sel symbol=D symbol=zero? ]
                       ]
                      ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=IF symbol=G5160865 
                      
                       [Node list symbol=setref symbol=rlt 
                       
                        [Node list symbol=lazyTerm 
                        
                         [Node list symbol=Sel symbol=D 
                         
                          [Node list symbol=Zero ]
                          ]
                         ]
                        ]
                       
                       [Node list symbol=SEQ 
                       
                        [Node list symbol=LET symbol=co 
                        
                         [Node list symbol=lt symbol=LCoeff ]
                         ]
                        
                        [Node list symbol=setref symbol=rlt symbol=lt ]
                        
                        [Node list symbol=LET symbol=res symbol=false ]
                        
                        [Node list symbol=exit int=1 
                        
                         [Node list symbol=LET symbol=newLazy 
                         
                          [Node list symbol=append symbol=newLazy 
                          
                           [Node list symbol=construct symbol=rlt ]
                           ]
                          ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=SEQ 
                    
                     [Node list symbol=LET symbol=res symbol=false ]
                     
                     [Node list symbol=exit int=1 
                     
                      [Node list symbol=LET symbol=newLazy 
                      
                       [Node list symbol=append symbol=newLazy 
                       
                        [Node list symbol=construct symbol=rlt ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=res symbol=false ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=newLazy 
                   
                    [Node list symbol=append symbol=newLazy 
                    
                     [Node list symbol=construct symbol=rlt ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160869 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=d 
         
          [Node list symbol=Sel symbol=D symbol=zero? ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160869 symbol=noBranch 
         
          [Node list symbol=LET symbol=newLazy 
          
           [Node list symbol=merge symbol=greater symbol=newLazy 
           
            [Node list symbol=construct 
            
             [Node list symbol=ref 
             
              [Node list symbol=lazyTerm symbol=d ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=rec 
       
        [Node list symbol=adapt symbol=rec symbol=newLazy ]
        ]
       
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=rec symbol=Ground? ]
        ]
       
       [Node list symbol=setref symbol=exp symbol=rec ]
       
       [Node list symbol=exit int=1 symbol=exp ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ground? exp $ groundFlag?
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= collect exp
    [Node list symbol=collect symbol=exp ]
    
   ]
   
  CAPSULEDef:
   [DEF evalDeriv rder SEQ
   DEFSubnode:atts= Reference LazyDer
    [Node list symbol=Reference symbol=LazyDer ]
    
   DEFSubnode:atts= Reference LazyDer
    [Node list symbol=Reference symbol=LazyDer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET der
    [Node list symbol=LET symbol=der 
    
     [Node list symbol=deref symbol=rder ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160870 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=der symbol=DEval? ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160870 symbol=rder 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160873 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zeroU? 
         
          [Node list symbol=der symbol=DFun ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160873 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=dfun symbol=D ]
           
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=fun symbol=D ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5160871 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=case symbol=D 
              
               [Node list symbol=der symbol=DFun ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5160871 
              
               [Node list symbol=:: symbol=D 
               
                [Node list symbol=der symbol=DFun ]
                ]
               
               [Node list symbol=:: symbol=D 
               
                [Node list symbol=:: symbol=$ 
                
                 [Node list symbol=der symbol=DFun ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=LazyEval 
           
            [Node list symbol=+ symbol=LazyEval 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=dfun symbol=D ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G5160872 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=case symbol=JB 
               
                [Node list symbol=der symbol=DX ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G5160872 
               
                [Node list symbol=fun 
                
                 [Node list symbol=Sel symbol=D symbol=differentiate ]
                 
                 [Node list symbol=:: symbol=JB 
                 
                  [Node list symbol=der symbol=DX ]
                  ]
                 ]
                
                [Node list symbol=fun 
                
                 [Node list symbol=Sel symbol=D symbol=differentiate ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=der symbol=DX ]
                  
                  [Node list symbol=Symbol ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=setref symbol=rder 
       
        [Node list symbol=construct symbol=true symbol=dfun 
        
         [Node list symbol=:: string=0 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=rder ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF evalTerm rlt SEQ
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts= Reference LazyTerm
    [Node list symbol=Reference symbol=LazyTerm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET lt
    [Node list symbol=LET symbol=lt 
    
     [Node list symbol=deref symbol=rlt ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160874 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=lt symbol=LEval? ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160874 symbol=rlt 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=co symbol=D ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5160875 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=case symbol=D 
          
           [Node list symbol=lt symbol=LCoeff ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5160875 
          
           [Node list symbol=:: symbol=D 
           
            [Node list symbol=lt symbol=LCoeff ]
            ]
           
           [Node list symbol=:: symbol=D 
           
            [Node list symbol=:: symbol=$ 
            
             [Node list symbol=lt symbol=LCoeff ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160876 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=co 
        
         [Node list symbol=Sel symbol=D symbol=zero? ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160876 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=setref symbol=rlt 
          
           [Node list symbol=lazyTerm 
           
            [Node list symbol=Sel symbol=D 
            
             [Node list symbol=Zero ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 symbol=rlt ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=co 
           
            [Node list symbol=Sel symbol=D symbol=* ]
            
            [Node list symbol=:: symbol=D 
            
             [Node list symbol=DFun 
             
              [Node list symbol=deref 
              
               [Node list symbol=evalDeriv 
               
                [Node list symbol=lt symbol=LDer ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=setref symbol=rlt 
          
           [Node list symbol=lazyTerm symbol=res ]
           ]
          
          [Node list symbol=exit int=1 symbol=rlt ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF eval1 exp $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160877 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=rec symbol=Ground? ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160877 symbol=exp 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=lazy 
       
        [Node list symbol=rec symbol=Lazy ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160878 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=empty? symbol=lazy ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160878 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=setref symbol=exp symbol=zeroRec ]
          
          [Node list symbol=exit int=1 symbol=exp ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=rlt 
          
           [Node list symbol=first symbol=lazy ]
           ]
          
          [Node list symbol=LET symbol=rco 
          
           [Node list symbol=deref symbol=rlt ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=d symbol=D ]
           
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=LET symbol=ld 
          
           [Node list symbol=rco symbol=LLD ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=UNTIL 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5160879 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=lazy ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5160879 symbol=true 
              
               [Node list symbol=< symbol=ld 
               
                [Node list symbol=LLD 
                
                 [Node list symbol=deref 
                 
                  [Node list symbol=first symbol=lazy ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=REPEAT 
            
             [Node list symbol=WHILE 
             
              [Node list symbol=rco symbol=LEval? ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=d 
              
               [Node list symbol=d 
               
                [Node list symbol=Sel symbol=D symbol=+ ]
                
                [Node list symbol=:: symbol=D 
                
                 [Node list symbol=rco symbol=LCoeff ]
                 ]
                ]
               ]
              
              [Node list symbol=LET symbol=lazy 
              
               [Node list symbol=rest symbol=lazy ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G5160880 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=lazy ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G5160880 
               
                [Node list symbol=return 
                
                 [Node list symbol=:: symbol=d symbol=$ ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET symbol=rlt 
                 
                  [Node list symbol=first symbol=lazy ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=rco 
                  
                   [Node list symbol=deref symbol=rlt ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=lazy 
            
             [Node list symbol=rest symbol=lazy ]
             ]
            
            [Node list symbol=LET symbol=co 
            
             [Node list symbol=:: symbol=D 
             
              [Node list symbol=LCoeff 
              
               [Node list symbol=deref 
               
                [Node list symbol=evalTerm symbol=rlt ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=d 
            
             [Node list symbol=d symbol=co 
             
              [Node list symbol=Sel symbol=D symbol=+ ]
              ]
             ]
            
            [Node list symbol=LET symbol=rlt 
            
             [Node list symbol=ref 
             
              [Node list symbol=lazyTerm symbol=d ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=ld 
             
              [Node list symbol=LLD 
              
               [Node list symbol=deref symbol=rlt ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5160881 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=d ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5160881 symbol=noBranch 
            
             [Node list symbol=LET symbol=lazy 
             
              [Node list symbol=merge symbol=greater symbol=lazy 
              
               [Node list symbol=construct symbol=rlt ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=setref symbol=exp 
          
           [Node list symbol=adapt symbol=rec symbol=lazy ]
           ]
          
          [Node list symbol=exit int=1 symbol=exp ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF eval exp $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160882 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=ground? symbol=exp ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160882 symbol=false symbol=true ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=exp 
     
      [Node list symbol=eval1 symbol=exp ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 exp
    [Node list symbol=exit int=1 symbol=exp ]
    
   ]
   
  CAPSULEDef:
   [DEF Zero $ ref zeroRec
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF One $ ref
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= true true empty empty
    [Node list symbol=true symbol=true symbol=empty symbol=empty 
    
     [Node list symbol=Sel symbol=RepRec symbol=construct ]
     
     [Node list symbol=Sel symbol=JB 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=ref 
      
       [Node list symbol=true symbol=true 
       
        [Node list symbol=Sel symbol=LazyTerm symbol=construct ]
        
        [Node list symbol=Sel symbol=JB 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=Sel symbol=D 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=ref symbol=emptyDer ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF zero? exp $ SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160883 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=ground? symbol=exp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160883 
     
      [Node list 
      
       [Node list symbol=Sel symbol=D symbol=zero? ]
       
       [Node list symbol=extract symbol=exp ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ld 
       
        [Node list symbol=leadingDer symbol=exp ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160884 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=type symbol=ld ]
         
         [Node list symbol=:: string=Const 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160884 symbol=false 
        
         [Node list 
         
          [Node list symbol=Sel symbol=D symbol=zero? ]
          
          [Node list symbol=extract 
          
           [Node list symbol=eval symbol=exp ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF eqRep? x y $ $ =
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= deref x
    [Node list symbol=deref symbol=x ]
    
   DEFSubnode:atts= deref y
    [Node list symbol=deref symbol=y ]
    
   ]
   
  CAPSULEDef:
   [DEF = x y $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160885 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=eqRep? symbol=x symbol=y ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160885 symbol=true 
     
      [Node list symbol=zero? 
      
       [Node list symbol=- symbol=x symbol=y ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF one? exp $ SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160886 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=ground? symbol=exp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160886 
     
      [Node list 
      
       [Node list symbol=Sel symbol=D symbol=one? ]
       
       [Node list symbol=extract symbol=exp ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ld 
       
        [Node list symbol=leadingDer symbol=exp ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160887 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=type symbol=ld ]
         
         [Node list symbol=:: string=Const 
         
          [Node list symbol=Symbol ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160887 symbol=false 
        
         [Node list 
         
          [Node list symbol=Sel symbol=D symbol=one? ]
          
          [Node list symbol=extract 
          
           [Node list symbol=eval symbol=exp ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEFatts= DEF exp
    numerator exp $ $
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF denominator exp $ $ One
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF - x $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=x ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resLazy 
     
      [Node list symbol=List 
      
       [Node list symbol=Reference symbol=LazyTerm ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=rlt 
      
       [Node list symbol=rec symbol=Lazy ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=lt 
       
        [Node list symbol=deref symbol=rlt ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=ref 
        
         [Node list symbol=construct 
         
          [Node list symbol=lt symbol=LLD ]
          
          [Node list symbol=lt symbol=LSharp? ]
          
          [Node list symbol=lt symbol=LEval? ]
          
          [Node list symbol=minus 
          
           [Node list symbol=lt symbol=LCoeff ]
           ]
          
          [Node list symbol=lt symbol=LDer ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=resLazy 
      
       [Node list symbol=rec symbol=LD ]
       
       [Node list symbol=rec symbol=Sharp? ]
       
       [Node list symbol=rec symbol=Ground? ]
       
       [Node list symbol=rec symbol=JV1 ]
       
       [Node list symbol=rec symbol=JV2 ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF + x y $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET xrec
    [Node list symbol=LET symbol=xrec 
    
     [Node list symbol=deref symbol=x ]
     ]
    
   DEFSubnode:atts= LET yrec
    [Node list symbol=LET symbol=yrec 
    
     [Node list symbol=deref symbol=y ]
     ]
    
   DEFSubnode:atts= LET resLazy
    [Node list symbol=LET symbol=resLazy 
    
     [Node list symbol=merge symbol=greater 
     
      [Node list symbol=xrec symbol=Lazy ]
      
      [Node list symbol=yrec symbol=Lazy ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160889 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=xrec symbol=LD ]
       
       [Node list symbol=yrec symbol=LD ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160889 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=resLD 
        
         [Node list symbol=xrec symbol=LD ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=resSharp? 
         
          [Node list symbol=xrec symbol=Sharp? ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160888 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=> 
         
          [Node list symbol=yrec symbol=LD ]
          
          [Node list symbol=xrec symbol=LD ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160888 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resLD 
           
            [Node list symbol=yrec symbol=LD ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resSharp? 
            
             [Node list symbol=yrec symbol=Sharp? ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=resLD 
           
            [Node list symbol=xrec symbol=LD ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=resSharp? symbol=false ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET xJV
    [Node list symbol=LET symbol=xJV 
    
     [Node list symbol=removeDuplicates! 
     
      [Node list symbol=append 
      
       [Node list symbol=xrec symbol=JV1 ]
       
       [Node list symbol=xrec symbol=JV2 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET yJV
    [Node list symbol=LET symbol=yJV 
    
     [Node list symbol=removeDuplicates! 
     
      [Node list symbol=append 
      
       [Node list symbol=yrec symbol=JV1 ]
       
       [Node list symbol=yrec symbol=JV2 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resJV1
    [Node list symbol=LET symbol=resJV1 
    
     [Node list symbol=sort! string=> 
     
      [Node list symbol=concat! 
      
       [Node list symbol=setDifference symbol=yJV 
       
        [Node list symbol=xrec symbol=JV1 ]
        ]
       
       [Node list symbol=setDifference symbol=xJV 
       
        [Node list symbol=yrec symbol=JV1 ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resJV2
    [Node list symbol=LET symbol=resJV2 
    
     [Node list symbol=sort! string=> 
     
      [Node list symbol=setDifference symbol=resJV1 
      
       [Node list symbol=concat! symbol=xJV symbol=yJV ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=resLD symbol=resSharp? symbol=false symbol=resJV1 symbol=resJV2 symbol=resLazy ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * i x $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=x ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resLazy 
     
      [Node list symbol=List 
      
       [Node list symbol=Reference symbol=LazyTerm ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=rlt 
     
      [Node list symbol=rec symbol=Lazy ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=lt 
      
       [Node list symbol=deref symbol=rlt ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=resLazy 
       
        [Node list symbol=concat! symbol=resLazy 
        
         [Node list symbol=construct 
         
          [Node list symbol=ref 
          
           [Node list symbol=construct 
           
            [Node list symbol=lt symbol=LLD ]
            
            [Node list symbol=lt symbol=LSharp? ]
            
            [Node list symbol=lt symbol=LEval? ]
            
            [Node list symbol=mult 
            
             [Node list symbol=:: symbol=i symbol=D ]
             
             [Node list symbol=lt symbol=LCoeff ]
             ]
            
            [Node list symbol=lt symbol=LDer ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=resLazy 
      
       [Node list symbol=rec symbol=LD ]
       
       [Node list symbol=rec symbol=Sharp? ]
       
       [Node list symbol=rec symbol=Ground? ]
       
       [Node list symbol=rec symbol=JV1 ]
       
       [Node list symbol=rec symbol=JV2 ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * d x D $ * x
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :: d $
    [Node list symbol=:: symbol=d symbol=$ ]
    
   ]
   
  CAPSULEDef:
   [DEF * x y $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160890 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=eqRep? symbol=x 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160890 
      
       [Node list symbol=exit int=2 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160891 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=eqRep? symbol=y 
         
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160891 symbol=noBranch 
         
          [Node list symbol=exit int=3 
          
           [Node list symbol=Zero ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160892 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=ground? symbol=x ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160892 symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160893 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=ground? symbol=y ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160893 symbol=noBranch 
         
          [Node list symbol=exit int=3 
          
           [Node list symbol=:: symbol=$ 
           
            [Node list 
            
             [Node list symbol=Sel symbol=D symbol=* ]
             
             [Node list symbol=extract symbol=x ]
             
             [Node list symbol=extract symbol=y ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET xrec
    [Node list symbol=LET symbol=xrec 
    
     [Node list symbol=deref symbol=x ]
     ]
    
   DEFSubnode:atts= LET yrec
    [Node list symbol=LET symbol=yrec 
    
     [Node list symbol=deref symbol=y ]
     ]
    
   DEFSubnode:atts= LET empty
    [Node list symbol=LET symbol=empty 
    
     [Node list symbol=: symbol=resLazy 
     
      [Node list symbol=List 
      
       [Node list symbol=Reference symbol=LazyTerm ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=xlt 
     
      [Node list symbol=xrec symbol=Lazy ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=ylt 
       
        [Node list symbol=yrec symbol=Lazy ]
        ]
       
       [Node list symbol=LET symbol=resLazy 
       
        [Node list symbol=merge symbol=greater symbol=resLazy 
        
         [Node list symbol=construct 
         
          [Node list symbol=multLazy symbol=xlt symbol=ylt ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=resJV1 
      
       [Node list symbol=removeDuplicates! 
       
        [Node list symbol=append 
        
         [Node list symbol=xrec symbol=JV1 ]
         
         [Node list symbol=yrec symbol=JV1 ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=resJV2 
       
        [Node list symbol=removeDuplicates! 
        
         [Node list symbol=append 
         
          [Node list symbol=xrec symbol=JV2 ]
          
          [Node list symbol=yrec symbol=JV2 ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5160895 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=xrec symbol=LD ]
       
       [Node list symbol=yrec symbol=LD ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5160895 
      
       [Node list symbol=LET symbol=resLD 
       
        [Node list symbol=xrec symbol=LD ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160894 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=> 
         
          [Node list symbol=yrec symbol=LD ]
          
          [Node list symbol=xrec symbol=LD ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160894 
         
          [Node list symbol=LET symbol=resLD 
          
           [Node list symbol=yrec symbol=LD ]
           ]
          
          [Node list symbol=LET symbol=resLD 
          
           [Node list symbol=xrec symbol=LD ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resSharp?
    [Node list symbol=LET symbol=resSharp? 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5160896 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=xrec symbol=Sharp? ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5160896 symbol=false 
       
        [Node list symbol=yrec symbol=Sharp? ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=resLD symbol=resSharp? symbol=false symbol=resJV1 symbol=resJV2 symbol=resLazy ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF recip exp $ SEQ
   DEFSubnode:atts= Union $ failed
    [Node list symbol=Union symbol=$ string=failed ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160897 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=ground? symbol=exp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160897 string=failed 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=rd 
       
        [Node list 
        
         [Node list symbol=Sel symbol=D symbol=recip ]
         
         [Node list symbol=extract symbol=exp ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF string=failed 
        
         [Node list symbol=case symbol=rd string=failed ]
         
         [Node list symbol=:: symbol=$ 
         
          [Node list symbol=:: symbol=rd symbol=D ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF const? exp $ SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160898 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? 
     
      [Node list symbol=rec symbol=JV1 ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160898 symbol=false 
     
      [Node list 
      
       [Node list symbol=Sel symbol=D symbol=const? ]
       
       [Node list symbol=:: symbol=exp symbol=D ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF order exp $ order
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= leadingDer exp
    [Node list symbol=leadingDer symbol=exp ]
    
   ]
   
  CAPSULEDef:
   [DEF class exp $ class
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= leadingDer exp
    [Node list symbol=leadingDer symbol=exp ]
    
   ]
   
  CAPSULEDef:
   [DEF jetVariables exp $ SEQ
   DEFSubnode:atts= List JB
    [Node list symbol=List symbol=JB ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=merge string=> 
     
      [Node list symbol=rec symbol=JV1 ]
      
      [Node list symbol=rec symbol=JV2 ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF differentiate exp jv $ $ JB SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= LET ld
    [Node list symbol=LET symbol=ld 
    
     [Node list symbol=rec symbol=LD ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol=> symbol=jv symbol=ld ]
      
      [Node list symbol=Zero ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=newJV 
       
        [Node list symbol=removeDuplicates! 
        
         [Node list symbol=merge string=> 
         
          [Node list symbol=rec symbol=JV1 ]
          
          [Node list symbol=rec symbol=JV2 ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5160899 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=member? symbol=jv symbol=newJV ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5160899 symbol=noBranch 
         
          [Node list symbol=exit int=2 
          
           [Node list symbol=Zero ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=LazyDiff 
       
        [Node list symbol=+ symbol=LazyDiff 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=ref 
        
         [Node list symbol=construct symbol=ld symbol=false symbol=false symbol=empty symbol=newJV 
         
          [Node list symbol=construct 
          
           [Node list symbol=ref 
           
            [Node list symbol=construct symbol=ld symbol=false symbol=false 
            
             [Node list symbol=Sel symbol=D 
             
              [Node list symbol=One ]
              ]
             
             [Node list symbol=ref 
             
              [Node list symbol=construct symbol=false symbol=jv symbol=exp ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF differentiate exp x $ $ SEQ
   DEFSubnode:atts= Symbol
    [Node list symbol=Symbol ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET LazyDiff
    [Node list symbol=LET symbol=LazyDiff 
    
     [Node list symbol=+ symbol=LazyDiff 
     
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= LET ld
    [Node list symbol=LET symbol=ld 
    
     [Node list symbol=rec symbol=LD ]
     ]
    
   DEFSubnode:atts= LET newJV
    [Node list symbol=LET symbol=newJV 
    
     [Node list symbol=removeDuplicates! 
     
      [Node list symbol=merge string=> 
      
       [Node list symbol=rec symbol=JV1 ]
       
       [Node list symbol=rec symbol=JV2 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=ld symbol=false symbol=false symbol=empty symbol=newJV 
      
       [Node list symbol=construct 
       
        [Node list symbol=ref 
        
         [Node list symbol=construct symbol=ld symbol=false symbol=false 
         
          [Node list symbol=Sel symbol=D 
          
           [Node list symbol=One ]
           ]
          
          [Node list symbol=ref 
          
           [Node list symbol=construct symbol=false symbol=x symbol=exp ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF formalDiff2 Sys i JM SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=DSys 
     
      [Node list symbol=List symbol=$ ]
      ]
     
     [Node list symbol=: symbol=JVars 
     
      [Node list symbol=List 
      
       [Node list symbol=List symbol=JB ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB $
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET inds
    [Node list symbol=LET symbol=inds 
    
     [Node list symbol=allIndices symbol=JM ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160900 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=inds ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160900 
     
      [Node list symbol=construct 
      
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=eq symbol=Sys ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=COLLECT symbol=empty 
       
        [Node list symbol=IN symbol=eq symbol=Sys ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=LRes 
        
         [Node list symbol=List symbol=$ ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=LJV 
        
         [Node list symbol=List 
         
          [Node list symbol=List symbol=JB ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=l 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=nrows symbol=JM ]
          ]
         ]
        
        [Node list symbol=IN symbol=f symbol=Sys ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=r 
         
          [Node list symbol=row symbol=JM symbol=l ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=res symbol=$ ]
          
          [Node list symbol=Zero ]
          ]
         
         [Node list symbol=LET symbol=empty 
         
          [Node list symbol=: symbol=JV 
          
           [Node list symbol=List symbol=JB ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=df 
          
           [Node list symbol=reverse 
           
            [Node list symbol=r symbol=Entries ]
            ]
           ]
          
          [Node list symbol=IN symbol=jv 
          
           [Node list symbol=reverse 
           
            [Node list symbol=r symbol=Indices ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5160901 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=eqRep? symbol=df 
            
             [Node list symbol=Zero ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5160901 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET symbol=djv 
              
               [Node list symbol=differentiate symbol=jv symbol=i ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF 
               
                [Node list symbol=case symbol=djv string=0 ]
                
                [Node list symbol=LET symbol=JV 
                
                 [Node list symbol=cons symbol=jv symbol=JV ]
                 ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G5160902 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=one? 
                  
                   [Node list symbol=:: symbol=djv symbol=JB ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G5160902 
                  
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=res 
                    
                     [Node list symbol=+ symbol=res symbol=df ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=JV 
                     
                      [Node list symbol=cons symbol=jv symbol=JV ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET symbol=res 
                    
                     [Node list symbol=+ symbol=res 
                     
                      [Node list symbol=* symbol=df 
                      
                       [Node list symbol=:: symbol=$ 
                       
                        [Node list symbol=:: symbol=djv symbol=JB ]
                        ]
                       ]
                      ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=LET symbol=JV 
                     
                      [Node list symbol=append symbol=JV 
                      
                       [Node list symbol=construct symbol=jv 
                       
                        [Node list symbol=:: symbol=djv symbol=JB ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5160903 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=Sharp? 
           
            [Node list symbol=deref symbol=f ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5160903 symbol=noBranch 
           
            [Node list symbol=LET symbol=true 
            
             [Node list symbol=Sharp? 
             
              [Node list symbol=deref symbol=res ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=LRes 
         
          [Node list symbol=cons symbol=res symbol=LRes ]
          ]
         
         [Node list symbol=LET symbol=JV 
         
          [Node list symbol=sort! string=> 
          
           [Node list symbol=removeDuplicates! symbol=JV ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=LJV 
          
           [Node list symbol=cons symbol=JV symbol=LJV ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct 
        
         [Node list symbol=reverse! symbol=LRes ]
         
         [Node list symbol=reverse! symbol=LJV ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF leadingDer exp JB $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET rec
    [Node list symbol=LET symbol=rec 
    
     [Node list symbol=deref symbol=exp ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160904 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=rec symbol=Sharp? ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160904 symbol=false 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5160905 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=ground? symbol=exp ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5160905 symbol=false symbol=true ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=exp 
      
       [Node list symbol=eval1 symbol=exp ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=rec 
       
        [Node list symbol=deref symbol=exp ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160906 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=rec symbol=Sharp? ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160906 
     
      [Node list symbol=rec symbol=LD ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=D symbol=leadingDer ]
       
       [Node list symbol=:: symbol=exp symbol=D ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF freeOf? exp jv $ JB SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160907 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=member? symbol=jv 
        
         [Node list symbol=JV1 
         
          [Node list symbol=deref symbol=exp ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160907 symbol=false 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5160908 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=ground? symbol=exp ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5160908 symbol=false symbol=true ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=exp 
     
      [Node list symbol=eval1 symbol=exp ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160909 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=member? symbol=jv 
     
      [Node list symbol=JV1 
      
       [Node list symbol=deref symbol=exp ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160909 symbol=false 
     
      [Node list symbol=jv 
      
       [Node list symbol=Sel symbol=D symbol=freeOf? ]
       
       [Node list symbol=:: symbol=exp symbol=D ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF solveFor exp jv $ JB SEQ
   DEFSubnode:atts= Union $ failed
    [Node list symbol=Union symbol=$ string=failed ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET sf
    [Node list symbol=LET symbol=sf 
    
     [Node list symbol=jv 
     
      [Node list symbol=Sel symbol=D symbol=solveFor ]
      
      [Node list symbol=:: symbol=exp symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF string=failed 
     
      [Node list symbol=case symbol=sf string=failed ]
      
      [Node list symbol=:: symbol=$ 
      
       [Node list symbol=:: symbol=sf symbol=D ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF subst exp jv sub $ $ JB $ :: $
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= jv
    [Node list symbol=jv 
    
     [Node list symbol=Sel symbol=D symbol=subst ]
     
     [Node list symbol=:: symbol=exp symbol=D ]
     
     [Node list symbol=:: symbol=sub symbol=D ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ld r JB LD
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Dep 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=: symbol=Fun symbol=$ ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= deref
    [Node list symbol=deref 
    
     [Node list symbol=r symbol=Fun ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF greaterLD r1 r2 >
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Dep 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=: symbol=Fun symbol=$ ]
     ]
    
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Dep 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=: symbol=Fun symbol=$ ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= ld r1
    [Node list symbol=ld symbol=r1 ]
    
   DEFSubnode:atts= ld r2
    [Node list symbol=ld symbol=r2 ]
    
   ]
   
  CAPSULEDef:
   [DEF simpLD l SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Dep 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=: symbol=Fun symbol=$ ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=Dep 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=: symbol=Fun symbol=$ ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5160910 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=< int=2 
     
      [Node list symbol=# symbol=l ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5160910 symbol=l 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=cur 
       
        [Node list symbol=first symbol=l ]
        ]
       
       [Node list symbol=LET symbol=cld 
       
        [Node list symbol=ld symbol=cur ]
        ]
       
       [Node list symbol=LET symbol=l 
       
        [Node list symbol=rest symbol=l ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160911 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=~= symbol=cld 
        
         [Node list symbol=ld 
         
          [Node list symbol=first symbol=l ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160911 
        
         [Node list symbol=cons symbol=cur 
         
          [Node list symbol=simpLD symbol=l ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=eqLD 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=Dep 
              
               [Node list symbol=List 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              
              [Node list symbol=: symbol=Fun symbol=$ ]
              ]
             ]
            ]
           
           [Node list symbol=construct symbol=cur ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=WHILE 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5160912 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=empty? symbol=l ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5160912 symbol=false 
              
               [Node list symbol== symbol=cld 
               
                [Node list symbol=ld 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=fl 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=Dep 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    
                    [Node list symbol=: symbol=Fun symbol=$ ]
                    ]
                   ]
                  
                  [Node list symbol=first symbol=l ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=eqLD 
            
             [Node list symbol=cons symbol=fl symbol=eqLD ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=l 
             
              [Node list symbol=rest symbol=l ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=false 
          
           [Node list symbol=: symbol=solvable? 
           
            [Node list symbol=Boolean ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=eq symbol=eqLD ]
           
           [Node list symbol=UNTIL symbol=solvable? ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=s 
            
             [Node list symbol=solveFor symbol=cld 
             
              [Node list symbol=eq symbol=Fun ]
              ]
             ]
            
            [Node list symbol=LET symbol=solvable? 
            
             [Node list symbol=case symbol=s symbol=$ ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=seq symbol=eq ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=newL 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=Dep 
              
               [Node list symbol=List 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               ]
              
              [Node list symbol=: symbol=Fun symbol=$ ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=IF symbol=solvable? 
          
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=eq symbol=eqLD ]
            
            [Node list symbol=| 
            
             [Node list symbol=~= symbol=eq symbol=seq ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=neweq 
             
              [Node list symbol=numerator 
              
               [Node list symbol=subst symbol=cld 
               
                [Node list symbol=eq symbol=Fun ]
                
                [Node list symbol=:: symbol=s symbol=$ ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5160913 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=zero? symbol=neweq ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5160913 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=newld 
                
                 [Node list symbol=leadingDer symbol=neweq ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=newL 
                 
                  [Node list symbol=merge symbol=greaterLD symbol=newL 
                  
                   [Node list symbol=construct 
                   
                    [Node list symbol=neweq 
                    
                     [Node list symbol=Sel symbol=construct 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=Dep 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       
                       [Node list symbol=: symbol=Fun symbol=$ ]
                       ]
                      ]
                     
                     [Node list symbol=append 
                     
                      [Node list symbol=eq symbol=Dep ]
                      
                      [Node list symbol=seq symbol=Dep ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=sys 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=eq symbol=eqLD ]
              
              [Node list symbol=:: symbol=D 
              
               [Node list symbol=eq symbol=Fun ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=oldDep 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=eq symbol=eqLD ]
              
              [Node list symbol=eq symbol=Dep ]
              ]
             ]
            
            [Node list symbol=LET symbol=tmp 
            
             [Node list symbol=sys 
             
              [Node list symbol=Sel symbol=D symbol=simplify ]
              
              [Node list symbol=jacobiMatrix symbol=sys ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5160914 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol== string=failed 
              
               [Node list symbol=tmp symbol=Depend ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5160914 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=dep 
                
                 [Node list symbol=removeDuplicates! 
                 
                  [Node list symbol=reduce symbol=append symbol=oldDep symbol=empty ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=newDep 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=COLLECT symbol=dep 
                  
                   [Node list symbol=IN symbol=eq 
                   
                    [Node list symbol=tmp symbol=Sys ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET symbol=empty 
                
                 [Node list symbol=: symbol=newDep 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=REPEAT 
                
                 [Node list symbol=IN symbol=dep 
                 
                  [Node list symbol=:: 
                  
                   [Node list symbol=tmp symbol=Depend ]
                   
                   [Node list symbol=List 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=empty 
                  
                   [Node list symbol=: symbol=ndep 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=REPEAT 
                  
                   [Node list symbol=IN symbol=d symbol=dep ]
                   
                   [Node list symbol=LET symbol=ndep 
                   
                    [Node list symbol=removeDuplicates! 
                    
                     [Node list symbol=concat! symbol=ndep 
                     
                      [Node list symbol=qelt symbol=oldDep symbol=d ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=newDep 
                   
                    [Node list symbol=cons symbol=ndep symbol=newDep ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=LET symbol=newDep 
                 
                  [Node list symbol=reverse! symbol=newDep ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=newL 
            
             [Node list symbol=COLLECT 
             
              [Node list symbol=IN symbol=deq 
              
               [Node list symbol=tmp symbol=Sys ]
               ]
              
              [Node list symbol=IN symbol=dep symbol=newDep ]
              
              [Node list symbol=construct symbol=dep 
              
               [Node list symbol=:: symbol=deq symbol=$ ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=newL 
             
              [Node list symbol=sort! symbol=greaterLD symbol=newL ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=cons symbol=seq 
           
            [Node list symbol=simpLD 
            
             [Node list symbol=merge symbol=greaterLD symbol=l symbol=newL ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF simplify sys jm SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Sys 
     
      [Node list symbol=List symbol=$ ]
      ]
     
     [Node list symbol=: symbol=JM 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     
     [Node list symbol=: symbol=Depend 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= SparseEchelonMatrix JB $
    [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=sl 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=Dep 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=Fun symbol=$ ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=f symbol=sys ]
      
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=construct symbol=f 
      
       [Node list symbol=construct 
       
        [Node list symbol=:: symbol=i 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET sl
    [Node list symbol=LET symbol=sl 
    
     [Node list symbol=simpLD 
     
      [Node list symbol=sort! symbol=greaterLD symbol=sl ]
      ]
     ]
    
   DEFSubnode:atts= LET resSys
    [Node list symbol=LET symbol=resSys 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=l symbol=sl ]
      
      [Node list symbol=collect 
      
       [Node list symbol=l symbol=Fun ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET resDep
    [Node list symbol=LET symbol=resDep 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=l symbol=sl ]
      
      [Node list symbol=l symbol=Dep ]
      ]
     ]
    
   DEFSubnode:atts= LET inds
    [Node list symbol=LET symbol=inds 
    
     [Node list symbol=allIndices symbol=jm ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resJM 
     
      [Node list symbol=SparseEchelonMatrix symbol=JB symbol=$ ]
      ]
     
     [Node list symbol=new symbol=inds 
     
      [Node list symbol=# symbol=sl ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=eq symbol=resSys ]
     
     [Node list symbol=IN symbol=dep symbol=resDep ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5160915 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=one? 
        
         [Node list symbol=# symbol=dep ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5160915 
        
         [Node list symbol=LET symbol=r 
         
          [Node list symbol=row symbol=jm 
          
           [Node list symbol=first symbol=dep ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=tmp 
          
           [Node list symbol=jacobiMatrix 
           
            [Node list symbol=construct symbol=eq ]
            
            [Node list symbol=construct symbol=inds ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=r 
           
            [Node list symbol=row symbol=tmp 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=setRow! symbol=resJM symbol=i symbol=r ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=resSys symbol=resJM symbol=resDep ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF reduceMod sys1 sys2 SEQ
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET sys1D
    [Node list symbol=LET symbol=sys1D 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=exp symbol=sys1 ]
      
      [Node list symbol=extract 
      
       [Node list symbol=eval symbol=exp ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET sys2D
    [Node list symbol=LET symbol=sys2D 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=exp symbol=sys2 ]
      
      [Node list symbol=extract 
      
       [Node list symbol=eval symbol=exp ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=d 
      
       [Node list symbol=sys1D symbol=sys2D 
       
        [Node list symbol=Sel symbol=D symbol=reduceMod ]
        ]
       ]
      
      [Node list symbol=:: symbol=d symbol=$ ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF autoReduce sys SEQ
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts= List $
    [Node list symbol=List symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET sysD
    [Node list symbol=LET symbol=sysD 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=exp symbol=sys ]
      
      [Node list symbol=extract 
      
       [Node list symbol=eval symbol=exp ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=d 
      
       [Node list symbol=sysD 
       
        [Node list symbol=Sel symbol=D symbol=autoReduce ]
        ]
       ]
      
      [Node list symbol=:: symbol=d symbol=$ ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleFunctionCategory symbol=JB ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=ATTRIBUTE 
    
     [Node list symbol=lazyRepresentation ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ symbol=D ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=D symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=collect 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=eval1 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=eval 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=ground? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=D symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=eqRep? 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=statistics 
    
     [Node list 
     
      [Node list symbol=Void ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleFunctionCategory JB
  [Node list symbol=JetBundleFunctionCategory symbol=JB ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF LUDecomposition D
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  LUDecomp
   SIGNATURE params:Record : LU Matrix D : Perm Vector Integer : Pivots List D 
   Matrix D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  LUSolve
   SIGNATURE params:Vector D 
   Matrix D 
   Vector Integer 
   Vector D 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  LUInverse
   SIGNATURE params:Record : Inv Matrix D : Pivots List D 
   Matrix D 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEDef:
   [DEF LUDecomp AA SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=LU 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     
     [Node list symbol=: symbol=Perm 
     
      [Node list symbol=Vector 
      
       [Node list symbol=Integer ]
       ]
      ]
     
     [Node list symbol=: symbol=Pivots 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= Matrix D
    [Node list symbol=Matrix symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET A
    [Node list symbol=LET symbol=A 
    
     [Node list symbol=copy symbol=AA ]
     ]
    
   DEFSubnode:atts= LET minR
    [Node list symbol=LET symbol=minR 
    
     [Node list symbol=minRowIndex symbol=A ]
     ]
    
   DEFSubnode:atts= LET maxR
    [Node list symbol=LET symbol=maxR 
    
     [Node list symbol=maxRowIndex symbol=A ]
     ]
    
   DEFSubnode:atts= LET minC
    [Node list symbol=LET symbol=minC 
    
     [Node list symbol=minColIndex symbol=A ]
     ]
    
   DEFSubnode:atts= LET maxC
    [Node list symbol=LET symbol=maxC 
    
     [Node list symbol=maxColIndex symbol=A ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5161934 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= symbol=maxR symbol=maxC ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5161934 
     
      [Node list symbol=error string=LU decomposition only of square matrices ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=PermV 
        
         [Node list symbol=Vector 
         
          [Node list symbol=Integer ]
          ]
         ]
        
        [Node list symbol=new 
        
         [Node list symbol=:: 
         
          [Node list symbol=+ 
          
           [Node list symbol=- symbol=maxR symbol=minR ]
           
           [Node list symbol=One ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=Zero ]
         ]
        ]
       
       [Node list symbol=LET symbol=empty 
       
        [Node list symbol=: symbol=Pivs 
        
         [Node list symbol=List symbol=D ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=SEGMENT symbol=minC symbol=maxC ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT symbol=minR 
           
            [Node list symbol=- symbol=j 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=s 
           
            [Node list symbol=qelt symbol=A symbol=i symbol=j ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=k 
            
             [Node list symbol=SEGMENT symbol=minR 
             
              [Node list symbol=- symbol=i 
              
               [Node list symbol=One ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=s 
            
             [Node list symbol=- symbol=s 
             
              [Node list symbol=* 
              
               [Node list symbol=qelt symbol=A symbol=i symbol=k ]
               
               [Node list symbol=qelt symbol=A symbol=k symbol=j ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=qsetelt! symbol=A symbol=i symbol=j symbol=s ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=i0 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=- 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=i 
          
           [Node list symbol=SEGMENT symbol=j symbol=maxR ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=s 
           
            [Node list symbol=qelt symbol=A symbol=i symbol=j ]
            ]
           
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=k 
            
             [Node list symbol=SEGMENT symbol=minC 
             
              [Node list symbol=- symbol=j 
              
               [Node list symbol=One ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=s 
            
             [Node list symbol=- symbol=s 
             
              [Node list symbol=* 
              
               [Node list symbol=qelt symbol=A symbol=i symbol=k ]
               
               [Node list symbol=qelt symbol=A symbol=k symbol=j ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=qsetelt! symbol=A symbol=i symbol=j symbol=s ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5161935 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=s ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5161935 symbol=noBranch 
            
             [Node list symbol=IF symbol=noBranch 
             
              [Node list symbol=< symbol=i0 
              
               [Node list symbol=Zero ]
               ]
              
              [Node list symbol=LET symbol=i0 symbol=i ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF 
          
           [Node list symbol=< symbol=i0 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=error string=singular matrix in LUDecomp ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G5161936 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=~= symbol=j symbol=i0 ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G5161936 symbol=noBranch 
              
               [Node list symbol=swapRows! symbol=A symbol=j symbol=i0 ]
               ]
              ]
             ]
            
            [Node list symbol=qsetelt! symbol=PermV symbol=j symbol=i0 ]
            
            [Node list symbol=LET symbol=Pivs 
            
             [Node list symbol=cons symbol=Pivs 
             
              [Node list symbol=qelt symbol=A symbol=j symbol=j ]
              ]
             ]
            
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5161937 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=~= symbol=j symbol=maxC ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5161937 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET symbol=d 
               
                [Node list symbol=/ 
                
                 [Node list symbol=One ]
                 
                 [Node list symbol=qelt symbol=A symbol=j symbol=j ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=REPEAT 
                
                 [Node list symbol=IN symbol=k 
                 
                  [Node list symbol=SEGMENT symbol=maxR 
                  
                   [Node list symbol=+ symbol=j 
                   
                    [Node list symbol=One ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=qsetelt! symbol=A symbol=k symbol=j 
                 
                  [Node list symbol=* symbol=d 
                  
                   [Node list symbol=qelt symbol=A symbol=k symbol=j ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=construct symbol=A symbol=PermV symbol=Pivs ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF LUSolve LU Perm XX SEQ
   DEFSubnode:atts= Vector D
    [Node list symbol=Vector symbol=D ]
    
   DEFSubnode:atts= Matrix D
    [Node list symbol=Matrix symbol=D ]
    
   DEFSubnode:atts= Vector
    [Node list symbol=Vector 
    
     [Node list symbol=Integer ]
     ]
    
   DEFSubnode:atts= Vector D
    [Node list symbol=Vector symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET X
    [Node list symbol=LET symbol=X 
    
     [Node list symbol=copy symbol=XX ]
     ]
    
   DEFSubnode:atts= LET minR
    [Node list symbol=LET symbol=minR 
    
     [Node list symbol=minRowIndex symbol=LU ]
     ]
    
   DEFSubnode:atts= LET maxR
    [Node list symbol=LET symbol=maxR 
    
     [Node list symbol=maxRowIndex symbol=LU ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5161938 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= symbol=maxR 
     
      [Node list symbol=maxIndex symbol=X ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5161938 
     
      [Node list symbol=error string=Wrong dimensions in LUSolve ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=ii 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=- 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=i 
        
         [Node list symbol=SEGMENT symbol=minR symbol=maxR ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=ip 
         
          [Node list symbol=qelt symbol=Perm symbol=i ]
          ]
         
         [Node list symbol=LET symbol=s 
         
          [Node list symbol=qelt symbol=X symbol=ip ]
          ]
         
         [Node list symbol=qsetelt! symbol=X symbol=ip 
         
          [Node list symbol=qelt symbol=X symbol=i ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol=>= symbol=ii 
          
           [Node list symbol=Zero ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=j 
           
            [Node list symbol=SEGMENT symbol=ii 
            
             [Node list symbol=- symbol=i 
             
              [Node list symbol=One ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=s 
           
            [Node list symbol=- symbol=s 
            
             [Node list symbol=* 
             
              [Node list symbol=qelt symbol=LU symbol=i symbol=j ]
              
              [Node list symbol=qelt symbol=X symbol=j ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5161939 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=s ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5161939 symbol=noBranch 
            
             [Node list symbol=LET symbol=ii symbol=i ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=qsetelt! symbol=X symbol=i symbol=s ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=INBY symbol=i 
        
         [Node list symbol=SEGMENT symbol=maxR symbol=minR ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=s 
         
          [Node list symbol=qelt symbol=X symbol=i ]
          ]
         
         [Node list symbol=REPEAT 
         
          [Node list symbol=IN symbol=j 
          
           [Node list symbol=SEGMENT symbol=maxR 
           
            [Node list symbol=+ symbol=i 
            
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=s 
          
           [Node list symbol=- symbol=s 
           
            [Node list symbol=* 
            
             [Node list symbol=qelt symbol=LU symbol=i symbol=j ]
             
             [Node list symbol=qelt symbol=X symbol=j ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=qsetelt! symbol=X symbol=i 
          
           [Node list symbol=/ symbol=s 
           
            [Node list symbol=qelt symbol=LU symbol=i symbol=i ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=X ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF LUInverse A SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=Inv 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     
     [Node list symbol=: symbol=Pivots 
     
      [Node list symbol=List symbol=D ]
      ]
     ]
    
   DEFSubnode:atts= Matrix D
    [Node list symbol=Matrix symbol=D ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET Alu
    [Node list symbol=LET symbol=Alu 
    
     [Node list symbol=LUDecomp symbol=A ]
     ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=ncols symbol=A ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=Matrix symbol=D ]
      ]
     
     [Node list symbol=new symbol=n symbol=n 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=minRowIndex symbol=A ]
       
       [Node list symbol=maxRowIndex symbol=A ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=v 
       
        [Node list symbol=Vector symbol=D ]
        ]
       
       [Node list symbol=new symbol=n 
       
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=qsetelt! symbol=v symbol=i 
      
       [Node list symbol=One ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=setColumn! symbol=res symbol=i 
        
         [Node list symbol=LUSolve symbol=v 
         
          [Node list symbol=Alu symbol=LU ]
          
          [Node list symbol=Alu symbol=Perm ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=res 
     
      [Node list symbol=Alu symbol=Pivots ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Field
  [Node list symbol=Field ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetCoordinateTransformation JB1 JB2 Y W
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  transform
   SIGNATURE params:JetBundleExpression JB2 
   
   ]
   
  CATEGORYSig:
   [SIGNATURE  transform
   SIGNATURE params:JetBundleExpression JB2 
   JetBundleExpression JB1 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=MDEF string=Number of variables must match 
   
    [Node list symbol=errmsg ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=nn 
   
    [Node list symbol=num1 ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=mm 
   
    [Node list symbol=num2 ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=remember 
    
     [Node list symbol=Table 
     
      [Node list symbol=Expression 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=JetBundleExpression symbol=JB2 ]
      ]
     ]
    
    [Node list symbol=dictionary ]
    ]
   
  CAPSULEOther:
   [Node list symbol=LET symbol=DYI 
   
    [Node list 
    
     [Node list symbol=Sel symbol=LUInverse 
     
      [Node list symbol=LUDecomposition 
      
       [Node list symbol=JetBundleExpression symbol=JB2 ]
       ]
      ]
     
     [Node list symbol=jacobi symbol=Y ]
     ]
    ]
   
  CAPSULEDef:
   [DEF num1 SEQ
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5162400 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= 
     
      [Node list 
      
       [Node list symbol=Sel symbol=JB1 symbol=numIndVar ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=JB2 symbol=numIndVar ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5162400 
     
      [Node list symbol=error symbol=errmsg ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5162401 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=~= 
        
         [Node list 
         
          [Node list symbol=Sel symbol=JB1 symbol=numIndVar ]
          ]
         
         [Node list symbol=# symbol=Y ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5162401 
        
         [Node list symbol=error symbol=errmsg ]
         
         [Node list 
         
          [Node list symbol=Sel symbol=JB1 symbol=numIndVar ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF num2 SEQ
   DEFSubnode:atts= PositiveInteger
    [Node list symbol=PositiveInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G5162402 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=~= 
     
      [Node list 
      
       [Node list symbol=Sel symbol=JB1 symbol=numDepVar ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=JB2 symbol=numDepVar ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G5162402 
     
      [Node list symbol=error symbol=errmsg ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5162403 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=~= 
        
         [Node list 
         
          [Node list symbol=Sel symbol=JB1 symbol=numDepVar ]
          ]
         
         [Node list symbol=# symbol=W ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5162403 
        
         [Node list symbol=error symbol=errmsg ]
         
         [Node list 
         
          [Node list symbol=Sel symbol=JB1 symbol=numDepVar ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF jacobi y SEQ
   DEFSubnode:atts= Matrix
    [Node list symbol=Matrix 
    
     [Node list symbol=JetBundleExpression symbol=JB2 ]
     ]
    
   DEFSubnode:atts= Vector
    [Node list symbol=Vector 
    
     [Node list symbol=JetBundleExpression symbol=JB2 ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ly
    [Node list symbol=LET symbol=ly 
    
     [Node list symbol=entries symbol=y ]
     ]
    
   DEFSubnode:atts= LET JM
    [Node list symbol=LET symbol=JM 
    
     [Node list symbol=jacobiMatrix symbol=ly ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=JetBundleExpression symbol=JB2 ]
       ]
      ]
     
     [Node list symbol=new symbol=nn 
     
      [Node list symbol=# symbol=y ]
      
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=nn 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=tmp 
      
       [Node list symbol=formalDiff2 symbol=ly symbol=JM 
       
        [Node list symbol=:: symbol=i 
        
         [Node list symbol=PositiveInteger ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=setColumn! symbol=res symbol=i 
        
         [Node list symbol=vector 
         
          [Node list symbol=tmp symbol=DSys ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF transform jv JB1 SEQ
   DEFSubnode:atts= JetBundleExpression JB2
    [Node list symbol=JetBundleExpression symbol=JB2 ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ans
    [Node list symbol=LET symbol=ans 
    
     [Node list symbol=search symbol=remember 
     
      [Node list symbol=:: symbol=jv 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol=case symbol=ans 
      
       [Node list symbol=JetBundleExpression symbol=JB2 ]
       ]
      
      [Node list symbol=:: symbol=ans 
      
       [Node list symbol=JetBundleExpression symbol=JB2 ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=jt 
       
        [Node list symbol=type symbol=jv ]
        ]
       
       [Node list symbol=IF 
       
        [Node list symbol== symbol=jt 
        
         [Node list symbol=:: string=Const 
         
          [Node list symbol=Symbol ]
          ]
         ]
        
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=Sel 
         
          [Node list symbol=JetBundleExpression symbol=JB2 ]
          
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=jt 
         
          [Node list symbol=:: string=Indep 
          
           [Node list symbol=Symbol ]
           ]
          ]
         
         [Node list symbol=LET symbol=res 
         
          [Node list symbol=qelt symbol=Y 
          
           [Node list symbol=- 
           
            [Node list symbol=+ 
            
             [Node list symbol=index symbol=jv ]
             
             [Node list symbol=minIndex symbol=Y ]
             ]
            
            [Node list symbol=One ]
            ]
           ]
          ]
         
         [Node list symbol=IF 
         
          [Node list symbol== symbol=jt 
          
           [Node list symbol=:: string=Dep 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=qelt symbol=W 
           
            [Node list symbol=- 
            
             [Node list symbol=+ 
             
              [Node list symbol=index symbol=jv ]
              
              [Node list symbol=minIndex symbol=W ]
              ]
             
             [Node list symbol=One ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=i 
           
            [Node list symbol=class symbol=jv ]
            ]
           
           [Node list symbol=LET symbol=pint 
           
            [Node list symbol=jv 
            
             [Node list symbol=Sel symbol=JB1 symbol=integrate ]
             
             [Node list symbol=:: symbol=i 
             
              [Node list symbol=PositiveInteger ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=qint 
           
            [Node list symbol=transform symbol=pint ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=LET symbol=res 
            
             [Node list symbol=reduce string=+ 
             
              [Node list symbol=COLLECT 
              
               [Node list symbol=IN symbol=k 
               
                [Node list symbol=SEGMENT symbol=nn 
                
                 [Node list symbol=One ]
                 ]
                ]
               
               [Node list symbol=* 
               
                [Node list symbol=qelt symbol=i symbol=k 
                
                 [Node list symbol=DYI symbol=Inv ]
                 ]
                
                [Node list symbol=formalDiff symbol=qint 
                
                 [Node list symbol=:: symbol=k 
                 
                  [Node list symbol=PositiveInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=Zero ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=setelt! symbol=remember symbol=res 
        
         [Node list symbol=:: symbol=jv 
         
          [Node list symbol=Expression 
          
           [Node list symbol=Integer ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF transform e1 SEQ
   DEFSubnode:atts= JetBundleExpression JB2
    [Node list symbol=JetBundleExpression symbol=JB2 ]
    
   DEFSubnode:atts= JetBundleExpression JB1
    [Node list symbol=JetBundleExpression symbol=JB1 ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET JV
    [Node list symbol=LET symbol=JV 
    
     [Node list symbol=jetVariables symbol=e1 ]
     ]
    
   DEFSubnode:atts= LET JE
    [Node list symbol=LET symbol=JE 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=jv symbol=JV ]
      
      [Node list symbol=:: 
      
       [Node list symbol=:: symbol=jv 
       
        [Node list symbol=Expression 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=JetBundleExpression symbol=JB2 ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET e2
    [Node list symbol=LET symbol=e2 
    
     [Node list symbol=:: 
     
      [Node list symbol=:: symbol=e1 
      
       [Node list symbol=Expression 
       
        [Node list symbol=Integer ]
        ]
       ]
      
      [Node list symbol=JetBundleExpression symbol=JB2 ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=jv symbol=JV ]
     
     [Node list symbol=IN symbol=je symbol=JE ]
     
     [Node list symbol=LET symbol=e2 
     
      [Node list symbol=eval symbol=e2 
      
       [Node list symbol== symbol=je 
       
        [Node list symbol=transform symbol=jv ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 e2
    [Node list symbol=exit int=1 symbol=e2 ]
    
   ]
   
  ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= Vector
  [Node list symbol=Vector 
  
   [Node list symbol=JetBundleExpression symbol=JB2 ]
   ]
  
 DEFSubnode:atts= Vector
  [Node list symbol=Vector 
  
   [Node list symbol=JetBundleExpression symbol=JB2 ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF JetBundlePolynomial R JB add
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleFunctionCategory symbol=JB ]
   
   [Node list symbol=PolynomialCategory symbol=R symbol=JB 
   
    [Node list symbol=IndexedExponents symbol=JB ]
    ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=R 
     
      [Node list symbol=GcdDomain ]
      ]
     
     [Node list symbol=SIGNATURE symbol=groebner 
     
      [Node list 
      
       [Node list symbol=List symbol=$ ]
       
       [Node list symbol=List symbol=$ ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= Ring
  [Node list symbol=Ring ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= SparseMultivariatePolynomial R JB
  [Node list symbol=SparseMultivariatePolynomial symbol=R symbol=JB ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=SparseMultivariatePolynomial symbol=R symbol=JB ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=jetVariables symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=variables symbol=p ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=subst symbol=p symbol=jv symbol=exp ]
    
    [Node list symbol=$ symbol=$ symbol=JB symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=eval symbol=p symbol=jv symbol=exp ]
    ]
   
   [Node list symbol=DEF symbol=l 
   
    [Node list symbol=numerator symbol=l ]
    
    [Node list symbol=$ symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=denominator symbol=l ]
    
    [Node list symbol=$ symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=One ]
    ]
   
   [Node list symbol=IF 
   
    [Node list symbol=has symbol=R 
    
     [Node list symbol=Field ]
     ]
    
    [Node list symbol=DEF 
    
     [Node list symbol=solveFor symbol=p symbol=jv ]
     
     [Node list symbol=$ symbol=JB 
     
      [Node list symbol=Union symbol=$ string=failed ]
      ]
     
     [Node list 
     
      [Node list ]
      
      [Node list ]
      
      [Node list ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=c 
      
       [Node list symbol=differentiate symbol=p symbol=jv ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5165263 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=ground? symbol=c ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5165263 string=failed 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=cc symbol=R ]
          
          [Node list symbol=retract symbol=c ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=- 
          
           [Node list symbol=* symbol=p 
           
            [Node list symbol=/ symbol=cc 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=:: symbol=jv symbol=$ ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=DEF 
    
     [Node list symbol=solveFor symbol=p symbol=jv ]
     
     [Node list symbol=$ symbol=JB 
     
      [Node list symbol=Union symbol=$ string=failed ]
      ]
     
     [Node list 
     
      [Node list ]
      
      [Node list ]
      
      [Node list ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=c 
      
       [Node list symbol=differentiate symbol=p symbol=jv ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5165264 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=ground? symbol=c ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5165264 string=failed 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=cc symbol=R ]
          
          [Node list symbol=retract symbol=c ]
          ]
         
         [Node list symbol=LET symbol=rc 
         
          [Node list symbol=recip symbol=cc ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF string=failed 
          
           [Node list symbol=case symbol=rc string=failed ]
           
           [Node list symbol=- 
           
            [Node list symbol=* symbol=p 
            
             [Node list symbol=:: symbol=rc symbol=R ]
             ]
            
            [Node list symbol=:: symbol=jv symbol=$ ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=R 
    
     [Node list symbol=GcdDomain ]
     ]
    
    [Node list symbol=DEF 
    
     [Node list symbol=groebner symbol=lp ]
     
     [Node list 
     
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=List symbol=$ ]
      ]
     
     [Node list 
     
      [Node list ]
      
      [Node list ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=message string=groebner ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=lj 
       
        [Node list symbol=List 
        
         [Node list symbol=List symbol=JB ]
         ]
        ]
       
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=p symbol=lp ]
        
        [Node list symbol=jetVariables symbol=p ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=LJV 
       
        [Node list symbol=List symbol=JB ]
        ]
       
       [Node list symbol=reduce symbol=setUnion symbol=lj symbol=empty ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=print 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=assign 
       
        [Node list symbol=message string=LJV ]
        
        [Node list symbol=:: symbol=LJV 
        
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=lp 
       
        [Node list symbol=Sel symbol=groebner 
        
         [Node list symbol=JetGroebner symbol=R symbol=JB symbol=LJV symbol=$ 
         
          [Node list symbol=DirectProduct 
          
           [Node list symbol=# symbol=LJV ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF DistributedJetBundlePolynomial R JB LJV E add
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=PolynomialCategory symbol=R symbol=E symbol=JB ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=convert 
    
     [Node list symbol=$ 
     
      [Node list symbol=JetBundlePolynomial symbol=R symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=convert 
    
     [Node list symbol=$ 
     
      [Node list symbol=JetBundlePolynomial symbol=R symbol=JB ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=const 
    
     [Node list symbol=R symbol=$ ]
     ]
    
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=has symbol=R 
     
      [Node list symbol=GcdDomain ]
      ]
     
     [Node list symbol=SIGNATURE symbol=groebner 
     
      [Node list 
      
       [Node list symbol=List symbol=$ ]
       
       [Node list symbol=List symbol=$ ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= Ring
  [Node list symbol=Ring ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= List JB
  [Node list symbol=List symbol=JB ]
  
 DEFSubnode:atts= DirectProductCategory
  [Node list symbol=DirectProductCategory 
  
   [Node list symbol=# symbol=LJV ]
   
   [Node list symbol=NonNegativeInteger ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= PolynomialRing R E
  [Node list symbol=PolynomialRing symbol=R symbol=E ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=LJVO 
    
     [Node list symbol=List 
     
      [Node list symbol=OutputForm ]
      ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=jv symbol=LJV ]
     
     [Node list symbol=:: symbol=jv 
     
      [Node list symbol=OutputForm ]
      ]
     ]
    ]
   
   [Node list symbol=LET 
   
    [Node list symbol=: symbol=nl 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list symbol=# symbol=LJV ]
    ]
   
   [Node list symbol=LET symbol=Term 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=k symbol=E ]
     
     [Node list symbol=: symbol=c symbol=R ]
     ]
    ]
   
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=List symbol=Term ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=lookup symbol=jv ]
    
    [Node list symbol=JB 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=nl 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=IN symbol=ljv symbol=LJV ]
      
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol== symbol=ljv symbol=jv ]
       
       [Node list symbol=return 
       
        [Node list symbol=:: symbol=i 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=error string=illegal jet variable ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=monomial symbol=p symbol=jv symbol=e ]
    
    [Node list symbol=$ symbol=$ symbol=JB 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=j 
     
      [Node list symbol=lookup symbol=jv ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=v 
      
       [Node list symbol=Vector 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=zero symbol=nl ]
      ]
     
     [Node list symbol=qsetelt! symbol=v symbol=j symbol=e ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=* symbol=p 
      
       [Node list symbol=monomial 
       
        [Node list symbol=One ]
        
        [Node list symbol=directProduct symbol=v ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=jv ]
    
    [Node list symbol=$ symbol=JB ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=monomial symbol=jv 
    
     [Node list symbol=One ]
     
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=zero? symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=empty? 
    
     [Node list symbol=:: symbol=p symbol=Rep ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=ground? symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=case string=failed 
    
     [Node list symbol=mainVariable symbol=p ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=monomial? symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=l symbol=Rep ]
      
      [Node list symbol=:: symbol=p symbol=Rep ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186237 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=l ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186237 symbol=true 
      
       [Node list symbol=empty? 
       
        [Node list symbol=rest symbol=l ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=numberOfMonomials symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=l symbol=Rep ]
      
      [Node list symbol=:: symbol=p symbol=Rep ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186238 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=l ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186238 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=l ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=mainVariable symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Union symbol=JB string=failed ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186239 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186239 string=failed 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=tdeg 
        
         [Node list symbol=degree symbol=p ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT symbol=nl 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=IN symbol=jv symbol=LJV ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5186240 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? 
           
            [Node list symbol=tdeg symbol=i ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5186240 symbol=noBranch 
           
            [Node list symbol=return symbol=jv ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 string=failed ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=variables symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=maxdeg 
      
       [Node list symbol=Vector 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=new symbol=nl 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=WHILE 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5186241 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? symbol=p ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5186241 symbol=false symbol=true ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=tdeg 
       
        [Node list symbol=degree symbol=p ]
        ]
       
       [Node list symbol=LET symbol=p 
       
        [Node list symbol=reductum symbol=p ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=i 
         
          [Node list symbol=SEGMENT symbol=nl 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=maxdeg symbol=i ]
          
          [Node list symbol=max 
          
           [Node list symbol=maxdeg symbol=i ]
           
           [Node list symbol=tdeg symbol=i ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=COLLECT symbol=jv 
      
       [Node list symbol=IN symbol=jv symbol=LJV ]
       
       [Node list symbol=IN symbol=i 
       
        [Node list symbol=SEGMENT symbol=nl 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=| 
       
        [Node list symbol=~= 
        
         [Node list symbol=maxdeg symbol=i ]
         
         [Node list symbol=Zero ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=OutputForm ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186242 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186242 
      
       [Node list symbol=:: 
       
        [Node list symbol=Sel symbol=R 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=empty 
        
         [Node list symbol=: symbol=lt 
         
          [Node list symbol=List 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=t 
         
          [Node list symbol=reverse symbol=p ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=empty 
          
           [Node list symbol=: symbol=l 
           
            [Node list symbol=List 
            
             [Node list symbol=OutputForm ]
             ]
            ]
           ]
          
          [Node list symbol=REPEAT 
          
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT symbol=nl 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5186243 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol== 
             
              [Node list symbol=i 
              
               [Node list symbol=t symbol=k ]
               ]
              
              [Node list symbol=Zero ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5186243 symbol=l 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5186244 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol== 
                
                 [Node list symbol=i 
                 
                  [Node list symbol=t symbol=k ]
                  ]
                 
                 [Node list symbol=One ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5186244 
                
                 [Node list symbol=LET symbol=l 
                 
                  [Node list symbol=cons symbol=l 
                  
                   [Node list symbol=LJVO symbol=i ]
                   ]
                  ]
                 
                 [Node list symbol=LET symbol=l 
                 
                  [Node list symbol=cons symbol=l 
                  
                   [Node list symbol=^ 
                   
                    [Node list symbol=LJVO symbol=i ]
                    
                    [Node list symbol=:: 
                    
                     [Node list symbol=i 
                     
                      [Node list symbol=t symbol=k ]
                      ]
                     
                     [Node list symbol=OutputForm ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=l 
          
           [Node list symbol=reverse symbol=l ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5186245 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=~= 
            
             [Node list symbol=t symbol=c ]
             
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5186245 
            
             [Node list symbol=LET symbol=l 
             
              [Node list symbol=cons symbol=l 
              
               [Node list symbol=:: 
               
                [Node list symbol=t symbol=c ]
                
                [Node list symbol=OutputForm ]
                ]
               ]
              ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G5186246 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=empty? symbol=l ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G5186246 symbol=noBranch 
               
                [Node list symbol=LET symbol=l 
                
                 [Node list symbol=cons symbol=l 
                 
                  [Node list symbol=:: 
                  
                   [Node list symbol=t symbol=c ]
                   
                   [Node list symbol=OutputForm ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5186247 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== 
           
            [Node list symbol=# symbol=l ]
            
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5186247 
           
            [Node list symbol=LET symbol=lt 
            
             [Node list symbol=cons symbol=lt 
             
              [Node list symbol=first symbol=l ]
              ]
             ]
            
            [Node list symbol=LET symbol=lt 
            
             [Node list symbol=cons symbol=lt 
             
              [Node list symbol=reduce string=* symbol=l ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5186248 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol== 
         
          [Node list symbol=# symbol=lt ]
          
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5186248 
         
          [Node list symbol=first symbol=lt ]
          
          [Node list symbol=reduce string=+ symbol=lt ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=convert symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=JetBundlePolynomial symbol=R symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=xx 
     
      [Node list symbol=mainVariable symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=xx string=failed ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=cc symbol=R ]
         
         [Node list symbol=retract symbol=p ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=:: symbol=cc symbol=$ ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=x 
        
         [Node list symbol=:: symbol=xx symbol=JB ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5186249 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=member? symbol=x symbol=LJV ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5186249 symbol=noBranch 
          
           [Node list symbol=exit int=2 
           
            [Node list symbol=error string=illegal jet variable ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=up 
        
         [Node list symbol=univariate symbol=p symbol=x ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=res symbol=$ ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=WHILE 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5186250 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=up ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5186250 symbol=false symbol=true ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=+ symbol=res 
           
            [Node list symbol=monomial symbol=x 
            
             [Node list symbol=convert 
             
              [Node list symbol=leadingCoefficient symbol=up ]
              ]
             
             [Node list symbol=degree symbol=up ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=up 
           
            [Node list symbol=reductum symbol=up ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=res ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=convert symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=JetBundlePolynomial symbol=R symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=xx 
     
      [Node list symbol=mainVariable symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=xx string=failed ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=cc symbol=R ]
         
         [Node list symbol=retract symbol=p ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=:: symbol=cc 
         
          [Node list symbol=JetBundlePolynomial symbol=R symbol=JB ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=x 
        
         [Node list symbol=:: symbol=xx symbol=JB ]
         ]
        
        [Node list symbol=LET symbol=up 
        
         [Node list symbol=univariate symbol=p symbol=x ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=res 
         
          [Node list symbol=JetBundlePolynomial symbol=R symbol=JB ]
          ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=WHILE 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5186251 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=up ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5186251 symbol=false symbol=true ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=+ symbol=res 
           
            [Node list symbol=monomial symbol=x 
            
             [Node list symbol=convert 
             
              [Node list symbol=leadingCoefficient symbol=up ]
              ]
             
             [Node list symbol=degree symbol=up ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=up 
           
            [Node list symbol=reductum symbol=up ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=res ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=const symbol=p ]
    
    [Node list symbol=R symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G5186252 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=ground? symbol=p ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G5186252 symbol=noBranch 
       
        [Node list symbol=exit int=2 
        
         [Node list symbol=error string=not a constant ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=leadingCoefficient symbol=p ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=retractIfCan symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Union symbol=R string=failed ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186253 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=ground? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186253 string=failed 
      
       [Node list symbol=leadingCoefficient symbol=p ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=retract symbol=p ]
    
    [Node list symbol=R symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=const symbol=p ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=univariate symbol=p symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=SparseUnivariatePolynomial symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186254 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186254 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=exp 
        
         [Node list symbol=degree symbol=p ]
         ]
        
        [Node list symbol=LET symbol=j 
        
         [Node list symbol=lookup symbol=jv ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=deg 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=LET symbol=nexp 
        
         [Node list symbol=directProduct 
         
          [Node list 
          
           [Node list symbol=Sel symbol=COLLECT 
           
            [Node list symbol=Vector 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           
           [Node list symbol=IN symbol=i 
           
            [Node list symbol=SEGMENT symbol=nl 
            
             [Node list symbol=One ]
             ]
            ]
           
           [Node list symbol=IF 
           
            [Node list symbol== symbol=j symbol=i ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=deg 
             
              [Node list symbol=exp symbol=i ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=Zero ]
              ]
             ]
            
            [Node list symbol=exp symbol=i ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=+ 
         
          [Node list symbol=monomial symbol=deg 
          
           [Node list symbol=monomial symbol=nexp 
           
            [Node list symbol=leadingCoefficient symbol=p ]
            ]
           ]
          
          [Node list symbol=univariate symbol=jv 
          
           [Node list symbol=reductum symbol=p ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=univariate symbol=p ]
    
    [Node list symbol=$ 
    
     [Node list symbol=SparseUnivariatePolynomial symbol=R ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=pv 
     
      [Node list symbol=p 
      
       [Node list symbol=Sel symbol=$ symbol=mainVariable ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF 
      
       [Node list symbol=case symbol=pv string=failed ]
       
       [Node list symbol=monomial 
       
        [Node list symbol=leadingCoefficient symbol=p ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=up 
        
         [Node list symbol=univariate symbol=p 
         
          [Node list symbol=:: symbol=pv symbol=JB ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=res 
         
          [Node list symbol=SparseUnivariatePolynomial symbol=R ]
          ]
         
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=WHILE 
         
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5186255 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? symbol=up ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5186255 symbol=false symbol=true ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=+ symbol=res 
           
            [Node list symbol=monomial 
            
             [Node list symbol=const 
             
              [Node list symbol=leadingCoefficient symbol=up ]
              ]
             
             [Node list symbol=degree symbol=up ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=up 
           
            [Node list symbol=reductum symbol=up ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 symbol=res ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=multivariate symbol=p1 symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=SparseUnivariatePolynomial symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186256 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=p1 ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186256 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5186257 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=zero? 
         
          [Node list symbol=degree symbol=p1 ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5186257 
         
          [Node list symbol=leadingCoefficient symbol=p1 ]
          
          [Node list symbol=+ 
          
           [Node list symbol=* 
           
            [Node list symbol=leadingCoefficient symbol=p1 ]
            
            [Node list symbol=^ 
            
             [Node list symbol=:: symbol=jv symbol=$ ]
             
             [Node list symbol=degree symbol=p1 ]
             ]
            ]
           
           [Node list symbol=multivariate symbol=jv 
           
            [Node list symbol=reductum symbol=p1 ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=multivariate symbol=p symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=SparseUnivariatePolynomial symbol=R ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186258 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186258 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=+ 
       
        [Node list symbol=* 
        
         [Node list symbol=leadingCoefficient symbol=p ]
         
         [Node list symbol=monomial symbol=jv 
         
          [Node list symbol=One ]
          
          [Node list symbol=degree symbol=p ]
          ]
         ]
        
        [Node list symbol=multivariate symbol=jv 
        
         [Node list symbol=reductum symbol=p ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=totalDegree symbol=p ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186259 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=zero? symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186259 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=REDUCE symbol=max int=0 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=t symbol=p ]
         
         [Node list symbol=reduce string=+ 
         
          [Node list symbol=:: 
          
           [Node list symbol=t symbol=k ]
           
           [Node list symbol=Vector 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          
          [Node list symbol=Zero ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=degree symbol=p symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=degree 
    
     [Node list symbol=univariate symbol=p symbol=jv ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=degree symbol=p symbol=ljv ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=jv symbol=ljv ]
     
     [Node list symbol=degree symbol=p symbol=jv ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=minimumDegree symbol=p symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=minimumDegree 
    
     [Node list symbol=univariate symbol=p symbol=jv ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=minimumDegree symbol=p symbol=ljv ]
    
    [Node list symbol=$ 
    
     [Node list ]
     
     [Node list symbol=List symbol=JB ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=jv symbol=ljv ]
     
     [Node list symbol=minimumDegree symbol=p symbol=jv ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=eval symbol=p symbol=jv symbol=val ]
    
    [Node list symbol=$ symbol=$ symbol=JB symbol=$ ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=val 
    
     [Node list symbol=univariate symbol=p symbol=jv ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=eval symbol=p symbol=jv symbol=val ]
    
    [Node list symbol=$ symbol=$ symbol=JB symbol=R ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=p symbol=jv 
    
     [Node list symbol=Sel symbol=$ symbol=eval ]
     
     [Node list symbol=:: symbol=val symbol=$ ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=eval symbol=p symbol=ljv symbol=lval ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=List symbol=JB ]
     
     [Node list symbol=List symbol=R ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G5186260 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=ljv ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G5186260 symbol=p 
      
       [Node list 
       
        [Node list symbol=Sel symbol=$ symbol=eval ]
        
        [Node list symbol=p 
        
         [Node list symbol=Sel symbol=$ symbol=eval ]
         
         [Node list symbol=first symbol=ljv ]
         
         [Node list symbol=:: symbol=$ 
         
          [Node list symbol=first symbol=lval ]
          ]
         ]
        
        [Node list symbol=rest symbol=ljv ]
        
        [Node list symbol=rest symbol=lval ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=evalSortedVarlist symbol=p symbol=Ljvar symbol=Lpval ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=List symbol=JB ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=j 
     
      [Node list symbol=mainVariable symbol=p ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=p 
      
       [Node list symbol=case symbol=j string=failed ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=pv 
        
         [Node list symbol=:: symbol=j symbol=JB ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G5186261 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=empty? symbol=Ljvar ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G5186261 
          
           [Node list symbol=exit int=2 symbol=p ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5186262 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=empty? symbol=Lpval ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5186262 symbol=noBranch 
             
              [Node list symbol=exit int=3 symbol=p ]
              ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=mvar 
        
         [Node list symbol=Ljvar symbol=first ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=> symbol=mvar symbol=pv ]
          
          [Node list symbol=evalSortedVarlist symbol=p 
          
           [Node list symbol=Ljvar symbol=rest ]
           
           [Node list symbol=Lpval symbol=rest ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=pval 
           
            [Node list symbol=Lpval symbol=first ]
            ]
           
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=pts 
            
             [Node list symbol=SparseUnivariatePolynomial symbol=$ ]
             ]
            
            [Node list symbol=map 
            
             [Node list symbol=+-> symbol=x 
             
              [Node list symbol=evalSortedVarlist symbol=x symbol=Ljvar symbol=Lpval ]
              ]
             
             [Node list symbol=univariate symbol=p symbol=pv ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF 
            
             [Node list symbol== symbol=mvar symbol=pv ]
             
             [Node list symbol=pts symbol=pval ]
             
             [Node list symbol=multivariate symbol=pts symbol=pv ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=eval symbol=p symbol=Ljvar symbol=Lpval ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=List symbol=JB ]
     
     [Node list symbol=List symbol=$ ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=nljvar 
      
       [Node list symbol=List symbol=JB ]
       ]
      
      [Node list symbol=sort symbol=Ljvar 
      
       [Node list symbol=+-> 
       
        [Node list symbol=@Tuple symbol=x symbol=y ]
        
        [Node list symbol=< 
        
         [Node list symbol=lookup symbol=x ]
         
         [Node list symbol=lookup symbol=y ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=nlpval 
     
      [Node list symbol=IF symbol=Lpval 
      
       [Node list symbol== symbol=Ljvar symbol=nljvar ]
       
       [Node list symbol=LET symbol=nlpval 
       
        [Node list symbol=COLLECT 
        
         [Node list symbol=IN symbol=mvar symbol=nljvar ]
         
         [Node list symbol=Lpval 
         
          [Node list symbol=position symbol=mvar symbol=Ljvar ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=evalSortedVarlist symbol=p symbol=nljvar symbol=nlpval ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=differentiate symbol=p symbol=jv ]
    
    [Node list symbol=$ symbol=JB 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=multivariate symbol=jv 
    
     [Node list symbol=differentiate 
     
      [Node list symbol=univariate symbol=p symbol=jv ]
      ]
     ]
    ]
   
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=R 
    
     [Node list symbol=Field ]
     ]
    
    [Node list symbol=DEF 
    
     [Node list symbol=/ symbol=p symbol=r ]
     
     [Node list symbol=$ symbol=R 
     
      [Node list ]
      ]
     
     [Node list 
     
      [Node list ]
      
      [Node list ]
      
      [Node list ]
      ]
     
     [Node list symbol=* symbol=p 
     
      [Node list symbol=inv symbol=r ]
      ]
     ]
    ]
   
   [Node list symbol=IF symbol=noBranch 
   
    [Node list symbol=has symbol=R 
    
     [Node list symbol=GcdDomain ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=DEF 
     
      [Node list symbol=content symbol=p ]
      
      [Node list symbol=R symbol=$ ]
      
      [Node list 
      
       [Node list ]
       
       [Node list ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G5186263 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=zero? symbol=p ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G5186263 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=REDUCE symbol=gcd int=0 
         
          [Node list symbol=COLLECT 
          
           [Node list symbol=IN symbol=t symbol=p ]
           
           [Node list symbol=t symbol=c ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=IF 
     
      [Node list symbol=has symbol=R 
      
       [Node list symbol=EuclideanDomain ]
       ]
      
      [Node list symbol=IF 
      
       [Node list symbol=has symbol=R 
       
        [Node list symbol=Field ]
        ]
       
       [Node list symbol=DEF 
       
        [Node list symbol=gcd symbol=p1 symbol=p2 ]
        
        [Node list symbol=$ symbol=$ symbol=$ ]
        
        [Node list 
        
         [Node list ]
         
         [Node list ]
         
         [Node list ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=: symbol=r symbol=R ]
         
         [Node list symbol=LET symbol=pv1 
         
          [Node list symbol=mainVariable symbol=p1 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF 
          
           [Node list symbol=case symbol=pv1 string=failed ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G5186264 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=zero? 
             
              [Node list symbol=LET symbol=r 
              
               [Node list symbol=leadingCoefficient symbol=p1 ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G5186264 symbol=p2 
             
              [Node list symbol=:: symbol=$ 
              
               [Node list symbol=gcd symbol=r 
               
                [Node list symbol=content symbol=p2 ]
                ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=pv2 
            
             [Node list symbol=mainVariable symbol=p2 ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF 
             
              [Node list symbol=case symbol=pv2 string=failed ]
              
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G5186265 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=zero? 
                
                 [Node list symbol=LET symbol=r 
                 
                  [Node list symbol=leadingCoefficient symbol=p2 ]
                  ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G5186265 symbol=p1 
                
                 [Node list symbol=:: symbol=$ 
                 
                  [Node list symbol=gcd symbol=r 
                  
                   [Node list symbol=content symbol=p1 ]
                   ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol=< symbol=pv1 symbol=pv2 ]
               
               [Node list symbol=gcd symbol=p1 
               
                [Node list symbol=content 
                
                 [Node list symbol=univariate symbol=p2 symbol=pv2 ]
                 ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol=< symbol=pv2 symbol=pv1 ]
                
                [Node list symbol=gcd symbol=p2 
                
                 [Node list symbol=content 
                 
                  [Node list symbol=univariate symbol=p1 symbol=pv1 ]
                  ]
                 ]
                
                [Node list symbol=multivariate symbol=pv1 
                
                 [Node list symbol=gcd 
                 
                  [Node list symbol=univariate symbol=p1 symbol=pv1 ]
                  
                  [Node list symbol=univariate symbol=p2 symbol=pv2 ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=DEF 
       
        [Node list symbol=gcd symbol=p1 symbol=p2 ]
        
        [Node list symbol=$ symbol=$ symbol=$ ]
        
        [Node list 
        
         [Node list ]
         
         [Node list ]
         
         [Node list ]
         ]
        
        [Node list symbol=p1 symbol=p2 
        
         [Node list symbol=Sel symbol=gcd 
         
          [Node list symbol=PolynomialGcdPackage symbol=E symbol=JB symbol=R symbol=$ ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=DEF 
      
       [Node list symbol=gcd symbol=p1 symbol=p2 ]
       
       [Node list symbol=$ symbol=$ symbol=$ ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=: symbol=r symbol=R ]
        
        [Node list symbol=LET symbol=pv1 
        
         [Node list symbol=mainVariable symbol=p1 ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF 
         
          [Node list symbol=case symbol=pv1 string=failed ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G5186264 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=zero? 
            
             [Node list symbol=LET symbol=r 
             
              [Node list symbol=leadingCoefficient symbol=p1 ]
              ]
             ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G5186264 symbol=p2 
            
             [Node list symbol=:: symbol=$ 
             
              [Node list symbol=gcd symbol=r 
              
               [Node list symbol=content symbol=p2 ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET symbol=pv2 
           
            [Node list symbol=mainVariable symbol=p2 ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF 
            
             [Node list symbol=case symbol=pv2 string=failed ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G5186265 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=zero? 
               
                [Node list symbol=LET symbol=r 
                
                 [Node list symbol=leadingCoefficient symbol=p2 ]
                 ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G5186265 symbol=p1 
               
                [Node list symbol=:: symbol=$ 
                
                 [Node list symbol=gcd symbol=r 
                 
                  [Node list symbol=content symbol=p1 ]
                  ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=IF 
             
              [Node list symbol=< symbol=pv1 symbol=pv2 ]
              
              [Node list symbol=gcd symbol=p1 
              
               [Node list symbol=content 
               
                [Node list symbol=univariate symbol=p2 symbol=pv2 ]
                ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol=< symbol=pv2 symbol=pv1 ]
               
               [Node list symbol=gcd symbol=p2 
               
                [Node list symbol=content 
                
                 [Node list symbol=univariate symbol=p1 symbol=pv1 ]
                 ]
                ]
               
               [Node list symbol=multivariate symbol=pv1 
               
                [Node list symbol=gcd 
                
                 [Node list symbol=univariate symbol=p1 symbol=pv1 ]
                 
                 [Node list symbol=univariate symbol=p2 symbol=pv2 ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=DEF 
      
       [Node list symbol=groebner symbol=lp ]
       
       [Node list 
       
        [Node list symbol=List symbol=$ ]
        
        [Node list symbol=List symbol=$ ]
        ]
       
       [Node list 
       
        [Node list ]
        
        [Node list ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list 
        
         [Node list symbol=Sel symbol=print 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=message string=groebner$DJBP ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=lp 
         
          [Node list symbol=Sel symbol=groebner 
          
           [Node list symbol=GroebnerPackage symbol=R symbol=E symbol=JB symbol=$ ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   ]
  
 ]
 
 [DEF JetGroebner R JB LJV P E
 DEFCategories:
  [CATEGORY  package
  CATEGORYSig:
   [SIGNATURE  groebner
   SIGNATURE params:List P 
   List P 
   
   ]
   
  ]
  
 DEFCapsule:
  [CAPSULE CAPSULEDef:
   [DEF convert1 p P SEQ
   DEFSubnode:atts= DistributedJetBundlePolynomial R JB LJV E
    [Node list symbol=DistributedJetBundlePolynomial symbol=R symbol=JB symbol=LJV symbol=E ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET xx
    [Node list symbol=LET symbol=xx 
    
     [Node list symbol=mainVariable symbol=p ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol=case symbol=xx string=failed ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=cc symbol=R ]
        
        [Node list symbol=retract symbol=p ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=:: symbol=cc 
        
         [Node list symbol=DistributedJetBundlePolynomial symbol=R symbol=JB symbol=LJV symbol=E ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=x 
       
        [Node list symbol=:: symbol=xx symbol=JB ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G5239801 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=member? symbol=x symbol=LJV ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G5239801 symbol=noBranch 
         
          [Node list symbol=exit int=2 
          
           [Node list symbol=error string=illegal jet variable ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=up 
       
        [Node list symbol=univariate symbol=p symbol=x ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res 
        
         [Node list symbol=DistributedJetBundlePolynomial symbol=R symbol=JB symbol=LJV symbol=E ]
         ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5239802 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=up ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5239802 symbol=false symbol=true ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=lcup 
         
          [Node list symbol=leadingCoefficient symbol=up ]
          ]
         
         [Node list symbol=LET symbol=clcup 
         
          [Node list symbol=convert1 symbol=lcup ]
          ]
         
         [Node list symbol=LET symbol=m 
         
          [Node list symbol=monomial symbol=clcup symbol=x 
          
           [Node list symbol=degree symbol=up ]
           ]
          ]
         
         [Node list symbol=LET symbol=res 
         
          [Node list symbol=+ symbol=res 
          
           [Node list symbol=monomial symbol=x 
           
            [Node list symbol=convert1 
            
             [Node list symbol=leadingCoefficient symbol=up ]
             ]
            
            [Node list symbol=degree symbol=up ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=up 
          
           [Node list symbol=reductum symbol=up ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF convert2 p P SEQ
   DEFSubnode:atts= DistributedJetBundlePolynomial R JB LJV E
    [Node list symbol=DistributedJetBundlePolynomial symbol=R symbol=JB symbol=LJV symbol=E ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET xx
    [Node list symbol=LET symbol=xx 
    
     [Node list symbol=mainVariable symbol=p ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF 
     
      [Node list symbol=case symbol=xx string=failed ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=cc symbol=R ]
        
        [Node list symbol=retract symbol=p ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=:: symbol=cc symbol=P ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=x 
       
        [Node list symbol=:: symbol=xx symbol=JB ]
        ]
       
       [Node list symbol=LET symbol=up 
       
        [Node list symbol=univariate symbol=p symbol=x ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=res symbol=P ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G5239803 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=zero? symbol=up ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G5239803 symbol=false symbol=true ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=res 
         
          [Node list symbol=+ symbol=res 
          
           [Node list symbol=monomial symbol=x 
           
            [Node list symbol=convert2 
            
             [Node list symbol=leadingCoefficient symbol=up ]
             ]
            
            [Node list symbol=degree symbol=up ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=up 
          
           [Node list symbol=reductum symbol=up ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 symbol=res ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF groebner lp SEQ
   DEFSubnode:atts= List P
    [Node list symbol=List symbol=P ]
    
   DEFSubnode:atts= List P
    [Node list symbol=List symbol=P ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nlp 
     
      [Node list symbol=List 
      
       [Node list symbol=DistributedJetBundlePolynomial symbol=R symbol=JB symbol=LJV symbol=E ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=p symbol=lp ]
      
      [Node list symbol=convert1 symbol=p ]
      ]
     ]
    
   DEFSubnode:atts= LET gb
    [Node list symbol=LET symbol=gb 
    
     [Node list symbol=nlp 
     
      [Node list symbol=Sel symbol=groebner 
      
       [Node list symbol=DistributedJetBundlePolynomial symbol=R symbol=JB symbol=LJV symbol=E ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=dp symbol=gb ]
      
      [Node list symbol=convert2 symbol=dp ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= GcdDomain
  [Node list symbol=GcdDomain ]
  
 DEFSubnode:atts= JetBundleCategory
  [Node list symbol=JetBundleCategory ]
  
 DEFSubnode:atts= List JB
  [Node list symbol=List symbol=JB ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=JetBundleFunctionCategory symbol=JB ]
   
   [Node list symbol=PolynomialCategory symbol=R symbol=JB 
   
    [Node list symbol=IndexedExponents symbol=JB ]
    ]
   ]
  
 DEFSubnode:atts= DirectProductCategory
  [Node list symbol=DirectProductCategory 
  
   [Node list symbol=# symbol=LJV ]
   
   [Node list symbol=NonNegativeInteger ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 