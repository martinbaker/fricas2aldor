[File 

 [DEF Loop
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=PrimitiveArray 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
  CAPSULEDef:
   [DEF loop lis $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=li 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT symbol=x 
     
      [Node list symbol=IN symbol=x symbol=lis ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G3861879 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=li ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G3861879 
     
      [Node list symbol=error string=cannot form empty loop ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=minValue 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=first symbol=li ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=lx 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=construct ]
        ]
       
       [Node list symbol=LET symbol=l1 symbol=li ]
       
       [Node list symbol=LET symbol=l2 symbol=lx ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=WHILE 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3861880 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=empty? symbol=li ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3861880 symbol=false symbol=true ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3861881 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=< symbol=minValue 
           
            [Node list symbol=first symbol=li ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3861881 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=l1 symbol=li ]
             
             [Node list symbol=LET symbol=l2 symbol=lx ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=minValue 
              
               [Node list symbol=first symbol=li ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=lx 
         
          [Node list symbol=cons symbol=lx 
          
           [Node list symbol=first symbol=li ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=li 
          
           [Node list symbol=rest symbol=li ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list 
        
         [Node list symbol=Sel symbol=Rep symbol=construct ]
         
         [Node list symbol=concat symbol=l1 
         
          [Node list symbol=reverse symbol=l2 ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF entries lp $
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel entries
    [Node list symbol=Sel symbol=entries 
    
     [Node list symbol=PrimitiveArray 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= pretend lp
    [Node list symbol=pretend symbol=lp 
    
     [Node list symbol=PrimitiveArray 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF hash s $ Sel
   DEFSubnode:atts= SingleInteger
    [Node list symbol=SingleInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SingleInteger
    [Node list symbol=SingleInteger ]
    
   DEFSubnode:atts= Zero
    [Node list symbol=Zero ]
    
   ]
   
  CAPSULEDef:
   [DEF latex lp $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET 
    [Node list symbol=LET string=
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=String ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=lp ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=x 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=lp 
       
        [Node list symbol=- symbol=i 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=construct symbol=res string=-> 
         
          [Node list symbol=string symbol=x ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list 
     
      [Node list symbol=Sel symbol=concat 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=construct string=[ symbol=res string=] ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF = x y $ $ SEQ
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3861882 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=# symbol=x ]
       
       [Node list symbol=# symbol=y ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3861882 symbol=noBranch 
      
       [Node list symbol=return symbol=false ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=x ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3861883 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=x 
        
         [Node list symbol=- symbol=i 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=y 
        
         [Node list symbol=- symbol=i 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3861883 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 true
    [Node list symbol=exit int=1 symbol=true ]
    
   ]
   
  CAPSULEDef:
   [DEF ~= x y $ $ IF false true
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= = x y
    [Node list symbol== symbol=x symbol=y ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce lp $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=OutputForm ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=OutputForm ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=lp ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=x 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=lp 
       
        [Node list symbol=- symbol=i 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list 
        
         [Node list symbol=Sel symbol=hconcat 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=construct symbol=res 
         
          [Node list symbol=outputForm 
          
           [Node list symbol=:: string=-> 
           
            [Node list symbol=Symbol ]
            ]
           ]
          
          [Node list symbol=:: symbol=x 
          
           [Node list symbol=OutputForm ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list 
     
      [Node list symbol=Sel symbol=hconcat 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=construct symbol=res 
      
       [Node list symbol=outputForm 
       
        [Node list symbol=:: string=[ 
        
         [Node list symbol=Symbol ]
         ]
        ]
       
       [Node list symbol=outputForm 
       
        [Node list symbol=:: string=] 
        
         [Node list symbol=Symbol ]
         ]
        ]
       ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=SetCategory ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=loop 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=entries 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF FiniteGraph S add
 DEFSubnode:atts= Category
  [Node list symbol=Category ]
  
 DEFSubnode:atts= SetCategory
  [Node list symbol=SetCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=CoercibleTo 
   
    [Node list symbol=OutputForm ]
    ]
   
   [Node list symbol=SetCategory ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=addObject! 
    
     [Node list symbol=$ symbol=$ symbol=S ]
     ]
    
    [Node list symbol=SIGNATURE symbol=addObject! 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=addArrow! 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=addArrow! 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=String ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=addArrow! 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=String ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=addArrow! 
    
     [Node list symbol=$ symbol=$ symbol=S symbol=S 
     
      [Node list symbol=String ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=getVertices 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=getVertexIndex 
    
     [Node list symbol=$ symbol=S 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=getArrows 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=flatten 
    
     [Node list symbol=$ 
     
      [Node list symbol=DirectedGraph symbol=$ ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=initial 
    
     [Node list symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=terminal 
    
     [Node list symbol=$ symbol=S ]
     ]
    
    [Node list symbol=SIGNATURE symbol=cycleOpen 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=String ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=cycleClosed 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=String ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=unit 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=String ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=kgraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=String ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=isDirectSuccessor? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=isGreaterThan? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=max 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=max 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=min 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=min 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=isFixPoint? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=arrowName 
    
     [Node list symbol=$ 
     
      [Node list symbol=String ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=getArrowIndex 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=inDegree 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=outDegree 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=nodeFromNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=nodeToNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=arrowsFromNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=arrowsToNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=nodeFromArrow 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=nodeToArrow 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=arrowsFromArrow 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=arrowsToArrow 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=routeNodes 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=routeArrows 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=distance 
    
     [Node list symbol=$ 
     
      [Node list symbol=Integer ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=+ 
    
     [Node list symbol=$ symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=merge 
    
     [Node list symbol=$ symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=spanningTreeArrow 
    
     [Node list symbol=$ 
     
      [Node list symbol=Tree 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=spanningForestArrow 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Tree 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=spanningTreeNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=Tree 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=spanningForestNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Tree 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=loopsNodes 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Loop ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=loopsAtNode 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Loop ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=loopsArrows 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Loop ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=isAcyclic? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=incidenceMatrix 
    
     [Node list symbol=$ 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=adjacencyMatrix 
    
     [Node list symbol=$ 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=laplacianMatrix 
    
     [Node list symbol=$ 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=distanceMatrix 
    
     [Node list symbol=$ 
     
      [Node list symbol=Matrix 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=isFunctional? 
    
     [Node list symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=isDirected? 
    
     [Node list 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=subdiagramSvg 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=Scene 
      
       [Node list symbol=SCartesian int=2 ]
       ]
      
      [Node list symbol=Boolean ]
      
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diagramSvg 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=String ]
      
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diagramsSvg 
    
     [Node list 
     
      [Node list symbol=Void ]
      
      [Node list symbol=String ]
      
      [Node list symbol=List symbol=$ ]
      
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=deepDiagramSvg 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=String ]
      
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diagramWidth 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diagramHeight 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=createWidth 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=createX 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=createY 
    
     [Node list 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=looseEquals 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=map 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=Integer ]
      
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=mapContra 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=Integer ]
      
      [Node list symbol=Integer ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= CAPSULE
  [Node list symbol=CAPSULE 
  
   [Node list symbol=import 
   
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=List 
    
     [Node list symbol=Loop ]
     ]
    ]
   
   [Node list symbol=import 
   
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    ]
   
   [Node list symbol=MDEF 
   
    [Node list symbol=math_to_string ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=Sel symbol=Lisp symbol=mathObject2String ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=getVertexIndex symbol=s symbol=o ]
    
    [Node list symbol=$ symbol=S 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=lv 
     
      [Node list symbol=getVertices symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=IN symbol=v symbol=lv ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864732 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=o 
        
         [Node list symbol=v symbol=value ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864732 symbol=noBranch 
        
         [Node list symbol=return symbol=i ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=addArrow! symbol=s symbol=aname symbol=o1 symbol=o2 ]
    
    [Node list symbol=$ symbol=$ symbol=S symbol=S 
    
     [Node list symbol=String ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=addArrow! symbol=s symbol=aname 
    
     [Node list symbol=getVertexIndex symbol=s symbol=o1 ]
     
     [Node list symbol=getVertexIndex symbol=s symbol=o2 ]
     ]
    ]
   
   [Node list symbol=DEF symbol=true 
   
    [Node list symbol=isDirected? ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=incidenceMatrix symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=vl 
     
      [Node list symbol=getVertices symbol=s ]
      ]
     
     [Node list symbol=LET symbol=al 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=LET symbol=res 
     
      [Node list 
      
       [Node list symbol=Sel symbol=zero 
       
        [Node list symbol=Matrix 
        
         [Node list symbol=Integer ]
         ]
        ]
       
       [Node list symbol=# symbol=vl ]
       
       [Node list symbol=# symbol=al ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ss 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=IF 
      
       [Node list symbol=isDirected? ]
       
       [Node list symbol=- 
       
        [Node list symbol=One ]
        ]
       
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=ar symbol=al ]
      
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ss 
       
        [Node list symbol=res symbol=j 
        
         [Node list symbol=ar symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET 
        
         [Node list symbol=res symbol=j 
         
          [Node list symbol=ar symbol=toOb ]
          ]
         
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=adjacencyMatrix symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=n 
     
      [Node list symbol=# 
      
       [Node list symbol=getVertices symbol=s ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=m 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=v 
       
        [Node list symbol=SEGMENT symbol=n 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=u 
        
         [Node list symbol=SEGMENT symbol=n 
         
          [Node list symbol=One ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3864733 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=s symbol=u symbol=v ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3864733 
          
           [Node list symbol=:: 
           
            [Node list symbol=One ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=matrix symbol=m ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=laplacianEntry symbol=s symbol=i symbol=j ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Integer ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=i symbol=j ]
      
      [Node list symbol=return 
      
       [Node list symbol=inDegree symbol=s symbol=i ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864734 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=isDirectSuccessor? symbol=s symbol=i symbol=j ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864734 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=- 
         
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=Integer ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=laplacianMatrix symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=m 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=v 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=getVertices symbol=s ]
          ]
         ]
        ]
       
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=u 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=getVertices symbol=s ]
           ]
          ]
         ]
        
        [Node list symbol=laplacianEntry symbol=s symbol=u symbol=v ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=matrix symbol=m ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=distanceMatrix symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Matrix 
     
      [Node list symbol=Integer ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=m 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=v 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=getVertices symbol=s ]
          ]
         ]
        ]
       
       [Node list symbol=COLLECT 
       
        [Node list symbol=IN symbol=u 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=getVertices symbol=s ]
           ]
          ]
         ]
        
        [Node list symbol=distance symbol=s symbol=u symbol=v ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=matrix symbol=m ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=spanningTreeArrowRecursive symbol=s symbol=i symbol=visited ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Tree 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=Reference 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=aa 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=arrowsToArrow symbol=s symbol=i ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ch 
      
       [Node list symbol=List 
       
        [Node list symbol=Tree 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=visited1 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=deref symbol=visited ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=x symbol=aa ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864735 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=entry? symbol=x symbol=visited1 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864735 
        
         [Node list symbol=LET symbol=ch 
         
          [Node list symbol=concat symbol=ch 
          
           [Node list symbol=tree 
           
            [Node list symbol=:: 
            
             [Node list symbol=- symbol=x ]
             
             [Node list symbol=Integer ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=visited1 
          
           [Node list symbol=visited1 symbol=x 
           
            [Node list symbol=Sel symbol=concat 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=setref symbol=visited symbol=visited1 ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ch 
           
            [Node list symbol=concat symbol=ch 
            
             [Node list symbol=spanningTreeArrowRecursive symbol=s symbol=x symbol=visited ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=tree symbol=ch 
      
       [Node list symbol=:: symbol=i 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=spanningTreeArrow symbol=s symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Tree 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=spanningTreeArrowRecursive symbol=s symbol=i 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=i ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=spanningForestArrow symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=Tree 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=getArrows symbol=s ]
        ]
       ]
      ]
     
     [Node list symbol=spanningTreeArrow symbol=s symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=spanningTreeNodeRecursive symbol=s symbol=i symbol=visited ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Tree 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=Reference 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=oa 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=nodeToNode symbol=s symbol=i ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ch 
      
       [Node list symbol=List 
       
        [Node list symbol=Tree 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=empty 
       
        [Node list symbol=List 
        
         [Node list symbol=Tree 
         
          [Node list symbol=Integer ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=flags 
      
       [Node list symbol=List 
       
        [Node list symbol=Boolean ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=empty 
       
        [Node list symbol=List 
        
         [Node list symbol=Boolean ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=visited1 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=deref symbol=visited ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=n symbol=oa ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864736 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=entry? symbol=n symbol=visited1 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864736 
        
         [Node list symbol=LET symbol=flags 
         
          [Node list symbol=flags symbol=false 
          
           [Node list symbol=Sel symbol=concat 
           
            [Node list symbol=List 
            
             [Node list symbol=Boolean ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=flags 
          
           [Node list symbol=flags symbol=true 
           
            [Node list symbol=Sel symbol=concat 
            
             [Node list symbol=List 
             
              [Node list symbol=Boolean ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=visited1 
           
            [Node list symbol=visited1 symbol=n 
            
             [Node list symbol=Sel symbol=concat 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=setref symbol=visited symbol=visited1 ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=n symbol=oa ]
      
      [Node list symbol=IN symbol=flag symbol=flags ]
      
      [Node list symbol=IF symbol=flag symbol=noBranch 
      
       [Node list symbol=LET symbol=ch 
       
        [Node list symbol=concat symbol=ch 
        
         [Node list symbol=spanningTreeNodeRecursive symbol=s symbol=n symbol=visited ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=tree symbol=ch 
      
       [Node list symbol=:: symbol=i 
       
        [Node list symbol=Integer ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=spanningTreeNode symbol=s symbol=i ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Tree 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=spanningTreeNodeRecursive symbol=s symbol=i 
    
     [Node list symbol=ref 
     
      [Node list symbol=construct symbol=i ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=spanningForestNode symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=Tree 
      
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=getVertices symbol=s ]
        ]
       ]
      ]
     
     [Node list symbol=spanningTreeNode symbol=s symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=loopsNodesRecursive symbol=t symbol=visited ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Loop ]
      ]
     
     [Node list symbol=Tree 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=c 
      
       [Node list symbol=List 
       
        [Node list symbol=Tree 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=children symbol=t ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=v 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=value symbol=t ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=< symbol=v 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=v2 
       
        [Node list symbol=:: 
        
         [Node list symbol=- symbol=v ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET symbol=i 
       
        [Node list symbol=v2 symbol=visited 
        
         [Node list symbol=Sel symbol=position 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol=< symbol=i 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=loop symbol=visited ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=afterIndex 
       
        [Node list symbol=- symbol=i 
        
         [Node list symbol=+ 
         
          [Node list symbol=# symbol=visited ]
          
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol=< symbol=afterIndex 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=loop symbol=visited ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=loop 
          
           [Node list symbol=visited 
           
            [Node list symbol=Sel symbol=last 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=:: symbol=afterIndex 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=List 
       
        [Node list symbol=Loop ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=x symbol=c ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ll 
       
        [Node list symbol=loopsNodesRecursive symbol=x 
        
         [Node list symbol=concat symbol=visited 
         
          [Node list symbol=:: symbol=v 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=res symbol=ll 
         
          [Node list symbol=Sel symbol=concat 
          
           [Node list symbol=List 
           
            [Node list symbol=Loop ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=loopsNodes symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=Loop ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=List 
       
        [Node list symbol=Loop ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET symbol=sf 
     
      [Node list symbol=spanningForestNode symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=x symbol=sf ]
      
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=res 
       
        [Node list symbol=Sel symbol=concat 
        
         [Node list symbol=List 
         
          [Node list symbol=Loop ]
          ]
         ]
        
        [Node list symbol=loopsNodesRecursive symbol=x 
        
         [Node list symbol=construct ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=removeDuplicates symbol=res ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=loopsAtNode symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=Loop ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=st 
      
       [Node list symbol=Tree 
       
        [Node list symbol=Integer ]
        ]
       ]
      
      [Node list symbol=spanningTreeNode symbol=s symbol=a ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=removeDuplicates 
      
       [Node list symbol=loopsNodesRecursive symbol=st 
       
        [Node list symbol=construct ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=loopsArrowsRecursive symbol=t symbol=visited ]
    
    [Node list 
    
     [Node list symbol=List 
     
      [Node list symbol=Loop ]
      ]
     
     [Node list symbol=Tree 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=c 
      
       [Node list symbol=List 
       
        [Node list symbol=Tree 
        
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=children symbol=t ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=v 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=value symbol=t ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=< symbol=v 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=v2 
       
        [Node list symbol=:: 
        
         [Node list symbol=- symbol=v ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET symbol=i 
       
        [Node list symbol=v2 symbol=visited 
        
         [Node list symbol=Sel symbol=position 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol=< symbol=i 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=loop symbol=visited ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=afterIndex 
       
        [Node list symbol=- symbol=i 
        
         [Node list symbol=+ 
         
          [Node list symbol=# symbol=visited ]
          
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol=< symbol=afterIndex 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=loop symbol=visited ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=loop 
          
           [Node list symbol=visited 
           
            [Node list symbol=Sel symbol=last 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=:: symbol=afterIndex 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=List 
       
        [Node list symbol=Loop ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=x symbol=c ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=ll 
       
        [Node list symbol=loopsArrowsRecursive symbol=x 
        
         [Node list symbol=concat symbol=visited 
         
          [Node list symbol=:: symbol=v 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=res symbol=ll 
         
          [Node list symbol=Sel symbol=concat 
          
           [Node list symbol=List 
           
            [Node list symbol=Loop ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=res ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=loopsArrows symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=Loop ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=res 
      
       [Node list symbol=List 
       
        [Node list symbol=Loop ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET symbol=sf 
     
      [Node list symbol=spanningForestArrow symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=x symbol=sf ]
      
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=res 
       
        [Node list symbol=Sel symbol=concat 
        
         [Node list symbol=List 
         
          [Node list symbol=Loop ]
          ]
         ]
        
        [Node list symbol=loopsArrowsRecursive symbol=x 
        
         [Node list symbol=construct ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=removeDuplicates symbol=res ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=isAcyclic? symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol== 
    
     [Node list symbol=loopsNodes symbol=s ]
     
     [Node list symbol=construct ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=isDirectSuccessor? symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864737 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=a 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864737 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3864738 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=b 
           
            [Node list symbol=arr symbol=toOb ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3864738 symbol=noBranch 
           
            [Node list symbol=return symbol=true ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=false ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=isFixPoint? symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864739 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=a 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864739 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3864740 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=a 
           
            [Node list symbol=arr symbol=toOb ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3864740 symbol=noBranch 
           
            [Node list symbol=return symbol=true ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=false ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=getArrowIndex symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arrs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864741 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=a 
        
         [Node list symbol=fromOb 
         
          [Node list symbol=arrs symbol=arrn ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864741 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3864742 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=b 
           
            [Node list symbol=toOb 
            
             [Node list symbol=arrs symbol=arrn ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3864742 symbol=noBranch 
           
            [Node list symbol=return symbol=arrn ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=arrowName symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=String ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864743 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=a 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864743 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3864744 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=b 
           
            [Node list symbol=arr symbol=toOb ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3864744 symbol=noBranch 
           
            [Node list symbol=return 
            
             [Node list symbol=arr symbol=name ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 string=? ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=inDegree symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=count 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864745 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=a 
        
         [Node list symbol=arr symbol=toOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864745 symbol=noBranch 
        
         [Node list symbol=LET symbol=count 
         
          [Node list symbol=+ symbol=count 
          
           [Node list symbol=:: 
           
            [Node list symbol=One ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=count ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=outDegree symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=count 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864746 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=a 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864746 symbol=noBranch 
        
         [Node list symbol=LET symbol=count 
         
          [Node list symbol=+ symbol=count 
          
           [Node list symbol=:: 
           
            [Node list symbol=One ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=count ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=nodeFromNode symbol=s symbol=v ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=i 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864747 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=v 
        
         [Node list symbol=arr symbol=toOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864747 symbol=noBranch 
        
         [Node list symbol=LET symbol=i 
         
          [Node list symbol=concat symbol=i 
          
           [Node list symbol=arr symbol=fromOb ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=nodeToNode symbol=s symbol=v ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=i 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864748 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=v 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864748 symbol=noBranch 
        
         [Node list symbol=LET symbol=i 
         
          [Node list symbol=concat symbol=i 
          
           [Node list symbol=arr symbol=toOb ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=arrowsFromNode symbol=s symbol=v ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=i 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arrs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864749 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=v 
        
         [Node list symbol=toOb 
         
          [Node list symbol=arrs symbol=arrn ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864749 symbol=noBranch 
        
         [Node list symbol=LET symbol=i 
         
          [Node list symbol=concat symbol=i symbol=arrn ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=arrowsToNode symbol=s symbol=v ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=i 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arrs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864750 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=v 
        
         [Node list symbol=fromOb 
         
          [Node list symbol=arrs symbol=arrn ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864750 symbol=noBranch 
        
         [Node list symbol=LET symbol=i 
         
          [Node list symbol=concat symbol=i symbol=arrn ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=nodeFromArrow symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct 
      
       [Node list symbol=toOb 
       
        [Node list symbol=arrs symbol=a ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=nodeToArrow symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=construct 
      
       [Node list symbol=fromOb 
       
        [Node list symbol=arrs symbol=a ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=arrowsFromArrow symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=i 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arrs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864751 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=toOb 
         
          [Node list symbol=arrs symbol=arrn ]
          ]
         
         [Node list symbol=fromOb 
         
          [Node list symbol=arrs symbol=a ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864751 symbol=noBranch 
        
         [Node list symbol=LET symbol=i 
         
          [Node list symbol=concat symbol=i symbol=arrn ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=arrowsToArrow symbol=s symbol=a ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=i 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arrs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864752 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=fromOb 
         
          [Node list symbol=arrs symbol=arrn ]
          ]
         
         [Node list symbol=toOb 
         
          [Node list symbol=arrs symbol=a ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864752 symbol=noBranch 
        
         [Node list symbol=LET symbol=i 
         
          [Node list symbol=concat symbol=i symbol=arrn ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=i ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=routeNodeRecursive symbol=s symbol=a symbol=b symbol=visited ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864753 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=> 
       
        [Node list symbol=# symbol=visited ]
        
        [Node list symbol=# 
        
         [Node list symbol=getVertices symbol=s ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864753 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=construct ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=shortest 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=a symbol=b ]
      
      [Node list symbol=return 
      
       [Node list symbol=construct symbol=a ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864754 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=isDirectSuccessor? symbol=s symbol=a symbol=b ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864754 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=construct symbol=a symbol=b ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864757 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=isDirectSuccessor? symbol=s symbol=a 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864757 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=d 
          
           [Node list symbol=routeNodeRecursive symbol=s symbol=b 
           
            [Node list symbol=arr symbol=fromOb ]
            
            [Node list symbol=visited symbol=a 
            
             [Node list symbol=Sel symbol=concat 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF 
           
            [Node list symbol== symbol=shortest 
            
             [Node list symbol=construct ]
             ]
            
            [Node list symbol=LET symbol=shortest symbol=d ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G3864755 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=~= symbol=d 
              
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G3864755 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3864756 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=< 
                 
                  [Node list symbol=# symbol=d ]
                  
                  [Node list symbol=# symbol=shortest ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3864756 symbol=noBranch 
                 
                  [Node list symbol=LET symbol=shortest symbol=d ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=shortest 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return 
      
       [Node list symbol=construct ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=concat symbol=a symbol=shortest ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=routeNodes symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=routeNodeRecursive symbol=s symbol=a symbol=b 
    
     [Node list symbol=construct ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=routeArrowRecursive symbol=s symbol=a symbol=b symbol=visited ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864758 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=> 
       
        [Node list symbol=# symbol=visited ]
        
        [Node list symbol=# 
        
         [Node list symbol=getVertices symbol=s ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864758 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=shortest 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=a symbol=b ]
      
      [Node list symbol=return 
      
       [Node list symbol=construct ]
       ]
      ]
     
     [Node list symbol=LET symbol=arrn 
     
      [Node list symbol=getArrowIndex symbol=s symbol=a symbol=b ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864759 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= symbol=arrn 
       
        [Node list symbol=Zero ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864759 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=construct symbol=arrn ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=aa 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=shortestFullPath 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=LET symbol=arrs 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr symbol=arrs ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864763 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=isDirectSuccessor? symbol=s symbol=a 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864763 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=aa 
          
           [Node list symbol=getArrowIndex symbol=s symbol=a 
           
            [Node list symbol=arr symbol=fromOb ]
            ]
           ]
          
          [Node list symbol=LET symbol=d 
          
           [Node list symbol=routeArrowRecursive symbol=s symbol=b 
           
            [Node list symbol=arr symbol=fromOb ]
            
            [Node list symbol=visited symbol=a 
            
             [Node list symbol=Sel symbol=concat 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=fullPath 
          
           [Node list symbol=concat symbol=aa symbol=d ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3864762 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=shortest 
           
            [Node list symbol=construct 
            
             [Node list symbol=Zero ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3864762 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=shortest symbol=d ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=shortestFullPath symbol=fullPath ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G3864760 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=~= symbol=d 
              
               [Node list symbol=construct 
               
                [Node list symbol=Zero ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G3864760 symbol=noBranch 
              
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3864761 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=< 
                 
                  [Node list symbol=# symbol=fullPath ]
                  
                  [Node list symbol=# symbol=shortestFullPath ]
                  ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3864761 symbol=noBranch 
                 
                  [Node list symbol=SEQ 
                  
                   [Node list symbol=LET symbol=shortest symbol=d ]
                   
                   [Node list symbol=exit int=1 
                   
                    [Node list symbol=LET symbol=shortestFullPath symbol=fullPath ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864764 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol== symbol=shortest 
       
        [Node list symbol=construct 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864764 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=construct 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=shortestFullPath ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=routeArrows symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=routeArrowRecursive symbol=s symbol=a symbol=b 
    
     [Node list symbol=construct ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=isGreaterThan? symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864765 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol== 
       
        [Node list symbol=routeNodeRecursive symbol=s symbol=a symbol=b 
        
         [Node list symbol=construct ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864765 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864766 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=routeNodeRecursive symbol=s symbol=b symbol=a 
        
         [Node list symbol=construct ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864766 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=true ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=max symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=ls ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=false 
       
        [Node list symbol=: symbol=fail 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=ls ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3864768 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=i symbol=j ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3864768 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3864767 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isGreaterThan? symbol=s symbol=j symbol=i ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3864767 symbol=noBranch 
             
              [Node list symbol=LET symbol=fail symbol=true ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=fail symbol=noBranch 
        
         [Node list symbol=return symbol=i ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=max symbol=s symbol=sub ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=sub ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=false 
       
        [Node list symbol=: symbol=fail 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j symbol=sub ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3864770 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=i symbol=j ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3864770 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3864769 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isGreaterThan? symbol=s symbol=j symbol=i ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3864769 symbol=noBranch 
             
              [Node list symbol=LET symbol=fail symbol=true ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=fail symbol=noBranch 
        
         [Node list symbol=return symbol=i ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=min symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=ls ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=false 
       
        [Node list symbol=: symbol=fail 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=ls ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3864772 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=i symbol=j ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3864772 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3864771 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isGreaterThan? symbol=s symbol=i symbol=j ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3864771 symbol=noBranch 
             
              [Node list symbol=LET symbol=fail symbol=true ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=fail symbol=noBranch 
        
         [Node list symbol=return symbol=i ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=min symbol=s symbol=sub ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=sub ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=false 
       
        [Node list symbol=: symbol=fail 
        
         [Node list symbol=Boolean ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=j symbol=sub ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3864774 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=i symbol=j ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3864774 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3864773 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isGreaterThan? symbol=s symbol=i symbol=j ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3864773 symbol=noBranch 
             
              [Node list symbol=LET symbol=fail symbol=true ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=fail symbol=noBranch 
        
         [Node list symbol=return symbol=i ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=distance symbol=s symbol=a symbol=b ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Integer ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=- 
    
     [Node list symbol=# 
     
      [Node list symbol=routeNodeRecursive symbol=s symbol=a symbol=b 
      
       [Node list symbol=construct ]
       ]
      ]
     
     [Node list symbol=One ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=isFunctional? symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=counts 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=x 
       
        [Node list symbol=getVertices symbol=s ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arr 
      
       [Node list symbol=getArrows symbol=s ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=fromI 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=arr symbol=fromOb ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET 
        
         [Node list symbol=counts symbol=fromI ]
         
         [Node list symbol=+ 
         
          [Node list symbol=counts symbol=fromI ]
          
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=x symbol=counts ]
      
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol== symbol=x 
       
        [Node list symbol=:: 
        
         [Node list symbol=One ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=return symbol=false ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=true ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=createWidth symbol=x ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=w 
      
       [Node list symbol=SEGMENT int=100 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864775 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=>= symbol=x 
        
         [Node list symbol=* symbol=w symbol=w ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864775 symbol=noBranch 
        
         [Node list symbol=return symbol=w ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=:: int=100 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=createX symbol=x symbol=n ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=w 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=createWidth symbol=x ]
      ]
     
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=subtractIfCan symbol=n 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=d 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=quotient 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=remainder 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=w 
      
       [Node list symbol=Sel symbol=divide 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: symbol=r 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864776 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=odd? 
       
        [Node list symbol=:: 
        
         [Node list symbol=d symbol=quotient ]
         
         [Node list symbol=Integer ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864776 symbol=noBranch 
       
        [Node list symbol=return 
        
         [Node list symbol=* int=2 
         
          [Node list symbol=:: 
          
           [Node list symbol=subtractIfCan symbol=w 
           
            [Node list symbol=d symbol=remainder ]
            ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=* int=2 
      
       [Node list symbol=+ 
       
        [Node list symbol=d symbol=remainder ]
        
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=createY symbol=x symbol=n ]
    
    [Node list 
    
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=w 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=createWidth symbol=x ]
      ]
     
     [Node list symbol=LET symbol=r 
     
      [Node list symbol=subtractIfCan symbol=n 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=d 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=quotient 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=remainder 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=w 
      
       [Node list symbol=Sel symbol=divide 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: symbol=r 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=* int=2 
      
       [Node list symbol=+ 
       
        [Node list symbol=d symbol=quotient ]
        
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=subdiagramSvg symbol=sc symbol=n symbol=dispArrowName symbol=deep ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Void ]
     
     [Node list symbol=Scene 
     
      [Node list symbol=SCartesian int=2 ]
      ]
     
     [Node list symbol=Boolean ]
     
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=mt1 
     
      [Node list symbol=sc string=black string=black 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt2 
     
      [Node list symbol=sc string=blue string=blue 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt3 
     
      [Node list symbol=sc string=orange string=orange 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt4 
     
      [Node list symbol=sc string=green string=green 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt5 
     
      [Node list symbol=sc string=brown string=brown 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt6 
     
      [Node list symbol=sc string=grey string=grey 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt7 
     
      [Node list symbol=sc string=red string=red 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=mt8 
     
      [Node list symbol=sc string=purple string=purple 
      
       [Node list symbol=Sel symbol=addSceneMaterial 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=:: int=3 
       
        [Node list symbol=DoubleFloat ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=n ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=indexPointx 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=indexPointy 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=indexBounds 
      
       [Node list symbol=List 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=indexNodes 
      
       [Node list symbol=List symbol=S ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=ls ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=indexNodes 
       
        [Node list symbol=concat symbol=indexNodes 
        
         [Node list symbol=i symbol=value ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=s 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=math_to_string 
        
         [Node list symbol=i symbol=value ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=x 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=i symbol=posX ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=y 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=i symbol=posY ]
        ]
       
       [Node list symbol=LET symbol=indexPointx 
       
        [Node list symbol=concat symbol=indexPointx symbol=x ]
        ]
       
       [Node list symbol=LET symbol=indexPointy 
       
        [Node list symbol=concat symbol=indexPointy symbol=y ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF 
        
         [Node list symbol=has symbol=S 
         
          [Node list symbol=DirectedGraph 
          
           [Node list symbol=String ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=subgraph 
           
            [Node list symbol=DirectedGraph 
            
             [Node list symbol=String ]
             ]
            ]
           
           [Node list symbol=pretend 
           
            [Node list symbol=i symbol=value ]
            
            [Node list symbol=DirectedGraph 
            
             [Node list symbol=String ]
             ]
            ]
           ]
          
          [Node list symbol=MDEF 
          
           [Node list symbol=SHAPE ]
           
           [Node list 
           
            [Node list ]
            ]
           
           [Node list 
           
            [Node list ]
            ]
           
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=shptype 
            
             [Node list symbol=Symbol ]
             ]
            
            [Node list symbol=: symbol=centre 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            
            [Node list symbol=: symbol=size 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            
            [Node list symbol=: symbol=fill 
            
             [Node list symbol=Boolean ]
             ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=sh symbol=SHAPE ]
           
           [Node list symbol=construct symbol=false 
           
            [Node list symbol=:: string=ellipse 
            
             [Node list symbol=Symbol ]
             ]
            
            [Node list symbol=+ 
            
             [Node list symbol=sipnt symbol=x symbol=y ]
             
             [Node list symbol=svec 
             
              [Node list symbol=:: 
              
               [Node list int=7 int=-1 int=10 
               
                [Node list symbol=Sel symbol=float 
                
                 [Node list symbol=Float ]
                 ]
                ]
               
               [Node list symbol=DoubleFloat ]
               ]
              
              [Node list symbol=:: 
              
               [Node list int=7 int=-1 int=10 
               
                [Node list symbol=Sel symbol=float 
                
                 [Node list symbol=Float ]
                 ]
                ]
               
               [Node list symbol=DoubleFloat ]
               ]
              ]
             ]
            
            [Node list symbol=svec 
            
             [Node list symbol=:: 
             
              [Node list int=7 int=-1 int=10 
              
               [Node list symbol=Sel symbol=float 
               
                [Node list symbol=Float ]
                ]
               ]
              
              [Node list symbol=DoubleFloat ]
              ]
             
             [Node list symbol=:: 
             
              [Node list int=7 int=-1 int=10 
              
               [Node list symbol=Sel symbol=float 
               
                [Node list symbol=Float ]
                ]
               ]
              
              [Node list symbol=DoubleFloat ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=LET symbol=ellip 
          
           [Node list symbol=addSceneShape symbol=sc symbol=sh ]
           ]
          
          [Node list symbol=LET symbol=tn 
          
           [Node list symbol=addSceneGraph symbol=sc symbol=subgraph symbol=x symbol=y symbol=dispArrowName ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=indexBounds 
           
            [Node list symbol=concat symbol=indexBounds symbol=ellip ]
            ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=tn 
          
           [Node list symbol=sc symbol=s 
           
            [Node list symbol=Sel symbol=addSceneText 
            
             [Node list symbol=Scene 
             
              [Node list symbol=SCartesian int=2 ]
              ]
             ]
            
            [Node list symbol=:: int=32 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=x symbol=y 
            
             [Node list symbol=Sel symbol=sipnt 
             
              [Node list symbol=SCartesian int=2 ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=indexBounds 
           
            [Node list symbol=concat symbol=indexBounds symbol=tn ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arrs 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getArrows symbol=n ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=void ]
      ]
     
     [Node list symbol=MDEF 
     
      [Node list symbol=IOBJT ]
      
      [Node list 
      
       [Node list ]
       ]
      
      [Node list 
      
       [Node list ]
       ]
      
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value 
       
        [Node list symbol=DirectedGraph 
        
         [Node list symbol=String ]
         ]
        ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=innerOb 
      
       [Node list symbol=List 
       
        [Node list symbol=List symbol=IOBJT ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=IF symbol=deep symbol=noBranch 
     
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol=has symbol=S 
       
        [Node list symbol=DirectedGraph 
        
         [Node list symbol=String ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=nd symbol=indexNodes ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=subNd 
          
           [Node list symbol=DirectedGraph 
           
            [Node list symbol=String ]
            ]
           ]
          
          [Node list symbol=pretend symbol=nd 
          
           [Node list symbol=DirectedGraph 
           
            [Node list symbol=String ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=innerObs 
          
           [Node list symbol=List symbol=IOBJT ]
           ]
          
          [Node list symbol=pretend 
          
           [Node list symbol=subNd 
           
            [Node list symbol=Sel symbol=getVertices 
            
             [Node list symbol=DirectedGraph 
             
              [Node list symbol=String ]
              ]
             ]
            ]
           
           [Node list symbol=List symbol=IOBJT ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=innerOb 
          
           [Node list symbol=innerOb symbol=innerObs 
           
            [Node list symbol=Sel symbol=concat 
            
             [Node list symbol=List 
             
              [Node list symbol=List symbol=IOBJT ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrow symbol=arrs ]
      
      [Node list symbol=IN symbol=arrn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arrs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=fromX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=indexPointx 
        
         [Node list symbol=arrow symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=toX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=indexPointx 
        
         [Node list symbol=arrow symbol=toOb ]
         ]
        ]
       
       [Node list symbol=LET symbol=fromX 
       
        [Node list symbol=:: 
        
         [Node list symbol=+ symbol=fromX 
         
          [Node list symbol=arrow symbol=xOffset ]
          ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET symbol=toX 
       
        [Node list symbol=:: 
        
         [Node list symbol=+ symbol=toX 
         
          [Node list symbol=arrow symbol=xOffset ]
          ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=fromY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=indexPointy 
        
         [Node list symbol=arrow symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=toY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=indexPointy 
        
         [Node list symbol=arrow symbol=toOb ]
         ]
        ]
       
       [Node list symbol=LET symbol=fromY 
       
        [Node list symbol=:: 
        
         [Node list symbol=+ symbol=fromY 
         
          [Node list symbol=arrow symbol=yOffset ]
          ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET symbol=toY 
       
        [Node list symbol=:: 
        
         [Node list symbol=+ symbol=toY 
         
          [Node list symbol=arrow symbol=yOffset ]
          ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=midX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=shift 
        
         [Node list symbol=+ symbol=toX symbol=fromX ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=midY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=shift 
        
         [Node list symbol=+ symbol=toY symbol=fromY ]
         
         [Node list symbol=- 
         
          [Node list symbol=One ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=arrIndex 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=arrowsToNode symbol=n 
        
         [Node list symbol=arrow symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=arrNumber 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=position symbol=arrn symbol=arrIndex ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=rema 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=remainder 
        
         [Node list symbol=divide symbol=arrNumber int=8 ]
         ]
        ]
       
       [Node list symbol=LET symbol=mt symbol=mt1 ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=LET symbol=mt symbol=mt1 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=LET symbol=mt symbol=mt2 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema int=2 ]
        
        [Node list symbol=LET symbol=mt symbol=mt3 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema int=3 ]
        
        [Node list symbol=LET symbol=mt symbol=mt4 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema int=4 ]
        
        [Node list symbol=LET symbol=mt symbol=mt5 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema int=5 ]
        
        [Node list symbol=LET symbol=mt symbol=mt6 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema int=6 ]
        
        [Node list symbol=LET symbol=mt symbol=mt7 ]
        ]
       
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=rema int=7 ]
        
        [Node list symbol=LET symbol=mt symbol=mt8 ]
        ]
       
       [Node list symbol=IF symbol=deep symbol=noBranch 
       
        [Node list symbol=IF symbol=noBranch 
        
         [Node list symbol=has symbol=S 
         
          [Node list symbol=DirectedGraph 
          
           [Node list symbol=String ]
           ]
          ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=mp 
           
            [Node list symbol=List 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           
           [Node list symbol=arrow symbol=map ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=REPEAT 
           
            [Node list symbol=IN symbol=subArrow symbol=mp ]
            
            [Node list symbol=IN symbol=subArrowN 
            
             [Node list symbol=SEGMENT 
             
              [Node list symbol=One ]
              
              [Node list symbol=# symbol=mp ]
              ]
             ]
            
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=innerObFrom symbol=IOBJT ]
              
              [Node list symbol=subArrowN 
              
               [Node list symbol=innerOb 
               
                [Node list symbol=arrow symbol=fromOb ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=innerObTo symbol=IOBJT ]
              
              [Node list symbol=subArrow 
              
               [Node list symbol=innerOb 
               
                [Node list symbol=arrow symbol=toOb ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=subFromX 
              
               [Node list symbol=DoubleFloat ]
               ]
              
              [Node list symbol=+ 
              
               [Node list symbol=:: symbol=fromX 
               
                [Node list symbol=DoubleFloat ]
                ]
               
               [Node list symbol=* 
               
                [Node list symbol=:: 
                
                 [Node list symbol=innerObFrom symbol=posX ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list int=25 int=-2 int=10 
                 
                  [Node list symbol=Sel symbol=float 
                  
                   [Node list symbol=Float ]
                   ]
                  ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=subToX 
              
               [Node list symbol=DoubleFloat ]
               ]
              
              [Node list symbol=+ 
              
               [Node list symbol=:: symbol=toX 
               
                [Node list symbol=DoubleFloat ]
                ]
               
               [Node list symbol=* 
               
                [Node list symbol=:: 
                
                 [Node list symbol=innerObFrom symbol=posY ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list int=25 int=-2 int=10 
                 
                  [Node list symbol=Sel symbol=float 
                  
                   [Node list symbol=Float ]
                   ]
                  ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=subFromY 
              
               [Node list symbol=DoubleFloat ]
               ]
              
              [Node list symbol=+ 
              
               [Node list symbol=:: symbol=fromY 
               
                [Node list symbol=DoubleFloat ]
                ]
               
               [Node list symbol=* 
               
                [Node list symbol=:: 
                
                 [Node list symbol=innerObTo symbol=posX ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list int=25 int=-2 int=10 
                 
                  [Node list symbol=Sel symbol=float 
                  
                   [Node list symbol=Float ]
                   ]
                  ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=subToY 
              
               [Node list symbol=DoubleFloat ]
               ]
              
              [Node list symbol=+ 
              
               [Node list symbol=:: symbol=toY 
               
                [Node list symbol=DoubleFloat ]
                ]
               
               [Node list symbol=* 
               
                [Node list symbol=:: 
                
                 [Node list symbol=innerObTo symbol=posY ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list int=25 int=-2 int=10 
                 
                  [Node list symbol=Sel symbol=float 
                  
                   [Node list symbol=Float ]
                   ]
                  ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=subArrNode 
              
               [Node list symbol=addSceneArrows symbol=mt 
               
                [Node list symbol=construct 
                
                 [Node list symbol=construct 
                 
                  [Node list symbol=subFromX symbol=subFromY 
                  
                   [Node list symbol=Sel symbol=spnt 
                   
                    [Node list symbol=SCartesian int=2 ]
                    ]
                   ]
                  
                  [Node list symbol=subToX symbol=subToY 
                  
                   [Node list symbol=Sel symbol=spnt 
                   
                    [Node list symbol=SCartesian int=2 ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=:: string=fixed 
                
                 [Node list symbol=Symbol ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list int=-1 int=10 
                 
                  [Node list symbol=Sel symbol=float 
                  
                   [Node list symbol=Float ]
                   ]
                  
                  [Node list symbol=One ]
                  ]
                 
                 [Node list symbol=DoubleFloat ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=deep symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=fnode 
           
            [Node list symbol=Scene 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            ]
           
           [Node list symbol=indexBounds 
           
            [Node list symbol=arrow symbol=fromOb ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=tnode 
           
            [Node list symbol=Scene 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            ]
           
           [Node list symbol=indexBounds 
           
            [Node list symbol=arrow symbol=toOb ]
            ]
           ]
          
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=offset 
           
            [Node list symbol=SCartesian int=2 ]
            ]
           
           [Node list 
           
            [Node list symbol=Sel symbol=sipnt 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            
            [Node list symbol=arrow symbol=xOffset ]
            
            [Node list symbol=arrow symbol=yOffset ]
            ]
           ]
          
          [Node list symbol=IF 
          
           [Node list symbol=has symbol=S 
           
            [Node list symbol=DirectedGraph 
            
             [Node list symbol=String ]
             ]
            ]
           
           [Node list symbol=LET symbol=arrNode 
           
            [Node list symbol=addSceneArrow symbol=mt symbol=fnode symbol=tnode symbol=offset 
            
             [Node list symbol=:: string=fixed 
             
              [Node list symbol=Symbol ]
              ]
             
             [Node list symbol=:: 
             
              [Node list int=-1 int=10 
              
               [Node list symbol=Sel symbol=float 
               
                [Node list symbol=Float ]
                ]
               
               [Node list symbol=One ]
               ]
              
              [Node list symbol=DoubleFloat ]
              ]
             
             [Node list symbol=:: 
             
              [Node list symbol=+ int=10 
              
               [Node list symbol=diagramWidth symbol=n ]
               ]
              
              [Node list symbol=DoubleFloat ]
              ]
             ]
            ]
           
           [Node list symbol=LET symbol=arrNode 
           
            [Node list symbol=addSceneArrow symbol=mt symbol=fnode symbol=tnode symbol=offset 
            
             [Node list symbol=:: string=proportional 
             
              [Node list symbol=Symbol ]
              ]
             
             [Node list symbol=:: 
             
              [Node list int=-1 int=10 
              
               [Node list symbol=Sel symbol=float 
               
                [Node list symbol=Float ]
                ]
               
               [Node list symbol=One ]
               ]
              
              [Node list symbol=DoubleFloat ]
              ]
             
             [Node list symbol=:: 
             
              [Node list symbol=+ int=10 
              
               [Node list symbol=diagramWidth symbol=n ]
               ]
              
              [Node list symbol=DoubleFloat ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=dispArrowName symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=s 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=arrow symbol=name ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=mt symbol=s 
              
               [Node list symbol=Sel symbol=addSceneText 
               
                [Node list symbol=Scene 
                
                 [Node list symbol=SCartesian int=2 ]
                 ]
                ]
               
               [Node list symbol=:: int=32 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=midX symbol=midY 
               
                [Node list symbol=Sel symbol=sipnt 
                
                 [Node list symbol=SCartesian int=2 ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=return symbol=void ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=diagramSvg symbol=fileName symbol=n symbol=dispArrowName ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Void ]
     
     [Node list symbol=String ]
     
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=view 
     
      [Node list 
      
       [Node list symbol=Sel symbol=boxBoundary 
       
        [Node list symbol=SBoundary 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=Zero ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=diagramWidth symbol=n ]
         
         [Node list symbol=:: int=10 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=diagramHeight symbol=n ]
         
         [Node list symbol=:: int=10 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=sc 
     
      [Node list symbol=view 
      
       [Node list symbol=Sel symbol=createSceneRoot 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=subdiagramSvg symbol=sc symbol=n symbol=dispArrowName symbol=false ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=writeSvg symbol=sc symbol=fileName ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=diagramsSvg symbol=fileName symbol=ln symbol=dispArrowName ]
    
    [Node list 
    
     [Node list symbol=Void ]
     
     [Node list symbol=String ]
     
     [Node list symbol=List symbol=$ ]
     
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=dW 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=Zero ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=n symbol=ln ]
      
      [Node list symbol=LET symbol=dW 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ int=10 
        
         [Node list symbol=+ symbol=dW 
         
          [Node list symbol=diagramWidth symbol=n ]
          ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=view 
     
      [Node list 
      
       [Node list symbol=Sel symbol=boxBoundary 
       
        [Node list symbol=SBoundary 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=Zero ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=dW 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=diagramHeight 
         
          [Node list symbol=first symbol=ln ]
          ]
         
         [Node list symbol=:: int=10 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=sc 
     
      [Node list symbol=view 
      
       [Node list symbol=Sel symbol=createSceneRoot 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=n symbol=ln ]
      
      [Node list symbol=subdiagramSvg symbol=sc symbol=n symbol=dispArrowName symbol=false ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=writeSvg symbol=sc symbol=fileName ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=deepDiagramSvg symbol=fileName symbol=n symbol=dispArrowName ]
    
    [Node list symbol=$ 
    
     [Node list symbol=Void ]
     
     [Node list symbol=String ]
     
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET symbol=view 
     
      [Node list 
      
       [Node list symbol=Sel symbol=boxBoundary 
       
        [Node list symbol=SBoundary 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=Zero ]
        
        [Node list symbol=Zero ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=diagramWidth symbol=n ]
         
         [Node list symbol=:: int=10 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=diagramHeight symbol=n ]
         
         [Node list symbol=:: int=10 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET symbol=sc 
     
      [Node list symbol=view 
      
       [Node list symbol=Sel symbol=createSceneRoot 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=subdiagramSvg symbol=sc symbol=n symbol=dispArrowName symbol=true ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=writeSvg symbol=sc symbol=fileName ]
      ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=diagramWidth symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=maxx 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=ls ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864777 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=> symbol=maxx 
        
         [Node list symbol=i symbol=posX ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864777 symbol=noBranch 
        
         [Node list symbol=LET symbol=maxx 
         
          [Node list symbol=i symbol=posX ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=maxx ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=diagramHeight symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=maxy 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=s ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=ls ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864778 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=> symbol=maxy 
        
         [Node list symbol=i symbol=posY ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864778 symbol=noBranch 
        
         [Node list symbol=LET symbol=maxy 
         
          [Node list symbol=i symbol=posY ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=maxy ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=looseEquals symbol=x symbol=y ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864779 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=# 
        
         [Node list symbol=getVertices symbol=x ]
         ]
        
        [Node list symbol=# 
        
         [Node list symbol=getVertices symbol=y ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864779 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arx 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getArrows symbol=x ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ary 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getArrows symbol=y ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864780 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=# symbol=arx ]
        
        [Node list symbol=# symbol=ary ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864780 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=arx ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G3864781 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=~= 
         
          [Node list symbol=fromOb 
          
           [Node list symbol=arx symbol=i ]
           ]
          
          [Node list symbol=fromOb 
          
           [Node list symbol=ary symbol=i ]
           ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G3864781 symbol=noBranch 
         
          [Node list symbol=return symbol=false ]
          ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3864782 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=~= 
        
         [Node list symbol=toOb 
         
          [Node list symbol=arx symbol=i ]
          ]
         
         [Node list symbol=toOb 
         
          [Node list symbol=ary symbol=i ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3864782 symbol=noBranch 
        
         [Node list symbol=return symbol=false ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=true ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=hash symbol=s ]
    
    [Node list symbol=$ 
    
     [Node list symbol=SingleInteger ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=Sel 
    
     [Node list symbol=SingleInteger ]
     
     [Node list symbol=Zero ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=latex symbol=n ]
    
    [Node list symbol=$ 
    
     [Node list symbol=String ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET string=
     
      [Node list symbol=: symbol=s 
      
       [Node list symbol=String ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=n ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=ls ]
      
      [Node list symbol=IF 
      
       [Node list symbol== symbol=s string=]
       
       [Node list symbol=LET symbol=s 
       
        [Node list symbol=latex 
        
         [Node list symbol=i symbol=value ]
         ]
        ]
       
       [Node list symbol=LET symbol=s 
       
        [Node list symbol=concat 
        
         [Node list symbol=construct symbol=s string=, 
         
          [Node list symbol=latex 
          
           [Node list symbol=i symbol=value ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arrs 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getArrows symbol=n ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=s ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=s ]
      ]
     
     [Node list symbol=LET symbol=s 
     
      [Node list 
      
       [Node list symbol=Sel symbol=concat 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=construct symbol=s string=| ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=fst 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=true ]
      ]
     
     [Node list symbol=LET string=-> 
     
      [Node list symbol=: symbol=arrStr 
      
       [Node list symbol=String ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrow symbol=arrs ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=IF symbol=fst symbol=noBranch 
       
        [Node list symbol=LET symbol=s 
        
         [Node list symbol=concat symbol=s string=, ]
         ]
        ]
       
       [Node list symbol=LET symbol=s 
       
        [Node list 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=construct symbol=s string=: symbol=arrStr 
         
          [Node list symbol=arrow symbol=name ]
          
          [Node list symbol=latex 
          
           [Node list symbol=value 
           
            [Node list symbol=ls 
            
             [Node list symbol=arrow symbol=fromOb ]
             ]
            ]
           ]
          
          [Node list symbol=latex 
          
           [Node list symbol=value 
           
            [Node list symbol=ls 
            
             [Node list symbol=arrow symbol=toOb ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=fst 
        
         [Node list symbol=false ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=s ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol== symbol=x symbol=y ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864783 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=getVertices symbol=x ]
        
        [Node list symbol=getVertices symbol=y ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864783 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3864784 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= 
       
        [Node list symbol=getArrows symbol=x ]
        
        [Node list symbol=getArrows symbol=y ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3864784 symbol=noBranch 
       
        [Node list symbol=return symbol=false ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=true ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=~= symbol=x symbol=y ]
    
    [Node list symbol=$ symbol=$ 
    
     [Node list symbol=Boolean ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=IF symbol=false symbol=true 
    
     [Node list symbol== symbol=x symbol=y ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerceSubgraph symbol=n ]
    
    [Node list symbol=$ 
    
     [Node list symbol=OutputForm ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=s 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=empty ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=n ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=ls ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=st 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=:: symbol=i 
        
         [Node list symbol=OutputForm ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF 
        
         [Node list symbol== symbol=s 
         
          [Node list 
          
           [Node list symbol=Sel symbol=empty 
           
            [Node list symbol=OutputForm ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=s symbol=st ]
         
         [Node list symbol=LET symbol=s 
         
          [Node list 
          
           [Node list symbol=Sel symbol=hconcat 
           
            [Node list symbol=OutputForm ]
            ]
           
           [Node list symbol=construct symbol=s symbol=st 
           
            [Node list symbol=message string=, ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arrs 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getArrows symbol=n ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=s ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=s ]
      ]
     
     [Node list symbol=LET symbol=s 
     
      [Node list 
      
       [Node list symbol=Sel symbol=hconcat 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=construct symbol=s 
       
        [Node list symbol=message string=| ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=fst 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=true ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arrStr 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=message string=-> ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrow symbol=arrs ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=stFrom 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=arrow symbol=fromOb ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=stTo 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=arrow symbol=toOb ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       
       [Node list symbol=IF symbol=fst symbol=noBranch 
       
        [Node list symbol=LET symbol=s 
        
         [Node list symbol=hconcat symbol=s 
         
          [Node list symbol=message string=, ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=s 
       
        [Node list 
        
         [Node list symbol=Sel symbol=hconcat 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=construct symbol=s symbol=stFrom symbol=arrStr symbol=stTo 
         
          [Node list symbol=:: 
          
           [Node list symbol=arrow symbol=name ]
           
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=message string=: ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=fst 
        
         [Node list symbol=false ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=s ]
     ]
    ]
   
   [Node list symbol=DEF 
   
    [Node list symbol=coerce symbol=n ]
    
    [Node list symbol=$ 
    
     [Node list symbol=OutputForm ]
     ]
    
    [Node list 
    
     [Node list ]
     
     [Node list ]
     ]
    
    [Node list symbol=SEQ 
    
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=has symbol=S 
      
       [Node list symbol=DirectedGraph 
       
        [Node list symbol=String ]
        ]
       ]
      
      [Node list symbol=return 
      
       [Node list symbol=coerceSubgraph symbol=n ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=s 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=empty ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=ls 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getVertices symbol=n ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=i symbol=ls ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=st 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=i symbol=value ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF 
        
         [Node list symbol== symbol=s 
         
          [Node list 
          
           [Node list symbol=Sel symbol=empty 
           
            [Node list symbol=OutputForm ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=s symbol=st ]
         
         [Node list symbol=LET symbol=s 
         
          [Node list 
          
           [Node list symbol=Sel symbol=hconcat 
           
            [Node list symbol=OutputForm ]
            ]
           
           [Node list symbol=construct symbol=s symbol=st 
           
            [Node list symbol=message string=, ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arrs 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=getArrows symbol=n ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=s ]
      ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol== symbol=arrs 
      
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=return symbol=s ]
      ]
     
     [Node list symbol=LET symbol=s 
     
      [Node list 
      
       [Node list symbol=Sel symbol=hconcat 
       
        [Node list symbol=OutputForm ]
        ]
       
       [Node list symbol=construct symbol=s 
       
        [Node list symbol=message string=| ]
        ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=fst 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=true ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=arrStr 
      
       [Node list symbol=OutputForm ]
       ]
      
      [Node list symbol=message string=-> ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=arrow symbol=arrs ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=stFrom 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=value 
         
          [Node list symbol=ls 
          
           [Node list symbol=arrow symbol=fromOb ]
           ]
          ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=stTo 
        
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=value 
         
          [Node list symbol=ls 
          
           [Node list symbol=arrow symbol=toOb ]
           ]
          ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       
       [Node list symbol=IF symbol=fst symbol=noBranch 
       
        [Node list symbol=LET symbol=s 
        
         [Node list symbol=hconcat symbol=s 
         
          [Node list symbol=message string=, ]
          ]
         ]
        ]
       
       [Node list symbol=LET symbol=s 
       
        [Node list 
        
         [Node list symbol=Sel symbol=hconcat 
         
          [Node list symbol=OutputForm ]
          ]
         
         [Node list symbol=construct symbol=s symbol=stFrom symbol=arrStr symbol=stTo 
         
          [Node list symbol=:: 
          
           [Node list symbol=arrow symbol=name ]
           
           [Node list symbol=OutputForm ]
           ]
          
          [Node list symbol=message string=: ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=fst 
        
         [Node list symbol=false ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 symbol=s ]
     ]
    ]
   ]
  
 ]
 
 [DEF DirectedGraph S
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=objects 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=arrows 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF directedGraph objs $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=objs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF directedGraph ob $ construct ob
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF directedGraph ob ar $ construct ob ar
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF directedGraph obs ars $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nodes 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=obs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=obs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=obs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=nodes 
       
        [Node list symbol=concat symbol=nodes symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=edges 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ar symbol=ars ]
     
     [Node list symbol=IN symbol=arn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=ars ]
       ]
      ]
     
     [Node list symbol=LET symbol=edges 
     
      [Node list symbol=edges 
      
       [Node list symbol=Sel symbol=concat 
       
        [Node list symbol=List 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=name 
          
           [Node list symbol=String ]
           ]
          
          [Node list symbol=: symbol=arrType 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=fromOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=toOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=xOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=yOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=map 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=concat string=a 
        
         [Node list symbol=string symbol=arn ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=ar symbol=fromOb ]
        
        [Node list symbol=ar symbol=toOb ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=nodes symbol=edges ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF directedGraph poset $ SEQ
   DEFSubnode:atts= FinitePoset S
    [Node list symbol=FinitePoset symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=poset 
     
      [Node list symbol=Sel symbol=getVert 
      
       [Node list symbol=FinitePoset symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ars
    [Node list symbol=LET symbol=ars 
    
     [Node list 
     
      [Node list symbol=Sel symbol=construct 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=mat 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=Boolean ]
        ]
       ]
      ]
     
     [Node list symbol=poset 
     
      [Node list symbol=Sel symbol=getArr 
      
       [Node list symbol=FinitePoset symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=x symbol=mat ]
     
     [Node list symbol=IN symbol=xn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=mat ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=y symbol=x ]
      
      [Node list symbol=IN symbol=yn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=x ]
        ]
       ]
      
      [Node list symbol=IF symbol=y symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=z 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=fromOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=: symbol=toOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         
         [Node list symbol=construct symbol=xn symbol=yn ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=ars symbol=z 
          
           [Node list symbol=Sel symbol=concat 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=fromOb 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=: symbol=toOb 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=directedGraph symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF directedGraph objs am $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=objs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ar 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=am ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=am symbol=i ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3866889 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=j 
         
          [Node list symbol=am symbol=i ]
          ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3866889 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=a 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=name 
             
              [Node list symbol=String ]
              ]
             
             [Node list symbol=: symbol=arrType 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=fromOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=toOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=xOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=yOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=map 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=construct string=a symbol=i symbol=j 
           
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=construct ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ar 
           
            [Node list symbol=concat symbol=ar symbol=a ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ar ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF directedGraph perms $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=perm symbol=perms ]
     
     [Node list symbol=IN symbol=px 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=perms ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=lr 
      
       [Node list symbol=listRepresentation symbol=perm ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=im 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=image ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol== symbol=px 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=LET symbol=obs symbol=im ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=v symbol=im ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3866890 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=< 
           
            [Node list symbol=position symbol=v symbol=obs ]
            
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3866890 symbol=noBranch 
           
            [Node list symbol=LET symbol=obs 
            
             [Node list symbol=concat symbol=obs symbol=v ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=tab 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=b 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=obs ]
        ]
       ]
      
      [Node list symbol=COLLECT symbol=b 
      
       [Node list symbol=IN symbol=a 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# symbol=perms ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=perm symbol=perms ]
     
     [Node list symbol=IN symbol=pi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=perms ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=lr 
      
       [Node list symbol=listRepresentation symbol=perm ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=im 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=image ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=preim 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=preimage ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=pt 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=im ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=pin 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=obs 
          
           [Node list symbol=Sel symbol=position 
           
            [Node list symbol=List symbol=S ]
            ]
           
           [Node list symbol=im symbol=pt ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=pout 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=obs 
          
           [Node list symbol=Sel symbol=position 
           
            [Node list symbol=List symbol=S ]
            ]
           
           [Node list symbol=preim symbol=pt ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET 
          
           [Node list symbol=pi 
           
            [Node list symbol=tab 
            
             [Node list symbol=:: symbol=pin 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           
           [Node list symbol=:: symbol=pout 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=verts 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=vert symbol=obs ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=vert 
       
        [Node list symbol=createX symbol=i 
        
         [Node list symbol=# symbol=obs ]
         ]
        
        [Node list symbol=createY symbol=i 
        
         [Node list symbol=# symbol=obs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=verts 
      
       [Node list symbol=concat symbol=verts symbol=o ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=arrNum 
        
         [Node list symbol=tab symbol=i ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct string=a symbol=i symbol=arrNum 
          
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=ars 
          
           [Node list symbol=concat symbol=ars symbol=a ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=verts symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obj 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=n 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=obj ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=obj ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=value symbol=S ]
     
     [Node list symbol=: symbol=posX 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=posY 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=n ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=n ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s ar $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=name 
     
      [Node list symbol=String ]
      ]
     
     [Node list symbol=: symbol=arrType 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=fromOb 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=toOb 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=xOffset 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=: symbol=yOffset 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=: symbol=map 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=s symbol=arrows ]
     
     [Node list symbol=concat symbol=ar 
     
      [Node list symbol=s symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 $ $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=a 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=nm symbol=n1 symbol=n2 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=addArrow! symbol=s symbol=a ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 mp $ $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=a 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=nm symbol=n1 symbol=n2 symbol=mp 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=addArrow! symbol=s symbol=a ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF getVertices s $ s objects
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF getArrows s $ s arrows
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF flatten n $ SEQ
   DEFSubnode:atts= DirectedGraph $
    [Node list symbol=DirectedGraph symbol=$ ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= MDEF
    [Node list symbol=MDEF 
    
     [Node list symbol=OBJT2 ]
     
     [Node list 
     
      [Node list ]
      ]
     
     [Node list 
     
      [Node list ]
      ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=$ ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=v 
     
      [Node list symbol=List symbol=OBJT2 ]
      ]
     
     [Node list symbol=n 
     
      [Node list symbol=Sel symbol=getVertices 
      
       [Node list symbol=DirectedGraph symbol=$ ]
       ]
      ]
     ]
    
   DEFSubnode:atts= MDEF
    [Node list symbol=MDEF 
    
     [Node list symbol=OBJT3 ]
     
     [Node list 
     
      [Node list ]
      ]
     
     [Node list 
     
      [Node list ]
      ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=innerValues 
     
      [Node list symbol=List symbol=OBJT3 ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=offset 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=offsets 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=innerArrows 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=v2 symbol=v ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=v3 
      
       [Node list symbol=v2 symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=obs 
       
        [Node list symbol=List symbol=OBJT3 ]
        ]
       
       [Node list symbol=v3 
       
        [Node list symbol=Sel symbol=$ symbol=getVertices ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=obs2 
       
        [Node list symbol=List symbol=OBJT3 ]
        ]
       
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=ob symbol=obs ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=px 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=+ 
         
          [Node list symbol=ob symbol=posX ]
          
          [Node list symbol=* int=4 
          
           [Node list symbol=v2 symbol=posX ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=py 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=+ 
         
          [Node list symbol=ob symbol=posY ]
          
          [Node list symbol=* int=4 
          
           [Node list symbol=v2 symbol=posY ]
           ]
          ]
         ]
        
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=ob2 symbol=OBJT3 ]
         
         [Node list symbol=construct symbol=px symbol=py 
         
          [Node list symbol=ob symbol=value ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=obs2 
         
          [Node list symbol=concat symbol=obs2 symbol=ob2 ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=innerValues 
      
       [Node list symbol=concat symbol=innerValues symbol=obs2 ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ina 
       
        [Node list symbol=List 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=name 
          
           [Node list symbol=String ]
           ]
          
          [Node list symbol=: symbol=arrType 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=fromOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=toOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=xOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=yOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=map 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=v3 
       
        [Node list symbol=Sel symbol=$ symbol=getArrows ]
        ]
       ]
      
      [Node list symbol=LET symbol=innerArrows 
      
       [Node list symbol=concat symbol=innerArrows symbol=ina ]
       ]
      
      [Node list symbol=LET symbol=offsets 
      
       [Node list symbol=concat symbol=offsets symbol=offset ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=offset 
       
        [Node list symbol=+ symbol=offset 
        
         [Node list symbol=# symbol=obs ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=iv 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=pretend symbol=innerValues 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=a 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a2 symbol=innerArrows ]
     
     [Node list symbol=IN symbol=a2n 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=innerArrows ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=a3 symbol=a2 ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=name2 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=a3 symbol=name ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=arrType2 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=a3 symbol=arrType ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=fromOb2 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=a3 symbol=fromOb ]
         
         [Node list symbol=offsets symbol=a2n ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=toOb2 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=+ 
        
         [Node list symbol=a3 symbol=toOb ]
         
         [Node list symbol=offsets symbol=a2n ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=xOffset2 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=a3 symbol=xOffset ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=yOffset2 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=a3 symbol=yOffset ]
        ]
       
       [Node list symbol=LET symbol=map2 
       
        [Node list symbol=a3 symbol=map ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=arr 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=name 
          
           [Node list symbol=String ]
           ]
          
          [Node list symbol=: symbol=arrType 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=fromOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=toOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=xOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=yOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=map 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=construct symbol=name2 symbol=arrType2 symbol=fromOb2 symbol=toOb2 symbol=xOffset2 symbol=yOffset2 symbol=map2 ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=a 
        
         [Node list symbol=concat symbol=a symbol=arr ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=outerArrows 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=getArrows symbol=n ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oa3 symbol=outerArrows ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=name3 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=oa3 symbol=name ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arrType3 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=oa3 symbol=arrType ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromOb3 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=offsets 
        
         [Node list symbol=oa3 symbol=fromOb ]
         ]
        
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=toOb3 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=offsets 
        
         [Node list symbol=oa3 symbol=toOb ]
         ]
        
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=xOffset3 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=oa3 symbol=xOffset ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=yOffset3 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=oa3 symbol=yOffset ]
       ]
      
      [Node list symbol=LET symbol=map3 
      
       [Node list symbol=oa3 symbol=map ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=endi symbol=map3 ]
        
        [Node list symbol=IN symbol=starti 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=map3 ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=fromOb3 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=starti 
          
           [Node list symbol=offsets 
           
            [Node list symbol=oa3 symbol=fromOb ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=toOb3 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=endi 
          
           [Node list symbol=offsets 
           
            [Node list symbol=oa3 symbol=toOb ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=arr 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=name3 symbol=arrType3 symbol=fromOb3 symbol=toOb3 symbol=xOffset3 symbol=yOffset3 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=a 
          
           [Node list symbol=concat symbol=a symbol=arr ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=iv symbol=a ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF initial $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF terminal a $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=o 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=a 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ar 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct string=loop 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct symbol=o ]
      
      [Node list symbol=construct symbol=ar ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleOpen objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=objs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3866891 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=- symbol=next 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3866891 symbol=noBranch 
        
         [Node list symbol=LET symbol=next symbol=obn ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3866892 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3866892 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat symbol=arrowName 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleClosed objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=objs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3866893 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=- symbol=next 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3866893 symbol=noBranch 
        
         [Node list symbol=LET symbol=next 
         
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3866894 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3866894 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat symbol=arrowName 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF unit objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=objs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=a 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=obn symbol=obn 
       
        [Node list symbol=concat symbol=arrowName 
        
         [Node list symbol=string symbol=arn ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=LET symbol=ars 
      
       [Node list symbol=concat symbol=ars symbol=a ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=arn 
       
        [Node list symbol=+ symbol=arn 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF kgraph objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=objs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=obm 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=objs ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3866895 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=obn symbol=obm ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3866895 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=a 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=name 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=: symbol=arrType 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=fromOb 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=toOb 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=xOffset 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=: symbol=yOffset 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=: symbol=map 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=construct symbol=obn symbol=obm 
             
              [Node list symbol=concat symbol=arrowName 
              
               [Node list symbol=string symbol=arn ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=construct ]
              ]
             ]
            
            [Node list symbol=LET symbol=ars 
            
             [Node list symbol=concat symbol=ars symbol=a ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=arn 
             
              [Node list symbol=+ symbol=arn 
              
               [Node list symbol=One ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF + a b $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lo 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat 
     
      [Node list symbol=a symbol=objects ]
      
      [Node list symbol=b symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bStart 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lb 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ba 
     
      [Node list symbol=b symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=ba symbol=name ]
        
        [Node list symbol=ba symbol=arrType ]
        
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=fromOb ]
         ]
        
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=toOb ]
         ]
        
        [Node list symbol=ba symbol=xOffset ]
        
        [Node list symbol=ba symbol=yOffset ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lb 
       
        [Node list symbol=lb symbol=arr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=lb 
     
      [Node list symbol=a symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=lo symbol=la ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF merge a b $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bmap 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT symbol=x 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newIndex 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET mergedObjects
    [Node list symbol=LET symbol=mergedObjects 
    
     [Node list symbol=a symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=bob 
     
      [Node list symbol=b symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=position symbol=bob 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol=< symbol=i 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=mergedObjects 
         
          [Node list symbol=concat symbol=mergedObjects symbol=bob ]
          ]
         
         [Node list symbol=LET symbol=newIndex 
         
          [Node list symbol=+ symbol=newIndex 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=bmap 
          
           [Node list symbol=concat symbol=bmap symbol=newIndex ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=bmap 
        
         [Node list symbol=concat symbol=bmap 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bStart 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lb 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ba 
     
      [Node list symbol=b symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=toI 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=bmap 
       
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=toOb ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromI 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=bmap 
       
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=fromOb ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=fromI symbol=toI 
       
        [Node list symbol=ba symbol=name ]
        
        [Node list symbol=ba symbol=arrType ]
        
        [Node list symbol=ba symbol=xOffset ]
        
        [Node list symbol=ba symbol=yOffset ]
        
        [Node list symbol=ba symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lb 
       
        [Node list symbol=lb symbol=arr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=lb 
     
      [Node list symbol=a symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=mergedObjects symbol=la ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF objProd a b $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value 
        
         [Node list symbol=Product symbol=S symbol=S ]
         ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=widtha 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramWidth symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=heighta 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramHeight symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp 
          
           [Node list symbol=Product symbol=S symbol=S ]
           ]
          
          [Node list symbol=ai symbol=bi 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=Product symbol=S symbol=S ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value 
            
             [Node list symbol=Product symbol=S symbol=S ]
             ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newObjs
    [Node list symbol=exit int=1 symbol=newObjs ]
    
   ]
   
  CAPSULEDef:
   [DEF indexProd aObj a b $ + a
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= *
    [Node list symbol=* 
    
     [Node list symbol=:: 
     
      [Node list symbol=- 
      
       [Node list symbol=:: symbol=b 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=aObj symbol=objects ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * a b $ $ SEQ
   DEFSubnode:atts= DirectedGraph
    [Node list symbol=DirectedGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3866896 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3866896 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3866897 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3866897 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=an 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=* 
                 
                  [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                  
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=arr 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=name 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=: symbol=arrType 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=fromOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=toOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=xOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=yOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=map 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=construct symbol=an 
                
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=construct ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=newArrs 
                
                 [Node list symbol=newArrs symbol=arr 
                 
                  [Node list symbol=Sel symbol=concat 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=name 
                     
                      [Node list symbol=String ]
                      ]
                     
                     [Node list symbol=: symbol=arrType 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=fromOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=toOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=xOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=yOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=map 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newArrs 
     
      [Node list symbol=Sel symbol=directedGraph 
      
       [Node list symbol=DirectedGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      
      [Node list symbol=objProd symbol=a symbol=b ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cartesian a b $ $ SEQ
   DEFSubnode:atts= DirectedGraph
    [Node list symbol=DirectedGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=bu symbol=bv ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3866898 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3866898 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=an 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol== symbol=bu symbol=bv ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3866899 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3866899 
                 
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                    
                    [Node list symbol=string symbol=bv ]
                    ]
                   ]
                  
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                    
                    [Node list symbol=string symbol=av ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=concat 
               
                [Node list symbol=construct string=# 
                
                 [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                 
                 [Node list symbol=string symbol=av ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=arr 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=name 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=: symbol=arrType 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=fromOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=toOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=xOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=yOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=map 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=construct symbol=an 
              
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
               
               [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=newArrs 
              
               [Node list symbol=newArrs symbol=arr 
               
                [Node list symbol=Sel symbol=concat 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=name 
                   
                    [Node list symbol=String ]
                    ]
                   
                   [Node list symbol=: symbol=arrType 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=fromOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=toOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=xOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=yOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=map 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=au symbol=av ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G3866900 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G3866900 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=an 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=bu symbol=bv ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G3866899 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G3866899 
                     
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                        
                        [Node list symbol=string symbol=bv ]
                        ]
                       ]
                      
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                        
                        [Node list symbol=string symbol=av ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=arr 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=construct symbol=an 
                  
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=construct ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newArrs 
                  
                   [Node list symbol=newArrs symbol=arr 
                   
                    [Node list symbol=Sel symbol=concat 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=name 
                       
                        [Node list symbol=String ]
                        ]
                       
                       [Node list symbol=: symbol=arrType 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=fromOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=toOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=xOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=yOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=map 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol== symbol=au symbol=av ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G3866901 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G3866901 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=an 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=bu symbol=bv ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G3866899 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G3866899 
                  
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                     
                     [Node list symbol=string symbol=bv ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=# 
                 
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  
                  [Node list symbol=string symbol=av ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=arr 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=name 
                 
                  [Node list symbol=String ]
                  ]
                 
                 [Node list symbol=: symbol=arrType 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=fromOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=toOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=xOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=yOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=map 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=an 
               
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                
                [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=construct ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newArrs 
               
                [Node list symbol=newArrs symbol=arr 
                
                 [Node list symbol=Sel symbol=concat 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newArrs 
     
      [Node list symbol=Sel symbol=directedGraph 
      
       [Node list symbol=DirectedGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      
      [Node list symbol=objProd symbol=a symbol=b ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedObjProd a b f $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=widtha 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramWidth symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=heighta 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramHeight symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp symbol=S ]
          
          [Node list symbol=f symbol=ai symbol=bi ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value symbol=S ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newObjs
    [Node list symbol=exit int=1 symbol=newObjs ]
    
   ]
   
  CAPSULEDef:
   [DEF closedTensor a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3866902 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3866902 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3866903 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3866903 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=an 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=* 
                 
                  [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                  
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=arr 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=name 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=: symbol=arrType 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=fromOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=toOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=xOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=yOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=map 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=construct symbol=an 
                
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=construct ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=newArrs 
                
                 [Node list symbol=newArrs symbol=arr 
                 
                  [Node list symbol=Sel symbol=concat 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=name 
                     
                      [Node list symbol=String ]
                      ]
                     
                     [Node list symbol=: symbol=arrType 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=fromOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=toOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=xOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=yOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=map 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=directedGraph symbol=newArrs 
     
      [Node list symbol=closedObjProd symbol=a symbol=b symbol=f ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedCartesian a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=bu symbol=bv ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3866904 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3866904 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=an 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol== symbol=bu symbol=bv ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3866905 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3866905 
                 
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                    
                    [Node list symbol=string symbol=bv ]
                    ]
                   ]
                  
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                    
                    [Node list symbol=string symbol=av ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=concat 
               
                [Node list symbol=construct string=# 
                
                 [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                 
                 [Node list symbol=string symbol=av ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=arr 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=name 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=: symbol=arrType 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=fromOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=toOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=xOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=yOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=map 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=construct symbol=an 
              
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
               
               [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=newArrs 
              
               [Node list symbol=newArrs symbol=arr 
               
                [Node list symbol=Sel symbol=concat 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=name 
                   
                    [Node list symbol=String ]
                    ]
                   
                   [Node list symbol=: symbol=arrType 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=fromOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=toOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=xOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=yOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=map 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=au symbol=av ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G3866906 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G3866906 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=an 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=bu symbol=bv ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G3866905 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G3866905 
                     
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                        
                        [Node list symbol=string symbol=bv ]
                        ]
                       ]
                      
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                        
                        [Node list symbol=string symbol=av ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=arr 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=construct symbol=an 
                  
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=construct ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newArrs 
                  
                   [Node list symbol=newArrs symbol=arr 
                   
                    [Node list symbol=Sel symbol=concat 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=name 
                       
                        [Node list symbol=String ]
                        ]
                       
                       [Node list symbol=: symbol=arrType 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=fromOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=toOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=xOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=yOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=map 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol== symbol=au symbol=av ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G3866907 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G3866907 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=an 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=bu symbol=bv ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G3866905 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G3866905 
                  
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                     
                     [Node list symbol=string symbol=bv ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=# 
                 
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  
                  [Node list symbol=string symbol=av ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=arr 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=name 
                 
                  [Node list symbol=String ]
                  ]
                 
                 [Node list symbol=: symbol=arrType 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=fromOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=toOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=xOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=yOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=map 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=an 
               
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                
                [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=construct ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newArrs 
               
                [Node list symbol=newArrs symbol=arr 
                
                 [Node list symbol=Sel symbol=concat 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=directedGraph symbol=newArrs 
     
      [Node list symbol=closedObjProd symbol=a symbol=b symbol=f ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ~ s SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=arrows ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=obs ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3866908 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=isDirectSuccessor? symbol=s symbol=i symbol=j ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3866908 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=newArr 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=name 
             
              [Node list symbol=String ]
              ]
             
             [Node list symbol=: symbol=arrType 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=fromOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=toOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=xOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=yOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=map 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=construct symbol=i symbol=j 
           
            [Node list symbol=concat 
            
             [Node list symbol=string symbol=i ]
             
             [Node list symbol=string symbol=j ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=Zero ]
            
            [Node list symbol=Zero ]
            
            [Node list symbol=construct ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=newArrs 
           
            [Node list symbol=concat symbol=newArrs symbol=newArr ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF map s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=i 
      
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: 
        
         [Node list symbol=newObjs symbol=i ]
         
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=value symbol=S ]
          
          [Node list symbol=: symbol=posX 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=posY 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=value 
         
          [Node list symbol=newObjs symbol=i ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetX 
          
           [Node list symbol=posX 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetY 
          
           [Node list symbol=posY 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oldArrow 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newArr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=oldArrow symbol=name ]
        
        [Node list symbol=oldArrow symbol=arrType ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=fromOb ]
         ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=toOb ]
         ]
        
        [Node list symbol=oldArrow symbol=xOffset ]
        
        [Node list symbol=oldArrow symbol=yOffset ]
        
        [Node list symbol=oldArrow symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newArrs 
       
        [Node list symbol=concat symbol=newArrs symbol=newArr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mapContra s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=i 
      
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: 
        
         [Node list symbol=newObjs symbol=i ]
         
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=value symbol=S ]
          
          [Node list symbol=: symbol=posX 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=posY 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=value 
         
          [Node list symbol=newObjs symbol=i ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetX 
          
           [Node list symbol=posX 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetY 
          
           [Node list symbol=posY 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oldArrow 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newArr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=oldArrow symbol=name ]
        
        [Node list symbol=oldArrow symbol=arrType ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=toOb ]
         ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=fromOb ]
         ]
        
        [Node list symbol=oldArrow symbol=xOffset ]
        
        [Node list symbol=oldArrow symbol=yOffset ]
        
        [Node list symbol=oldArrow symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newArrs 
       
        [Node list symbol=concat symbol=newArrs symbol=newArr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce pg $ directedGraph
   DEFSubnode:atts= PermutationGroup S
    [Node list symbol=PermutationGroup symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :: pg
    [Node list symbol=:: symbol=pg 
    
     [Node list symbol=List 
     
      [Node list symbol=Permutation symbol=S ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce poset $ directedGraph poset
   DEFSubnode:atts= FinitePoset S
    [Node list symbol=FinitePoset symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce lst $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=lst ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=lst ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=lst ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=lst ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3866909 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=lst ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3866909 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat string=a 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=FiniteGraph symbol=S ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=directedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=FinitePoset symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=DirectedGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=cartesian 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=DirectedGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedTensor 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedCartesian 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=~ 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=PermutationGroup symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=FinitePoset symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= SetCategory
  [Node list symbol=SetCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF FunctionGraph S
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=objects 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=import 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=value symbol=S ]
     
     [Node list symbol=: symbol=posX 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=posY 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=next 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=map 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF functionGraph ob $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x symbol=ob ]
      
      [Node list symbol=construct symbol=x 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=objs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF functionGraph ob $ construct ob
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=next 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF functionGraph ob ar $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arrs 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=ob ]
        ]
       ]
      
      [Node list symbol=:: symbol=x 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a symbol=ar ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromo 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=a symbol=fromOb ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=too 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=a symbol=toOb ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=too 
       
        [Node list symbol=arrs symbol=fromo ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=fobs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=fn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=ob ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=f 
      
       [Node list symbol=ob symbol=fn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fo 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=f symbol=value ]
        
        [Node list symbol=f symbol=posX ]
        
        [Node list symbol=f symbol=posY ]
        
        [Node list symbol=arrs symbol=fn ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=fobs 
       
        [Node list symbol=concat symbol=fobs symbol=fo ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=fobs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF functionGraph perms $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3869007 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=# symbol=perms ]
       
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3869007 symbol=noBranch 
      
       [Node list symbol=error string=functionGraph only needs one permutation ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET perm
    [Node list symbol=LET symbol=perm 
    
     [Node list symbol=first symbol=perms ]
     ]
    
   DEFSubnode:atts= LET lr
    [Node list symbol=LET symbol=lr 
    
     [Node list symbol=listRepresentation symbol=perm ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=im 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=lr symbol=image ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=preim 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=lr symbol=preimage ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=vert symbol=im ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=im ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=n 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# symbol=preim ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G3869008 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol== 
         
          [Node list symbol=im symbol=i ]
          
          [Node list symbol=preim symbol=j ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G3869008 symbol=noBranch 
         
          [Node list symbol=LET symbol=n symbol=j ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=vert symbol=n 
       
        [Node list symbol=createX symbol=i 
        
         [Node list symbol=# symbol=im ]
         ]
        
        [Node list symbol=createY symbol=i 
        
         [Node list symbol=# symbol=im ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obj 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=n 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=# symbol=obs ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=obj ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=obj ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=value symbol=S ]
     
     [Node list symbol=: symbol=posX 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=posY 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error this form of addObject! not supported in functionGraph
    [Node list symbol=error string=this form of addObject! not supported in functionGraph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 $ $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET n2
    [Node list symbol=LET symbol=n2 
    
     [Node list symbol=next 
     
      [Node list symbol=n1 
      
       [Node list symbol=s symbol=objects ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF getVertices s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=soj 
     
      [Node list symbol=s symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=soj symbol=value ]
        
        [Node list symbol=soj symbol=posX ]
        
        [Node list symbol=soj symbol=posY ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=concat symbol=res symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF getArrows s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=sojn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=soj 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=sojn 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=a 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=sojn 
       
        [Node list symbol=string symbol=sojn ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=soj symbol=next ]
        
        [Node list symbol=Zero ]
        
        [Node list symbol=Zero ]
        
        [Node list symbol=soj symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=concat symbol=res symbol=a ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF initial $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF terminal a $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=o 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=a 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct symbol=o ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleOpen objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=n 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869009 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869009 symbol=noBranch 
        
         [Node list symbol=LET symbol=n 
         
          [Node list symbol=# symbol=objs ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob symbol=n 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleClosed objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=n 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869010 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869010 symbol=noBranch 
        
         [Node list symbol=LET symbol=n 
         
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob symbol=n 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF unit objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=objs symbol=x ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: symbol=x 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=objs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF kgraph objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error kgraph not valid in function graph
    [Node list symbol=error string=kgraph not valid in function graph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF + a b $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=b symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=c 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=value 
       
        [Node list symbol=objs symbol=x ]
        ]
       
       [Node list symbol=posX 
       
        [Node list symbol=objs symbol=x ]
        ]
       
       [Node list symbol=posY 
       
        [Node list symbol=objs symbol=x ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=:: symbol=x 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       
       [Node list symbol=map 
       
        [Node list symbol=objs symbol=x ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=concat symbol=c 
      
       [Node list symbol=a symbol=objects ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF merge a b $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error merge not valid in function graph
    [Node list symbol=error string=merge not valid in function graph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF indexProd aObj a b $ SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=x 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=+ symbol=a 
     
      [Node list symbol=* 
      
       [Node list symbol=:: 
       
        [Node list symbol=- 
        
         [Node list symbol=:: symbol=b 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=One ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=# 
       
        [Node list symbol=aObj symbol=objects ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 x
    [Node list symbol=exit int=1 symbol=x ]
    
   ]
   
  CAPSULEDef:
   [DEF * a b $ $ SEQ
   DEFSubnode:atts= FunctionGraph
    [Node list symbol=FunctionGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value 
        
         [Node list symbol=Product symbol=S symbol=S ]
         ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ani 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bni 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=next ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=nextA 
         
          [Node list symbol=indexProd symbol=b symbol=bni symbol=ani ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp 
          
           [Node list symbol=Product symbol=S symbol=S ]
           ]
          
          [Node list symbol=ai symbol=bi 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=Product symbol=S symbol=S ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value 
            
             [Node list symbol=Product symbol=S symbol=S ]
             ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=next 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y symbol=nextA 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newObjs 
     
      [Node list symbol=Sel symbol=functionGraph 
      
       [Node list symbol=FunctionGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedTensor a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ani 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bni 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=next ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=nextA 
         
          [Node list symbol=indexProd symbol=b symbol=bni symbol=ani ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp symbol=S ]
          
          [Node list symbol=f symbol=ai symbol=bi ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value symbol=S ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=next 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y symbol=nextA 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=functionGraph symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF map s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=oldObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=oldObjs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=oldObj 
      
       [Node list symbol=oldObjs symbol=oi ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=inext 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=m 
       
        [Node list symbol=oldObj symbol=next ]
        ]
       ]
      
      [Node list symbol=LET symbol=newObj 
      
       [Node list symbol=newOb symbol=i ]
       ]
      
      [Node list symbol=LET symbol=newX 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetX 
        
         [Node list symbol=oldObj symbol=posX ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=newY 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetY 
        
         [Node list symbol=oldObj symbol=posY ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=newNext 
      
       [Node list symbol=m 
       
        [Node list symbol=oldObj symbol=next ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=nv 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=newObj symbol=newX symbol=newY symbol=newNext 
       
        [Node list symbol=oldObj symbol=map ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3869011 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= symbol=i symbol=inext ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3869011 symbol=noBranch 
       
        [Node list symbol=LET symbol=nv 
        
         [Node list symbol=newObjs symbol=i ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=p 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=newObjs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=nwob 
      
       [Node list symbol=newObjs symbol=p ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3869012 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=< 
       
        [Node list symbol=nwob symbol=next ]
        
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3869012 symbol=noBranch 
       
        [Node list symbol=LET symbol=p 
        
         [Node list symbol=nwob symbol=next ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mapContra s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=oldObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=oldObjs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=oldObj 
      
       [Node list symbol=oldObjs symbol=oi ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=inext 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=m 
       
        [Node list symbol=oldObj symbol=next ]
        ]
       ]
      
      [Node list symbol=LET symbol=newObj 
      
       [Node list symbol=newOb symbol=i ]
       ]
      
      [Node list symbol=LET symbol=newX 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetX 
        
         [Node list symbol=oldObj symbol=posX ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=newY 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetY 
        
         [Node list symbol=oldObj symbol=posY ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=incoming 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=nodeToNode symbol=s symbol=oi ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869013 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=~= 
        
         [Node list symbol=# symbol=incoming ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869013 symbol=noBranch 
        
         [Node list symbol=error string=not a FunctionGraph ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=newNext 
      
       [Node list symbol=m 
       
        [Node list symbol=first symbol=incoming ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=n 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=newObj symbol=newX symbol=newY symbol=newNext 
       
        [Node list symbol=oldObj symbol=map ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3869014 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=~= symbol=i symbol=inext ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3869014 symbol=noBranch 
       
        [Node list symbol=LET symbol=n 
        
         [Node list symbol=newObjs symbol=i ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=p 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=newObjs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=nwob 
      
       [Node list symbol=newObjs symbol=p ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3869015 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=< 
       
        [Node list symbol=nwob symbol=next ]
        
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3869015 symbol=noBranch 
       
        [Node list symbol=LET symbol=p 
        
         [Node list symbol=nwob symbol=next ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coAdjoint s m $ SEQ
   DEFSubnode:atts= Union failed
    [Node list symbol=Union string=failed 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=domainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=s symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=codomainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi symbol=m ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=> symbol=mi symbol=codomainSize ]
      
      [Node list symbol=LET symbol=codomainSize symbol=mi ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ret 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=retOpt 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=m ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=retOpt 
      
       [Node list symbol=m symbol=mi ]
       ]
      
      [Node list symbol=concat symbol=mi 
      
       [Node list symbol=retOpt 
       
        [Node list symbol=m symbol=mi ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=entry 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ri symbol=retOpt ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=max symbol=s symbol=ri ]
       ]
      
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol== symbol=x 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=return string=failed ]
       ]
      
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=ret symbol=entry ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=entry 
       
        [Node list symbol=+ symbol=entry 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 ret
    [Node list symbol=exit int=1 symbol=ret ]
    
   ]
   
  CAPSULEDef:
   [DEF contraAdjoint s m $ SEQ
   DEFSubnode:atts= Union failed
    [Node list symbol=Union string=failed 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=domainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=s symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=codomainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi symbol=m ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=> symbol=mi symbol=codomainSize ]
      
      [Node list symbol=LET symbol=codomainSize symbol=mi ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ret 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=retOpt 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=m ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=retOpt 
      
       [Node list symbol=m symbol=mi ]
       ]
      
      [Node list symbol=concat symbol=mi 
      
       [Node list symbol=retOpt 
       
        [Node list symbol=m symbol=mi ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=entry 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ri symbol=retOpt ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=min symbol=s symbol=ri ]
       ]
      
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol== symbol=x 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=return string=failed ]
       ]
      
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=ret symbol=entry ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=entry 
       
        [Node list symbol=+ symbol=entry 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 ret
    [Node list symbol=exit int=1 symbol=ret ]
    
   ]
   
  CAPSULEDef:
   [DEF apply s a $ next
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= a
    [Node list symbol=a 
    
     [Node list symbol=s symbol=objects ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF limit s a $ SEQ
   DEFSubnode:atts= Loop
    [Node list symbol=Loop ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ptr a
    [Node list symbol=LET symbol=ptr symbol=a ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=s1 
     
      [Node list symbol=s symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=lp 
       
        [Node list symbol=List 
        
         [Node list symbol=Loop ]
         ]
        ]
       
       [Node list symbol=loopsAtNode symbol=s symbol=ptr ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869016 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=> 
        
         [Node list symbol=# symbol=lp ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869016 symbol=noBranch 
        
         [Node list symbol=error string=limit: cant have >1 loop through node ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869017 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=# symbol=lp ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869017 symbol=noBranch 
        
         [Node list symbol=return 
         
          [Node list symbol=first symbol=lp ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=ptr 
       
        [Node list symbol=apply symbol=s symbol=ptr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=loop 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=FiniteGraph symbol=S ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=functionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=functionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=functionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=functionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=FunctionGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedTensor 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coAdjoint 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=contraAdjoint 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=apply 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=limit 
    
     [Node list symbol=$ 
     
      [Node list symbol=Loop ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= SetCategory
  [Node list symbol=SetCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF UndirectedGraph S
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=objects 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=arrows 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEFatts= DEF false
    isDirected?
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF undirectedGraph ob $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x symbol=ob ]
      
      [Node list symbol=construct symbol=x 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=objs 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF undirectedGraph ob $ construct ob
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF undirectedGraph ob ar $ construct ob ar
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF undirectedGraph obs ars $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=nodes 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=obs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=obs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=obs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=nodes 
       
        [Node list symbol=concat symbol=nodes symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=edges 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ar symbol=ars ]
     
     [Node list symbol=IN symbol=arn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=ars ]
       ]
      ]
     
     [Node list symbol=LET symbol=edges 
     
      [Node list symbol=edges 
      
       [Node list symbol=Sel symbol=concat 
       
        [Node list symbol=List 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=name 
          
           [Node list symbol=String ]
           ]
          
          [Node list symbol=: symbol=arrType 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=fromOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=toOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=xOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=yOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=map 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=concat string=a 
        
         [Node list symbol=string symbol=arn ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=ar symbol=fromOb ]
        
        [Node list symbol=ar symbol=toOb ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=nodes symbol=edges ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF undirectedGraph poset $ SEQ
   DEFSubnode:atts= FinitePoset S
    [Node list symbol=FinitePoset symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=poset 
     
      [Node list symbol=Sel symbol=getVert 
      
       [Node list symbol=FinitePoset symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ars
    [Node list symbol=LET symbol=ars 
    
     [Node list 
     
      [Node list symbol=Sel symbol=construct 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=mat 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=Boolean ]
        ]
       ]
      ]
     
     [Node list symbol=poset 
     
      [Node list symbol=Sel symbol=getArr 
      
       [Node list symbol=FinitePoset symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=x symbol=mat ]
     
     [Node list symbol=IN symbol=xn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=mat ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=y symbol=x ]
      
      [Node list symbol=IN symbol=yn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=x ]
        ]
       ]
      
      [Node list symbol=IF symbol=y symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=z 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=fromOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=: symbol=toOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         
         [Node list symbol=construct symbol=xn symbol=yn ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=ars symbol=z 
          
           [Node list symbol=Sel symbol=concat 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=fromOb 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=: symbol=toOb 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=undirectedGraph symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF undirectedGraph objs am $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ar 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=am ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=am symbol=i ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869616 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=j 
         
          [Node list symbol=am symbol=i ]
          ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869616 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=a 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=name 
             
              [Node list symbol=String ]
              ]
             
             [Node list symbol=: symbol=arrType 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=fromOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=toOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=xOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=yOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=map 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=construct string=a symbol=i symbol=j 
           
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=construct ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ar 
           
            [Node list symbol=concat symbol=ar symbol=a ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ar ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obj 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=n 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=obj ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=obj ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=value symbol=S ]
     
     [Node list symbol=: symbol=posX 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=posY 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=n ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=n ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s ar $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=name 
     
      [Node list symbol=String ]
      ]
     
     [Node list symbol=: symbol=arrType 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=fromOb 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=toOb 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=xOffset 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=: symbol=yOffset 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=: symbol=map 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=s symbol=arrows ]
     
     [Node list symbol=concat symbol=ar 
     
      [Node list symbol=s symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 $ $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=a 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=nm symbol=n1 symbol=n2 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=addArrow! symbol=s symbol=a ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 mp $ $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=a 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=nm symbol=n1 symbol=n2 symbol=mp 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=addArrow! symbol=s symbol=a ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF getVertices s $ s objects
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF getArrows s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=as 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=forwAr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=a symbol=name ]
        
        [Node list symbol=a symbol=arrType ]
        
        [Node list symbol=a symbol=fromOb ]
        
        [Node list symbol=a symbol=toOb ]
        
        [Node list symbol=a symbol=xOffset ]
        
        [Node list symbol=a symbol=yOffset ]
        
        [Node list symbol=a symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=as 
       
        [Node list symbol=as symbol=forwAr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=revAr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=a symbol=name ]
        
        [Node list symbol=a symbol=arrType ]
        
        [Node list symbol=a symbol=toOb ]
        
        [Node list symbol=a symbol=fromOb ]
        
        [Node list symbol=a symbol=xOffset ]
        
        [Node list symbol=a symbol=yOffset ]
        
        [Node list symbol=a symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=as 
       
        [Node list symbol=as symbol=revAr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 as
    [Node list symbol=exit int=1 symbol=as ]
    
   ]
   
  CAPSULEDef:
   [DEF initial $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF terminal a $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=o 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=a 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ar 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=arrType 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct string=loop 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct symbol=o ]
      
      [Node list symbol=construct symbol=ar ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleOpen objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3869617 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3869617 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat symbol=arrowName 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleClosed objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3869618 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=- symbol=next 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3869618 symbol=noBranch 
        
         [Node list symbol=LET symbol=next 
         
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3869619 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3869619 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat symbol=arrowName 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF unit objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=a 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=obn symbol=obn 
       
        [Node list symbol=concat symbol=arrowName 
        
         [Node list symbol=string symbol=arn ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=LET symbol=ars 
      
       [Node list symbol=concat symbol=ars symbol=a ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=arn 
       
        [Node list symbol=+ symbol=arn 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF kgraph objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=obm 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=objs ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3869620 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=obn symbol=obm ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3869620 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=a 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=name 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=: symbol=arrType 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=fromOb 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=toOb 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=xOffset 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=: symbol=yOffset 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=: symbol=map 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=construct symbol=obn symbol=obm 
             
              [Node list symbol=concat symbol=arrowName 
              
               [Node list symbol=string symbol=arn ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=construct ]
              ]
             ]
            
            [Node list symbol=LET symbol=ars 
            
             [Node list symbol=concat symbol=ars symbol=a ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=arn 
             
              [Node list symbol=+ symbol=arn 
              
               [Node list symbol=One ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF + a b $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lo 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat 
     
      [Node list symbol=a symbol=objects ]
      
      [Node list symbol=b symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bStart 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lb 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ba 
     
      [Node list symbol=b symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=ba symbol=name ]
        
        [Node list symbol=ba symbol=arrType ]
        
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=fromOb ]
         ]
        
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=toOb ]
         ]
        
        [Node list symbol=ba symbol=xOffset ]
        
        [Node list symbol=ba symbol=yOffset ]
        
        [Node list symbol=ba symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lb 
       
        [Node list symbol=lb symbol=arr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=lb 
     
      [Node list symbol=a symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=lo symbol=la ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF merge a b $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bmap 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT symbol=x 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newIndex 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET mergedObjects
    [Node list symbol=LET symbol=mergedObjects 
    
     [Node list symbol=a symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=bob 
     
      [Node list symbol=b symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=position symbol=bob 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol=< symbol=i 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=mergedObjects 
         
          [Node list symbol=concat symbol=mergedObjects symbol=bob ]
          ]
         
         [Node list symbol=LET symbol=newIndex 
         
          [Node list symbol=+ symbol=newIndex 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=bmap 
          
           [Node list symbol=concat symbol=bmap symbol=newIndex ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=bmap 
        
         [Node list symbol=concat symbol=bmap 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bStart 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lb 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ba 
     
      [Node list symbol=b symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=toI 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=bmap 
       
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=toOb ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromI 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=bmap 
       
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=fromOb ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=fromI symbol=toI 
       
        [Node list symbol=ba symbol=name ]
        
        [Node list symbol=ba symbol=arrType ]
        
        [Node list symbol=ba symbol=xOffset ]
        
        [Node list symbol=ba symbol=yOffset ]
        
        [Node list symbol=ba symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lb 
       
        [Node list symbol=lb symbol=arr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=lb 
     
      [Node list symbol=a symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=mergedObjects symbol=la ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF objProd a b $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value 
        
         [Node list symbol=Product symbol=S symbol=S ]
         ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=widtha 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramWidth symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=heighta 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramHeight symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp 
          
           [Node list symbol=Product symbol=S symbol=S ]
           ]
          
          [Node list symbol=ai symbol=bi 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=Product symbol=S symbol=S ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value 
            
             [Node list symbol=Product symbol=S symbol=S ]
             ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newObjs
    [Node list symbol=exit int=1 symbol=newObjs ]
    
   ]
   
  CAPSULEDef:
   [DEF indexProd aObj a b $ + a
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= *
    [Node list symbol=* 
    
     [Node list symbol=:: 
     
      [Node list symbol=- 
      
       [Node list symbol=:: symbol=b 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=aObj symbol=objects ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * a b $ $ SEQ
   DEFSubnode:atts= UndirectedGraph
    [Node list symbol=UndirectedGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3869621 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3869621 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3869622 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3869622 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=an 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=* 
                 
                  [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                  
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=arr 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=name 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=: symbol=arrType 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=fromOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=toOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=xOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=yOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=map 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=construct symbol=an 
                
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=construct ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=newArrs 
                
                 [Node list symbol=newArrs symbol=arr 
                 
                  [Node list symbol=Sel symbol=concat 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=name 
                     
                      [Node list symbol=String ]
                      ]
                     
                     [Node list symbol=: symbol=arrType 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=fromOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=toOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=xOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=yOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=map 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newArrs 
     
      [Node list symbol=Sel symbol=undirectedGraph 
      
       [Node list symbol=UndirectedGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      
      [Node list symbol=objProd symbol=a symbol=b ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cartesian a b $ $ SEQ
   DEFSubnode:atts= UndirectedGraph
    [Node list symbol=UndirectedGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=bu symbol=bv ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3869623 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3869623 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=an 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol== symbol=bu symbol=bv ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3869624 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3869624 
                 
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                    
                    [Node list symbol=string symbol=bv ]
                    ]
                   ]
                  
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                    
                    [Node list symbol=string symbol=av ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=concat 
               
                [Node list symbol=construct string=# 
                
                 [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                 
                 [Node list symbol=string symbol=av ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=arr 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=name 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=: symbol=arrType 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=fromOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=toOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=xOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=yOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=map 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=construct symbol=an 
              
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
               
               [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=newArrs 
              
               [Node list symbol=newArrs symbol=arr 
               
                [Node list symbol=Sel symbol=concat 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=name 
                   
                    [Node list symbol=String ]
                    ]
                   
                   [Node list symbol=: symbol=arrType 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=fromOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=toOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=xOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=yOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=map 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=au symbol=av ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G3869625 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G3869625 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=an 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=bu symbol=bv ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G3869624 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G3869624 
                     
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                        
                        [Node list symbol=string symbol=bv ]
                        ]
                       ]
                      
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                        
                        [Node list symbol=string symbol=av ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=arr 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=construct symbol=an 
                  
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=construct ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newArrs 
                  
                   [Node list symbol=newArrs symbol=arr 
                   
                    [Node list symbol=Sel symbol=concat 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=name 
                       
                        [Node list symbol=String ]
                        ]
                       
                       [Node list symbol=: symbol=arrType 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=fromOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=toOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=xOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=yOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=map 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol== symbol=au symbol=av ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G3869626 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G3869626 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=an 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=bu symbol=bv ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G3869624 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G3869624 
                  
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                     
                     [Node list symbol=string symbol=bv ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=# 
                 
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  
                  [Node list symbol=string symbol=av ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=arr 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=name 
                 
                  [Node list symbol=String ]
                  ]
                 
                 [Node list symbol=: symbol=arrType 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=fromOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=toOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=xOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=yOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=map 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=an 
               
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                
                [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=construct ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newArrs 
               
                [Node list symbol=newArrs symbol=arr 
                
                 [Node list symbol=Sel symbol=concat 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newArrs 
     
      [Node list symbol=Sel symbol=undirectedGraph 
      
       [Node list symbol=UndirectedGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      
      [Node list symbol=objProd symbol=a symbol=b ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedObjProd a b f $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=widtha 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramWidth symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=heighta 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramHeight symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp symbol=S ]
          
          [Node list symbol=f symbol=ai symbol=bi ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value symbol=S ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newObjs
    [Node list symbol=exit int=1 symbol=newObjs ]
    
   ]
   
  CAPSULEDef:
   [DEF closedTensor a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3869627 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3869627 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3869628 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3869628 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=an 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=* 
                 
                  [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                  
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=arr 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=name 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=: symbol=arrType 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=fromOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=toOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=xOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=yOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=map 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=construct symbol=an 
                
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=construct ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=newArrs 
                
                 [Node list symbol=newArrs symbol=arr 
                 
                  [Node list symbol=Sel symbol=concat 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=name 
                     
                      [Node list symbol=String ]
                      ]
                     
                     [Node list symbol=: symbol=arrType 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=fromOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=toOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=xOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=yOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=map 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=undirectedGraph symbol=newArrs 
     
      [Node list symbol=closedObjProd symbol=a symbol=b symbol=f ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedCartesian a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=bu symbol=bv ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3869629 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3869629 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=an 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol== symbol=bu symbol=bv ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3869630 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3869630 
                 
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                    
                    [Node list symbol=string symbol=bv ]
                    ]
                   ]
                  
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                    
                    [Node list symbol=string symbol=av ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=concat 
               
                [Node list symbol=construct string=# 
                
                 [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                 
                 [Node list symbol=string symbol=av ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=arr 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=name 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=: symbol=arrType 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=fromOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=toOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=xOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=yOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=map 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=construct symbol=an 
              
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
               
               [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=newArrs 
              
               [Node list symbol=newArrs symbol=arr 
               
                [Node list symbol=Sel symbol=concat 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=name 
                   
                    [Node list symbol=String ]
                    ]
                   
                   [Node list symbol=: symbol=arrType 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=fromOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=toOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=xOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=yOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=map 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=au symbol=av ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G3869631 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G3869631 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=an 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=bu symbol=bv ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G3869630 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G3869630 
                     
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                        
                        [Node list symbol=string symbol=bv ]
                        ]
                       ]
                      
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                        
                        [Node list symbol=string symbol=av ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=arr 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=construct symbol=an 
                  
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=construct ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newArrs 
                  
                   [Node list symbol=newArrs symbol=arr 
                   
                    [Node list symbol=Sel symbol=concat 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=name 
                       
                        [Node list symbol=String ]
                        ]
                       
                       [Node list symbol=: symbol=arrType 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=fromOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=toOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=xOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=yOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=map 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol== symbol=au symbol=av ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G3869632 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G3869632 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=an 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=bu symbol=bv ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G3869630 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G3869630 
                  
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                     
                     [Node list symbol=string symbol=bv ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=# 
                 
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  
                  [Node list symbol=string symbol=av ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=arr 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=name 
                 
                  [Node list symbol=String ]
                  ]
                 
                 [Node list symbol=: symbol=arrType 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=fromOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=toOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=xOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=yOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=map 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=an 
               
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                
                [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=construct ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newArrs 
               
                [Node list symbol=newArrs symbol=arr 
                
                 [Node list symbol=Sel symbol=concat 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=arrType 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=undirectedGraph symbol=newArrs 
     
      [Node list symbol=closedObjProd symbol=a symbol=b symbol=f ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF map s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=i 
      
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: 
        
         [Node list symbol=newObjs symbol=i ]
         
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=value symbol=S ]
          
          [Node list symbol=: symbol=posX 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=posY 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=value 
         
          [Node list symbol=newObjs symbol=i ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetX 
          
           [Node list symbol=posX 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetY 
          
           [Node list symbol=posY 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oldArrow 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newArr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=oldArrow symbol=name ]
        
        [Node list symbol=oldArrow symbol=arrType ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=fromOb ]
         ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=toOb ]
         ]
        
        [Node list symbol=oldArrow symbol=xOffset ]
        
        [Node list symbol=oldArrow symbol=yOffset ]
        
        [Node list symbol=oldArrow symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newArrs 
       
        [Node list symbol=concat symbol=newArrs symbol=newArr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mapContra s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=i 
      
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: 
        
         [Node list symbol=newObjs symbol=i ]
         
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=value symbol=S ]
          
          [Node list symbol=: symbol=posX 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=posY 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=value 
         
          [Node list symbol=newObjs symbol=i ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetX 
          
           [Node list symbol=posX 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetY 
          
           [Node list symbol=posY 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oldArrow 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newArr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=oldArrow symbol=name ]
        
        [Node list symbol=oldArrow symbol=arrType ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=toOb ]
         ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=fromOb ]
         ]
        
        [Node list symbol=oldArrow symbol=xOffset ]
        
        [Node list symbol=oldArrow symbol=yOffset ]
        
        [Node list symbol=oldArrow symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newArrs 
       
        [Node list symbol=concat symbol=newArrs symbol=newArr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce poset $ undirectedGraph poset
   DEFSubnode:atts= FinitePoset S
    [Node list symbol=FinitePoset symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce n $ SEQ
   DEFSubnode:atts= OutputForm
    [Node list symbol=OutputForm ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET vertices
    [Node list symbol=LET symbol=vertices 
    
     [Node list symbol=message string=Vertices:  ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lv 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=getVertices symbol=n ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lvof 
     
      [Node list symbol=List 
      
       [Node list symbol=OutputForm ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=v symbol=lv ]
      
      [Node list symbol=:: 
      
       [Node list symbol=v symbol=value ]
       
       [Node list symbol=OutputForm ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET vertices
    [Node list symbol=LET symbol=vertices 
    
     [Node list symbol=hconcat symbol=vertices 
     
      [Node list symbol=commaSeparate symbol=lvof ]
      ]
     ]
    
   DEFSubnode:atts= LET arrows
    [Node list symbol=LET symbol=arrows 
    
     [Node list symbol=message string=Edges:  ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=getArrows symbol=n ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3869633 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=la ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3869633 symbol=noBranch 
      
       [Node list symbol=return symbol=vertices ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=laof 
     
      [Node list symbol=List 
      
       [Node list symbol=OutputForm ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=ar symbol=la ]
      
      [Node list symbol=hconcat 
      
       [Node list symbol=construct 
       
        [Node list symbol=:: 
        
         [Node list symbol=ar symbol=fromOb ]
         
         [Node list symbol=OutputForm ]
         ]
        
        [Node list symbol=message string=- ]
        
        [Node list symbol=:: 
        
         [Node list symbol=ar symbol=toOb ]
         
         [Node list symbol=OutputForm ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET arrows
    [Node list symbol=LET symbol=arrows 
    
     [Node list symbol=hconcat symbol=arrows 
     
      [Node list symbol=commaSeparate symbol=laof ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=pile 
     
      [Node list symbol=construct symbol=vertices symbol=arrows ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF subdiagramSvg sc n dispArrowName deep $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= Scene
    [Node list symbol=Scene 
    
     [Node list symbol=SCartesian int=2 ]
     ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET mt
    [Node list symbol=LET symbol=mt 
    
     [Node list symbol=sc string=black string=black 
     
      [Node list symbol=Sel symbol=addSceneMaterial 
      
       [Node list symbol=Scene 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       ]
      
      [Node list symbol=:: int=3 
      
       [Node list symbol=DoubleFloat ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ls 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=getVertices symbol=n ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=indexPointx 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=indexPointy 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=indexBounds 
     
      [Node list symbol=List 
      
       [Node list symbol=Scene 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=indexNodes 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i symbol=ls ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=indexNodes 
      
       [Node list symbol=concat symbol=indexNodes 
       
        [Node list symbol=i symbol=value ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=s 
       
        [Node list symbol=String ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=Lisp symbol=mathObject2String ]
        
        [Node list symbol=i symbol=value ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=x 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=i symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=y 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=i symbol=posY ]
       ]
      
      [Node list symbol=LET symbol=indexPointx 
      
       [Node list symbol=concat symbol=indexPointx symbol=x ]
       ]
      
      [Node list symbol=LET symbol=indexPointy 
      
       [Node list symbol=concat symbol=indexPointy symbol=y ]
       ]
      
      [Node list symbol=LET symbol=tn 
      
       [Node list symbol=sc symbol=s 
       
        [Node list symbol=Sel symbol=addSceneText 
        
         [Node list symbol=Scene 
         
          [Node list symbol=SCartesian int=2 ]
          ]
         ]
        
        [Node list symbol=:: int=32 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=x symbol=y 
        
         [Node list symbol=Sel symbol=sipnt 
         
          [Node list symbol=SCartesian int=2 ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=indexBounds 
       
        [Node list symbol=concat symbol=indexBounds symbol=tn ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=getArrows symbol=n ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3869634 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=empty? symbol=arrs ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3869634 symbol=noBranch 
      
       [Node list symbol=return symbol=void ]
       ]
      ]
     ]
    
   DEFSubnode:atts= MDEF
    [Node list symbol=MDEF 
    
     [Node list symbol=IOBJT ]
     
     [Node list 
     
      [Node list ]
      ]
     
     [Node list 
     
      [Node list ]
      ]
     
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value 
      
       [Node list symbol=DirectedGraph 
       
        [Node list symbol=String ]
        ]
       ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=innerOb 
     
      [Node list symbol=List 
      
       [Node list symbol=List symbol=IOBJT ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=arrow symbol=arrs ]
     
     [Node list symbol=IN symbol=arrn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=arrs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=indexPointx 
       
        [Node list symbol=arrow symbol=fromOb ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=toX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=indexPointx 
       
        [Node list symbol=arrow symbol=toOb ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=indexPointy 
       
        [Node list symbol=arrow symbol=fromOb ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=toY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=indexPointy 
       
        [Node list symbol=arrow symbol=toOb ]
        ]
       ]
      
      [Node list symbol=LET symbol=fromX 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=fromX 
        
         [Node list symbol=arrow symbol=xOffset ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=toX 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=toX 
        
         [Node list symbol=arrow symbol=xOffset ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=fromY 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=fromY 
        
         [Node list symbol=arrow symbol=yOffset ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=toY 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=toY 
        
         [Node list symbol=arrow symbol=yOffset ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=midX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=shift 
       
        [Node list symbol=+ symbol=toX symbol=fromX ]
        
        [Node list symbol=- 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=midY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=shift 
       
        [Node list symbol=+ symbol=toY symbol=fromY ]
        
        [Node list symbol=- 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arrIndex 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=arrowsToNode symbol=n 
       
        [Node list symbol=arrow symbol=fromOb ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arrNumber 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=position symbol=arrn symbol=arrIndex ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=rema 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=remainder 
       
        [Node list symbol=divide symbol=arrNumber int=8 ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fnode 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=indexBounds 
       
        [Node list symbol=arrow symbol=fromOb ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=tnode 
       
        [Node list symbol=Scene 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        ]
       
       [Node list symbol=indexBounds 
       
        [Node list symbol=arrow symbol=toOb ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=offset 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       
       [Node list 
       
        [Node list symbol=Sel symbol=sipnt 
        
         [Node list symbol=SCartesian int=2 ]
         ]
        
        [Node list symbol=arrow symbol=xOffset ]
        
        [Node list symbol=arrow symbol=yOffset ]
        ]
       ]
      
      [Node list symbol=LET symbol=arrNode 
      
       [Node list symbol=addSceneLine symbol=mt symbol=fnode symbol=tnode symbol=deep 
       
        [Node list symbol=:: 
        
         [Node list symbol=+ int=10 
         
          [Node list symbol=diagramWidth symbol=n ]
          ]
         
         [Node list symbol=DoubleFloat ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=dispArrowName symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=s 
          
           [Node list symbol=String ]
           ]
          
          [Node list symbol=arrow symbol=name ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=mt symbol=s 
          
           [Node list symbol=Sel symbol=addSceneText 
           
            [Node list symbol=Scene 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            ]
           
           [Node list symbol=:: int=32 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=midX symbol=midY 
           
            [Node list symbol=Sel symbol=sipnt 
            
             [Node list symbol=SCartesian int=2 ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=return symbol=void ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF diagramSvg fileName n dispArrowName $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET view
    [Node list symbol=LET symbol=view 
    
     [Node list 
     
      [Node list symbol=Sel symbol=boxBoundary 
      
       [Node list symbol=SBoundary 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=sipnt 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       
       [Node list symbol=Zero ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=sipnt 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=diagramWidth symbol=n ]
        
        [Node list symbol=:: int=10 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=diagramHeight symbol=n ]
        
        [Node list symbol=:: int=10 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET sc
    [Node list symbol=LET symbol=sc 
    
     [Node list symbol=view 
     
      [Node list symbol=Sel symbol=createSceneRoot 
      
       [Node list symbol=Scene 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= subdiagramSvg sc n dispArrowName true
    [Node list symbol=subdiagramSvg symbol=sc symbol=n symbol=dispArrowName symbol=true ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=writeSvgQuantised symbol=sc symbol=fileName ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF diagramSvg2 fileName n dispArrowName $ SEQ
   DEFSubnode:atts= Void
    [Node list symbol=Void ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET view
    [Node list symbol=LET symbol=view 
    
     [Node list 
     
      [Node list symbol=Sel symbol=boxBoundary 
      
       [Node list symbol=SBoundary 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=sipnt 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       
       [Node list symbol=Zero ]
       
       [Node list symbol=Zero ]
       ]
      
      [Node list 
      
       [Node list symbol=Sel symbol=sipnt 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=diagramWidth symbol=n ]
        
        [Node list symbol=:: int=10 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=+ 
       
        [Node list symbol=diagramHeight symbol=n ]
        
        [Node list symbol=:: int=10 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET sc
    [Node list symbol=LET symbol=sc 
    
     [Node list symbol=view 
     
      [Node list symbol=Sel symbol=createSceneRoot 
      
       [Node list symbol=Scene 
       
        [Node list symbol=SCartesian int=2 ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= subdiagramSvg sc n dispArrowName false
    [Node list symbol=subdiagramSvg symbol=sc symbol=n symbol=dispArrowName symbol=false ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=writeSvgQuantised symbol=sc symbol=fileName ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=FiniteGraph symbol=S ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=undirectedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=undirectedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=undirectedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=undirectedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=undirectedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=FinitePoset symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=undirectedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=UndirectedGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=cartesian 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=UndirectedGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedTensor 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedCartesian 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=diagramSvg2 
    
     [Node list symbol=$ 
     
      [Node list symbol=Void ]
      
      [Node list symbol=String ]
      
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=FinitePoset symbol=S ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= SetCategory
  [Node list symbol=SetCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF MultifunctionGraph S
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=objects 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEOther:
   [Node list symbol=MDEF 
   
    [Node list symbol=math_to_string ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list 
    
     [Node list ]
     ]
    
    [Node list symbol=Sel symbol=Lisp symbol=mathObject2String ]
    ]
   
  CAPSULEDef:
   [DEF multifunctionGraph ob $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x symbol=ob ]
      
      [Node list symbol=construct symbol=x 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=:: 
        
         [Node list symbol=One ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=objs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF multifunctionGraph ob $ construct ob
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=next 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF multifunctionGraph ob ar $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arrs 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=ob ]
        ]
       ]
      
      [Node list symbol=:: symbol=x 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a symbol=ar ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromo 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=a symbol=fromOb ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=too 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=a symbol=toOb ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=too 
       
        [Node list symbol=arrs symbol=fromo ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=fobs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=f symbol=ob ]
     
     [Node list symbol=IN symbol=fn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=ob ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fo 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=f symbol=value ]
        
        [Node list symbol=f symbol=posX ]
        
        [Node list symbol=f symbol=posY ]
        
        [Node list symbol=construct 
        
         [Node list symbol=arrs symbol=fn ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=fobs 
       
        [Node list symbol=concat symbol=fobs symbol=fo ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=fobs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF multifunctionGraph objs am $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=fobs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=f symbol=obs ]
     
     [Node list symbol=IN symbol=fn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fo 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=f symbol=value ]
        
        [Node list symbol=f symbol=posX ]
        
        [Node list symbol=f symbol=posY ]
        
        [Node list symbol=construct 
        
         [Node list symbol=am symbol=fn ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=fobs 
       
        [Node list symbol=concat symbol=fobs symbol=fo ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=fobs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF multifunctionGraph perms $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=perm symbol=perms ]
     
     [Node list symbol=IN symbol=px 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=perms ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=lr 
      
       [Node list symbol=listRepresentation symbol=perm ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=im 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=image ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=preim 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=preimage ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol== symbol=px 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=LET symbol=obs symbol=im ]
        
        [Node list symbol=REPEAT 
        
         [Node list symbol=IN symbol=v symbol=im ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3871114 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=< 
           
            [Node list symbol=position symbol=v symbol=obs ]
            
            [Node list symbol=One ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3871114 symbol=noBranch 
           
            [Node list symbol=LET symbol=obs 
            
             [Node list symbol=concat symbol=obs symbol=v ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=tab 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=b 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=obs ]
        ]
       ]
      
      [Node list symbol=COLLECT symbol=b 
      
       [Node list symbol=IN symbol=a 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# symbol=perms ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=perm symbol=perms ]
     
     [Node list symbol=IN symbol=pi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=perms ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=lr 
      
       [Node list symbol=listRepresentation symbol=perm ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=im 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=image ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=preim 
       
        [Node list symbol=List symbol=S ]
        ]
       
       [Node list symbol=lr symbol=preimage ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=pt 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=im ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=pin 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=obs 
          
           [Node list symbol=Sel symbol=position 
           
            [Node list symbol=List symbol=S ]
            ]
           
           [Node list symbol=im symbol=pt ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=pout 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=obs 
          
           [Node list symbol=Sel symbol=position 
           
            [Node list symbol=List symbol=S ]
            ]
           
           [Node list symbol=preim symbol=pt ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET 
          
           [Node list symbol=pi 
           
            [Node list symbol=tab 
            
             [Node list symbol=:: symbol=pin 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           
           [Node list symbol=:: symbol=pout 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=verts 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=vert symbol=obs ]
     
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=vert 
       
        [Node list symbol=createX symbol=i 
        
         [Node list symbol=# symbol=obs ]
         ]
        
        [Node list symbol=createY symbol=i 
        
         [Node list symbol=# symbol=obs ]
         ]
        
        [Node list symbol=tab symbol=i ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=verts 
       
        [Node list symbol=concat symbol=verts symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=verts ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obj 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=next 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=n 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=# symbol=obs ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=obj ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=obj ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=value symbol=S ]
     
     [Node list symbol=: symbol=posX 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=posY 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error this form of addObject! not supported in multifunctionGraph
    [Node list symbol=error string=this form of addObject! not supported in multifunctionGraph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 $ $ SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET n2
    [Node list symbol=LET symbol=n2 
    
     [Node list 
     
      [Node list symbol=next 
      
       [Node list symbol=n1 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      
      [Node list symbol=One ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF getVertices s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=soj 
     
      [Node list symbol=s symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=soj symbol=value ]
        
        [Node list symbol=soj symbol=posX ]
        
        [Node list symbol=soj symbol=posY ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=concat symbol=res symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF getArrows s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=sojn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=soj 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=sojn 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=ar 
        
         [Node list symbol=soj symbol=next ]
         ]
        
        [Node list symbol=IN symbol=ai 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=soj symbol=next ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=arrType 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sojn symbol=ar 
          
           [Node list symbol=concat 
           
            [Node list symbol=string symbol=sojn ]
            
            [Node list symbol=string symbol=ai ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=Zero ]
           
           [Node list symbol=Zero ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=res 
          
           [Node list symbol=concat symbol=res symbol=a ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF initial $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF terminal a $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=o 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=next 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=a 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=:: 
       
        [Node list symbol=One ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct symbol=o ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleOpen objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=n 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3871115 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3871115 symbol=noBranch 
        
         [Node list symbol=LET symbol=n 
         
          [Node list symbol=# symbol=objs ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=construct symbol=n ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleClosed objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=n 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3871116 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3871116 symbol=noBranch 
        
         [Node list symbol=LET symbol=n 
         
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=construct symbol=n ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF unit objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=objs symbol=x ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=:: symbol=x 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=objs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF kgraph objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error kgraph not valid in function graph
    [Node list symbol=error string=kgraph not valid in function graph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF + a b $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=b symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=c 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=construct 
      
       [Node list symbol=value 
       
        [Node list symbol=objs symbol=x ]
        ]
       
       [Node list symbol=posX 
       
        [Node list symbol=objs symbol=x ]
        ]
       
       [Node list symbol=posY 
       
        [Node list symbol=objs symbol=x ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=+ 
        
         [Node list symbol=:: symbol=x 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=# 
         
          [Node list symbol=a symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=concat symbol=c 
      
       [Node list symbol=a symbol=objects ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF merge a b $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error merge not valid in function graph
    [Node list symbol=error string=merge not valid in function graph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF indexProd aObj a b $ + a
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= *
    [Node list symbol=* 
    
     [Node list symbol=:: 
     
      [Node list symbol=- 
      
       [Node list symbol=:: symbol=b 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=aObj symbol=objects ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF tensorNext aObj a b $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3871117 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=# symbol=a ]
       
       [Node list symbol=# symbol=b ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3871117 symbol=noBranch 
      
       [Node list symbol=error 
       
        [Node list 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=construct string=tensor product with different degree a= string= b= 
         
          [Node list symbol=math_to_string symbol=a ]
          
          [Node list symbol=math_to_string symbol=b ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=a ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=b ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET symbol=x 
       
        [Node list symbol=indexProd symbol=aObj 
        
         [Node list symbol=a symbol=i ]
         
         [Node list symbol=b symbol=j ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=LET symbol=res 
        
         [Node list symbol=res symbol=x 
         
          [Node list symbol=Sel symbol=concat 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF cartesianNext aObj a b an bn $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3871118 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= 
      
       [Node list symbol=# symbol=a ]
       
       [Node list symbol=# symbol=b ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3871118 symbol=noBranch 
      
       [Node list symbol=error 
       
        [Node list 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=construct string=Cartesian product with different degree a= string= b= 
         
          [Node list symbol=math_to_string symbol=a ]
          
          [Node list symbol=math_to_string symbol=b ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=a ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=indexProd symbol=aObj symbol=bn 
       
        [Node list symbol=a symbol=i ]
        ]
       ]
      
      [Node list symbol=LET symbol=res 
      
       [Node list symbol=res symbol=x 
       
        [Node list symbol=Sel symbol=concat 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=y 
      
       [Node list symbol=indexProd symbol=aObj symbol=an 
       
        [Node list symbol=b symbol=i ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=res symbol=y 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF * a b $ $ SEQ
   DEFSubnode:atts= MultifunctionGraph
    [Node list symbol=MultifunctionGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value 
        
         [Node list symbol=Product symbol=S symbol=S ]
         ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ani 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=aoi symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bni 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          
          [Node list symbol=boi symbol=next ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=nextA 
         
          [Node list symbol=tensorNext symbol=b symbol=bni symbol=ani ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp 
          
           [Node list symbol=Product symbol=S symbol=S ]
           ]
          
          [Node list symbol=ai symbol=bi 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=Product symbol=S symbol=S ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value 
            
             [Node list symbol=Product symbol=S symbol=S ]
             ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=next 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y symbol=nextA 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newObjs 
     
      [Node list symbol=Sel symbol=multifunctionGraph 
      
       [Node list symbol=MultifunctionGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cartesian a b $ $ SEQ
   DEFSubnode:atts= MultifunctionGraph
    [Node list symbol=MultifunctionGraph 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value 
        
         [Node list symbol=Product symbol=S symbol=S ]
         ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aptr 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ani 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=aoi symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bptr 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=a symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bni 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          
          [Node list symbol=boi symbol=next ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=nextA 
         
          [Node list symbol=cartesianNext symbol=b symbol=bni symbol=ani symbol=bptr symbol=aptr ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp 
          
           [Node list symbol=Product symbol=S symbol=S ]
           ]
          
          [Node list symbol=ai symbol=bi 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=Product symbol=S symbol=S ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value 
            
             [Node list symbol=Product symbol=S symbol=S ]
             ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=next 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y symbol=nextA 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newObjs 
     
      [Node list symbol=Sel symbol=multifunctionGraph 
      
       [Node list symbol=MultifunctionGraph 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedTensor a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ani 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=aoi symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bni 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          
          [Node list symbol=boi symbol=next ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=nextA 
         
          [Node list symbol=tensorNext symbol=b symbol=bni symbol=ani ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp symbol=S ]
          
          [Node list symbol=f symbol=ai symbol=bi ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value symbol=S ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=next 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y symbol=nextA 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=multifunctionGraph symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedCartesian a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aptr 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ani 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=aoi symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bptr 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=a symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bni 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          
          [Node list symbol=boi symbol=next ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=nextA 
         
          [Node list symbol=cartesianNext symbol=b symbol=bni symbol=ani symbol=bptr symbol=aptr ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp symbol=S ]
          
          [Node list symbol=f symbol=ai symbol=bi ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value symbol=S ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=next 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y symbol=nextA 
          
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=multifunctionGraph symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF ~ s SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=s symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=nextA 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=x 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=s symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G3871119 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol== 
         
          [Node list symbol=position symbol=x 
          
           [Node list symbol=aoi symbol=next ]
           ]
          
          [Node list symbol=Zero ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G3871119 symbol=noBranch 
         
          [Node list symbol=LET symbol=nextA 
          
           [Node list symbol=concat symbol=nextA symbol=x ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ob 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=nextA 
       
        [Node list symbol=aoi symbol=value ]
        
        [Node list symbol=aoi symbol=posX ]
        
        [Node list symbol=aoi symbol=posY ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newObjs 
       
        [Node list symbol=concat symbol=newObjs symbol=ob ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF map s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=oldObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=oldObjs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=oldObj 
      
       [Node list symbol=oldObjs symbol=oi ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=LET symbol=newObj 
      
       [Node list symbol=newOb symbol=i ]
       ]
      
      [Node list symbol=LET symbol=newX 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetX 
        
         [Node list symbol=oldObj symbol=posX ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=newY 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetY 
        
         [Node list symbol=oldObj symbol=posY ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newNext 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=n 
       
        [Node list symbol=oldObj symbol=next ]
        ]
       
       [Node list symbol=LET symbol=newNext 
       
        [Node list symbol=concat symbol=newNext 
        
         [Node list symbol=m symbol=n ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=nv 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=newObj symbol=newX symbol=newY symbol=newNext 
       
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=nv 
       
        [Node list symbol=newObjs symbol=i ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mapContra s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=construct ]
       
       [Node list symbol=construct ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=oldObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=oldObjs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=oldObj 
      
       [Node list symbol=oldObjs symbol=oi ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=LET symbol=newObj 
      
       [Node list symbol=newOb symbol=i ]
       ]
      
      [Node list symbol=LET symbol=newX 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetX 
        
         [Node list symbol=oldObj symbol=posX ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET symbol=newY 
      
       [Node list symbol=:: 
       
        [Node list symbol=+ symbol=offsetY 
        
         [Node list symbol=oldObj symbol=posY ]
         ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newNext 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=construct ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=n 
       
        [Node list symbol=oldObj symbol=next ]
        ]
       
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=incoming 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=nodeToNode symbol=s 
         
          [Node list symbol=m symbol=n ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=newNext 
         
          [Node list symbol=concat symbol=newNext symbol=incoming ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=nv 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=next 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=newObj symbol=newX symbol=newY symbol=newNext 
       
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=nv 
       
        [Node list symbol=newObjs symbol=i ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coAdjoint s m $ SEQ
   DEFSubnode:atts= Union failed
    [Node list symbol=Union string=failed 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=domainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=s symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=codomainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi symbol=m ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=> symbol=mi symbol=codomainSize ]
      
      [Node list symbol=LET symbol=codomainSize symbol=mi ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ret 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=retOpt 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=m ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=retOpt 
      
       [Node list symbol=m symbol=mi ]
       ]
      
      [Node list symbol=concat symbol=mi 
      
       [Node list symbol=retOpt 
       
        [Node list symbol=m symbol=mi ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=entry 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ri symbol=retOpt ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=max symbol=s symbol=ri ]
       ]
      
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol== symbol=x 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=return string=failed ]
       ]
      
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=ret symbol=entry ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=entry 
       
        [Node list symbol=+ symbol=entry 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 ret
    [Node list symbol=exit int=1 symbol=ret ]
    
   ]
   
  CAPSULEDef:
   [DEF contraAdjoint s m $ SEQ
   DEFSubnode:atts= Union failed
    [Node list symbol=Union string=failed 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=domainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=s symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=codomainSize 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi symbol=m ]
     
     [Node list symbol=IF symbol=noBranch 
     
      [Node list symbol=> symbol=mi symbol=codomainSize ]
      
      [Node list symbol=LET symbol=codomainSize symbol=mi ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ret 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=retOpt 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT symbol=codomainSize 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=mi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=m ]
       ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=retOpt 
      
       [Node list symbol=m symbol=mi ]
       ]
      
      [Node list symbol=concat symbol=mi 
      
       [Node list symbol=retOpt 
       
        [Node list symbol=m symbol=mi ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=entry 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=One ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ri symbol=retOpt ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=min symbol=s symbol=ri ]
       ]
      
      [Node list symbol=IF symbol=noBranch 
      
       [Node list symbol== symbol=x 
       
        [Node list symbol=Zero ]
        ]
       
       [Node list symbol=return string=failed ]
       ]
      
      [Node list symbol=LET symbol=x 
      
       [Node list symbol=ret symbol=entry ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=entry 
       
        [Node list symbol=+ symbol=entry 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 ret
    [Node list symbol=exit int=1 symbol=ret ]
    
   ]
   
  CAPSULEDef:
   [DEF apply s a m $ m
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= next
    [Node list symbol=next 
    
     [Node list symbol=a 
     
      [Node list symbol=s symbol=objects ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF limit s a m $ SEQ
   DEFSubnode:atts= Loop
    [Node list symbol=Loop ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET ptr a
    [Node list symbol=LET symbol=ptr symbol=a ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=s1 
     
      [Node list symbol=s symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=lp 
       
        [Node list symbol=List 
        
         [Node list symbol=Loop ]
         ]
        ]
       
       [Node list symbol=loopsAtNode symbol=s symbol=ptr ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3871120 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=> 
        
         [Node list symbol=# symbol=lp ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3871120 symbol=noBranch 
        
         [Node list symbol=error string=limit: cant have >1 loop through node ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3871121 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=# symbol=lp ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3871121 symbol=noBranch 
        
         [Node list symbol=return 
         
          [Node list symbol=first symbol=lp ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=ptr 
       
        [Node list symbol=apply symbol=s symbol=ptr symbol=m ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=loop 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce pg $ multifunctionGraph
   DEFSubnode:atts= PermutationGroup S
    [Node list symbol=PermutationGroup symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= :: pg
    [Node list symbol=:: symbol=pg 
    
     [Node list symbol=List 
     
      [Node list symbol=Permutation symbol=S ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF permIndex entry lps2 SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= Permutation S
    [Node list symbol=Permutation symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=dimen 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# symbol=lps2 ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resu 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=dimen 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=e2 
       
        [Node list symbol=Permutation symbol=S ]
        ]
       
       [Node list symbol=lps2 symbol=i ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=noBranch 
       
        [Node list symbol== symbol=entry symbol=e2 ]
        
        [Node list symbol=LET symbol=resu 
        
         [Node list symbol=:: symbol=i 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 resu
    [Node list symbol=exit int=1 symbol=resu ]
    
   ]
   
  CAPSULEDef:
   [DEF generateNewPerms gens2 stngs permutationNames SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=prm 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     
     [Node list symbol=: symbol=nam 
     
      [Node list symbol=List 
      
       [Node list symbol=String ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=String ]
     ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=dimen 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# symbol=gens2 ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resu 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=resstr 
     
      [Node list symbol=List 
      
       [Node list symbol=String ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT symbol=dimen 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT symbol=dimen 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=p 
        
         [Node list symbol=Permutation symbol=S ]
         ]
        
        [Node list symbol=* 
        
         [Node list symbol=gens2 symbol=i ]
         
         [Node list symbol=gens2 symbol=j ]
         ]
        ]
       
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=foundNew 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3871122 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=member? symbol=p symbol=gens2 ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3871122 symbol=false 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3871123 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=member? symbol=p symbol=resu ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3871123 symbol=false symbol=true ]
             ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=foundNew symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET symbol=resu 
          
           [Node list symbol=concat symbol=resu symbol=p ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=permutationNames 
           
            [Node list symbol=LET symbol=resstr 
            
             [Node list symbol=concat symbol=resstr 
             
              [Node list symbol=@ 
              
               [Node list symbol=math_to_string symbol=p ]
               
               [Node list symbol=String ]
               ]
              ]
             ]
            
            [Node list symbol=LET symbol=resstr 
            
             [Node list symbol=concat symbol=resstr 
             
              [Node list symbol=concat 
              
               [Node list symbol=stngs symbol=i ]
               
               [Node list symbol=stngs symbol=j ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=resu symbol=resstr ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF generateName n SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET 96
    [Node list symbol=LET int=96 
    
     [Node list symbol=: symbol=ascii 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=> symbol=n int=8 ]
     
     [Node list symbol=LET symbol=ascii int=97 ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=:: 
     
      [Node list 
      
       [Node list symbol=Sel symbol=char 
       
        [Node list symbol=Character ]
        ]
       
       [Node list symbol=+ symbol=ascii symbol=n ]
       ]
      
      [Node list symbol=String ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF generateNames n IF
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=String ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= = n
    [Node list symbol== symbol=n 
    
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= construct 0
    [Node list symbol=construct string=0 ]
    
   DEFSubnode:atts= COLLECT
    [Node list symbol=COLLECT 
    
     [Node list symbol=IN symbol=ptr2 
     
      [Node list symbol=SEGMENT symbol=n 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=generateName symbol=ptr2 ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF generateNamesCycle g SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=String ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=s1 
     
      [Node list symbol=String ]
      ]
     
     [Node list symbol=@ 
     
      [Node list symbol=math_to_string 
      
       [Node list symbol=Sel 
       
        [Node list symbol=Permutation symbol=S ]
        
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=String ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=s2 
     
      [Node list symbol=List 
      
       [Node list symbol=String ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=ptr2 symbol=g ]
      
      [Node list symbol=@ 
      
       [Node list symbol=math_to_string symbol=ptr2 ]
       
       [Node list symbol=String ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=concat symbol=s1 symbol=s2 ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF toCayleyGraph permList permutationNames SEQ
   DEFSubnode:atts= MultifunctionGraph
    [Node list symbol=MultifunctionGraph 
    
     [Node list symbol=String ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Permutation symbol=S ]
     ]
    
   DEFSubnode:atts= Boolean
    [Node list symbol=Boolean ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET permList
    [Node list symbol=LET symbol=permList 
    
     [Node list symbol=: symbol=elements 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=numGenerators 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# symbol=permList ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=strngs 
     
      [Node list symbol=List 
      
       [Node list symbol=String ]
       ]
      ]
     
     [Node list symbol=generateNames 
     
      [Node list symbol=# symbol=elements ]
      ]
     ]
    
   DEFSubnode:atts= IF permutationNames noBranch
    [Node list symbol=IF symbol=permutationNames symbol=noBranch 
    
     [Node list symbol=LET symbol=strngs 
     
      [Node list symbol=generateNamesCycle symbol=permList ]
      ]
     ]
    
   DEFSubnode:atts= LET true
    [Node list symbol=LET symbol=true 
    
     [Node list symbol=: symbol=contin 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=WHILE symbol=contin ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=resu 
      
       [Node list symbol=generateNewPerms symbol=elements symbol=strngs symbol=permutationNames ]
       ]
      
      [Node list symbol=LET symbol=contin 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=G3871124 
         
          [Node list symbol=Boolean ]
          ]
         
         [Node list symbol=empty? 
         
          [Node list symbol=resu symbol=prm ]
          ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=IF symbol=G3871124 symbol=false symbol=true ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=contin symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=elements 
         
          [Node list symbol=append symbol=elements 
          
           [Node list symbol=resu symbol=prm ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=strngs 
          
           [Node list symbol=append symbol=strngs 
           
            [Node list symbol=resu symbol=nam ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=idPos 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=position symbol=one? symbol=elements ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol=> symbol=idPos 
     
      [Node list symbol=One ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=idPerm 
      
       [Node list symbol=elements symbol=idPos ]
       ]
      
      [Node list symbol=LET symbol=elements 
      
       [Node list symbol=concat symbol=idPerm 
       
        [Node list symbol=delete symbol=elements symbol=idPos ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=strngs 
       
        [Node list symbol=concat string=i 
        
         [Node list symbol=delete symbol=strngs symbol=idPos ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=dimen 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# symbol=elements ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ct 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=dimen 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=SEGMENT symbol=dimen 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=permIndex symbol=elements 
       
        [Node list symbol=* 
        
         [Node list symbol=elements symbol=i ]
         
         [Node list symbol=elements symbol=j ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=gens 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=dimen 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=first symbol=numGenerators 
      
       [Node list symbol=rest 
       
        [Node list symbol=ct symbol=i ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=multifunctionGraph symbol=strngs symbol=gens ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF toCayleyGraph pg SEQ
   DEFSubnode:atts= MultifunctionGraph
    [Node list symbol=MultifunctionGraph 
    
     [Node list symbol=String ]
     ]
    
   DEFSubnode:atts= PermutationGroup S
    [Node list symbol=PermutationGroup symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=perms 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     
     [Node list symbol=generators symbol=pg ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=toCayleyGraph symbol=perms symbol=false ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF toPermutation s $ SEQ
   DEFSubnode:atts= PermutationGroup
    [Node list symbol=PermutationGroup 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lp 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= : preTable
    [Node list symbol=: symbol=preTable 
    
     [Node list symbol=List 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obj symbol=objs ]
     
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newNext 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=obj symbol=next ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=preTable 
       
        [Node list symbol=concat symbol=preTable symbol=newNext ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET numRows
    [Node list symbol=LET symbol=numRows 
    
     [Node list symbol=# symbol=preTable ]
     ]
    
   DEFSubnode:atts= LET numCols
    [Node list symbol=LET symbol=numCols 
    
     [Node list symbol=# 
     
      [Node list symbol=first symbol=preTable ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=cayleyTable 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=i 
      
       [Node list symbol=SEGMENT symbol=numCols 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=COLLECT 
      
       [Node list symbol=IN symbol=j 
       
        [Node list symbol=SEGMENT symbol=numRows 
        
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=i 
       
        [Node list symbol=preTable symbol=j ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET preImgs
    [Node list symbol=LET symbol=preImgs 
    
     [Node list symbol=COLLECT symbol=p 
     
      [Node list symbol=IN symbol=p 
      
       [Node list symbol=SEGMENT symbol=numRows 
       
        [Node list symbol=One ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=cayleyTable ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=imgs 
      
       [Node list symbol=cayleyTable symbol=i ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=p 
       
        [Node list symbol=Permutation 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       
       [Node list symbol=coercePreimagesImages 
       
        [Node list symbol=construct symbol=preImgs symbol=imgs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lp 
       
        [Node list symbol=concat symbol=lp symbol=p ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=permutationGroup symbol=lp ]
     ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=FiniteGraph symbol=S ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=multifunctionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=multifunctionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=next 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=multifunctionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=multifunctionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=multifunctionGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=MultifunctionGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=cartesian 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=MultifunctionGraph 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedTensor 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedCartesian 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coAdjoint 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=contraAdjoint 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union string=failed 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=apply 
    
     [Node list symbol=$ 
     
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=limit 
    
     [Node list symbol=$ 
     
      [Node list symbol=Loop ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=~ 
    
     [Node list symbol=$ symbol=$ ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=PermutationGroup symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=toCayleyGraph 
    
     [Node list 
     
      [Node list symbol=MultifunctionGraph 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Permutation symbol=S ]
       ]
      
      [Node list symbol=Boolean ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=toCayleyGraph 
    
     [Node list 
     
      [Node list symbol=MultifunctionGraph 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=PermutationGroup symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=toPermutation 
    
     [Node list symbol=$ 
     
      [Node list symbol=PermutationGroup 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= SetCategory
  [Node list symbol=SetCategory ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 
 [DEF WeightedGraph S W
 DEFCapsule:
  [CAPSULE CAPSULEOther:
   [Node list symbol=LET symbol=Rep 
   
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=objects 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=: symbol=arrows 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    ]
   
  CAPSULEDef:
   [DEF weightedGraph ob $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=objs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=x symbol=ob ]
      
      [Node list symbol=construct symbol=x 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=Sel symbol=W 
       
        [Node list symbol=Zero ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=objs 
     
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedGraph ob $ construct ob
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=weight symbol=W ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedGraph ob ar $ construct ob ar
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=weight symbol=W ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=weight symbol=W ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedGraph ob ar $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a symbol=ar ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arro 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=a symbol=name ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=a symbol=fromOb ]
        
        [Node list symbol=a symbol=toOb ]
        
        [Node list symbol=a symbol=xOffset ]
        
        [Node list symbol=a symbol=yOffset ]
        
        [Node list symbol=a symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=arrs 
       
        [Node list symbol=concat symbol=arrs symbol=arro ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=fobs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=f symbol=ob ]
     
     [Node list symbol=IN symbol=fn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=ob ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fo 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=f symbol=value ]
        
        [Node list symbol=f symbol=posX ]
        
        [Node list symbol=f symbol=posY ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=fobs 
       
        [Node list symbol=concat symbol=fobs symbol=fo ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=fobs symbol=arrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedGraph obs ars $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET nodes
    [Node list symbol=LET symbol=nodes 
    
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ob symbol=obs ]
     
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=obs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=obs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=obs ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=nodes 
       
        [Node list symbol=concat symbol=nodes symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET edges
    [Node list symbol=LET symbol=edges 
    
     [Node list 
     
      [Node list symbol=Sel symbol=empty 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ar symbol=ars ]
     
     [Node list symbol=IN symbol=arn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=ars ]
       ]
      ]
     
     [Node list symbol=LET symbol=edges 
     
      [Node list symbol=edges 
      
       [Node list symbol=Sel symbol=concat 
       
        [Node list symbol=List 
        
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=name 
          
           [Node list symbol=String ]
           ]
          
          [Node list symbol=: symbol=arrType 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=fromOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=toOb 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=xOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=yOffset 
          
           [Node list symbol=Integer ]
           ]
          
          [Node list symbol=: symbol=map 
          
           [Node list symbol=List 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=concat string=a 
        
         [Node list symbol=string symbol=arn ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=ar symbol=fromOb ]
        
        [Node list symbol=ar symbol=toOb ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=weightedGraph symbol=nodes symbol=edges ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedGraph poset $ SEQ
   DEFSubnode:atts= FinitePoset S
    [Node list symbol=FinitePoset symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List symbol=S ]
      ]
     
     [Node list symbol=poset 
     
      [Node list symbol=Sel symbol=getVert 
      
       [Node list symbol=FinitePoset symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET ars
    [Node list symbol=LET symbol=ars 
    
     [Node list 
     
      [Node list symbol=Sel symbol=construct 
      
       [Node list symbol=List 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=mat 
     
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=Boolean ]
        ]
       ]
      ]
     
     [Node list symbol=poset 
     
      [Node list symbol=Sel symbol=getArr 
      
       [Node list symbol=FinitePoset symbol=S ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=x symbol=mat ]
     
     [Node list symbol=IN symbol=xn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=mat ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=y symbol=x ]
      
      [Node list symbol=IN symbol=yn 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# symbol=x ]
        ]
       ]
      
      [Node list symbol=IF symbol=y symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET 
        
         [Node list symbol=: symbol=z 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=fromOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=: symbol=toOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           ]
          ]
         
         [Node list symbol=construct symbol=xn symbol=yn ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=ars symbol=z 
          
           [Node list symbol=Sel symbol=concat 
           
            [Node list symbol=List 
            
             [Node list symbol=Record 
             
              [Node list symbol=: symbol=fromOb 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              
              [Node list symbol=: symbol=toOb 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=weightedGraph symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedGraph objs am $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=List 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=obs 
       
        [Node list symbol=concat symbol=obs symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ar 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=am ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=j 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=am symbol=i ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3872430 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=j 
         
          [Node list symbol=am symbol=i ]
          ]
         
         [Node list symbol=One ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3872430 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=a 
           
            [Node list symbol=Record 
            
             [Node list symbol=: symbol=name 
             
              [Node list symbol=String ]
              ]
             
             [Node list symbol=: symbol=weight symbol=W ]
             
             [Node list symbol=: symbol=fromOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=toOb 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             
             [Node list symbol=: symbol=xOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=yOffset 
             
              [Node list symbol=Integer ]
              ]
             
             [Node list symbol=: symbol=map 
             
              [Node list symbol=List 
              
               [Node list symbol=NonNegativeInteger ]
               ]
              ]
             ]
            ]
           
           [Node list symbol=construct string=a symbol=i symbol=j 
           
            [Node list symbol=Sel symbol=W 
            
             [Node list symbol=Zero ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=:: 
            
             [Node list symbol=Zero ]
             
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=construct ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=LET symbol=ar 
           
            [Node list symbol=concat symbol=ar symbol=a ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ar ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=objects ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obj 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=weight symbol=W ]
       ]
      ]
     
     [Node list symbol=construct symbol=n 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=Sel symbol=W 
      
       [Node list symbol=Zero ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF
    [Node list symbol=IF 
    
     [Node list symbol== symbol=obs 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=construct symbol=obj ]
      ]
     
     [Node list symbol=LET 
     
      [Node list symbol=s symbol=objects ]
      
      [Node list symbol=concat symbol=obs symbol=obj ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 s
    [Node list symbol=exit int=1 symbol=s ]
    
   ]
   
  CAPSULEDef:
   [DEF addObject! s n $ $ SEQ
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=value symbol=S ]
     
     [Node list symbol=: symbol=posX 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=posY 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= error this form of addObject! not supported in multifunctionGraph
    [Node list symbol=error string=this form of addObject! not supported in multifunctionGraph ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s ar $ $ addWArrow! s
   DEFSubnode:atts= Record
    [Node list symbol=Record 
    
     [Node list symbol=: symbol=name 
     
      [Node list symbol=String ]
      ]
     
     [Node list symbol=: symbol=arrType 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=fromOb 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=toOb 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=: symbol=xOffset 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=: symbol=yOffset 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=: symbol=map 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= ar name
    [Node list symbol=ar symbol=name ]
    
   DEFSubnode:atts= ar fromOb
    [Node list symbol=ar symbol=fromOb ]
    
   DEFSubnode:atts= ar toOb
    [Node list symbol=ar symbol=toOb ]
    
   DEFSubnode:atts= Sel W
    [Node list symbol=Sel symbol=W 
    
     [Node list symbol=Zero ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addArrow! s nm n1 n2 $ $ addWArrow! s nm n1 n2
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= Sel W
    [Node list symbol=Sel symbol=W 
    
     [Node list symbol=Zero ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF addWArrow! s nm n1 n2 w $ $ W SEQ
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arrss 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=s symbol=arrows ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=a 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=weight symbol=W ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct symbol=nm symbol=w symbol=n1 symbol=n2 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=G3872431 
     
      [Node list symbol=Boolean ]
      ]
     
     [Node list symbol=empty? symbol=arrss ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=IF symbol=G3872431 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=s symbol=arrows ]
        
        [Node list symbol=construct symbol=a ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=return symbol=s ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=arrs 
        
         [Node list symbol=List 
         
          [Node list symbol=Record 
          
           [Node list symbol=: symbol=name 
           
            [Node list symbol=String ]
            ]
           
           [Node list symbol=: symbol=weight symbol=W ]
           
           [Node list symbol=: symbol=fromOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=: symbol=toOb 
           
            [Node list symbol=NonNegativeInteger ]
            ]
           
           [Node list symbol=: symbol=xOffset 
           
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=: symbol=yOffset 
           
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=: symbol=map 
           
            [Node list symbol=List 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            ]
           ]
          ]
         ]
        
        [Node list symbol=concat symbol=arrss symbol=a ]
        ]
       
       [Node list symbol=LET symbol=arrs 
       
        [Node list symbol=s symbol=arrows ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=return symbol=s ]
        ]
       ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF getVertices s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=soj 
     
      [Node list symbol=s symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=soj symbol=value ]
        
        [Node list symbol=soj symbol=posX ]
        
        [Node list symbol=soj symbol=posY ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=concat symbol=res symbol=o ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF getArrows s $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=name 
      
       [Node list symbol=String ]
       ]
      
      [Node list symbol=: symbol=arrType 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=fromOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=toOb 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=xOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=yOffset 
      
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=: symbol=map 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=a 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=aw 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=arrType 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=a symbol=name ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=a symbol=fromOb ]
        
        [Node list symbol=a symbol=toOb ]
        
        [Node list symbol=a symbol=xOffset ]
        
        [Node list symbol=a symbol=yOffset ]
        
        [Node list symbol=a symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=arrs 
       
        [Node list symbol=concat symbol=arrs symbol=aw ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 arrs
    [Node list symbol=exit int=1 symbol=arrs ]
    
   ]
   
  CAPSULEDef:
   [DEF initial $ construct
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF terminal a $ S SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=o 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=value symbol=S ]
       
       [Node list symbol=: symbol=posX 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=posY 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=weight symbol=W ]
       ]
      ]
     
     [Node list symbol=construct symbol=a 
     
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=Sel symbol=W 
      
       [Node list symbol=Zero ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ar 
     
      [Node list symbol=Record 
      
       [Node list symbol=: symbol=name 
       
        [Node list symbol=String ]
        ]
       
       [Node list symbol=: symbol=weight symbol=W ]
       
       [Node list symbol=: symbol=fromOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=toOb 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=: symbol=xOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=yOffset 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=: symbol=map 
       
        [Node list symbol=List 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct string=loop 
     
      [Node list symbol=Sel symbol=W 
      
       [Node list symbol=Zero ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=One ]
       
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=:: 
      
       [Node list symbol=Zero ]
       
       [Node list symbol=Integer ]
       ]
      
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct 
     
      [Node list symbol=construct symbol=o ]
      
      [Node list symbol=construct symbol=ar ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleOpen objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3872432 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3872432 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=weight symbol=W ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat symbol=arrowName 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=Sel symbol=W 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cycleClosed objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=next 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=+ symbol=obn 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3872433 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== 
        
         [Node list symbol=- symbol=next 
         
          [Node list symbol=One ]
          ]
         
         [Node list symbol=# symbol=objs ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3872433 symbol=noBranch 
        
         [Node list symbol=LET symbol=next 
         
          [Node list symbol=:: 
          
           [Node list symbol=One ]
           
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3872434 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=<= symbol=next 
       
        [Node list symbol=# symbol=objs ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3872434 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=a 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=weight symbol=W ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          
          [Node list symbol=construct symbol=obn symbol=next 
          
           [Node list symbol=concat symbol=arrowName 
           
            [Node list symbol=string symbol=arn ]
            ]
           
           [Node list symbol=Sel symbol=W 
           
            [Node list symbol=Zero ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=:: 
           
            [Node list symbol=Zero ]
            
            [Node list symbol=Integer ]
            ]
           
           [Node list symbol=construct ]
           ]
          ]
         
         [Node list symbol=LET symbol=ars 
         
          [Node list symbol=concat symbol=ars symbol=a ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=arn 
          
           [Node list symbol=+ symbol=arn 
           
            [Node list symbol=One ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF unit objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=a 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=obn symbol=obn 
       
        [Node list symbol=concat symbol=arrowName 
        
         [Node list symbol=string symbol=arn ]
         ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=:: 
        
         [Node list symbol=Zero ]
         
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=construct ]
        ]
       ]
      
      [Node list symbol=LET symbol=ars 
      
       [Node list symbol=concat symbol=ars symbol=a ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=arn 
       
        [Node list symbol=+ symbol=arn 
        
         [Node list symbol=One ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF kgraph objs arrowName $ SEQ
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= String
    [Node list symbol=String ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=obs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=ars 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=arn 
     
      [Node list symbol=Integer ]
      ]
     
     [Node list symbol=:: 
     
      [Node list symbol=One ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=obn 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# symbol=objs ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=ob 
      
       [Node list symbol=objs symbol=obn ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=o 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=value symbol=S ]
         
         [Node list symbol=: symbol=posX 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=posY 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         ]
        ]
       
       [Node list symbol=construct symbol=ob 
       
        [Node list symbol=createX symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=createY symbol=obn 
        
         [Node list symbol=# symbol=objs ]
         ]
        
        [Node list symbol=Sel symbol=W 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=obs 
      
       [Node list symbol=concat symbol=obs symbol=o ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=obm 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# symbol=objs ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3872435 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=~= symbol=obn symbol=obm ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3872435 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=a 
             
              [Node list symbol=Record 
              
               [Node list symbol=: symbol=name 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=: symbol=weight symbol=W ]
               
               [Node list symbol=: symbol=fromOb 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=toOb 
               
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=: symbol=xOffset 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=: symbol=yOffset 
               
                [Node list symbol=Integer ]
                ]
               
               [Node list symbol=: symbol=map 
               
                [Node list symbol=List 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=construct symbol=obn symbol=obm 
             
              [Node list symbol=concat symbol=arrowName 
              
               [Node list symbol=string symbol=arn ]
               ]
              
              [Node list symbol=Sel symbol=W 
              
               [Node list symbol=Zero ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=:: 
              
               [Node list symbol=Zero ]
               
               [Node list symbol=Integer ]
               ]
              
              [Node list symbol=construct ]
              ]
             ]
            
            [Node list symbol=LET symbol=ars 
            
             [Node list symbol=concat symbol=ars symbol=a ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=arn 
             
              [Node list symbol=+ symbol=arn 
              
               [Node list symbol=One ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=obs symbol=ars ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF + a b $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lo 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=concat 
     
      [Node list symbol=a symbol=objects ]
      
      [Node list symbol=b symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bStart 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lb 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ba 
     
      [Node list symbol=b symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=ba symbol=name ]
        
        [Node list symbol=ba symbol=weight ]
        
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=fromOb ]
         ]
        
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=toOb ]
         ]
        
        [Node list symbol=ba symbol=xOffset ]
        
        [Node list symbol=ba symbol=yOffset ]
        
        [Node list symbol=ba symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lb 
       
        [Node list symbol=lb symbol=arr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=weight symbol=W ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=lb 
     
      [Node list symbol=a symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=lo symbol=la ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF merge a b $ $ $ SEQ
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bmap 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=COLLECT symbol=x 
     
      [Node list symbol=IN symbol=x 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newIndex 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET mergedObjects
    [Node list symbol=LET symbol=mergedObjects 
    
     [Node list symbol=a symbol=objects ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=bob 
     
      [Node list symbol=b symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=i 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=position symbol=bob 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF 
       
        [Node list symbol=< symbol=i 
        
         [Node list symbol=One ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=mergedObjects 
         
          [Node list symbol=concat symbol=mergedObjects symbol=bob ]
          ]
         
         [Node list symbol=LET symbol=newIndex 
         
          [Node list symbol=+ symbol=newIndex 
          
           [Node list symbol=One ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=bmap 
          
           [Node list symbol=concat symbol=bmap symbol=newIndex ]
           ]
          ]
         ]
        
        [Node list symbol=LET symbol=bmap 
        
         [Node list symbol=concat symbol=bmap 
         
          [Node list symbol=:: symbol=i 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=bStart 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=a symbol=objects ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lb 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=ba 
     
      [Node list symbol=b symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=toI 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=bmap 
       
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=toOb ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=fromI 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=bmap 
       
        [Node list symbol=+ symbol=bStart 
        
         [Node list symbol=ba symbol=fromOb ]
         ]
        ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=arr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct symbol=fromI symbol=toI 
       
        [Node list symbol=ba symbol=name ]
        
        [Node list symbol=ba symbol=weight ]
        
        [Node list symbol=ba symbol=xOffset ]
        
        [Node list symbol=ba symbol=yOffset ]
        
        [Node list symbol=ba symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lb 
       
        [Node list symbol=lb symbol=arr 
        
         [Node list symbol=Sel symbol=concat 
         
          [Node list symbol=List 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=name 
            
             [Node list symbol=String ]
             ]
            
            [Node list symbol=: symbol=weight symbol=W ]
            
            [Node list symbol=: symbol=fromOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=toOb 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=xOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=yOffset 
            
             [Node list symbol=Integer ]
             ]
            
            [Node list symbol=: symbol=map 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=la 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=concat symbol=lb 
     
      [Node list symbol=a symbol=arrows ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=mergedObjects symbol=la ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF objProd a b $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=weight symbol=W ]
      ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value 
        
         [Node list symbol=Product symbol=S symbol=S ]
         ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=widtha 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramWidth symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=heighta 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramHeight symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp 
          
           [Node list symbol=Product symbol=S symbol=S ]
           ]
          
          [Node list symbol=ai symbol=bi 
          
           [Node list symbol=Sel symbol=construct 
           
            [Node list symbol=Product symbol=S symbol=S ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value 
            
             [Node list symbol=Product symbol=S symbol=S ]
             ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=weight symbol=W ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y 
          
           [Node list symbol=Sel symbol=W 
           
            [Node list symbol=Zero ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newObjs
    [Node list symbol=exit int=1 symbol=newObjs ]
    
   ]
   
  CAPSULEDef:
   [DEF indexProd aObj a b $ + a
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= *
    [Node list symbol=* 
    
     [Node list symbol=:: 
     
      [Node list symbol=- 
      
       [Node list symbol=:: symbol=b 
       
        [Node list symbol=Integer ]
        ]
       
       [Node list symbol=One ]
       ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=# 
     
      [Node list symbol=aObj symbol=objects ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF * a b $ $ SEQ
   DEFSubnode:atts= WeightedGraph W
    [Node list symbol=WeightedGraph symbol=W 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3872436 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3872436 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3872437 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3872437 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=an 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=* 
                 
                  [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                  
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=arr 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=name 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=: symbol=weight symbol=W ]
                  
                  [Node list symbol=: symbol=fromOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=toOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=xOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=yOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=map 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=construct symbol=an 
                
                 [Node list symbol=Sel symbol=W 
                 
                  [Node list symbol=Zero ]
                  ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=construct ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=newArrs 
                
                 [Node list symbol=newArrs symbol=arr 
                 
                  [Node list symbol=Sel symbol=concat 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=name 
                     
                      [Node list symbol=String ]
                      ]
                     
                     [Node list symbol=: symbol=weight symbol=W ]
                     
                     [Node list symbol=: symbol=fromOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=toOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=xOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=yOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=map 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newArrs 
     
      [Node list symbol=Sel symbol=weightedGraph 
      
       [Node list symbol=WeightedGraph symbol=W 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      
      [Node list symbol=objProd symbol=a symbol=b ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF cartesian a b $ $ SEQ
   DEFSubnode:atts= WeightedGraph W
    [Node list symbol=WeightedGraph symbol=W 
    
     [Node list symbol=Product symbol=S symbol=S ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=bu symbol=bv ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3872438 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3872438 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=an 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol== symbol=bu symbol=bv ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3872439 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3872439 
                 
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                    
                    [Node list symbol=string symbol=bv ]
                    ]
                   ]
                  
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                    
                    [Node list symbol=string symbol=av ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=concat 
               
                [Node list symbol=construct string=# 
                
                 [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                 
                 [Node list symbol=string symbol=av ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=arr 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=name 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=: symbol=weight symbol=W ]
                
                [Node list symbol=: symbol=fromOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=toOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=xOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=yOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=map 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=construct symbol=an 
              
               [Node list symbol=Sel symbol=W 
               
                [Node list symbol=Zero ]
                ]
               
               [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
               
               [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=newArrs 
              
               [Node list symbol=newArrs symbol=arr 
               
                [Node list symbol=Sel symbol=concat 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=name 
                   
                    [Node list symbol=String ]
                    ]
                   
                   [Node list symbol=: symbol=weight symbol=W ]
                   
                   [Node list symbol=: symbol=fromOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=toOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=xOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=yOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=map 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=au symbol=av ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G3872440 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G3872440 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=an 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=bu symbol=bv ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G3872439 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G3872439 
                     
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                        
                        [Node list symbol=string symbol=bv ]
                        ]
                       ]
                      
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                        
                        [Node list symbol=string symbol=av ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=arr 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=weight symbol=W ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=construct symbol=an 
                  
                   [Node list symbol=Sel symbol=W 
                   
                    [Node list symbol=Zero ]
                    ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=construct ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newArrs 
                  
                   [Node list symbol=newArrs symbol=arr 
                   
                    [Node list symbol=Sel symbol=concat 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=name 
                       
                        [Node list symbol=String ]
                        ]
                       
                       [Node list symbol=: symbol=weight symbol=W ]
                       
                       [Node list symbol=: symbol=fromOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=toOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=xOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=yOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=map 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol== symbol=au symbol=av ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G3872441 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G3872441 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=an 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=bu symbol=bv ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G3872439 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G3872439 
                  
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                     
                     [Node list symbol=string symbol=bv ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=# 
                 
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  
                  [Node list symbol=string symbol=av ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=arr 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=name 
                 
                  [Node list symbol=String ]
                  ]
                 
                 [Node list symbol=: symbol=weight symbol=W ]
                 
                 [Node list symbol=: symbol=fromOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=toOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=xOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=yOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=map 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=an 
               
                [Node list symbol=Sel symbol=W 
                
                 [Node list symbol=Zero ]
                 ]
                
                [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                
                [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=construct ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newArrs 
               
                [Node list symbol=newArrs symbol=arr 
                
                 [Node list symbol=Sel symbol=concat 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=weight symbol=W ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=newArrs 
     
      [Node list symbol=Sel symbol=weightedGraph 
      
       [Node list symbol=WeightedGraph symbol=W 
       
        [Node list symbol=Product symbol=S symbol=S ]
        ]
       ]
      
      [Node list symbol=objProd symbol=a symbol=b ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedObjProd a b f $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=Record 
     
      [Node list symbol=: symbol=value symbol=S ]
      
      [Node list symbol=: symbol=posX 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=posY 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      
      [Node list symbol=: symbol=weight symbol=W ]
      ]
     ]
    
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=aoi 
     
      [Node list symbol=a symbol=objects ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ai symbol=S ]
       
       [Node list symbol=aoi symbol=value ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=axi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posX ]
       ]
      
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=ayi 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=aoi symbol=posY ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=boi 
        
         [Node list symbol=b symbol=objects ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bi symbol=S ]
          
          [Node list symbol=boi symbol=value ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=bxi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posX ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=byi 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=boi symbol=posY ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=x 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=axi 
          
           [Node list symbol=* symbol=bxi 
           
            [Node list symbol=diagramWidth symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=y 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=+ symbol=ayi 
          
           [Node list symbol=* symbol=byi 
           
            [Node list symbol=diagramHeight symbol=a ]
            ]
           ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=widtha 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramWidth symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=heighta 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=diagramHeight symbol=a ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=sp symbol=S ]
          
          [Node list symbol=f symbol=ai symbol=bi ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=ob 
          
           [Node list symbol=Record 
           
            [Node list symbol=: symbol=value symbol=S ]
            
            [Node list symbol=: symbol=posX 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=posY 
            
             [Node list symbol=NonNegativeInteger ]
             ]
            
            [Node list symbol=: symbol=weight symbol=W ]
            ]
           ]
          
          [Node list symbol=construct symbol=sp symbol=x symbol=y 
          
           [Node list symbol=Sel symbol=W 
           
            [Node list symbol=Zero ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=LET symbol=newObjs 
          
           [Node list symbol=concat symbol=newObjs symbol=ob ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 newObjs
    [Node list symbol=exit int=1 symbol=newObjs ]
    
   ]
   
  CAPSULEDef:
   [DEF closedTensor a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=SEQ 
        
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3872442 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3872442 symbol=noBranch 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3872443 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3872443 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=an 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=* 
                 
                  [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                  
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  ]
                 ]
                ]
               
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=arr 
                
                 [Node list symbol=Record 
                 
                  [Node list symbol=: symbol=name 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=: symbol=weight symbol=W ]
                  
                  [Node list symbol=: symbol=fromOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=toOb 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  
                  [Node list symbol=: symbol=xOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=yOffset 
                  
                   [Node list symbol=Integer ]
                   ]
                  
                  [Node list symbol=: symbol=map 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=construct symbol=an 
                
                 [Node list symbol=Sel symbol=W 
                 
                  [Node list symbol=Zero ]
                  ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                 
                 [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=:: 
                 
                  [Node list symbol=Zero ]
                  
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=construct ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=LET symbol=newArrs 
                
                 [Node list symbol=newArrs symbol=arr 
                 
                  [Node list symbol=Sel symbol=concat 
                  
                   [Node list symbol=List 
                   
                    [Node list symbol=Record 
                    
                     [Node list symbol=: symbol=name 
                     
                      [Node list symbol=String ]
                      ]
                     
                     [Node list symbol=: symbol=weight symbol=W ]
                     
                     [Node list symbol=: symbol=fromOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=toOb 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     
                     [Node list symbol=: symbol=xOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=yOffset 
                     
                      [Node list symbol=Integer ]
                      ]
                     
                     [Node list symbol=: symbol=map 
                     
                      [Node list symbol=List 
                      
                       [Node list symbol=NonNegativeInteger ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=weightedGraph symbol=newArrs 
     
      [Node list symbol=closedObjProd symbol=a symbol=b symbol=f ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF closedCartesian a b f $ $ $ SEQ
   DEFSubnode:atts= Mapping S S S
    [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=au 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=a symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=av 
      
       [Node list symbol=SEGMENT 
       
        [Node list symbol=One ]
        
        [Node list symbol=# 
        
         [Node list symbol=a symbol=objects ]
         ]
        ]
       ]
      
      [Node list symbol=REPEAT 
      
       [Node list symbol=IN symbol=bu 
       
        [Node list symbol=SEGMENT 
        
         [Node list symbol=One ]
         
         [Node list symbol=# 
         
          [Node list symbol=b symbol=objects ]
          ]
         ]
        ]
       
       [Node list symbol=REPEAT 
       
        [Node list symbol=IN symbol=bv 
        
         [Node list symbol=SEGMENT 
         
          [Node list symbol=One ]
          
          [Node list symbol=# 
          
           [Node list symbol=b symbol=objects ]
           ]
          ]
         ]
        
        [Node list symbol=IF 
        
         [Node list symbol== symbol=bu symbol=bv ]
         
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3872444 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3872444 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=an 
              
               [Node list symbol=String ]
               ]
              
              [Node list symbol=IF 
              
               [Node list symbol== symbol=bu symbol=bv ]
               
               [Node list symbol=SEQ 
               
                [Node list symbol=LET 
                
                 [Node list symbol=: symbol=G3872445 
                 
                  [Node list symbol=Boolean ]
                  ]
                 
                 [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                 ]
                
                [Node list symbol=exit int=1 
                
                 [Node list symbol=IF symbol=G3872445 
                 
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                    
                    [Node list symbol=string symbol=bv ]
                    ]
                   ]
                  
                  [Node list symbol=concat 
                  
                   [Node list symbol=construct string=# 
                   
                    [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                    
                    [Node list symbol=string symbol=av ]
                    ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=concat 
               
                [Node list symbol=construct string=# 
                
                 [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                 
                 [Node list symbol=string symbol=av ]
                 ]
                ]
               ]
              ]
             
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=arr 
              
               [Node list symbol=Record 
               
                [Node list symbol=: symbol=name 
                
                 [Node list symbol=String ]
                 ]
                
                [Node list symbol=: symbol=weight symbol=W ]
                
                [Node list symbol=: symbol=fromOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=toOb 
                
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=: symbol=xOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=yOffset 
                
                 [Node list symbol=Integer ]
                 ]
                
                [Node list symbol=: symbol=map 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=construct symbol=an 
              
               [Node list symbol=Sel symbol=W 
               
                [Node list symbol=Zero ]
                ]
               
               [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
               
               [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=:: 
               
                [Node list symbol=Zero ]
                
                [Node list symbol=NonNegativeInteger ]
                ]
               
               [Node list symbol=construct ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=newArrs 
              
               [Node list symbol=newArrs symbol=arr 
               
                [Node list symbol=Sel symbol=concat 
                
                 [Node list symbol=List 
                 
                  [Node list symbol=Record 
                  
                   [Node list symbol=: symbol=name 
                   
                    [Node list symbol=String ]
                    ]
                   
                   [Node list symbol=: symbol=weight symbol=W ]
                   
                   [Node list symbol=: symbol=fromOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=toOb 
                   
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=: symbol=xOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=yOffset 
                   
                    [Node list symbol=Integer ]
                    ]
                   
                   [Node list symbol=: symbol=map 
                   
                    [Node list symbol=List 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            
            [Node list symbol=IF symbol=noBranch 
            
             [Node list symbol== symbol=au symbol=av ]
             
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=G3872446 
               
                [Node list symbol=Boolean ]
                ]
               
               [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=IF symbol=G3872446 symbol=noBranch 
               
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=an 
                  
                   [Node list symbol=String ]
                   ]
                  
                  [Node list symbol=IF 
                  
                   [Node list symbol== symbol=bu symbol=bv ]
                   
                   [Node list symbol=SEQ 
                   
                    [Node list symbol=LET 
                    
                     [Node list symbol=: symbol=G3872445 
                     
                      [Node list symbol=Boolean ]
                      ]
                     
                     [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                     ]
                    
                    [Node list symbol=exit int=1 
                    
                     [Node list symbol=IF symbol=G3872445 
                     
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                        
                        [Node list symbol=string symbol=bv ]
                        ]
                       ]
                      
                      [Node list symbol=concat 
                      
                       [Node list symbol=construct string=# 
                       
                        [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                        
                        [Node list symbol=string symbol=av ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=arr 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=weight symbol=W ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  
                  [Node list symbol=construct symbol=an 
                  
                   [Node list symbol=Sel symbol=W 
                   
                    [Node list symbol=Zero ]
                    ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                   
                   [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=:: 
                   
                    [Node list symbol=Zero ]
                    
                    [Node list symbol=NonNegativeInteger ]
                    ]
                   
                   [Node list symbol=construct ]
                   ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=LET symbol=newArrs 
                  
                   [Node list symbol=newArrs symbol=arr 
                   
                    [Node list symbol=Sel symbol=concat 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=Record 
                      
                       [Node list symbol=: symbol=name 
                       
                        [Node list symbol=String ]
                        ]
                       
                       [Node list symbol=: symbol=weight symbol=W ]
                       
                       [Node list symbol=: symbol=fromOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=toOb 
                       
                        [Node list symbol=NonNegativeInteger ]
                        ]
                       
                       [Node list symbol=: symbol=xOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=yOffset 
                       
                        [Node list symbol=Integer ]
                        ]
                       
                       [Node list symbol=: symbol=map 
                       
                        [Node list symbol=List 
                        
                         [Node list symbol=NonNegativeInteger ]
                         ]
                        ]
                       ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=IF symbol=noBranch 
         
          [Node list symbol== symbol=au symbol=av ]
          
          [Node list symbol=SEQ 
          
           [Node list symbol=LET 
           
            [Node list symbol=: symbol=G3872447 
            
             [Node list symbol=Boolean ]
             ]
            
            [Node list symbol=isDirectSuccessor? symbol=b symbol=bu symbol=bv ]
            ]
           
           [Node list symbol=exit int=1 
           
            [Node list symbol=IF symbol=G3872447 symbol=noBranch 
            
             [Node list symbol=SEQ 
             
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=an 
               
                [Node list symbol=String ]
                ]
               
               [Node list symbol=IF 
               
                [Node list symbol== symbol=bu symbol=bv ]
                
                [Node list symbol=SEQ 
                
                 [Node list symbol=LET 
                 
                  [Node list symbol=: symbol=G3872445 
                  
                   [Node list symbol=Boolean ]
                   ]
                  
                  [Node list symbol=isDirectSuccessor? symbol=a symbol=au symbol=av ]
                  ]
                 
                 [Node list symbol=exit int=1 
                 
                  [Node list symbol=IF symbol=G3872445 
                  
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=a symbol=au symbol=av ]
                     
                     [Node list symbol=string symbol=bv ]
                     ]
                    ]
                   
                   [Node list symbol=concat 
                   
                    [Node list symbol=construct string=# 
                    
                     [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                     
                     [Node list symbol=string symbol=av ]
                     ]
                    ]
                   ]
                  ]
                 ]
                
                [Node list symbol=concat 
                
                 [Node list symbol=construct string=# 
                 
                  [Node list symbol=arrowName symbol=b symbol=bu symbol=bv ]
                  
                  [Node list symbol=string symbol=av ]
                  ]
                 ]
                ]
               ]
              
              [Node list symbol=LET 
              
               [Node list symbol=: symbol=arr 
               
                [Node list symbol=Record 
                
                 [Node list symbol=: symbol=name 
                 
                  [Node list symbol=String ]
                  ]
                 
                 [Node list symbol=: symbol=weight symbol=W ]
                 
                 [Node list symbol=: symbol=fromOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=toOb 
                 
                  [Node list symbol=NonNegativeInteger ]
                  ]
                 
                 [Node list symbol=: symbol=xOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=yOffset 
                 
                  [Node list symbol=Integer ]
                  ]
                 
                 [Node list symbol=: symbol=map 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=NonNegativeInteger ]
                   ]
                  ]
                 ]
                ]
               
               [Node list symbol=construct symbol=an 
               
                [Node list symbol=Sel symbol=W 
                
                 [Node list symbol=Zero ]
                 ]
                
                [Node list symbol=indexProd symbol=b symbol=bu symbol=au ]
                
                [Node list symbol=indexProd symbol=b symbol=bv symbol=av ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=:: 
                
                 [Node list symbol=Zero ]
                 
                 [Node list symbol=NonNegativeInteger ]
                 ]
                
                [Node list symbol=construct ]
                ]
               ]
              
              [Node list symbol=exit int=1 
              
               [Node list symbol=LET symbol=newArrs 
               
                [Node list symbol=newArrs symbol=arr 
                
                 [Node list symbol=Sel symbol=concat 
                 
                  [Node list symbol=List 
                  
                   [Node list symbol=Record 
                   
                    [Node list symbol=: symbol=name 
                    
                     [Node list symbol=String ]
                     ]
                    
                    [Node list symbol=: symbol=weight symbol=W ]
                    
                    [Node list symbol=: symbol=fromOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=toOb 
                    
                     [Node list symbol=NonNegativeInteger ]
                     ]
                    
                    [Node list symbol=: symbol=xOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=yOffset 
                    
                     [Node list symbol=Integer ]
                     ]
                    
                    [Node list symbol=: symbol=map 
                    
                     [Node list symbol=List 
                     
                      [Node list symbol=NonNegativeInteger ]
                      ]
                     ]
                    ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=weightedGraph symbol=newArrs 
     
      [Node list symbol=closedObjProd symbol=a symbol=b symbol=f ]
      ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF map s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=Sel symbol=W 
       
        [Node list symbol=Zero ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=i 
      
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: 
        
         [Node list symbol=newObjs symbol=i ]
         
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=value symbol=S ]
          
          [Node list symbol=: symbol=posX 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=posY 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=weight symbol=W ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=value 
         
          [Node list symbol=newObjs symbol=i ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetX 
          
           [Node list symbol=posX 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetY 
          
           [Node list symbol=posY 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=Sel symbol=W 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oldArrow 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newArr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=oldArrow symbol=name ]
        
        [Node list symbol=oldArrow symbol=weight ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=fromOb ]
         ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=toOb ]
         ]
        
        [Node list symbol=oldArrow symbol=xOffset ]
        
        [Node list symbol=oldArrow symbol=yOffset ]
        
        [Node list symbol=oldArrow symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newArrs 
       
        [Node list symbol=concat symbol=newArrs symbol=newArr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF mapContra s m newOb offsetX offsetY $ $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= List S
    [Node list symbol=List symbol=S ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts= Integer
    [Node list symbol=Integer ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newObjs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     
     [Node list symbol=COLLECT 
     
      [Node list symbol=IN symbol=o symbol=newOb ]
      
      [Node list symbol=construct symbol=o 
      
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=:: 
       
        [Node list symbol=Zero ]
        
        [Node list symbol=NonNegativeInteger ]
        ]
       
       [Node list symbol=Sel symbol=W 
       
        [Node list symbol=Zero ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oi 
     
      [Node list symbol=SEGMENT 
      
       [Node list symbol=One ]
       
       [Node list symbol=# 
       
        [Node list symbol=s symbol=objects ]
        ]
       ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET symbol=i 
      
       [Node list symbol=m symbol=oi ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET 
       
        [Node list symbol=: 
        
         [Node list symbol=newObjs symbol=i ]
         
         [Node list symbol=Record 
         
          [Node list symbol=: symbol=value symbol=S ]
          
          [Node list symbol=: symbol=posX 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=posY 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          
          [Node list symbol=: symbol=weight symbol=W ]
          ]
         ]
        
        [Node list symbol=construct 
        
         [Node list symbol=value 
         
          [Node list symbol=newObjs symbol=i ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetX 
          
           [Node list symbol=posX 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=:: 
         
          [Node list symbol=+ symbol=offsetY 
          
           [Node list symbol=posY 
           
            [Node list symbol=oi 
            
             [Node list symbol=s symbol=objects ]
             ]
            ]
           ]
          
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=Sel symbol=W 
         
          [Node list symbol=Zero ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=newArrs 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=oldArrow 
     
      [Node list symbol=s symbol=arrows ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=newArr 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=construct 
       
        [Node list symbol=oldArrow symbol=name ]
        
        [Node list symbol=oldArrow symbol=weight ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=toOb ]
         ]
        
        [Node list symbol=m 
        
         [Node list symbol=oldArrow symbol=fromOb ]
         ]
        
        [Node list symbol=oldArrow symbol=xOffset ]
        
        [Node list symbol=oldArrow symbol=yOffset ]
        
        [Node list symbol=oldArrow symbol=map ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=newArrs 
       
        [Node list symbol=concat symbol=newArrs symbol=newArr ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=construct symbol=newObjs symbol=newArrs ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF routeNodeRecursive s a b visited $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3872448 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=# symbol=visited ]
       
       [Node list symbol=# 
       
        [Node list symbol=getVertices symbol=s ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3872448 symbol=noBranch 
      
       [Node list symbol=return 
       
        [Node list symbol=construct ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=shortest 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol== symbol=a symbol=b ]
     
     [Node list symbol=return 
     
      [Node list symbol=construct symbol=a ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3872449 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=isDirectSuccessor? symbol=s symbol=a symbol=b ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3872449 symbol=noBranch 
      
       [Node list symbol=return 
       
        [Node list symbol=construct symbol=a symbol=b ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=arr 
     
      [Node list symbol=getArrows symbol=s ]
      ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3872452 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=isDirectSuccessor? symbol=s symbol=a 
       
        [Node list symbol=arr symbol=fromOb ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3872452 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=d 
         
          [Node list symbol=routeNodeRecursive symbol=s symbol=b 
          
           [Node list symbol=arr symbol=fromOb ]
           
           [Node list symbol=visited symbol=a 
           
            [Node list symbol=Sel symbol=concat 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF 
          
           [Node list symbol== symbol=shortest 
           
            [Node list symbol=construct ]
            ]
           
           [Node list symbol=LET symbol=shortest symbol=d ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3872450 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=~= symbol=d 
             
              [Node list symbol=construct ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3872450 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G3872451 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=< 
                
                 [Node list symbol=routeNodeWeight symbol=s 
                 
                  [Node list symbol=concat symbol=a symbol=d ]
                  ]
                 
                 [Node list symbol=routeNodeWeight symbol=s 
                 
                  [Node list symbol=concat symbol=a symbol=shortest ]
                  ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G3872451 symbol=noBranch 
                
                 [Node list symbol=LET symbol=shortest symbol=d ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol== symbol=shortest 
     
      [Node list symbol=construct ]
      ]
     
     [Node list symbol=return 
     
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=concat symbol=a symbol=shortest ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF routeNodes s a b $ routeNodeRecursive s a b
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF routeArrowRecursive s a b visited $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3872453 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=> 
      
       [Node list symbol=# symbol=visited ]
       
       [Node list symbol=# 
       
        [Node list symbol=getVertices symbol=s ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3872453 symbol=noBranch 
      
       [Node list symbol=return 
       
        [Node list symbol=construct 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=shortest 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= IF noBranch
    [Node list symbol=IF symbol=noBranch 
    
     [Node list symbol== symbol=a symbol=b ]
     
     [Node list symbol=return 
     
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= LET arrn
    [Node list symbol=LET symbol=arrn 
    
     [Node list symbol=getArrowIndex symbol=s symbol=a symbol=b ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3872454 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol=~= symbol=arrn 
      
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3872454 symbol=noBranch 
      
       [Node list symbol=return 
       
        [Node list symbol=construct symbol=arrn ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=aa 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=shortestFullPath 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=construct 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET arrs
    [Node list symbol=LET symbol=arrs 
    
     [Node list symbol=getArrows symbol=s ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=arr symbol=arrs ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=G3872458 
       
        [Node list symbol=Boolean ]
        ]
       
       [Node list symbol=isDirectSuccessor? symbol=s symbol=a 
       
        [Node list symbol=arr symbol=fromOb ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=IF symbol=G3872458 symbol=noBranch 
       
        [Node list symbol=SEQ 
        
         [Node list symbol=LET symbol=aa 
         
          [Node list symbol=getArrowIndex symbol=s symbol=a 
          
           [Node list symbol=arr symbol=fromOb ]
           ]
          ]
         
         [Node list symbol=LET symbol=d 
         
          [Node list symbol=routeArrowRecursive symbol=s symbol=b 
          
           [Node list symbol=arr symbol=fromOb ]
           
           [Node list symbol=visited symbol=a 
           
            [Node list symbol=Sel symbol=concat 
            
             [Node list symbol=List 
             
              [Node list symbol=NonNegativeInteger ]
              ]
             ]
            ]
           ]
          ]
         
         [Node list symbol=LET symbol=fullPath 
         
          [Node list symbol=concat symbol=aa symbol=d ]
          ]
         
         [Node list symbol=LET 
         
          [Node list symbol=: symbol=G3872457 
          
           [Node list symbol=Boolean ]
           ]
          
          [Node list symbol== symbol=shortest 
          
           [Node list symbol=construct 
           
            [Node list symbol=Zero ]
            ]
           ]
          ]
         
         [Node list symbol=exit int=1 
         
          [Node list symbol=IF symbol=G3872457 
          
           [Node list symbol=SEQ 
           
            [Node list symbol=LET symbol=shortest symbol=d ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=LET symbol=shortestFullPath symbol=fullPath ]
             ]
            ]
           
           [Node list symbol=SEQ 
           
            [Node list symbol=LET 
            
             [Node list symbol=: symbol=G3872455 
             
              [Node list symbol=Boolean ]
              ]
             
             [Node list symbol=~= symbol=d 
             
              [Node list symbol=construct 
              
               [Node list symbol=Zero ]
               ]
              ]
             ]
            
            [Node list symbol=exit int=1 
            
             [Node list symbol=IF symbol=G3872455 symbol=noBranch 
             
              [Node list symbol=SEQ 
              
               [Node list symbol=LET 
               
                [Node list symbol=: symbol=G3872456 
                
                 [Node list symbol=Boolean ]
                 ]
                
                [Node list symbol=< 
                
                 [Node list symbol=routeArrowWeight symbol=s symbol=fullPath ]
                 
                 [Node list symbol=routeArrowWeight symbol=s symbol=shortestFullPath ]
                 ]
                ]
               
               [Node list symbol=exit int=1 
               
                [Node list symbol=IF symbol=G3872456 symbol=noBranch 
                
                 [Node list symbol=SEQ 
                 
                  [Node list symbol=LET symbol=shortest symbol=d ]
                  
                  [Node list symbol=exit int=1 
                  
                   [Node list symbol=LET symbol=shortestFullPath symbol=fullPath ]
                   ]
                  ]
                 ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3872459 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol== symbol=shortest 
      
       [Node list symbol=construct 
       
        [Node list symbol=Zero ]
        ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3872459 symbol=noBranch 
      
       [Node list symbol=return 
       
        [Node list symbol=construct 
        
         [Node list symbol=Zero ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 shortestFullPath
    [Node list symbol=exit int=1 symbol=shortestFullPath ]
    
   ]
   
  CAPSULEDef:
   [DEF routeArrows s a b $ routeArrowRecursive s a b
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= construct
    [Node list symbol=construct ]
    
   ]
   
  CAPSULEDef:
   [DEF distanceWeighted s a b $ SEQ
   DEFSubnode:atts= Union W disjoint
    [Node list symbol=Union symbol=W string=disjoint ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=r 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     
     [Node list symbol=routeNodeRecursive symbol=s symbol=a symbol=b 
     
      [Node list symbol=construct ]
      ]
     ]
    
   DEFSubnode:atts= SEQ
    [Node list symbol=SEQ 
    
     [Node list symbol=LET 
     
      [Node list symbol=: symbol=G3872460 
      
       [Node list symbol=Boolean ]
       ]
      
      [Node list symbol== 
      
       [Node list symbol=# symbol=r ]
       
       [Node list symbol=Zero ]
       ]
      ]
     
     [Node list symbol=exit int=1 
     
      [Node list symbol=IF symbol=G3872460 symbol=noBranch 
      
       [Node list symbol=return string=disjoint ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1
    [Node list symbol=exit int=1 
    
     [Node list symbol=routeNodeWeight symbol=s symbol=r ]
     ]
    
   ]
   
  CAPSULEDef:
   [DEF getWeightBetween s i1 i2 W $ SEQ
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts= NonNegativeInteger
    [Node list symbol=NonNegativeInteger ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET true
    [Node list symbol=LET symbol=true 
    
     [Node list symbol=: symbol=isDisjoint 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=W ]
     
     [Node list symbol=Sel symbol=W 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET arrs
    [Node list symbol=LET symbol=arrs 
    
     [Node list symbol=s symbol=arrows ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=arr symbol=arrs ]
     
     [Node list symbol=IF symbol=isDisjoint 
     
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3872461 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=i1 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3872461 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3872462 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=i2 
           
            [Node list symbol=arr symbol=toOb ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3872462 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET symbol=res 
             
              [Node list symbol=arr symbol=weight ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=LET symbol=isDisjoint symbol=false ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=SEQ 
      
       [Node list symbol=LET 
       
        [Node list symbol=: symbol=G3872463 
        
         [Node list symbol=Boolean ]
         ]
        
        [Node list symbol== symbol=i1 
        
         [Node list symbol=arr symbol=fromOb ]
         ]
        ]
       
       [Node list symbol=exit int=1 
       
        [Node list symbol=IF symbol=G3872463 symbol=noBranch 
        
         [Node list symbol=SEQ 
         
          [Node list symbol=LET 
          
           [Node list symbol=: symbol=G3872464 
           
            [Node list symbol=Boolean ]
            ]
           
           [Node list symbol== symbol=i2 
           
            [Node list symbol=arr symbol=toOb ]
            ]
           ]
          
          [Node list symbol=exit int=1 
          
           [Node list symbol=IF symbol=G3872464 symbol=noBranch 
           
            [Node list symbol=SEQ 
            
             [Node list symbol=LET 
             
              [Node list symbol=: symbol=G3872465 
              
               [Node list symbol=Boolean ]
               ]
              
              [Node list symbol=< symbol=res 
              
               [Node list symbol=arr symbol=weight ]
               ]
              ]
             
             [Node list symbol=exit int=1 
             
              [Node list symbol=IF symbol=G3872465 symbol=noBranch 
              
               [Node list symbol=LET symbol=res 
               
                [Node list symbol=arr symbol=weight ]
                ]
               ]
              ]
             ]
            ]
           ]
          ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF routeNodeWeight s r W $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=W ]
     
     [Node list symbol=Sel symbol=W 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= LET true
    [Node list symbol=LET symbol=true 
    
     [Node list symbol=: symbol=fst 
     
      [Node list symbol=Boolean ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=lasti 
     
      [Node list symbol=NonNegativeInteger ]
      ]
     
     [Node list symbol=Zero ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i symbol=r ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=IF symbol=fst symbol=noBranch 
      
       [Node list symbol=SEQ 
       
        [Node list symbol=LET symbol=w 
        
         [Node list symbol=getWeightBetween symbol=s symbol=lasti symbol=i ]
         ]
        
        [Node list symbol=exit int=1 
        
         [Node list symbol=LET symbol=res 
         
          [Node list symbol=+ symbol=res symbol=w ]
          ]
         ]
        ]
       ]
      
      [Node list symbol=LET symbol=fst symbol=false ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=lasti symbol=i ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF routeArrowWeight s r W $ SEQ
   DEFSubnode:atts= List
    [Node list symbol=List 
    
     [Node list symbol=NonNegativeInteger ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=res symbol=W ]
     
     [Node list symbol=Sel symbol=W 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=i symbol=r ]
     
     [Node list symbol=SEQ 
     
      [Node list symbol=LET 
      
       [Node list symbol=: symbol=a 
       
        [Node list symbol=Record 
        
         [Node list symbol=: symbol=name 
         
          [Node list symbol=String ]
          ]
         
         [Node list symbol=: symbol=weight symbol=W ]
         
         [Node list symbol=: symbol=fromOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=toOb 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         
         [Node list symbol=: symbol=xOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=yOffset 
         
          [Node list symbol=Integer ]
          ]
         
         [Node list symbol=: symbol=map 
         
          [Node list symbol=List 
          
           [Node list symbol=NonNegativeInteger ]
           ]
          ]
         ]
        ]
       
       [Node list symbol=i 
       
        [Node list symbol=s symbol=arrows ]
        ]
       ]
      
      [Node list symbol=exit int=1 
      
       [Node list symbol=LET symbol=res 
       
        [Node list symbol=+ symbol=res 
        
         [Node list symbol=a symbol=weight ]
         ]
        ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 res
    [Node list symbol=exit int=1 symbol=res ]
    
   ]
   
  CAPSULEDef:
   [DEF weightedDistanceMatrix s $ SEQ
   DEFSubnode:atts= TwoDimensionalArray
    [Node list symbol=TwoDimensionalArray 
    
     [Node list symbol=Union symbol=W string=disjoint ]
     ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts= LET n
    [Node list symbol=LET symbol=n 
    
     [Node list symbol=# 
     
      [Node list symbol=getVertices symbol=s ]
      ]
     ]
    
   DEFSubnode:atts= LET
    [Node list symbol=LET 
    
     [Node list symbol=: symbol=m symbol=TwoDimensionalArray ]
     
     [Node list symbol=new symbol=n symbol=n 
     
      [Node list symbol=Zero ]
      ]
     ]
    
   DEFSubnode:atts= REPEAT
    [Node list symbol=REPEAT 
    
     [Node list symbol=IN symbol=u 
     
      [Node list symbol=SEGMENT symbol=n 
      
       [Node list symbol=One ]
       ]
      ]
     
     [Node list symbol=REPEAT 
     
      [Node list symbol=IN symbol=v 
      
       [Node list symbol=SEGMENT symbol=n 
       
        [Node list symbol=One ]
        ]
       ]
      
      [Node list symbol=qsetelt! symbol=m symbol=u symbol=v 
      
       [Node list symbol=distanceWeighted symbol=s symbol=u symbol=v ]
       ]
      ]
     ]
    
   DEFSubnode:atts= exit 1 m
    [Node list symbol=exit int=1 symbol=m ]
    
   ]
   
  CAPSULEDef:
   [DEF coerce poset $ weightedGraph poset
   DEFSubnode:atts= FinitePoset S
    [Node list symbol=FinitePoset symbol=S ]
    
   DEFSubnode:atts=
    [Node list ]
    
   DEFSubnode:atts=
    [Node list ]
    
   ]
   
  ]
  
 DEFSubnode:atts= Join
  [Node list symbol=Join 
  
   [Node list symbol=FiniteGraph symbol=S ]
   
   [Node list symbol=CATEGORY symbol=domain 
   
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=weight symbol=W ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=value symbol=S ]
        
        [Node list symbol=: symbol=posX 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=posY 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=name 
        
         [Node list symbol=String ]
         ]
        
        [Node list symbol=: symbol=arrType 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=xOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=yOffset 
        
         [Node list symbol=Integer ]
         ]
        
        [Node list symbol=: symbol=map 
        
         [Node list symbol=List 
         
          [Node list symbol=NonNegativeInteger ]
          ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=Record 
       
        [Node list symbol=: symbol=fromOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        
        [Node list symbol=: symbol=toOb 
        
         [Node list symbol=NonNegativeInteger ]
         ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=FinitePoset symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedGraph 
    
     [Node list symbol=$ 
     
      [Node list symbol=List symbol=S ]
      
      [Node list symbol=List 
      
       [Node list symbol=List 
       
        [Node list symbol=NonNegativeInteger ]
        ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=addWArrow! 
    
     [Node list symbol=$ symbol=$ symbol=W 
     
      [Node list symbol=String ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=distanceWeighted 
    
     [Node list symbol=$ 
     
      [Node list symbol=Union symbol=W string=disjoint ]
      
      [Node list symbol=NonNegativeInteger ]
      
      [Node list symbol=NonNegativeInteger ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=routeNodeWeight 
    
     [Node list symbol=W symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=routeArrowWeight 
    
     [Node list symbol=W symbol=$ 
     
      [Node list symbol=List 
      
       [Node list symbol=NonNegativeInteger ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=* 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=WeightedGraph symbol=W 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=cartesian 
    
     [Node list symbol=$ symbol=$ 
     
      [Node list symbol=WeightedGraph symbol=W 
      
       [Node list symbol=Product symbol=S symbol=S ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedTensor 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=closedCartesian 
    
     [Node list symbol=$ symbol=$ symbol=$ 
     
      [Node list symbol=Mapping symbol=S symbol=S symbol=S ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=weightedDistanceMatrix 
    
     [Node list symbol=$ 
     
      [Node list symbol=TwoDimensionalArray 
      
       [Node list symbol=Union symbol=W string=disjoint ]
       ]
      ]
     ]
    
    [Node list symbol=SIGNATURE symbol=coerce 
    
     [Node list symbol=$ 
     
      [Node list symbol=FinitePoset symbol=S ]
      ]
     ]
    ]
   ]
  
 DEFSubnode:atts= SetCategory
  [Node list symbol=SetCategory ]
  
 DEFSubnode:atts= OrderedAbelianMonoid
  [Node list symbol=OrderedAbelianMonoid ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 DEFSubnode:atts=
  [Node list ]
  
 ]
 